/*
  File INITIALISExPARAMETER_ALLOCATE.c generated by XCOM-I, 2024-08-08
  04:34:25.
*/

#include "runtimeC.h"

int32_t
INITIALISExPARAMETER_ALLOCATE (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "INITIALISExPARAMETER_ALLOCATE");
  // IF PTYPE = APOINTER THEN (2520)
  if (1
      & (xEQ (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExPTYPE),
              BYTE0 (mAPOINTER))))
    // DO; (2521)
    {
    rs1:;
      // SYT_FLAGS(OP) = SYT_FLAGS(OP) | POINTER_FLAG; (2522)
      {
        int32_t numberRHS = (int32_t)(xOR (
            getFIXED (getFIXED (mSYM_TAB)
                      + 34 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP))
                      + 8 + 4 * (0)),
            getFIXED (mPOINTER_FLAG)));
        putFIXED (getFIXED (mSYM_TAB)
                      + 34 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP))
                      + 8 + 4 * (0),
                  numberRHS);
      }
      // TEMP = BIGHTS(DINTEGER) * LEN; (2523)
      {
        int32_t numberRHS = (int32_t)(xmultiply (
            BYTE0 (mBIGHTS + 1 * BYTE0 (mDINTEGER)),
            COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExLEN)));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mINITIALISExPARAMETER_ALLOCATExTEMP, bitRHS);
        bitRHS->inUse = 0;
      }
    es1:;
    } // End of DO block
  // ELSE (2524)
  else
    // TEMP = BIGHTS(PTYPE) * LEN; (2525)
    {
      int32_t numberRHS = (int32_t)(xmultiply (
          BYTE0 (mBIGHTS
                 + 1 * COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExPTYPE)),
          COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExLEN)));
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mINITIALISExPARAMETER_ALLOCATExTEMP, bitRHS);
      bitRHS->inUse = 0;
    }
  // SCOPE = SYT_SCOPE(OP); (2526)
  {
    descriptor_t *bitRHS = getBIT (
        8, getFIXED (mSYM_TAB)
               + 34 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP)) + 29
               + 1 * (0));
    putBIT (16, mINITIALISExPARAMETER_ALLOCATExSCOPE, bitRHS);
    bitRHS->inUse = 0;
  }
  // CALL NEED_STACK(SCOPE); (2527)
  {
    putBITp (16, mNEED_STACKxIX,
             getBIT (16, mINITIALISExPARAMETER_ALLOCATExSCOPE));
    NEED_STACK (0);
  }
  // SYT_PARM(OP) = -1; (2528)
  {
    int32_t numberRHS = (int32_t)(-1);
    putBIT (16,
            getFIXED (mP2SYMS)
                + 12 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP)) + 8
                + 2 * (0),
            fixedToBit (16, numberRHS));
  }
  // IF DATATYPE(PTYPE)=SCALAR THEN (2529)
  if (1
      & (xEQ (
          BYTE0 (mDATATYPE
                 + 1 * COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExPTYPE)),
          BYTE0 (mSCALAR))))
    // DO; (2530)
    {
    rs2:;
      // SYT_DISP(OP) = PARMTEMP; (2531)
      {
        int32_t numberRHS
            = (int32_t)(INITIALISExPARAMETER_ALLOCATExPARMTEMP (0));
        putBIT (16,
                getFIXED (mP2SYMS)
                    + 12 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP))
                    + 6 + 2 * (0),
                fixedToBit (16, numberRHS));
      }
      // IF FLTARG(SCOPE) <= 4 THEN (2532)
      if (1
          & (xLE (
              getFIXED (
                  mERRSEG
                  + 4 * COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExSCOPE)),
              4)))
        // SYT_PARM(OP) = FLTARG(SCOPE) + FR0; (2533)
        {
          int32_t numberRHS = (int32_t)(xadd (
              getFIXED (
                  mERRSEG
                  + 4 * COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExSCOPE)),
              BYTE0 (mFR0)));
          putBIT (16,
                  getFIXED (mP2SYMS)
                      + 12 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP))
                      + 8 + 2 * (0),
                  fixedToBit (16, numberRHS));
        }
      // FLTARG(SCOPE) = FLTARG(SCOPE) + 2; (2534)
      {
        int32_t numberRHS = (int32_t)(xadd (
            getFIXED (
                mERRSEG
                + 4 * COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExSCOPE)),
            2));
        putFIXED (
            mERRSEG
                + 4 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExSCOPE)),
            numberRHS);
      }
    es2:;
    } // End of DO block
  // ELSE (2535)
  else
    // IF PTYPE = APOINTER & LEN = 1 & PTRARG(SCOPE) = 0 THEN (2536)
    if (1
        & (xAND (
            xAND (xEQ (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExPTYPE),
                       BYTE0 (mAPOINTER)),
                  xEQ (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExLEN), 1)),
            xEQ (
                BYTE0 (
                    mINITIALISExPTRARG
                    + 1 * COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExSCOPE)),
                0))))
      // DO; (2537)
      {
      rs3:;
        // SYT_DISP(OP) = SHL(PTRARG1, 1) + REGISTER_SAVE_AREA; (2538)
        {
          int32_t numberRHS = (int32_t)(xadd (SHL (BYTE0 (mPTRARG1), 1),
                                              BYTE0 (mREGISTER_SAVE_AREA)));
          putBIT (16,
                  getFIXED (mP2SYMS)
                      + 12 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP))
                      + 6 + 2 * (0),
                  fixedToBit (16, numberRHS));
        }
        // SYT_PARM(OP) = PTRARG1; (2539)
        {
          descriptor_t *bitRHS = getBIT (8, mPTRARG1);
          putBIT (16,
                  getFIXED (mP2SYMS)
                      + 12 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP))
                      + 8 + 2 * (0),
                  bitRHS);
          bitRHS->inUse = 0;
        }
        // PTRARG(SCOPE) = 1; (2540)
        {
          int32_t numberRHS = (int32_t)(1);
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (
              1,
              mINITIALISExPTRARG
                  + 1 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExSCOPE)),
              bitRHS);
          bitRHS->inUse = 0;
        }
      es3:;
      } // End of DO block
    // ELSE (2541)
    else
      // DO; (2542)
      {
      rs4:;
        // IF FIXARG(SCOPE) > 3-LEN THEN (2543)
        if (1
            & (xGT (
                COREHALFWORD (
                    mSTACKSPACE
                    + 2 * COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExSCOPE)),
                xsubtract (
                    3, COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExLEN)))))
          // SYT_DISP(OP) = PARMTEMP; (2544)
          {
            int32_t numberRHS
                = (int32_t)(INITIALISExPARAMETER_ALLOCATExPARMTEMP (0));
            putBIT (
                16,
                getFIXED (mP2SYMS)
                    + 12 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP))
                    + 6 + 2 * (0),
                fixedToBit (16, numberRHS));
          }
        // ELSE (2545)
        else
          // DO; (2546)
          {
          rs4s1:;
            // SYT_DISP(OP) = SHL(FIXARG(SCOPE)+FIXARG1,1) +
            // REGISTER_SAVE_AREA; (2547)
            {
              int32_t numberRHS = (int32_t)(xadd (
                  SHL (
                      xadd (
                          COREHALFWORD (
                              mSTACKSPACE
                              + 2
                                    * COREHALFWORD (
                                        mINITIALISExPARAMETER_ALLOCATExSCOPE)),
                          BYTE0 (mFIXARG1)),
                      1),
                  BYTE0 (mREGISTER_SAVE_AREA)));
              putBIT (
                  16,
                  getFIXED (mP2SYMS)
                      + 12 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP))
                      + 6 + 2 * (0),
                  fixedToBit (16, numberRHS));
            }
            // SYT_PARM(OP) = FIXARG(SCOPE) + FIXARG1; (2548)
            {
              int32_t numberRHS = (int32_t)(xadd (
                  COREHALFWORD (
                      mSTACKSPACE
                      + 2
                            * COREHALFWORD (
                                mINITIALISExPARAMETER_ALLOCATExSCOPE)),
                  BYTE0 (mFIXARG1)));
              putBIT (
                  16,
                  getFIXED (mP2SYMS)
                      + 12 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP))
                      + 8 + 2 * (0),
                  fixedToBit (16, numberRHS));
            }
          es4s1:;
          } // End of DO block
        // FIXARG(SCOPE) = FIXARG(SCOPE) + LEN; (2549)
        {
          int32_t numberRHS = (int32_t)(xadd (
              COREHALFWORD (
                  mSTACKSPACE
                  + 2 * COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExSCOPE)),
              COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExLEN)));
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (
              16,
              mSTACKSPACE
                  + 2 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExSCOPE)),
              bitRHS);
          bitRHS->inUse = 0;
        }
      es4:;
      } // End of DO block
  // SYT_ADDR(OP) = SYT_DISP(OP); (2550)
  {
    descriptor_t *bitRHS = getBIT (
        16, getFIXED (mP2SYMS)
                + 12 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP)) + 6
                + 2 * (0));
    putFIXED (getFIXED (mSYM_TAB)
                  + 34 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP)) + 4
                  + 4 * (0),
              bitToFixed (bitRHS));
    bitRHS->inUse = 0;
  }
  // SYT_BASE(OP) = TEMPBASE; (2551)
  {
    descriptor_t *bitRHS = getBIT (8, mTEMPBASE);
    putBIT (16,
            getFIXED (mP2SYMS)
                + 12 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP)) + 4
                + 2 * (0),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // IF LEN > 1 THEN (2552)
  if (1 & (xGT (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExLEN), 1)))
    // SYT_LEVEL(OP) = LEN - 1; (2553)
    {
      int32_t numberRHS = (int32_t)(xsubtract (
          COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExLEN), 1));
      putBIT (16,
              getFIXED (mP2SYMS)
                  + 12 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP))
                  + 10 + 2 * (0),
              fixedToBit (16, numberRHS));
    }
  // IF ASSEMBLER_CODE THEN (2554)
  if (1 & (bitToFixed (getBIT (1, mASSEMBLER_CODE))))
    // DO; (2555)
    {
    rs5:;
      // OUTPUT=SYT_NAME(OP)||X2||LEFTBRACKET||EXTENT(OP)||RIGHTBRACKET||X2||
      // HEX(SYT_ADDR(OP),6)||X2||HEX(SYT_DISP(OP),3)||LEFTBRACKET||
      // SYT_BASE(OP)||RIGHTBRACKET||X2||SYT_CONST(OP); (2556)
      {
        descriptor_t *stringRHS;
        stringRHS = xsCAT (
            xsCAT (
                xsCAT (
                    xsCAT (
                        xsCAT (
                            xsCAT (
                                xsCAT (
                                    xsCAT (
                                        xsCAT (
                                            xsCAT (
                                                xsCAT (
                                                    xsCAT (
                                                        xsCAT (
                                                            getCHARACTER (
                                                                getFIXED (
                                                                    mSYM_TAB)
                                                                + 34
                                                                      * (COREHALFWORD (
                                                                          mINITIALISExPARAMETER_ALLOCATExOP))
                                                                + 0 + 4 * (0)),
                                                            getCHARACTER (
                                                                mX2)),
                                                        getCHARACTER (
                                                            mLEFTBRACKET)),
                                                    fixedToCharacter (getFIXED (
                                                        getFIXED (mSYM_TAB)
                                                        + 34
                                                              * (COREHALFWORD (
                                                                  mINITIALISExPARAMETER_ALLOCATExOP))
                                                        + 12 + 4 * (0)))),
                                                getCHARACTER (mRIGHTBRACKET)),
                                            getCHARACTER (mX2)),
                                        (putFIXED (
                                             mHEXxHVAL,
                                             getFIXED (
                                                 getFIXED (mSYM_TAB)
                                                 + 34
                                                       * (COREHALFWORD (
                                                           mINITIALISExPARAMETER_ALLOCATExOP))
                                                 + 4 + 4 * (0))),
                                         putFIXED (mHEXxN, 6), HEX (0))),
                                    getCHARACTER (mX2)),
                                (putFIXED (
                                     mHEXxHVAL,
                                     COREHALFWORD (
                                         getFIXED (mP2SYMS)
                                         + 12
                                               * (COREHALFWORD (
                                                   mINITIALISExPARAMETER_ALLOCATExOP))
                                         + 6 + 2 * (0))),
                                 putFIXED (mHEXxN, 3), HEX (0))),
                            getCHARACTER (mLEFTBRACKET)),
                        bitToCharacter (getBIT (
                            16,
                            getFIXED (mP2SYMS)
                                + 12
                                      * (COREHALFWORD (
                                          mINITIALISExPARAMETER_ALLOCATExOP))
                                + 4 + 2 * (0)))),
                    getCHARACTER (mRIGHTBRACKET)),
                getCHARACTER (mX2)),
            fixedToCharacter (getFIXED (
                getFIXED (mP2SYMS)
                + 12 * (COREHALFWORD (mINITIALISExPARAMETER_ALLOCATExOP)) + 0
                + 4 * (0))));
        OUTPUT (0, stringRHS);
        stringRHS->inUse = 0;
      }
    es5:;
    } // End of DO block
  {
    reentryGuard = 0;
    return 0;
  }
}
