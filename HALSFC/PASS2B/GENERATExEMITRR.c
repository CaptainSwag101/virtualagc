/*
  File GENERATExEMITRR.c generated by XCOM-I, 2024-08-09 12:41:32.
*/

#include "runtimeC.h"

int32_t
GENERATExEMITRR (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GENERATExEMITRR");
  // IF REG1 < 0 THEN (2994)
  if (1 & (xLT (COREHALFWORD (mGENERATExEMITRRxREG1), 0)))
    // CALL ERRORS(CLASS_BI,511,'ACCUMULATOR'); (2995)
    {
      putBITp (16, mERRORSxCLASS, getBIT (8, mCLASS_BI));
      putBITp (16, mERRORSxNUM, fixedToBit (32, (int32_t)(511)));
      putCHARACTERp (mERRORSxTEXT, cToDescriptor (NULL, "ACCUMULATOR"));
      ERRORS (0);
    }
  // IF REG2 < 0 THEN (2996)
  if (1 & (xLT (COREHALFWORD (mGENERATExEMITRRxREG2), 0)))
    // CALL ERRORS(CLASS_BI,511,'ACCUMULATOR'); (2997)
    {
      putBITp (16, mERRORSxCLASS, getBIT (8, mCLASS_BI));
      putBITp (16, mERRORSxNUM, fixedToBit (32, (int32_t)(511)));
      putCHARACTERp (mERRORSxTEXT, cToDescriptor (NULL, "ACCUMULATOR"));
      ERRORS (0);
    }
  // IF INST ~<  4 THEN (2998)
  if (1 & (xGE (COREHALFWORD (mGENERATExEMITRRxINST), 4)))
    // REG2 = REG2 & RM; (2999)
    {
      int32_t numberRHS = (int32_t)(xAND (COREHALFWORD (mGENERATExEMITRRxREG2),
                                          getFIXED (mRM)));
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mGENERATExEMITRRxREG2, bitRHS);
      bitRHS->inUse = 0;
    }
  // IF ASSEMBLER_CODE THEN (3000)
  if (1 & (bitToFixed (getBIT (1, mASSEMBLER_CODE))))
    // DO; (3001)
    {
    rs1:;
      // MESSAGE=INSTRUCTION(INST)||X3||(REG1&RM)||COMMA||REG2; (3002)
      {
        descriptor_t *stringRHS;
        stringRHS = xsCAT (
            xsCAT (xsCAT (xsCAT ((putBITp (16, mINSTRUCTIONxOPCODE,
                                           getBIT (16, mGENERATExEMITRRxINST)),
                                  INSTRUCTION (0)),
                                 getCHARACTER (mX3)),
                          fixedToCharacter (
                              xAND (COREHALFWORD (mGENERATExEMITRRxREG1),
                                    getFIXED (mRM)))),
                   getCHARACTER (mCOMMA)),
            bitToCharacter (getBIT (16, mGENERATExEMITRRxREG2)));
        putCHARACTER (mMESSAGE, stringRHS);
        stringRHS->inUse = 0;
      }
      // OUTPUT=HEX_LOCCTR||X3||MESSAGE||INFO; (3003)
      {
        descriptor_t *stringRHS;
        stringRHS = xsCAT (xsCAT (xsCAT (HEX_LOCCTR (0), getCHARACTER (mX3)),
                                  getCHARACTER (mMESSAGE)),
                           getCHARACTER (mINFO));
        OUTPUT (0, stringRHS);
        stringRHS->inUse = 0;
      }
      // INFO=''; (3004)
      {
        descriptor_t *stringRHS;
        stringRHS = cToDescriptor (NULL, "");
        putCHARACTER (mINFO, stringRHS);
        stringRHS->inUse = 0;
      }
    es1:;
    } // End of DO block
  // IF DATA_REMOTE & (D_R1_CHANGE | D_R3_CHANGE) THEN (3005)
  if (1
      & (xAND (BYTE0 (mDATA_REMOTE),
               xOR (BYTE0 (mD_R1_CHANGE), BYTE0 (mD_R3_CHANGE)))))
    // CALL CHECK_RESTORE_R1R3(INST, 0, 0, REG1,RRTYPE); (3006)
    {
      putBITp (16, mGENERATExCHECK_RESTORE_R1R3xINST,
               getBIT (16, mGENERATExEMITRRxINST));
      putBITp (16, mGENERATExCHECK_RESTORE_R1R3xFLAG,
               fixedToBit (32, (int32_t)(0)));
      putBITp (16, mGENERATExCHECK_RESTORE_R1R3xXBASE,
               fixedToBit (32, (int32_t)(0)));
      putBITp (16, mGENERATExCHECK_RESTORE_R1R3xCOND,
               getBIT (16, mGENERATExEMITRRxREG1));
      putBITp (16, mGENERATExCHECK_RESTORE_R1R3xINSTYPE, getBIT (8, mRRTYPE));
      GENERATExCHECK_RESTORE_R1R3 (0);
    }
  // CALL EMITC(RRTYPE, SHL(INST,8) | SHL(REG1&RM,4) | REG2); (3007)
  {
    putBITp (16, mEMITCxTYPE, getBIT (8, mRRTYPE));
    putBITp (16, mEMITCxINST,
             fixedToBit (
                 32, (int32_t)(xOR (
                         xOR (SHL (COREHALFWORD (mGENERATExEMITRRxINST), 8),
                              SHL (xAND (COREHALFWORD (mGENERATExEMITRRxREG1),
                                         getFIXED (mRM)),
                                   4)),
                         COREHALFWORD (mGENERATExEMITRRxREG2)))));
    EMITC (0);
  }
  // CALL OPSTAT(INST, REG1); (3008)
  {
    putBITp (16, mGENERATExOPSTATxINST, getBIT (16, mGENERATExEMITRRxINST));
    putBITp (16, mGENERATExOPSTATxXREG, getBIT (16, mGENERATExEMITRRxREG1));
    GENERATExOPSTAT (0);
  }
  // IF (DOUBLE_TYPE(REG1) > 0) & (REG1 >= FR0) & (INST= 57) THEN (3009)
  if (1
      & (xAND (xAND (xGT (BYTE0 (mDOUBLE_TYPE
                                 + 1 * COREHALFWORD (mGENERATExEMITRRxREG1)),
                          0),
                     xGE (COREHALFWORD (mGENERATExEMITRRxREG1), BYTE0 (mFR0))),
               xEQ (COREHALFWORD (mGENERATExEMITRRxINST), 57))))
    // R_TYPE(REG1)=DOUBLE_TYPE(REG1); (3010)
    {
      descriptor_t *bitRHS = getBIT (
          8, mDOUBLE_TYPE + 1 * COREHALFWORD (mGENERATExEMITRRxREG1));
      putBIT (8, mR_TYPE + 1 * (COREHALFWORD (mGENERATExEMITRRxREG1)), bitRHS);
      bitRHS->inUse = 0;
    }
  // IF (DOUBLE_TYPE(REG2) > 0) & (REG2 >= FR0) THEN (3011)
  if (1
      & (xAND (
          xGT (BYTE0 (mDOUBLE_TYPE + 1 * COREHALFWORD (mGENERATExEMITRRxREG2)),
               0),
          xGE (COREHALFWORD (mGENERATExEMITRRxREG2), BYTE0 (mFR0)))))
    // R_TYPE(REG2)=DOUBLE_TYPE(REG2); (3012)
    {
      descriptor_t *bitRHS = getBIT (
          8, mDOUBLE_TYPE + 1 * COREHALFWORD (mGENERATExEMITRRxREG2));
      putBIT (8, mR_TYPE + 1 * (COREHALFWORD (mGENERATExEMITRRxREG2)), bitRHS);
      bitRHS->inUse = 0;
    }
  {
    reentryGuard = 0;
    return 0;
  }
}
