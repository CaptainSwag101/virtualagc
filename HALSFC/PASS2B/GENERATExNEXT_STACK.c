/*
  File GENERATExNEXT_STACK.c generated by XCOM-I, 2024-08-08 04:34:25.
*/

#include "runtimeC.h"

descriptor_t *
GENERATExNEXT_STACK (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (descriptor_t *)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GENERATExNEXT_STACK");
  // PTR = STACK_PTR; (2780)
  {
    descriptor_t *bitRHS = getBIT (16, mSTACK_PTR);
    putBIT (16, mGENERATExNEXT_STACKxPTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // STACK_PTR = STACK_PTR(STACK_PTR); (2781)
  {
    descriptor_t *bitRHS
        = getBIT (16, mSTACK_PTR + 2 * COREHALFWORD (mSTACK_PTR));
    putBIT (16, mSTACK_PTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF PTR = 0 THEN (2782)
  if (1 & (xEQ (COREHALFWORD (mGENERATExNEXT_STACKxPTR), 0)))
    // CALL ERRORS(CLASS_BS, 106); (2783)
    {
      putBITp (16, mERRORSxCLASS, getBIT (8, mCLASS_BS));
      putBITp (16, mERRORSxNUM, fixedToBit (32, (int32_t)(106)));
      ERRORS (0);
    }
  // STACK_PTR(PTR) = -1; (2784)
  {
    int32_t numberRHS = (int32_t)(-1);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mSTACK_PTR + 2 * (COREHALFWORD (mGENERATExNEXT_STACKxPTR)),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // IF PTR > STACK_MAX THEN (2785)
  if (1
      & (xGT (COREHALFWORD (mGENERATExNEXT_STACKxPTR),
              COREHALFWORD (mSTACK_MAX))))
    // STACK_MAX = PTR; (2786)
    {
      descriptor_t *bitRHS = getBIT (16, mGENERATExNEXT_STACKxPTR);
      putBIT (16, mSTACK_MAX, bitRHS);
      bitRHS->inUse = 0;
    }
  // IF DIAGNOSTICS THEN (2787)
  if (1 & (bitToFixed (getBIT (1, mDIAGNOSTICS))))
    // OUTPUT = 'GOT STAK ' || PTR; (2788)
    {
      descriptor_t *stringRHS;
      stringRHS
          = xsCAT (cToDescriptor (NULL, "GOT STAK "),
                   bitToCharacter (getBIT (16, mGENERATExNEXT_STACKxPTR)));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // RETURN PTR; (2789)
  {
    reentryGuard = 0;
    return getBIT (16, mGENERATExNEXT_STACKxPTR);
  }
}
