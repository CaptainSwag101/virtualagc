/*
  File GENERATExARRAY2_INDEX_MOD.c generated by XCOM-I, 2024-08-09 12:41:32.
*/

#include "runtimeC.h"

int32_t
GENERATExARRAY2_INDEX_MOD (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GENERATExARRAY2_INDEX_MOD");
  // IF SELF_ALIGNING THEN (5678)
  if (1 & (bitToFixed (getBIT (1, mSELF_ALIGNING))))
    // SHIFTCT = 0; (5679)
    {
      int32_t numberRHS = (int32_t)(0);
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mGENERATExARRAY2_INDEX_MODxSHIFTCT, bitRHS);
      bitRHS->inUse = 0;
    }
  // IF OP = 0 THEN (5680)
  if (1 & (xEQ (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOP), 0)))
    // DO; (5681)
    {
    rs1:;
      // OPX = GET_STACK_ENTRY; (5682)
      {
        int32_t numberRHS = (int32_t)(GENERATExGET_STACK_ENTRY (0));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGENERATExARRAY2_INDEX_MODxOPX, bitRHS);
        bitRHS->inUse = 0;
      }
      // FORM(OPX) = AIDX2; (5683)
      {
        descriptor_t *bitRHS = getBIT (8, mAIDX2);
        putBIT (16,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOPX)) + 32
                    + 2 * (0),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // LOC(OPX) = INDEX1; (5684)
      {
        descriptor_t *bitRHS = getBIT (16, mGENERATExARRAY2_INDEX_MODxINDEX1);
        putBIT (16,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOPX)) + 40
                    + 2 * (0),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // LOC2(OPX) = INDEX2; (5685)
      {
        descriptor_t *bitRHS = getBIT (16, mGENERATExARRAY2_INDEX_MODxINDEX2);
        putBIT (16,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOPX)) + 42
                    + 2 * (0),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // TYPE(OPX) = INTEGER; (5686)
      {
        descriptor_t *bitRHS = getBIT (8, mINTEGER);
        putBIT (16,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOPX)) + 50
                    + 2 * (0),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // INX_SHIFT(OPX) = SHIFTCT; (5687)
      {
        descriptor_t *bitRHS = getBIT (16, mGENERATExARRAY2_INDEX_MODxSHIFTCT);
        putBIT (8,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOPX)) + 64
                    + 1 * (0),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // XVAL(OPX) = MULT; (5688)
      {
        descriptor_t *bitRHS = getBIT (16, mGENERATExARRAY2_INDEX_MODxMULT);
        putFIXED (getFIXED (mIND_STACK)
                      + 73 * (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOPX))
                      + 16 + 4 * (0),
                  bitToFixed (bitRHS));
        bitRHS->inUse = 0;
      }
      // DO I = 0 TO SHIFTCT ~= 0; (5689)
      {
        int32_t from65, to65, by65;
        from65 = 0;
        to65 = xNEQ (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxSHIFTCT), 0);
        by65 = 1;
        for (putBIT (16, mGENERATExARRAY2_INDEX_MODxI,
                     fixedToBit (16, from65));
             bitToFixed (getBIT (16, mGENERATExARRAY2_INDEX_MODxI)) <= to65;
             putBIT (16, mGENERATExARRAY2_INDEX_MODxI,
                     fixedToBit (16, bitToFixed (getBIT (
                                         16, mGENERATExARRAY2_INDEX_MODxI))
                                         + by65)))
          {
            // REG(OPX) = SEARCH_INDEX2(OPX); (5690)
            {
              int32_t numberRHS = (int32_t)((
                  putBITp (16, mGENERATExSEARCH_INDEX2xOP,
                           getBIT (16, mGENERATExARRAY2_INDEX_MODxOPX)),
                  GENERATExSEARCH_INDEX2 (0)));
              putBIT (
                  16,
                  getFIXED (mIND_STACK)
                      + 73 * (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOPX))
                      + 46 + 2 * (0),
                  fixedToBit (16, numberRHS));
            }
            // IF REG(OPX) >= 0 THEN (5691)
            if (1
                & (xGE (
                    COREHALFWORD (
                        getFIXED (mIND_STACK)
                        + 73 * (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOPX))
                        + 46 + 2 * (0)),
                    0)))
              // DO; (5692)
              {
              rs1s1s1:;
                // CALL UPDATE_INX_USAGE(OPX); (5693)
                {
                  putBITp (16, mGENERATExUPDATE_INX_USAGExOP,
                           getBIT (16, mGENERATExARRAY2_INDEX_MODxOPX));
                  GENERATExUPDATE_INX_USAGE (0);
                }
                // LOC2(OPX) = -1; (5694)
                {
                  int32_t numberRHS = (int32_t)(-1);
                  putBIT (16,
                          getFIXED (mIND_STACK)
                              + 73
                                    * (COREHALFWORD (
                                        mGENERATExARRAY2_INDEX_MODxOPX))
                              + 42 + 2 * (0),
                          fixedToBit (16, numberRHS));
                }
                // FORM(OPX) = VAC; (5695)
                {
                  descriptor_t *bitRHS = getBIT (8, mVAC);
                  putBIT (16,
                          getFIXED (mIND_STACK)
                              + 73
                                    * (COREHALFWORD (
                                        mGENERATExARRAY2_INDEX_MODxOPX))
                              + 32 + 2 * (0),
                          bitRHS);
                  bitRHS->inUse = 0;
                }
                // RETURN OPX; (5696)
                {
                  reentryGuard = 0;
                  return COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOPX);
                }
              es1s1s1:;
              } // End of DO block
            // INX_SHIFT(OPX) = 0; (5697)
            {
              int32_t numberRHS = (int32_t)(0);
              putBIT (
                  8,
                  getFIXED (mIND_STACK)
                      + 73 * (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOPX))
                      + 64 + 1 * (0),
                  fixedToBit (8, numberRHS));
            }
            // TO_BE_MODIFIED = TRUE; (5698)
            {
              int32_t numberRHS = (int32_t)(1);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (1, mGENERATExTO_BE_MODIFIED, bitRHS);
              bitRHS->inUse = 0;
            }
          }
      } // End of DO for-loop block
      // CALL RETURN_STACK_ENTRY(OPX); (5699)
      {
        putBITp (16, mGENERATExRETURN_STACK_ENTRYxP,
                 getBIT (16, mGENERATExARRAY2_INDEX_MODxOPX));
        GENERATExRETURN_STACK_ENTRY (0);
      }
    es1:;
    } // End of DO block
  // OPX = ARRAY_INDEX_MOD(OP, INDEX1); (5700)
  {
    descriptor_t *bitRHS
        = (putBITp (16, mGENERATExARRAY_INDEX_MODxOP,
                    getBIT (16, mGENERATExARRAY2_INDEX_MODxOP)),
           putBITp (16, mGENERATExARRAY_INDEX_MODxINDEX,
                    getBIT (16, mGENERATExARRAY2_INDEX_MODxINDEX1)),
           GENERATExARRAY_INDEX_MOD (0));
    putBIT (16, mGENERATExARRAY2_INDEX_MODxOPX, bitRHS);
    bitRHS->inUse = 0;
  }
  // CALL SUBSCRIPT_MULT(OPX, MULT); (5701)
  {
    putBITp (16, mGENERATExSUBSCRIPT_MULTxOP,
             getBIT (16, mGENERATExARRAY2_INDEX_MODxOPX));
    putFIXED (mGENERATExSUBSCRIPT_MULTxVALUE,
              COREHALFWORD (mGENERATExARRAY2_INDEX_MODxMULT));
    GENERATExSUBSCRIPT_MULT (0);
  }
  // OPX = ARRAY_INDEX_MOD(OPX, INDEX2); (5702)
  {
    descriptor_t *bitRHS
        = (putBITp (16, mGENERATExARRAY_INDEX_MODxOP,
                    getBIT (16, mGENERATExARRAY2_INDEX_MODxOPX)),
           putBITp (16, mGENERATExARRAY_INDEX_MODxINDEX,
                    getBIT (16, mGENERATExARRAY2_INDEX_MODxINDEX2)),
           GENERATExARRAY_INDEX_MOD (0));
    putBIT (16, mGENERATExARRAY2_INDEX_MODxOPX, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF OP = 0 THEN (5703)
  if (1 & (xEQ (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOP), 0)))
    // DO; (5704)
    {
    rs2:;
      // I = REG(OPX); (5705)
      {
        descriptor_t *bitRHS = getBIT (
            16, getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOPX)) + 46
                    + 2 * (0));
        putBIT (16, mGENERATExARRAY2_INDEX_MODxI, bitRHS);
        bitRHS->inUse = 0;
      }
      // CALL SET_USAGE(I, AIDX2, INDEX1); (5706)
      {
        putBITp (16, mGENERATExSET_USAGExR,
                 getBIT (16, mGENERATExARRAY2_INDEX_MODxI));
        putBITp (16, mGENERATExSET_USAGExRFORM, getBIT (8, mAIDX2));
        putFIXED (mGENERATExSET_USAGExRVAR,
                  COREHALFWORD (mGENERATExARRAY2_INDEX_MODxINDEX1));
        GENERATExSET_USAGE (0);
      }
      // R_VAR2(I) = INDEX2; (5707)
      {
        descriptor_t *bitRHS = getBIT (16, mGENERATExARRAY2_INDEX_MODxINDEX2);
        putBIT (16,
                mR_VAR2 + 2 * (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxI)),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // R_MULT(I) = MULT; (5708)
      {
        descriptor_t *bitRHS = getBIT (16, mGENERATExARRAY2_INDEX_MODxMULT);
        putBIT (16,
                mR_MULT + 2 * (COREHALFWORD (mGENERATExARRAY2_INDEX_MODxI)),
                bitRHS);
        bitRHS->inUse = 0;
      }
    es2:;
    } // End of DO block
  // RETURN OPX; (5709)
  {
    reentryGuard = 0;
    return COREHALFWORD (mGENERATExARRAY2_INDEX_MODxOPX);
  }
}
