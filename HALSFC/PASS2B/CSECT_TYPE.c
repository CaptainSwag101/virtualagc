/*
  File CSECT_TYPE.c generated by XCOM-I, 2024-08-08 04:34:25.
*/

#include "runtimeC.h"

descriptor_t *
CSECT_TYPE (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (descriptor_t *)0;
    }
  reentryGuard = guardReentry (reentryGuard, "CSECT_TYPE");
  // IF OP=0 THEN (809)
  if (1 & (xEQ (COREHALFWORD (mCSECT_TYPExOP), 0)))
    // FRM,LC2,STRC_WLK,P_R = 0; (810)
    {
      int32_t numberRHS = (int32_t)(0);
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mCSECT_TYPExFRM, bitRHS);
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mCSECT_TYPExLC2, bitRHS);
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mCSECT_TYPExSTRC_WLK, bitRHS);
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mCSECT_TYPExP_R, bitRHS);
      bitRHS->inUse = 0;
    }
  // ELSE (811)
  else
    // DO; (812)
    {
    rs1:;
      // FRM = IND_STACK(OP).I_FORM; (813)
      {
        descriptor_t *bitRHS = getBIT (
            16, getFIXED (mIND_STACK) + 73 * (COREHALFWORD (mCSECT_TYPExOP))
                    + 32 + 2 * (0));
        putBIT (16, mCSECT_TYPExFRM, bitRHS);
        bitRHS->inUse = 0;
      }
      // LC2 = IND_STACK(OP).I_LOC2; (814)
      {
        descriptor_t *bitRHS = getBIT (
            16, getFIXED (mIND_STACK) + 73 * (COREHALFWORD (mCSECT_TYPExOP))
                    + 42 + 2 * (0));
        putBIT (16, mCSECT_TYPExLC2, bitRHS);
        bitRHS->inUse = 0;
      }
      // STRC_WLK = IND_STACK(OP).I_STRUCT_WALK; (815)
      {
        descriptor_t *bitRHS = getBIT (
            8, getFIXED (mIND_STACK) + 73 * (COREHALFWORD (mCSECT_TYPExOP))
                   + 71 + 1 * (0));
        putBIT (16, mCSECT_TYPExSTRC_WLK, bitRHS);
        bitRHS->inUse = 0;
      }
      // P_R = IND_STACK(OP).I_PNTREMT; (816)
      {
        descriptor_t *bitRHS = getBIT (
            8, getFIXED (mIND_STACK) + 73 * (COREHALFWORD (mCSECT_TYPExOP))
                   + 68 + 1 * (0));
        putBIT (16, mCSECT_TYPExP_R, bitRHS);
        bitRHS->inUse = 0;
      }
      // OP = 0; (817)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mCSECT_TYPExOP, bitRHS);
        bitRHS->inUse = 0;
      }
    es1:;
    } // End of DO block
  // IF PTR < 1 THEN (818)
  if (1 & (xLT (COREHALFWORD (mCSECT_TYPExPTR), 1)))
    // RETURN -1; (819)
    {
      reentryGuard = 0;
      return fixedToBit (32, (int32_t)(-1));
    }
  // IF (FRM = LIT) | ((FRM > 7) & (FRM < 14)) THEN (820)
  if (1
      & (xOR (xEQ (COREHALFWORD (mCSECT_TYPExFRM), BYTE0 (mLIT)),
              xAND (xGT (COREHALFWORD (mCSECT_TYPExFRM), 7),
                    xLT (COREHALFWORD (mCSECT_TYPExFRM), 14)))))
    // DO; (821)
    {
    rs2:;
      // RETURN LOCAL#D; (822)
      {
        reentryGuard = 0;
        return fixedToBit (32, (int32_t)(6));
      }
    es2:;
    } // End of DO block
  // IF (FRM=WORK) | (LC2=-1) THEN (823)
  if (1
      & (xOR (xEQ (COREHALFWORD (mCSECT_TYPExFRM), BYTE0 (mWORK)),
              xEQ (COREHALFWORD (mCSECT_TYPExLC2), -1))))
    // DO; (824)
    {
    rs3:;
      // RETURN STACKVAL; (825)
      {
        reentryGuard = 0;
        return fixedToBit (32, (int32_t)(0));
      }
    es3:;
    } // End of DO block
  // IF STRC_WLK THEN (826)
  if (1 & (bitToFixed (getBIT (16, mCSECT_TYPExSTRC_WLK))))
    // DO; (827)
    {
    rs4:;
      // IF P_R THEN (828)
      if (1 & (bitToFixed (getBIT (16, mCSECT_TYPExP_R))))
        // RETURN STRUCT_NAME32; (829)
        {
          reentryGuard = 0;
          return fixedToBit (32, (int32_t)(8));
        }
      // ELSE (830)
      else
        // RETURN STRUCT_NAME16; (831)
        {
          reentryGuard = 0;
          return fixedToBit (32, (int32_t)(9));
        }
    es4:;
    } // End of DO block
  // ELSE (832)
  else
    // IF (SYT_FLAGS(PTR) & POINTER_FLAG) ~= 0 THEN (833)
    if (1
        & (xNEQ (xAND (getFIXED (getFIXED (mSYM_TAB)
                                 + 34 * (COREHALFWORD (mCSECT_TYPExPTR)) + 8
                                 + 4 * (0)),
                       getFIXED (mPOINTER_FLAG)),
                 0)))
      // DO; (834)
      {
      rs5:;
        // RETURN STACKADDR; (835)
        {
          reentryGuard = 0;
          return fixedToBit (32, (int32_t)(1));
        }
      es5:;
      } // End of DO block
    // ELSE (836)
    else
      // IF ((SYT_FLAGS(PTR) & TEMPORARY_FLAG) ~= 0) | ((SYT_FLAGS(PTR) &
      // PARM_FLAGS) ~= 0) | (((SYT_FLAGS(PTR) & AUTO_FLAG) ~= 0) &
      // ((SYT_FLAGS(PROC_LEVEL(SYT_SCOPE(PTR))) & REENTRANT_FLAG)~=0)) THEN
      // (837)
      if (1
          & (xOR (
              xOR (
                  xNEQ (xAND (getFIXED (getFIXED (mSYM_TAB)
                                        + 34 * (COREHALFWORD (mCSECT_TYPExPTR))
                                        + 8 + 4 * (0)),
                              getFIXED (mTEMPORARY_FLAG)),
                        0),
                  xNEQ (xAND (getFIXED (getFIXED (mSYM_TAB)
                                        + 34 * (COREHALFWORD (mCSECT_TYPExPTR))
                                        + 8 + 4 * (0)),
                              getFIXED (mPARM_FLAGS)),
                        0)),
              xAND (
                  xNEQ (xAND (getFIXED (getFIXED (mSYM_TAB)
                                        + 34 * (COREHALFWORD (mCSECT_TYPExPTR))
                                        + 8 + 4 * (0)),
                              getFIXED (mAUTO_FLAG)),
                        0),
                  xNEQ (
                      xAND (getFIXED (
                                getFIXED (mSYM_TAB)
                                + 34
                                      * (COREHALFWORD (
                                          mPROC_LEVEL
                                          + 2
                                                * BYTE0 (
                                                    getFIXED (mSYM_TAB)
                                                    + 34
                                                          * (COREHALFWORD (
                                                              mCSECT_TYPExPTR))
                                                    + 29 + 1 * (0))))
                                + 8 + 4 * (0)),
                            getFIXED (mREENTRANT_FLAG)),
                      0)))))
        // DO; (838)
        {
        rs6:;
          // RETURN STACKVAL; (839)
          {
            reentryGuard = 0;
            return fixedToBit (32, (int32_t)(0));
          }
        es6:;
        } // End of DO block
      // ELSE (840)
      else
        // IF (SYT_FLAGS(PTR) & INCLUDED_REMOTE) ~= 0 THEN (841)
        if (1
            & (xNEQ (xAND (getFIXED (getFIXED (mSYM_TAB)
                                     + 34 * (COREHALFWORD (mCSECT_TYPExPTR))
                                     + 8 + 4 * (0)),
                           getFIXED (mINCLUDED_REMOTE)),
                     0)))
          // DO; (842)
          {
          rs7:;
            // RETURN INCREM#P; (843)
            {
              reentryGuard = 0;
              return fixedToBit (32, (int32_t)(2));
            }
          es7:;
          } // End of DO block
        // ELSE (844)
        else
          // IF SYT_TYPE(PROC_LEVEL(SYT_SCOPE(PTR))) = COMPOOL_LABEL THEN (845)
          if (1
              & (xEQ (
                  BYTE0 (getFIXED (mSYM_TAB)
                         + 34
                               * (COREHALFWORD (
                                   mPROC_LEVEL
                                   + 2
                                         * BYTE0 (getFIXED (mSYM_TAB)
                                                  + 34
                                                        * (COREHALFWORD (
                                                            mCSECT_TYPExPTR))
                                                  + 29 + 1 * (0))))
                         + 32 + 1 * (0)),
                  BYTE0 (mCOMPOOL_LABEL))))
            // DO; (846)
            {
            rs8:;
              // IF (SYT_FLAGS(PTR) & NAME_OR_REMOTE) = REMOTE_FLAG THEN (847)
              if (1
                  & (xEQ (
                      xAND (getFIXED (getFIXED (mSYM_TAB)
                                      + 34 * (COREHALFWORD (mCSECT_TYPExPTR))
                                      + 8 + 4 * (0)),
                            getFIXED (mNAME_OR_REMOTE)),
                      getFIXED (mREMOTE_FLAG))))
                // RETURN COMPOOL#R; (848)
                {
                  reentryGuard = 0;
                  return fixedToBit (32, (int32_t)(3));
                }
              // ELSE (849)
              else
                // RETURN COMPOOL#P; (850)
                {
                  reentryGuard = 0;
                  return fixedToBit (32, (int32_t)(4));
                }
            es8:;
            } // End of DO block
          // ELSE (851)
          else
            // IF (SYT_FLAGS(PTR) & NAME_OR_REMOTE) = REMOTE_FLAG THEN (852)
            if (1
                & (xEQ (xAND (getFIXED (getFIXED (mSYM_TAB)
                                        + 34 * (COREHALFWORD (mCSECT_TYPExPTR))
                                        + 8 + 4 * (0)),
                              getFIXED (mNAME_OR_REMOTE)),
                        getFIXED (mREMOTE_FLAG))))
              // DO; (853)
              {
              rs9:;
                // RETURN REMOTE#R; (854)
                {
                  reentryGuard = 0;
                  return fixedToBit (32, (int32_t)(5));
                }
              es9:;
              } // End of DO block
            // ELSE (855)
            else
              // IF (SYT_TYPE(PTR) = PROG_LABEL) |  (SYT_TYPE(PTR) =
              // TASK_LABEL) THEN (856)
              if (1
                  & (xOR (xEQ (BYTE0 (getFIXED (mSYM_TAB)
                                      + 34 * (COREHALFWORD (mCSECT_TYPExPTR))
                                      + 32 + 1 * (0)),
                               BYTE0 (mPROG_LABEL)),
                          xEQ (BYTE0 (getFIXED (mSYM_TAB)
                                      + 34 * (COREHALFWORD (mCSECT_TYPExPTR))
                                      + 32 + 1 * (0)),
                               BYTE0 (mTASK_LABEL)))))
                // DO; (857)
                {
                rs10:;
                  // RETURN PDENTRY#E; (858)
                  {
                    reentryGuard = 0;
                    return fixedToBit (32, (int32_t)(7));
                  }
                es10:;
                } // End of DO block
              // ELSE (859)
              else
                // DO; (860)
                {
                rs11:;
                  // RETURN LOCAL#D; (861)
                  {
                    reentryGuard = 0;
                    return fixedToBit (32, (int32_t)(6));
                  }
                es11:;
                } // End of DO block
  {
    reentryGuard = 0;
    return 0;
  }
}
