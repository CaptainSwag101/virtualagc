/*
  File PUSH_STACK.c generated by XCOM-I, 2024-08-09 12:38:53.
*/

#include "runtimeC.h"

int32_t
PUSH_STACK (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "PUSH_STACK");
  // IF STACK_TRACE THEN (3284)
  if (1 & (bitToFixed (getBIT (8, mSTACK_TRACE))))
    // OUTPUT = 'PUSH_STACK(' || INL# || ',' || SAVE_TAGS || '):  ' || STT#;
    // (3285)
    {
      descriptor_t *stringRHS;
      stringRHS = xsCAT (
          xsCAT (xsCAT (xsCAT (xsCAT (cToDescriptor (NULL, "PUSH_STACK("),
                                      bitToCharacter (
                                          getBIT (16, mPUSH_STACKxINLp))),
                               cToDescriptor (NULL, ",")),
                        bitToCharacter (getBIT (8, mPUSH_STACKxSAVE_TAGS))),
                 cToDescriptor (NULL, "):  ")),
          bitToCharacter (getBIT (16, mSTTp)));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // S1 = SYT_SIZE + 1; (3286)
  {
    int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mSYT_SIZE), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mPUSH_STACKxS1, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO WHILE LEVEL >= RECORD_TOP(PAR_SYM); (3287)
  while (1
         & (xGE (COREHALFWORD (mLEVEL),
                 xsubtract (COREWORD (xadd (
                                ADDR ("PAR_SYM", 0x80000000, NULL, 0), 12)),
                            1))))
    {
      // DO ; (3288)
      {
      rs1s1:;
        // IF COREWORD ( ADDR ( PAR_SYM ) + 12 ) >= COREWORD ( ADDR ( PAR_SYM )
        // + 8 ) THEN (3289)
        if (1
            & (xGE (
                COREWORD (xadd (ADDR ("PAR_SYM", 0x80000000, NULL, 0), 12)),
                COREWORD (xadd (ADDR ("PAR_SYM", 0x80000000, NULL, 0), 8)))))
          // CALL _NEEDMORE_SPACE ( ADDR ( PAR_SYM )  ) ; (3290)
          {
            putFIXED (m_NEEDMORE_SPACExDOPE,
                      ADDR ("PAR_SYM", 0x80000000, NULL, 0));
            _NEEDMORE_SPACE (0);
          }
        // COREWORD ( ADDR ( PAR_SYM ) + 12 ) = COREWORD ( ADDR ( PAR_SYM ) +
        // 12 ) + 1 ; (3291)
        {
          int32_t numberRHS = (int32_t)(xadd (
              COREWORD (xadd (ADDR ("PAR_SYM", 0x80000000, NULL, 0), 12)), 1));
          COREWORD2 (xadd (ADDR ("PAR_SYM", 0x80000000, NULL, 0), 12),
                     numberRHS);
        }
      es1s1:;
      } // End of DO block
      // DO ; (3292)
      {
      rs1s2:;
        // IF COREWORD ( ADDR ( VAL_TABLE ) + 12 ) >= COREWORD ( ADDR (
        // VAL_TABLE ) + 8 ) THEN (3293)
        if (1
            & (xGE (
                COREWORD (xadd (ADDR ("VAL_TABLE", 0x80000000, NULL, 0), 12)),
                COREWORD (xadd (ADDR ("VAL_TABLE", 0x80000000, NULL, 0), 8)))))
          // CALL _NEEDMORE_SPACE ( ADDR ( VAL_TABLE )  ) ; (3294)
          {
            putFIXED (m_NEEDMORE_SPACExDOPE,
                      ADDR ("VAL_TABLE", 0x80000000, NULL, 0));
            _NEEDMORE_SPACE (0);
          }
        // COREWORD ( ADDR ( VAL_TABLE ) + 12 ) = COREWORD ( ADDR ( VAL_TABLE )
        // + 12 ) + 1 ; (3295)
        {
          int32_t numberRHS = (int32_t)(xadd (
              COREWORD (xadd (ADDR ("VAL_TABLE", 0x80000000, NULL, 0), 12)),
              1));
          COREWORD2 (xadd (ADDR ("VAL_TABLE", 0x80000000, NULL, 0), 12),
                     numberRHS);
        }
      es1s2:;
      } // End of DO block
      // DO ; (3296)
      {
      rs1s3:;
        // IF COREWORD ( ADDR ( LEVEL_STACK_VARS ) + 12 ) >= COREWORD ( ADDR (
        // LEVEL_STACK_VARS ) + 8 ) THEN (3297)
        if (1
            & (xGE (COREWORD (xadd (
                        ADDR ("LEVEL_STACK_VARS", 0x80000000, NULL, 0), 12)),
                    COREWORD (xadd (
                        ADDR ("LEVEL_STACK_VARS", 0x80000000, NULL, 0), 8)))))
          // CALL _NEEDMORE_SPACE ( ADDR ( LEVEL_STACK_VARS )  ) ; (3298)
          {
            putFIXED (m_NEEDMORE_SPACExDOPE,
                      ADDR ("LEVEL_STACK_VARS", 0x80000000, NULL, 0));
            _NEEDMORE_SPACE (0);
          }
        // COREWORD ( ADDR ( LEVEL_STACK_VARS ) + 12 ) = COREWORD ( ADDR (
        // LEVEL_STACK_VARS ) + 12 ) + 1 ; (3299)
        {
          int32_t numberRHS = (int32_t)(xadd (
              COREWORD (
                  xadd (ADDR ("LEVEL_STACK_VARS", 0x80000000, NULL, 0), 12)),
              1));
          COREWORD2 (xadd (ADDR ("LEVEL_STACK_VARS", 0x80000000, NULL, 0), 12),
                     numberRHS);
        }
      es1s3:;
      } // End of DO block
      // PULL_LOOP_HEAD(RECORD_TOP(LEVEL_STACK_VARS)) = -1; (3300)
      {
        int32_t numberRHS = (int32_t)(-1);
        putBIT (
            16,
            getFIXED (mLEVEL_STACK_VARS)
                + 11
                      * (xsubtract (COREWORD (xadd (ADDR ("LEVEL_STACK_VARS",
                                                          0x80000000, NULL, 0),
                                                    12)),
                                    1))
                + 4 + 2 * (0),
            fixedToBit (16, numberRHS));
      }
    } // End of DO WHILE block
  // DO FOR K = 0 TO SYT_SIZE; (3301)
  {
    int32_t from80, to80, by80;
    from80 = 0;
    to80 = bitToFixed (getBIT (16, mSYT_SIZE));
    by80 = 1;
    for (putBIT (16, mPUSH_STACKxK, fixedToBit (16, from80));
         bitToFixed (getBIT (16, mPUSH_STACKxK)) <= to80; putBIT (
             16, mPUSH_STACKxK,
             fixedToBit (16, bitToFixed (getBIT (16, mPUSH_STACKxK)) + by80)))
      {
        // PAR_SYM(LEVEL+1).CAT_ARRAY(K) = PAR_SYM(LEVEL).CAT_ARRAY(K); (3302)
        {
          descriptor_t *bitRHS
              = getBIT (16, getFIXED (mPAR_SYM) + 2 * (COREHALFWORD (mLEVEL))
                                + 0 + 2 * (COREHALFWORD (mPUSH_STACKxK)));
          putBIT (16,
                  getFIXED (mPAR_SYM) + 2 * (xadd (COREHALFWORD (mLEVEL), 1))
                      + 0 + 2 * (COREHALFWORD (mPUSH_STACKxK)),
                  bitRHS);
          bitRHS->inUse = 0;
        }
      }
  } // End of DO for-loop block
  // DO FOR K = 0 TO VAL_SIZE - 1; (3303)
  {
    int32_t from81, to81, by81;
    from81 = 0;
    to81 = xsubtract (COREHALFWORD (mVAL_SIZE), 1);
    by81 = 1;
    for (putBIT (16, mPUSH_STACKxK, fixedToBit (16, from81));
         bitToFixed (getBIT (16, mPUSH_STACKxK)) <= to81; putBIT (
             16, mPUSH_STACKxK,
             fixedToBit (16, bitToFixed (getBIT (16, mPUSH_STACKxK)) + by81)))
      {
        // VAL_TABLE(LEVEL+1).VAL_ARRAY(K) = VAL_TABLE(LEVEL).VAL_ARRAY(K);
        // (3304)
        {
          int32_t numberRHS = (int32_t)(getFIXED (
              getFIXED (mVAL_TABLE) + 4 * (COREHALFWORD (mLEVEL)) + 0
              + 4 * (COREHALFWORD (mPUSH_STACKxK))));
          putFIXED (getFIXED (mVAL_TABLE)
                        + 4 * (xadd (COREHALFWORD (mLEVEL), 1)) + 0
                        + 4 * (COREHALFWORD (mPUSH_STACKxK)),
                    numberRHS);
        }
      }
  } // End of DO for-loop block
  // IF ~SAVE_BLOCK# THEN (3305)
  if (1 & (xNOT (BYTE0 (mPUSH_STACKxSAVE_BLOCKp))))
    // BLOCK# = BUMP_BLOCK; (3306)
    {
      descriptor_t *bitRHS = BUMP_BLOCK (0);
      putBIT (16, mBLOCKp, bitRHS);
      bitRHS->inUse = 0;
    }
  // LEVEL = LEVEL + 1; (3307)
  {
    int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mLEVEL), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mLEVEL, bitRHS);
    bitRHS->inUse = 0;
  }
  // STACKED_BLOCK#(LEVEL) = BLOCK#; (3308)
  {
    descriptor_t *bitRHS = getBIT (16, mBLOCKp);
    putBIT (16,
            getFIXED (mLEVEL_STACK_VARS) + 11 * (COREHALFWORD (mLEVEL)) + 8
                + 2 * (0),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // IF SAVE_TAGS THEN (3309)
  if (1 & (bitToFixed (getBIT (8, mPUSH_STACKxSAVE_TAGS))))
    // SAVE_TAGS = 0; (3310)
    {
      int32_t numberRHS = (int32_t)(0);
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (8, mPUSH_STACKxSAVE_TAGS, bitRHS);
      bitRHS->inUse = 0;
    }
  // ELSE (3311)
  else
    // STACK_TAGS(LEVEL) = STACK_TAGS(LEVEL - 1) &  4; (3312)
    {
      int32_t numberRHS = (int32_t)(xAND (
          BYTE0 (getFIXED (mLEVEL_STACK_VARS)
                 + 11 * (xsubtract (COREHALFWORD (mLEVEL), 1)) + 10 + 1 * (0)),
          4));
      putBIT (8,
              getFIXED (mLEVEL_STACK_VARS) + 11 * (COREHALFWORD (mLEVEL)) + 10
                  + 1 * (0),
              fixedToBit (8, numberRHS));
    }
  // IF LOOP THEN (3313)
  if (1 & (bitToFixed (getBIT (8, mPUSH_STACKxLOOP))))
    // ZAP_BASE(LEVEL),LOOP_ZAPS_LEVEL=ZAP_LEVEL; (3314)
    {
      descriptor_t *bitRHS = getBIT (16, mZAP_LEVEL);
      putFIXED (getFIXED (mLEVEL_STACK_VARS) + 11 * (COREHALFWORD (mLEVEL)) + 0
                    + 4 * (0),
                bitToFixed (bitRHS));
      putBIT (16, mLOOP_ZAPS_LEVEL, bitRHS);
      bitRHS->inUse = 0;
    }
  // ELSE (3315)
  else
    // ZAP_BASE(LEVEL) = ZAP_BASE(LEVEL - 1); (3316)
    {
      int32_t numberRHS = (int32_t)(getFIXED (
          getFIXED (mLEVEL_STACK_VARS)
          + 11 * (xsubtract (COREHALFWORD (mLEVEL), 1)) + 0 + 4 * (0)));
      putFIXED (getFIXED (mLEVEL_STACK_VARS) + 11 * (COREHALFWORD (mLEVEL)) + 0
                    + 4 * (0),
                numberRHS);
    }
  // PULL_LOOP_HEAD(LEVEL) = PULL_LOOP_HEAD(LEVEL - 1); (3317)
  {
    descriptor_t *bitRHS = getBIT (
        16, getFIXED (mLEVEL_STACK_VARS)
                + 11 * (xsubtract (COREHALFWORD (mLEVEL), 1)) + 4 + 2 * (0));
    putBIT (16,
            getFIXED (mLEVEL_STACK_VARS) + 11 * (COREHALFWORD (mLEVEL)) + 4
                + 2 * (0),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // STACK_INL#(LEVEL) = INL#; (3318)
  {
    descriptor_t *bitRHS = getBIT (16, mPUSH_STACKxINLp);
    putBIT (16,
            getFIXED (mLEVEL_STACK_VARS) + 11 * (COREHALFWORD (mLEVEL)) + 6
                + 2 * (0),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // LOOP,INL#,SAVE_BLOCK# = 0; (3319)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mPUSH_STACKxLOOP, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mPUSH_STACKxINLp, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mPUSH_STACKxSAVE_BLOCKp, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF TRACE THEN (3320)
  if (1 & (bitToFixed (getBIT (8, mTRACE))))
    // CALL STACK_DUMP; (3321)
    STACK_DUMP (0);
  {
    reentryGuard = 0;
    return 0;
  }
}
