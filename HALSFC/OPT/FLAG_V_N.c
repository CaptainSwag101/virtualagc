/*
  File FLAG_V_N.c generated by XCOM-I, 2024-08-08 04:31:49.
*/

#include "runtimeC.h"

int32_t
FLAG_V_N (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "FLAG_V_N");
  // PTR = HALMAT_NODE_START; (4220)
  {
    descriptor_t *bitRHS = getBIT (16, mHALMAT_NODE_START);
    putBIT (16, mFLAG_V_NxPTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO WHILE PTR <= HALMAT_NODE_END; (4221)
  while (
      1
      & (xLE (COREHALFWORD (mFLAG_V_NxPTR), COREHALFWORD (mHALMAT_NODE_END))))
    {
      // IF FLAG(PTR) THEN (4222)
      if (1
          & (bitToFixed (
              getBIT (8, mFLAG + 1 * COREHALFWORD (mFLAG_V_NxPTR)))))
        // DO FOR I = 1 TO NO_OPERANDS(PTR); (4223)
        {
          int32_t from99, to99, by99;
          from99 = 1;
          to99 = bitToFixed (
              (putBITp (16, mNO_OPERANDSxPTR, getBIT (16, mFLAG_V_NxPTR)),
               NO_OPERANDS (0)));
          by99 = 1;
          for (putBIT (16, mFLAG_V_NxI, fixedToBit (16, from99));
               bitToFixed (getBIT (16, mFLAG_V_NxI)) <= to99;
               putBIT (16, mFLAG_V_NxI,
                       fixedToBit (16, bitToFixed (getBIT (16, mFLAG_V_NxI))
                                           + by99)))
            {
              // TMP = OPR(PTR + I); (4224)
              {
                int32_t numberRHS = (int32_t)(getFIXED (
                    mOPR
                    + 4
                          * xadd (COREHALFWORD (mFLAG_V_NxPTR),
                                  COREHALFWORD (mFLAG_V_NxI))));
                putFIXED (mFLAG_V_NxTMP, numberRHS);
              }
              // IF (SHR(TMP,4) &  15) = 1 THEN (4225)
              if (1 & (xEQ (xAND (SHR (getFIXED (mFLAG_V_NxTMP), 4), 15), 1)))
                // DO; (4226)
                {
                rs1s1s1:;
                  // IF CATALOG_PTR(SHR(TMP,16)) = (CSE &  65535) THEN (4227)
                  if (1
                      & (xEQ (
                          bitToFixed ((
                              putBITp (
                                  16, mCATALOG_PTRxPTR,
                                  fixedToBit (
                                      32, (int32_t)(SHR (
                                              getFIXED (mFLAG_V_NxTMP), 16)))),
                              CATALOG_PTR (0))),
                          xAND (getFIXED (mCSE), 65535))))
                    // DO; (4228)
                    {
                    rs1s1s1s1:;
                      // IF (SHR(CSE,20) & 1) = (SHR(FLAG(PTR + I),2) +
                      // ((FORWARD) & REVERSE) &  1) & VALIDITY(SHR(TMP,16))
                      // THEN (4229)
                      if (1
                          & (xAND (
                              xEQ (
                                  xAND (SHR (getFIXED (mCSE), 20), 1),
                                  xAND (
                                      xadd (
                                          SHR (
                                              BYTE0 (
                                                  mFLAG
                                                  + 1
                                                        * xadd (
                                                            COREHALFWORD (
                                                                mFLAG_V_NxPTR),
                                                            COREHALFWORD (
                                                                mFLAG_V_NxI))),
                                              2),
                                          xAND (BYTE0 (mFORWARD),
                                                BYTE0 (mREVERSE))),
                                      1)),
                              bitToFixed ((
                                  putBITp (
                                      16, mVALIDITYxPTR,
                                      fixedToBit (
                                          32,
                                          (int32_t)(SHR (
                                              getFIXED (mFLAG_V_NxTMP), 16)))),
                                  VALIDITY (0))))))
                        // IF ~SHR(FLAG(PTR + I),1) THEN (4230)
                        if (1
                            & (xNOT (SHR (
                                BYTE0 (
                                    mFLAG
                                    + 1
                                          * xadd (COREHALFWORD (mFLAG_V_NxPTR),
                                                  COREHALFWORD (mFLAG_V_NxI))),
                                1))))
                          // DO; (4231)
                          {
                          rs1s1s1s1s1:;
                            // CALL SET_FLAG(PTR+I,1); (4232)
                            {
                              putBITp (
                                  16, mSET_FLAGxPTR,
                                  fixedToBit (
                                      32, (int32_t)(xadd (
                                              COREHALFWORD (mFLAG_V_NxPTR),
                                              COREHALFWORD (mFLAG_V_NxI)))));
                              putBITp (8, mSET_FLAGxBITp,
                                       fixedToBit (32, (int32_t)(1)));
                              SET_FLAG (0);
                            }
                            // RETURN; (4233)
                            {
                              reentryGuard = 0;
                              return 0;
                            }
                          es1s1s1s1s1:;
                          } // End of DO block
                    es1s1s1s1:;
                    } // End of DO block
                es1s1s1:;
                } // End of DO block
            }
        } // End of DO for-loop block
      // PTR = PTR + NO_OPERANDS(PTR) + 1; (4234)
      {
        int32_t numberRHS = (int32_t)(xadd (
            xadd (COREHALFWORD (mFLAG_V_NxPTR),
                  bitToFixed ((putBITp (16, mNO_OPERANDSxPTR,
                                        getBIT (16, mFLAG_V_NxPTR)),
                               NO_OPERANDS (0)))),
            1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mFLAG_V_NxPTR, bitRHS);
        bitRHS->inUse = 0;
      }
    } // End of DO WHILE block
  {
    reentryGuard = 0;
    return 0;
  }
}
