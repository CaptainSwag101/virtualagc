/*
  File COMBINE_LOOPS.c generated by XCOM-I, 2024-08-09 12:38:53.
*/

#include "runtimeC.h"

int32_t
COMBINE_LOOPS (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "COMBINE_LOOPS");
  // IF C_TRACE THEN (2506)
  if (1 & (bitToFixed (getBIT (8, mC_TRACE))))
    // OUTPUT = 'COMBINE_LOOPS:'; (2507)
    {
      descriptor_t *stringRHS;
      stringRHS = cToDescriptor (NULL, "COMBINE_LOOPS:");
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // IF AR_SIZE <= 1 THEN (2508)
  if (1 & (xLE (COREHALFWORD (mAR_SIZE), 1)))
    // RETURN; (2509)
    {
      reentryGuard = 0;
      return 0;
    }
  // IF IN_VM THEN (2510)
  if (1 & (bitToFixed (getBIT (8, mIN_VM))))
    // DIMS = 1; (2511)
    {
      int32_t numberRHS = (int32_t)(1);
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mCOMBINE_LOOPSxDIMS, bitRHS);
      bitRHS->inUse = 0;
    }
  // ELSE (2512)
  else
    // DIMS = AR_DIMS; (2513)
    {
      descriptor_t *bitRHS = getBIT (8, mAR_DIMS);
      putBIT (16, mCOMBINE_LOOPSxDIMS, bitRHS);
      bitRHS->inUse = 0;
    }
  // DO FOR TEMP = 1 TO DIMS; (2514)
  {
    int32_t from58, to58, by58;
    from58 = 1;
    to58 = bitToFixed (getBIT (16, mCOMBINE_LOOPSxDIMS));
    by58 = 1;
    for (putBIT (16, mCOMBINE_LOOPSxTEMP, fixedToBit (16, from58));
         bitToFixed (getBIT (16, mCOMBINE_LOOPSxTEMP)) <= to58;
         putBIT (16, mCOMBINE_LOOPSxTEMP,
                 fixedToBit (16, bitToFixed (getBIT (16, mCOMBINE_LOOPSxTEMP))
                                     + by58)))
      {
        // OPR(LOOP_HEAD(1) + TEMP) = OPR(LOOP_HEAD + TEMP) | OPR(LOOP_HEAD(1)
        // + TEMP); (2515)
        {
          int32_t numberRHS = (int32_t)(xOR (
              getFIXED (mOPR
                        + 4
                              * xadd (COREHALFWORD (mLOOP_HEAD),
                                      COREHALFWORD (mCOMBINE_LOOPSxTEMP))),
              getFIXED (mOPR
                        + 4
                              * xadd (COREHALFWORD (mLOOP_HEAD + 2 * 1),
                                      COREHALFWORD (mCOMBINE_LOOPSxTEMP)))));
          putFIXED (mOPR
                        + 4
                              * (xadd (COREHALFWORD (mLOOP_HEAD + 2 * 1),
                                       COREHALFWORD (mCOMBINE_LOOPSxTEMP))),
                    numberRHS);
        }
        // OPR(LOOP_HEAD + TEMP) = 0; (2516)
        {
          int32_t numberRHS = (int32_t)(0);
          putFIXED (mOPR
                        + 4
                              * (xadd (COREHALFWORD (mLOOP_HEAD),
                                       COREHALFWORD (mCOMBINE_LOOPSxTEMP))),
                    numberRHS);
        }
      }
  } // End of DO for-loop block
  // OPR(LOOP_HEAD(1)) = OPR(LOOP_HEAD(1)) & ( 4294967287 | OPR(LOOP_HEAD));
  // (2517)
  {
    int32_t numberRHS = (int32_t)(xAND (
        getFIXED (mOPR + 4 * COREHALFWORD (mLOOP_HEAD + 2 * 1)),
        xOR (4294967287, getFIXED (mOPR + 4 * COREHALFWORD (mLOOP_HEAD)))));
    putFIXED (mOPR + 4 * (COREHALFWORD (mLOOP_HEAD + 2 * 1)), numberRHS);
  }
  // OPR(LOOP_END) = OPR(LOOP_END) & ( 4294967287 | OPR(LOOP_END(1))); (2518)
  {
    int32_t numberRHS = (int32_t)(xAND (
        getFIXED (mOPR + 4 * COREHALFWORD (mLOOP_END)),
        xOR (4294967287,
             getFIXED (mOPR + 4 * COREHALFWORD (mLOOP_END + 2 * 1)))));
    putFIXED (mOPR + 4 * (COREHALFWORD (mLOOP_END)), numberRHS);
  }
  // OPR(LOOP_END(1)) = 0; (2519)
  {
    int32_t numberRHS = (int32_t)(0);
    putFIXED (mOPR + 4 * (COREHALFWORD (mLOOP_END + 2 * 1)), numberRHS);
  }
  // OPR(LOOP_HEAD) = OPR(LOOP_HEAD) &  16711680; (2520)
  {
    int32_t numberRHS = (int32_t)(xAND (
        getFIXED (mOPR + 4 * COREHALFWORD (mLOOP_HEAD)), 16711680));
    putFIXED (mOPR + 4 * (COREHALFWORD (mLOOP_HEAD)), numberRHS);
  }
  // LOOP_END(1) = LOOP_END; (2521)
  {
    descriptor_t *bitRHS = getBIT (16, mLOOP_END);
    putBIT (16, mLOOP_END + 2 * (1), bitRHS);
    bitRHS->inUse = 0;
  }
  // COMBINE# = COMBINE# + 1; (2522)
  {
    int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mCOMBINEp), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mCOMBINEp, bitRHS);
    bitRHS->inUse = 0;
  }
  // CALL FIX_LOOP_STACK; (2523)
  COMBINE_LOOPSxFIX_LOOP_STACK (0);
  // IF C_TRACE THEN (2524)
  if (1 & (bitToFixed (getBIT (8, mC_TRACE))))
    // DO; (2525)
    {
    rs2:;
      // CALL VU(LOOP_HEAD,AR_DIMS); (2526)
      {
        putBITp (16, mVUxBEGIN, getBIT (16, mLOOP_HEAD));
        putBITp (16, mVUxNO, getBIT (8, mAR_DIMS));
        VU (0);
      }
    es2:;
    } // End of DO block
  {
    reentryGuard = 0;
    return 0;
  }
}
