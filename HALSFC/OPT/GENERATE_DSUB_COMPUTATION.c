/*
  File GENERATE_DSUB_COMPUTATION.c generated by XCOM-I, 2024-08-08 04:31:49.
*/

#include "runtimeC.h"

int32_t
GENERATE_DSUB_COMPUTATION (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GENERATE_DSUB_COMPUTATION");
  // IF ~PREVIOUS_COMPUTATION THEN (3679)
  if (1 & (xNOT (BYTE0 (mPREVIOUS_COMPUTATION))))
    // DO; (3680)
    {
    rs1:;
      // IF TSUB_SUB THEN (3681)
      if (1 & (bitToFixed (getBIT (8, mTSUB_SUB))))
        // DO; (3682)
        {
        rs1s1:;
          // DIMENSIONS = 2; (3683)
          {
            int32_t numberRHS = (int32_t)(2);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mDIMENSIONS, bitRHS);
            bitRHS->inUse = 0;
          }
        es1s1:;
        } // End of DO block
      // ELSE (3684)
      else
        // CALL COMPUTE_DIMENSIONS; (3685)
        COMPUTE_DIMENSIONS (0);
    es1:;
    } // End of DO block
  // IF VAR_TYPE = BIT_VAR AND PRESENT_DIMENSION >ARRAY_DIMENSIONS THEN (3686)
  if (1
      & (xAND (xEQ (COREHALFWORD (mVAR_TYPE), BYTE0 (mBIT_VAR)),
               xGT (COREHALFWORD (mPRESENT_DIMENSION),
                    COREHALFWORD (mARRAY_DIMENSIONS)))))
    // RETURN; (3687)
    {
      reentryGuard = 0;
      return 0;
    }
  // IF PRESENT_DIMENSION ~= DIMENSIONS THEN (3688)
  if (1
      & (xNEQ (COREHALFWORD (mPRESENT_DIMENSION), COREHALFWORD (mDIMENSIONS))))
    // DO; (3689)
    {
    rs2:;
      // TMP = INSERT_HALMAT_TRIPLE(IIPR,EXTRACT_VAR,COMPUTE_DIM_CONSTANT,1);
      // (3690)
      {
        int32_t numberRHS = (int32_t)((
            putBITp (16, mINSERT_HALMAT_TRIPLExOP, getBIT (16, mIIPR)),
            putFIXED (mINSERT_HALMAT_TRIPLExPTR_WORD, EXTRACT_VAR (0)),
            putFIXED (mINSERT_HALMAT_TRIPLExCONST_PTR,
                      COMPUTE_DIM_CONSTANT (0)),
            putBITp (8, mINSERT_HALMAT_TRIPLExTAG,
                     fixedToBit (32, (int32_t)(1))),
            INSERT_HALMAT_TRIPLE (0)));
        putFIXED (mGENERATE_DSUB_COMPUTATIONxTMP, numberRHS);
      }
      // IF PREVIOUS_COMPUTATION THEN (3691)
      if (1 & (bitToFixed (getBIT (8, mPREVIOUS_COMPUTATION))))
        // LAST_DSUB_HALMAT = INSERT_HALMAT_TRIPLE(IADD,TMP,LAST_DSUB_HALMAT);
        // (3692)
        {
          int32_t numberRHS = (int32_t)((
              putBITp (16, mINSERT_HALMAT_TRIPLExOP, getBIT (16, mIADD)),
              putFIXED (mINSERT_HALMAT_TRIPLExPTR_WORD,
                        getFIXED (mGENERATE_DSUB_COMPUTATIONxTMP)),
              putFIXED (mINSERT_HALMAT_TRIPLExCONST_PTR,
                        getFIXED (mLAST_DSUB_HALMAT)),
              INSERT_HALMAT_TRIPLE (0)));
          putFIXED (mLAST_DSUB_HALMAT, numberRHS);
        }
      // ELSE (3693)
      else
        // LAST_DSUB_HALMAT = TMP; (3694)
        {
          int32_t numberRHS
              = (int32_t)(getFIXED (mGENERATE_DSUB_COMPUTATIONxTMP));
          putFIXED (mLAST_DSUB_HALMAT, numberRHS);
        }
    es2:;
    } // End of DO block
  // ELSE (3695)
  else
    // DO; (3696)
    {
    rs3:;
      // IF PREVIOUS_COMPUTATION THEN (3697)
      if (1 & (bitToFixed (getBIT (8, mPREVIOUS_COMPUTATION))))
        // DO; (3698)
        {
        rs3s1:;
          // LAST_DSUB_HALMAT = INSERT_HALMAT_TRIPLE(IADD,LAST_DSUB_HALMAT,
          // EXTRACT_VAR); (3699)
          {
            int32_t numberRHS = (int32_t)((
                putBITp (16, mINSERT_HALMAT_TRIPLExOP, getBIT (16, mIADD)),
                putFIXED (mINSERT_HALMAT_TRIPLExPTR_WORD,
                          getFIXED (mLAST_DSUB_HALMAT)),
                putFIXED (mINSERT_HALMAT_TRIPLExCONST_PTR, EXTRACT_VAR (0)),
                INSERT_HALMAT_TRIPLE (0)));
            putFIXED (mLAST_DSUB_HALMAT, numberRHS);
          }
        es3s1:;
        } // End of DO block
      // ELSE (3700)
      else
        // LAST_DSUB_HALMAT = EXTRACT_VAR; (3701)
        {
          int32_t numberRHS = (int32_t)(EXTRACT_VAR (0));
          putFIXED (mLAST_DSUB_HALMAT, numberRHS);
        }
    es3:;
    } // End of DO block
  // PREVIOUS_COMPUTATION = TRUE; (3702)
  {
    int32_t numberRHS = (int32_t)(1);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mPREVIOUS_COMPUTATION, bitRHS);
    bitRHS->inUse = 0;
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
