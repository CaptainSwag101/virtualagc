/*
  File PULL_INVARS.c generated by XCOM-I, 2024-08-08 04:31:49.
*/

#include "runtimeC.h"

int32_t
PULL_INVARS (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "PULL_INVARS");
  // IF I_TRACE THEN (5375)
  if (1 & (bitToFixed (getBIT (8, mSTACK_TRACE))))
    // OUTPUT = 'PULL_INVARS(' || AR_INV || '):  NODE_BEGINNING = ' ||
    // NODE_BEGINNING; (5376)
    {
      descriptor_t *stringRHS;
      stringRHS = xsCAT (
          xsCAT (xsCAT (cToDescriptor (NULL, "PULL_INVARS("),
                        bitToCharacter (getBIT (8, mPULL_INVARSxAR_INV))),
                 cToDescriptor (NULL, "):  NODE_BEGINNING = ")),
          bitToCharacter (getBIT (16, mNODE_BEGINNING)));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // PULL_LOOP_HEAD(0) = 0; (5377)
  {
    int32_t numberRHS = (int32_t)(0);
    putBIT (16, getFIXED (mLEVEL_STACK_VARS) + 11 * (0) + 4 + 2 * (0),
            fixedToBit (16, numberRHS));
  }
  // NOT_TSUB = (NODE(NODE_BEGINNING) &  65535) ~= TSUB; (5378)
  {
    int32_t numberRHS = (int32_t)(xNEQ (
        xAND (getFIXED (mNODE + 4 * COREHALFWORD (mNODE_BEGINNING)), 65535),
        COREHALFWORD (mTSUB)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mPULL_INVARSxNOT_TSUB, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO FOR LEV = 1 - AR_INV TO LEVEL; (5379)
  {
    int32_t from120, to120, by120;
    from120 = xsubtract (1, BYTE0 (mPULL_INVARSxAR_INV));
    to120 = bitToFixed (getBIT (16, mLEVEL));
    by120 = 1;
    for (putBIT (16, mLEV, fixedToBit (16, from120));
         bitToFixed (getBIT (16, mLEV)) <= to120;
         putBIT (16, mLEV,
                 fixedToBit (16, bitToFixed (getBIT (16, mLEV)) + by120)))
      {
        // IF PULL_LOOP_HEAD(LEV) >= 0 & PULL_LOOP_HEAD(LEV) ~=
        // PULL_LOOP_HEAD(0) & SHR(STACK_TAGS(LEV),2) OR AR_INV THEN (5380)
        if (1
            & (xOR (
                xAND (xAND (xGE (COREHALFWORD (getFIXED (mLEVEL_STACK_VARS)
                                               + 11 * (COREHALFWORD (mLEV)) + 4
                                               + 2 * (0)),
                                 0),
                            xNEQ (COREHALFWORD (getFIXED (mLEVEL_STACK_VARS)
                                                + 11 * (COREHALFWORD (mLEV))
                                                + 4 + 2 * (0)),
                                  COREHALFWORD (getFIXED (mLEVEL_STACK_VARS)
                                                + 11 * (0) + 4 + 2 * (0)))),
                      SHR (BYTE0 (getFIXED (mLEVEL_STACK_VARS)
                                  + 11 * (COREHALFWORD (mLEV)) + 10 + 1 * (0)),
                           2)),
                BYTE0 (mPULL_INVARSxAR_INV))))
          // DO; (5381)
          {
          rs1s1:;
            // IF AR_INV THEN (5382)
            if (1 & (bitToFixed (getBIT (8, mPULL_INVARSxAR_INV))))
              // PULL_LOOP_HEAD(0) = GET_ADLP(NODE_BEGINNING,1); (5383)
              {
                descriptor_t *bitRHS
                    = (putBITp (16, mGET_ADLPxPTR,
                                getBIT (16, mNODE_BEGINNING)),
                       putBITp (8, mGET_ADLPxOP,
                                fixedToBit (32, (int32_t)(1))),
                       GET_ADLP (0));
                putBIT (16,
                        getFIXED (mLEVEL_STACK_VARS) + 11 * (0) + 4 + 2 * (0),
                        bitRHS);
                bitRHS->inUse = 0;
              }
            // ELSE (5384)
            else
              // PULL_LOOP_HEAD(0) = PULL_LOOP_HEAD(LEV); (5385)
              {
                descriptor_t *bitRHS = getBIT (
                    16, getFIXED (mLEVEL_STACK_VARS)
                            + 11 * (COREHALFWORD (mLEV)) + 4 + 2 * (0));
                putBIT (16,
                        getFIXED (mLEVEL_STACK_VARS) + 11 * (0) + 4 + 2 * (0),
                        bitRHS);
                bitRHS->inUse = 0;
              }
            // LOOP_ZAPS_LEVEL = ZAP_BASE(LEV); (5386)
            {
              int32_t numberRHS = (int32_t)(getFIXED (
                  getFIXED (mLEVEL_STACK_VARS) + 11 * (COREHALFWORD (mLEV)) + 0
                  + 4 * (0)));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mLOOP_ZAPS_LEVEL, bitRHS);
              bitRHS->inUse = 0;
            }
            // IF PULL_LOOP_HEAD(0) >= 0 THEN (5387)
            if (1
                & (xGE (COREHALFWORD (getFIXED (mLEVEL_STACK_VARS) + 11 * (0)
                                      + 4 + 2 * (0)),
                        0)))
              // IF CHECK_INVAR(AR_INV) THEN (5388)
              if (1
                  & (bitToFixed ((putBITp (8, mCHECK_INVARxAR_INV,
                                           getBIT (8, mPULL_INVARSxAR_INV)),
                                  CHECK_INVAR (0)))))
                // DO; (5389)
                {
                rs1s1s1:;
                  // INVARIANT_PULLED = TRUE; (5390)
                  {
                    int32_t numberRHS = (int32_t)(1);
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (8, mINVARIANT_PULLED, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // CALL SETUP_REARRANGE(1); (5391)
                  {
                    putBITp (8, mSETUP_REARRANGExLOOP_INVAR,
                             fixedToBit (32, (int32_t)(1)));
                    SETUP_REARRANGE (0);
                  }
                  // CALL REARRANGE_HALMAT(1); (5392)
                  {
                    putBITp (8, mREARRANGE_HALMATxLOOP_PULL,
                             fixedToBit (32, (int32_t)(1)));
                    REARRANGE_HALMAT (0);
                  }
                  // CALL STRIP_NODES(1); (5393)
                  {
                    putBITp (8, mSTRIP_NODESxLOOP_PULL,
                             fixedToBit (32, (int32_t)(1)));
                    STRIP_NODES (0);
                  }
                  // TEMP = EJECT_INVARS(AR_INV,NOT_TSUB); (5394)
                  {
                    int32_t numberRHS = (int32_t)((
                        putBITp (8, mEJECT_INVARSxAR_INV,
                                 getBIT (8, mPULL_INVARSxAR_INV)),
                        putBITp (8, mEJECT_INVARSxNOT_TSUB,
                                 getBIT (8, mPULL_INVARSxNOT_TSUB)),
                        EJECT_INVARS (0)));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mPULL_INVARSxTEMP, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // IF ~AR_INV AND STATEMENT_ARRAYNESS AND NOT_TSUB AND
                  // (~NONCOMMUTATIVE OR (~ARRAYED_OPS AND NONCOMMUTATIVE))
                  // THEN (5395)
                  if (1
                      & (xAND (xAND (xAND (xNOT (BYTE0 (mPULL_INVARSxAR_INV)),
                                           BYTE0 (mSTATEMENT_ARRAYNESS)),
                                     BYTE0 (mPULL_INVARSxNOT_TSUB)),
                               xOR (xNOT (BYTE0 (mNONCOMMUTATIVE)),
                                    xAND (xNOT (BYTE0 (mARRAYED_OPS)),
                                          BYTE0 (mNONCOMMUTATIVE))))))
                    // CALL BUMP_AR_INV(TEMP); (5396)
                    {
                      putBITp (16, mBUMP_AR_INVxPTR,
                               getBIT (16, mPULL_INVARSxTEMP));
                      BUMP_AR_INV (0);
                    }
                  // IF STATISTICS THEN (5397)
                  if (1 & (bitToFixed (getBIT (16, mSTATISTICS))))
                    // DO; (5398)
                    {
                    rs1s1s1s1:;
                      // INVAR# = INVAR# + 1; (5399)
                      {
                        int32_t numberRHS
                            = (int32_t)(xadd (COREHALFWORD (mINVARp), 1));
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (16, mINVARp, bitRHS);
                        bitRHS->inUse = 0;
                      }
                      // OUTPUT='LOOP INVARIANT COMPUTATION FOUND IN HAL/S
                      // STATEMENT  ' || STT#; (5400)
                      {
                        descriptor_t *stringRHS;
                        stringRHS = xsCAT (
                            cToDescriptor (NULL, "LOOP INVARIANT COMPUTATION "
                                                 "FOUND IN HAL/S STATEMENT  "),
                            bitToCharacter (getBIT (16, mSTTp)));
                        OUTPUT (0, stringRHS);
                        stringRHS->inUse = 0;
                      }
                    es1s1s1s1:;
                    } // End of DO block
                  // IF TOTAL_MATCH_PRES THEN (5401)
                  if (1 & (bitToFixed (getBIT (8, mTOTAL_MATCH_PRES))))
                    // GO TO EXITT; (5402)
                    goto EXITT;
                es1s1s1:;
                } // End of DO block
          es1s1:;
          } // End of DO block
        // IF AR_INV THEN (5403)
        if (1 & (bitToFixed (getBIT (8, mPULL_INVARSxAR_INV))))
          // GO TO EXITT; (5404)
          goto EXITT;
      }
  } // End of DO for-loop block
// EXITT: (5405)
EXITT:
  // INVARIANT_COMPUTATION = FALSE; (5406)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mINVARIANT_COMPUTATION, bitRHS);
    bitRHS->inUse = 0;
  }
  // LOOP_ZAPS_LEVEL = ZAP_BASE(LEVEL); (5407)
  {
    int32_t numberRHS
        = (int32_t)(getFIXED (getFIXED (mLEVEL_STACK_VARS)
                              + 11 * (COREHALFWORD (mLEVEL)) + 0 + 4 * (0)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mLOOP_ZAPS_LEVEL, bitRHS);
    bitRHS->inUse = 0;
  }
  // LEV = LEVEL; (5408)
  {
    descriptor_t *bitRHS = getBIT (16, mLEVEL);
    putBIT (16, mLEV, bitRHS);
    bitRHS->inUse = 0;
  }
  // AR_INV = 0; (5409)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mPULL_INVARSxAR_INV, bitRHS);
    bitRHS->inUse = 0;
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
