/*
  File GET_LOOP_DIMENSION.c generated by XCOM-I, 2024-08-08 04:31:49.
*/

#include "runtimeC.h"

descriptor_t *
GET_LOOP_DIMENSION (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (descriptor_t *)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GET_LOOP_DIMENSION");
  // CALL SET_VAR(PTR + DSUB_FLAG); (3777)
  {
    putBITp (16, mSET_VARxPTR,
             fixedToBit (
                 32, (int32_t)(xadd (COREHALFWORD (mGET_LOOP_DIMENSIONxPTR),
                                     BYTE0 (mGET_LOOP_DIMENSIONxDSUB_FLAG)))));
    SET_VAR (0);
  }
  // CALL COMPUTE_DIMENSIONS; (3778)
  COMPUTE_DIMENSIONS (0);
  // IF DSUB_FLAG THEN (3779)
  if (1 & (bitToFixed (getBIT (8, mGET_LOOP_DIMENSIONxDSUB_FLAG))))
    // DO; (3780)
    {
    rs1:;
      // DSUB_FLAG = 0; (3781)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (8, mGET_LOOP_DIMENSIONxDSUB_FLAG, bitRHS);
        bitRHS->inUse = 0;
      }
      // PRESENT_DIMENSION = 0; (3782)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mPRESENT_DIMENSION, bitRHS);
        bitRHS->inUse = 0;
      }
      // LOOP_DIMENSION = 1; (3783)
      {
        int32_t numberRHS = (int32_t)(1);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mLOOP_DIMENSION, bitRHS);
        bitRHS->inUse = 0;
      }
      // DO FOR DSUB_INX = PTR + 2 TO LAST_OPERAND(PTR); (3784)
      {
        int32_t from93, to93, by93;
        from93 = xadd (COREHALFWORD (mGET_LOOP_DIMENSIONxPTR), 2);
        to93 = bitToFixed ((putBITp (16, mLAST_OPERANDxPTR,
                                     getBIT (16, mGET_LOOP_DIMENSIONxPTR)),
                            LAST_OPERAND (0)));
        by93 = 1;
        for (putBIT (16, mDSUB_INX, fixedToBit (16, from93));
             bitToFixed (getBIT (16, mDSUB_INX)) <= to93; putBIT (
                 16, mDSUB_INX,
                 fixedToBit (16, bitToFixed (getBIT (16, mDSUB_INX)) + by93)))
          {
            // DO CASE ALPHA; (3785)
            {
            rs1s1s1:
              switch (xAND (
                  SHR (getFIXED (mOPR + 4 * COREHALFWORD (mDSUB_INX)), 8), 3))
                {
                case 0:
                  // DO; (3787)
                  {
                  rs1s1s1s1:;
                    // PRESENT_DIMENSION = PRESENT_DIMENSION + 1; (3787)
                    {
                      int32_t numberRHS = (int32_t)(xadd (
                          COREHALFWORD (mPRESENT_DIMENSION), 1));
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (16, mPRESENT_DIMENSION, bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // IF PRESENT_DIMENSION > ARRAY_DIMENSIONS THEN (3788)
                    if (1
                        & (xGT (COREHALFWORD (mPRESENT_DIMENSION),
                                COREHALFWORD (mARRAY_DIMENSIONS))))
                      // LOOP_DIMENSION = LOOP_DIMENSION * COMPONENT_SIZE
                      // (PRESENT_DIMENSION); (3789)
                      {
                        int32_t numberRHS = (int32_t)(xmultiply (
                            COREHALFWORD (mLOOP_DIMENSION),
                            COREHALFWORD (
                                mCOMPONENT_SIZE
                                + 2 * COREHALFWORD (mPRESENT_DIMENSION))));
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (16, mLOOP_DIMENSION, bitRHS);
                        bitRHS->inUse = 0;
                      }
                  es1s1s1s1:;
                  } // End of DO block
                  break;
                case 1:
                  // PRESENT_DIMENSION = PRESENT_DIMENSION + 1; (3791)
                  {
                    int32_t numberRHS = (int32_t)(xadd (
                        COREHALFWORD (mPRESENT_DIMENSION), 1));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mPRESENT_DIMENSION, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  break;
                case 2:
                  // DO; (3792)
                  {
                  rs1s1s1s2:;
                    // IF BETA THEN (3792)
                    if (1
                        & (SHR (getFIXED (mOPR + 4 * COREHALFWORD (mDSUB_INX)),
                                1)))
                      // DO; (3793)
                      {
                      rs1s1s1s2s1:;
                        // PRESENT_DIMENSION = PRESENT_DIMENSION + 1; (3794)
                        {
                          int32_t numberRHS = (int32_t)(xadd (
                              COREHALFWORD (mPRESENT_DIMENSION), 1));
                          descriptor_t *bitRHS;
                          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                          putBIT (16, mPRESENT_DIMENSION, bitRHS);
                          bitRHS->inUse = 0;
                        }
                        // TO_START = SHR(OPR(DSUB_INX),16); (3795)
                        {
                          int32_t numberRHS = (int32_t)(SHR (
                              getFIXED (mOPR + 4 * COREHALFWORD (mDSUB_INX)),
                              16));
                          descriptor_t *bitRHS;
                          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                          putBIT (16, mGET_LOOP_DIMENSIONxTO_START, bitRHS);
                          bitRHS->inUse = 0;
                        }
                      es1s1s1s2s1:;
                      } // End of DO block
                    // ELSE (3796)
                    else
                      // IF PRESENT_DIMENSION > ARRAY_DIMENSIONS THEN (3797)
                      if (1
                          & (xGT (COREHALFWORD (mPRESENT_DIMENSION),
                                  COREHALFWORD (mARRAY_DIMENSIONS))))
                        // DO; (3798)
                        {
                        rs1s1s1s2s2:;
                          // LOOP_DIMENSION = LOOP_DIMENSION *
                          // (SHR(OPR(DSUB_INX),16) - TO_START + 1); (3799)
                          {
                            int32_t numberRHS = (int32_t)(xmultiply (
                                COREHALFWORD (mLOOP_DIMENSION),
                                xadd (xsubtract (
                                          SHR (getFIXED (mOPR
                                                         + 4
                                                               * COREHALFWORD (
                                                                   mDSUB_INX)),
                                               16),
                                          COREHALFWORD (
                                              mGET_LOOP_DIMENSIONxTO_START)),
                                      1)));
                            descriptor_t *bitRHS;
                            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                            putBIT (16, mLOOP_DIMENSION, bitRHS);
                            bitRHS->inUse = 0;
                          }
                        es1s1s1s2s2:;
                        } // End of DO block
                  es1s1s1s2:;
                  } // End of DO block
                  break;
                case 3:
                  // DO; (3801)
                  {
                  rs1s1s1s3:;
                    // IF BETA THEN (3801)
                    if (1
                        & (SHR (getFIXED (mOPR + 4 * COREHALFWORD (mDSUB_INX)),
                                1)))
                      // DO; (3802)
                      {
                      rs1s1s1s3s1:;
                        // PRESENT_DIMENSION = PRESENT_DIMENSION + 1; (3803)
                        {
                          int32_t numberRHS = (int32_t)(xadd (
                              COREHALFWORD (mPRESENT_DIMENSION), 1));
                          descriptor_t *bitRHS;
                          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                          putBIT (16, mPRESENT_DIMENSION, bitRHS);
                          bitRHS->inUse = 0;
                        }
                        // IF PRESENT_DIMENSION > ARRAY_DIMENSIONS THEN (3804)
                        if (1
                            & (xGT (COREHALFWORD (mPRESENT_DIMENSION),
                                    COREHALFWORD (mARRAY_DIMENSIONS))))
                          // LOOP_DIMENSION = LOOP_DIMENSION *
                          // SHR(OPR(DSUB_INX),16); (3805)
                          {
                            int32_t numberRHS = (int32_t)(xmultiply (
                                COREHALFWORD (mLOOP_DIMENSION),
                                SHR (getFIXED (mOPR
                                               + 4 * COREHALFWORD (mDSUB_INX)),
                                     16)));
                            descriptor_t *bitRHS;
                            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                            putBIT (16, mLOOP_DIMENSION, bitRHS);
                            bitRHS->inUse = 0;
                          }
                      es1s1s1s3s1:;
                      } // End of DO block
                  es1s1s1s3:;
                  } // End of DO block
                  break;
                }
            } // End of DO CASE block
          }
      } // End of DO for-loop block
    es1:;
    } // End of DO block
  // ELSE (3806)
  else
    // DO; (3807)
    {
    rs2:;
      // PRESENT_DIMENSION = ARRAY_DIMENSIONS; (3808)
      {
        descriptor_t *bitRHS = getBIT (16, mARRAY_DIMENSIONS);
        putBIT (16, mPRESENT_DIMENSION, bitRHS);
        bitRHS->inUse = 0;
      }
      // LOOP_DIMENSION = COMPUTE_DIM_CONSTANT(1); (3809)
      {
        int32_t numberRHS = (int32_t)((putBITp (8, mCOMPUTE_DIM_CONSTANTxFLAG,
                                                fixedToBit (32, (int32_t)(1))),
                                       COMPUTE_DIM_CONSTANT (0)));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mLOOP_DIMENSION, bitRHS);
        bitRHS->inUse = 0;
      }
    es2:;
    } // End of DO block
  // IF SUB_TRACE THEN (3810)
  if (1 & (bitToFixed (getBIT (8, mSUB_TRACE))))
    // OUTPUT = 'GET_LOOP_DIMENSION(' ||PTR|| ',' || FLAG || ') = ' ||
    // LOOP_DIMENSION; (3811)
    {
      descriptor_t *stringRHS;
      stringRHS = xsCAT (
          xsCAT (
              xsCAT (xsCAT (xsCAT (cToDescriptor (NULL, "GET_LOOP_DIMENSION("),
                                   bitToCharacter (
                                       getBIT (16, mGET_LOOP_DIMENSIONxPTR))),
                            cToDescriptor (NULL, ",")),
                     bitToCharacter (getBIT (8, mFLAG))),
              cToDescriptor (NULL, ") = ")),
          bitToCharacter (getBIT (16, mLOOP_DIMENSION)));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // RETURN LOOP_DIMENSION; (3812)
  {
    reentryGuard = 0;
    return getBIT (16, mLOOP_DIMENSION);
  }
}
