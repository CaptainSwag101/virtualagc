/*
  File ZAP_TABLES.c generated by XCOM-I, 2024-08-08 04:31:49.
*/

#include "runtimeC.h"

int32_t
ZAP_TABLES (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "ZAP_TABLES");
  // IF STACK_TRACE THEN (3053)
  if (1 & (bitToFixed (getBIT (8, mSTACK_TRACE))))
    // OUTPUT = 'ZAP_TABLES('||MAJOR||'):  '||STT#; (3054)
    {
      descriptor_t *stringRHS;
      stringRHS = xsCAT (
          xsCAT (xsCAT (cToDescriptor (NULL, "ZAP_TABLES("),
                        bitToCharacter (getBIT (8, mZAP_TABLESxMAJOR))),
                 cToDescriptor (NULL, "):  ")),
          bitToCharacter (getBIT (16, mSTTp)));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // IF MAJOR THEN (3055)
  if (1 & (bitToFixed (getBIT (8, mZAP_TABLESxMAJOR))))
    // DO; (3056)
    {
    rs1:;
      // FINAL_LEVEL = 0; (3057)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mZAP_TABLESxFINAL_LEVEL, bitRHS);
        bitRHS->inUse = 0;
      }
      // ZAP_LEVEL = 0; (3058)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mZAP_LEVEL, bitRHS);
        bitRHS->inUse = 0;
      }
    es1:;
    } // End of DO block
  // ELSE (3059)
  else
    // FINAL_LEVEL = LEVEL; (3060)
    {
      descriptor_t *bitRHS = getBIT (16, mLEVEL);
      putBIT (16, mZAP_TABLESxFINAL_LEVEL, bitRHS);
      bitRHS->inUse = 0;
    }
  // ZAPS(0) = 1; (3061)
  {
    int32_t numberRHS = (int32_t)(1);
    putFIXED (getFIXED (mOBPS) + 4 * (COREHALFWORD (mZAP_LEVEL)) + 0 + 4 * (0),
              numberRHS);
  }
  // DO WHILE LEVEL > FINAL_LEVEL; (3062)
  while (
      1
      & (xGT (COREHALFWORD (mLEVEL), COREHALFWORD (mZAP_TABLESxFINAL_LEVEL))))
    {
      // DO FOR K = 0 TO SYT_WORDS; (3063)
      {
        int32_t from72, to72, by72;
        from72 = 0;
        to72 = SHR (COREHALFWORD (mSYT_USED), 5);
        by72 = 1;
        for (putBIT (16, mZAP_TABLESxK, fixedToBit (16, from72));
             bitToFixed (getBIT (16, mZAP_TABLESxK)) <= to72;
             putBIT (16, mZAP_TABLESxK,
                     fixedToBit (16, bitToFixed (getBIT (16, mZAP_TABLESxK))
                                         + by72)))
          {
            // VAL_TABLE(LEVEL).VAL_ARRAY(K) = 0; (3064)
            {
              int32_t numberRHS = (int32_t)(0);
              putFIXED (getFIXED (mVAL_TABLE) + 4 * (COREHALFWORD (mLEVEL)) + 0
                            + 4 * (COREHALFWORD (mZAP_TABLESxK)),
                        numberRHS);
            }
          }
      } // End of DO for-loop block
      // STACK_TAGS(LEVEL) = STACK_TAGS(LEVEL) &  1; (3065)
      {
        int32_t numberRHS = (int32_t)(xAND (
            BYTE0 (getFIXED (mLEVEL_STACK_VARS) + 11 * (COREHALFWORD (mLEVEL))
                   + 10 + 1 * (0)),
            1));
        putBIT (8,
                getFIXED (mLEVEL_STACK_VARS) + 11 * (COREHALFWORD (mLEVEL))
                    + 10 + 1 * (0),
                fixedToBit (8, numberRHS));
      }
      // LEVEL = LEVEL - 1; (3066)
      {
        int32_t numberRHS = (int32_t)(xsubtract (COREHALFWORD (mLEVEL), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mLEVEL, bitRHS);
        bitRHS->inUse = 0;
      }
    } // End of DO WHILE block
  // DO FOR K = 0 TO SYT_WORDS; (3067)
  {
    int32_t from73, to73, by73;
    from73 = 0;
    to73 = SHR (COREHALFWORD (mSYT_USED), 5);
    by73 = 1;
    for (putBIT (16, mZAP_TABLESxK, fixedToBit (16, from73));
         bitToFixed (getBIT (16, mZAP_TABLESxK)) <= to73; putBIT (
             16, mZAP_TABLESxK,
             fixedToBit (16, bitToFixed (getBIT (16, mZAP_TABLESxK)) + by73)))
      {
        // VAL_TABLE(LEVEL).VAL_ARRAY(K) = 0; (3068)
        {
          int32_t numberRHS = (int32_t)(0);
          putFIXED (getFIXED (mVAL_TABLE) + 4 * (COREHALFWORD (mLEVEL)) + 0
                        + 4 * (COREHALFWORD (mZAP_TABLESxK)),
                    numberRHS);
        }
      }
  } // End of DO for-loop block
  // BLOCK# = STACKED_BLOCK#(LEVEL); (3069)
  {
    descriptor_t *bitRHS
        = getBIT (16, getFIXED (mLEVEL_STACK_VARS)
                          + 11 * (COREHALFWORD (mLEVEL)) + 8 + 2 * (0));
    putBIT (16, mBLOCKp, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF LEVEL = 0 THEN (3070)
  if (1 & (xEQ (COREHALFWORD (mLEVEL), 0)))
    // DO; (3071)
    {
    rs4:;
      // IF N_INX ~= 1 THEN (3072)
      if (1 & (xNEQ (COREHALFWORD (mN_INX), 1)))
        // DO; (3073)
        {
        rs4s1:;
          // IF STACK_TRACE THEN (3074)
          if (1 & (bitToFixed (getBIT (8, mSTACK_TRACE))))
            // DO; (3075)
            {
            rs4s1s1:;
              // CALL CSE_TAB_DUMP; (3076)
              CSE_TAB_DUMP (0);
            es4s1s1:;
            } // End of DO block
          // IF MAX_CSE_TAB < FREE_BLOCK_BEGIN THEN (3077)
          if (1
              & (xLT (COREHALFWORD (mMAX_CSE_TAB),
                      COREHALFWORD (mFREE_BLOCK_BEGIN))))
            // MAX_CSE_TAB = FREE_BLOCK_BEGIN; (3078)
            {
              descriptor_t *bitRHS = getBIT (16, mFREE_BLOCK_BEGIN);
              putBIT (16, mMAX_CSE_TAB, bitRHS);
              bitRHS->inUse = 0;
            }
          // IF N_INX > MAXNODE THEN (3079)
          if (1 & (xGT (COREHALFWORD (mN_INX), COREHALFWORD (mMAXNODE))))
            // MAXNODE = N_INX; (3080)
            {
              descriptor_t *bitRHS = getBIT (16, mN_INX);
              putBIT (16, mMAXNODE, bitRHS);
              bitRHS->inUse = 0;
            }
          // LAST_SPACE_BLOCK = 0; (3081)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mLAST_SPACE_BLOCK, bitRHS);
            bitRHS->inUse = 0;
          }
          // FREE_SPACE = CSE_TAB_SIZE; (3082)
          {
            int32_t numberRHS = (int32_t)(2500);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mFREE_SPACE, bitRHS);
            bitRHS->inUse = 0;
          }
          // FREE_BLOCK_BEGIN = 1; (3083)
          {
            int32_t numberRHS = (int32_t)(1);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mFREE_BLOCK_BEGIN, bitRHS);
            bitRHS->inUse = 0;
          }
          // IF CSE_L_INX ~= 0 THEN (3084)
          if (1 & (xNEQ (COREHALFWORD (mCSE_L_INX), 0)))
            // CALL RELOCATE_HALMAT; (3085)
            RELOCATE_HALMAT (0);
        es4s1:;
        } // End of DO block
      // SYT_USED = 0; (3086)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mSYT_USED, bitRHS);
        bitRHS->inUse = 0;
      }
      // CALL FINAL_PASS; (3087)
      FINAL_PASS (0);
      // LAST_ZAP = CTR; (3088)
      {
        descriptor_t *bitRHS = getBIT (16, mCTR);
        putBIT (16, mLAST_ZAP, bitRHS);
        bitRHS->inUse = 0;
      }
      // N_INX = 1; (3089)
      {
        int32_t numberRHS = (int32_t)(1);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mN_INX, bitRHS);
        bitRHS->inUse = 0;
      }
    es4:;
    } // End of DO block
  // ELSE (3090)
  else
    // IF TRACE THEN (3091)
    if (1 & (bitToFixed (getBIT (8, mTRACE))))
      // CALL CSE_TAB_DUMP; (3092)
      CSE_TAB_DUMP (0);
  // MAJOR = 0; (3093)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mZAP_TABLESxMAJOR, bitRHS);
    bitRHS->inUse = 0;
  }
  // STILL_NODES,SEARCHABLE=FALSE; (3094)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mSTILL_NODES, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mSEARCHABLE, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF STACK_TRACE THEN (3095)
  if (1 & (bitToFixed (getBIT (8, mSTACK_TRACE))))
    // CALL STACK_DUMP; (3096)
    STACK_DUMP (0);
  {
    reentryGuard = 0;
    return 0;
  }
}
