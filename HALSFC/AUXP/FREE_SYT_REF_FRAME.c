/*
  File FREE_SYT_REF_FRAME.c generated by XCOM-I, 2024-08-08 04:32:08.
*/

#include "../AUXP/runtimeC.h"

int32_t
FREE_SYT_REF_FRAME (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "FREE_SYT_REF_FRAME");
  // IF POOL_INDEX = 0 THEN (1010)
  if (1 & (xEQ (COREHALFWORD (mFREE_SYT_REF_FRAMExPOOL_INDEX), 0)))
    // RETURN; (1011)
    {
      reentryGuard = 0;
      return 0;
    }
  // MAP# = POOL_INDEX / (SYT_REF_POOL_FRAME_SIZE + 1); (1012)
  {
    int32_t numberRHS = (int32_t)(xdivide (
        COREHALFWORD (mFREE_SYT_REF_FRAMExPOOL_INDEX),
        xadd (COREHALFWORD (mSYT_REF_POOL_FRAME_SIZE), 1)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mFREE_SYT_REF_FRAMExMAPp, bitRHS);
    bitRHS->inUse = 0;
  }
  // TEMP_PTR = SHR(MAP#, 5); (1013)
  {
    int32_t numberRHS
        = (int32_t)(SHR (COREHALFWORD (mFREE_SYT_REF_FRAMExMAPp), 5));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mFREE_SYT_REF_FRAMExTEMP_PTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // SYT_REF_POOL_MAP(TEMP_PTR) = SYT_REF_POOL_MAP(TEMP_PTR) &
  // (~MAP_INDICES(MAP# &  31)); (1014)
  {
    int32_t numberRHS = (int32_t)(xAND (
        COREWORD (getFIXED (mS_MAP_VAR)
                  + 4 * (COREHALFWORD (mFREE_SYT_REF_FRAMExTEMP_PTR)) + 0
                  + 4 * (0)),
        xNOT (getFIXED (
            mMAP_INDICES
            + 4 * xAND (COREHALFWORD (mFREE_SYT_REF_FRAMExMAPp), 31)))));
    putBIT (32,
            getFIXED (mS_MAP_VAR)
                + 4 * (COREHALFWORD (mFREE_SYT_REF_FRAMExTEMP_PTR)) + 0
                + 4 * (0),
            fixedToBit (32, numberRHS));
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
