/*
  File INITIALISExCONSTERM.c generated by XCOM-I, 2024-08-09 12:39:31.
*/

#include "runtimeC.h"

int32_t
INITIALISExCONSTERM (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "INITIALISExCONSTERM");
  // T = DATATYPE(SYT_TYPE(OP)); (2136)
  {
    descriptor_t *bitRHS = getBIT (
        8, mDATATYPE
               + 1
                     * BYTE0 (getFIXED (mSYM_TAB)
                              + 34 * (COREHALFWORD (mINITIALISExCONSTERMxOP))
                              + 32 + 1 * (0)));
    putBIT (16, mINITIALISExCONSTERMxT, bitRHS);
    bitRHS->inUse = 0;
  }
  // TERM1 = -1; (2137)
  {
    int32_t numberRHS = (int32_t)(-1);
    putFIXED (mINITIALISExCONSTERMxTERM1, numberRHS);
  }
  // J = 2; (2138)
  {
    int32_t numberRHS = (int32_t)(2);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mINITIALISExCONSTERMxJ, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF T = 0 THEN (2139)
  if (1 & (xEQ (COREHALFWORD (mINITIALISExCONSTERMxT), 0)))
    // DO; (2140)
    {
    rs1:;
      // IF SYT_ARRAY(OP) ~= 0 THEN (2141)
      if (1
          & (xNEQ (
              COREHALFWORD (getFIXED (mSYM_TAB)
                            + 34 * (COREHALFWORD (mINITIALISExCONSTERMxOP))
                            + 20 + 2 * (0)),
              0)))
        // DO; (2142)
        {
        rs1s1:;
          // K = SYT_DIMS(OP); (2143)
          {
            descriptor_t *bitRHS = getBIT (
                16, getFIXED (mSYM_TAB)
                        + 34 * (COREHALFWORD (mINITIALISExCONSTERMxOP)) + 18
                        + 2 * (0));
            putBIT (16, mINITIALISExCONSTERMxK, bitRHS);
            bitRHS->inUse = 0;
          }
          // RETURN -(EXTENT(K) + SYT_DISP(K)); (2144)
          {
            reentryGuard = 0;
            return xminus (xadd (
                getFIXED (getFIXED (mSYM_TAB)
                          + 34 * (COREHALFWORD (mINITIALISExCONSTERMxK)) + 12
                          + 4 * (0)),
                COREHALFWORD (getFIXED (mP2SYMS)
                              + 12 * (COREHALFWORD (mINITIALISExCONSTERMxK))
                              + 6 + 2 * (0))));
          }
        es1s1:;
        } // End of DO block
      // ELSE (2145)
      else
        // RETURN 0; (2146)
        {
          reentryGuard = 0;
          return 0;
        }
    es1:;
    } // End of DO block
  // ELSE (2147)
  else
    // DO; (2148)
    {
    rs2:;
      // K = GETARRAY#(OP); (2149)
      {
        descriptor_t *bitRHS = (putBITp (16, mGETARRAYpxOP,
                                         getBIT (16, mINITIALISExCONSTERMxOP)),
                                GETARRAYp (0));
        putBIT (16, mINITIALISExCONSTERMxK, bitRHS);
        bitRHS->inUse = 0;
      }
      // IF K > 0 THEN (2150)
      if (1 & (xGT (COREHALFWORD (mINITIALISExCONSTERMxK), 0)))
        // DO; (2151)
        {
        rs2s1:;
          // DO I = J TO K; (2152)
          {
            int32_t from33, to33, by33;
            from33 = bitToFixed (getBIT (16, mINITIALISExCONSTERMxJ));
            to33 = bitToFixed (getBIT (16, mINITIALISExCONSTERMxK));
            by33 = 1;
            for (putBIT (16, mINITIALISExCONSTERMxI, fixedToBit (16, from33));
                 bitToFixed (getBIT (16, mINITIALISExCONSTERMxI)) <= to33;
                 putBIT (16, mINITIALISExCONSTERMxI,
                         fixedToBit (16, bitToFixed (getBIT (
                                             16, mINITIALISExCONSTERMxI))
                                             + by33)))
              {
                // TERM1 = TERM1 * GETARRAYDIM(I, OP) - 1; (2153)
                {
                  int32_t numberRHS = (int32_t)(xsubtract (
                      xmultiply (
                          getFIXED (mINITIALISExCONSTERMxTERM1),
                          bitToFixed (
                              (putBITp (8, mGETARRAYDIMxIX,
                                        getBIT (16, mINITIALISExCONSTERMxI)),
                               putBITp (16, mGETARRAYDIMxOP1,
                                        getBIT (16, mINITIALISExCONSTERMxOP)),
                               GETARRAYDIM (0)))),
                      1));
                  putFIXED (mINITIALISExCONSTERMxTERM1, numberRHS);
                }
              }
          } // End of DO for-loop block
          // J = 1; (2154)
          {
            int32_t numberRHS = (int32_t)(1);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mINITIALISExCONSTERMxJ, bitRHS);
            bitRHS->inUse = 0;
          }
        es2s1:;
        } // End of DO block
      // IF T = CHAR THEN (2155)
      if (1 & (xEQ (COREHALFWORD (mINITIALISExCONSTERMxT), BYTE0 (mCHAR))))
        // DO; (2156)
        {
        rs2s2:;
          // IF J = 1 THEN (2157)
          if (1 & (xEQ (COREHALFWORD (mINITIALISExCONSTERMxJ), 1)))
            // IF SYT_DIMS(OP) > 0 THEN (2158)
            if (1
                & (xGT (COREHALFWORD (
                            getFIXED (mSYM_TAB)
                            + 34 * (COREHALFWORD (mINITIALISExCONSTERMxOP))
                            + 18 + 2 * (0)),
                        0)))
              // TERM1 = TERM1 * CS(SYT_DIMS(OP)+2); (2159)
              {
                int32_t numberRHS = (int32_t)(xmultiply (
                    getFIXED (mINITIALISExCONSTERMxTERM1),
                    (putFIXED (mCSxLEN,
                               xadd (COREHALFWORD (
                                         getFIXED (mSYM_TAB)
                                         + 34
                                               * (COREHALFWORD (
                                                   mINITIALISExCONSTERMxOP))
                                         + 18 + 2 * (0)),
                                     2)),
                     CS (0))));
                putFIXED (mINITIALISExCONSTERMxTERM1, numberRHS);
              }
        es2s2:;
        } // End of DO block
      // ELSE (2160)
      else
        // IF T = MATRIX THEN (2161)
        if (1 & (xEQ (COREHALFWORD (mINITIALISExCONSTERMxT), BYTE0 (mMATRIX))))
          // DO; (2162)
          {
          rs2s3:;
            // IF J = 1 THEN (2163)
            if (1 & (xEQ (COREHALFWORD (mINITIALISExCONSTERMxJ), 1)))
              // DO; (2164)
              {
              rs2s3s1:;
                // TERM1 = SHR(SYT_DIMS(OP), 8) * TERM1; (2165)
                {
                  int32_t numberRHS = (int32_t)(xmultiply (
                      SHR (COREHALFWORD (
                               getFIXED (mSYM_TAB)
                               + 34 * (COREHALFWORD (mINITIALISExCONSTERMxOP))
                               + 18 + 2 * (0)),
                           8),
                      getFIXED (mINITIALISExCONSTERMxTERM1)));
                  putFIXED (mINITIALISExCONSTERMxTERM1, numberRHS);
                }
                // TERM1 = (SYT_DIMS(OP) &  255) * TERM1 - 1; (2166)
                {
                  int32_t numberRHS = (int32_t)(xsubtract (
                      xmultiply (xAND (COREHALFWORD (
                                           getFIXED (mSYM_TAB)
                                           + 34
                                                 * (COREHALFWORD (
                                                     mINITIALISExCONSTERMxOP))
                                           + 18 + 2 * (0)),
                                       255),
                                 getFIXED (mINITIALISExCONSTERMxTERM1)),
                      1));
                  putFIXED (mINITIALISExCONSTERMxTERM1, numberRHS);
                }
              es2s3s1:;
              } // End of DO block
            // J = 1; (2167)
            {
              int32_t numberRHS = (int32_t)(1);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mINITIALISExCONSTERMxJ, bitRHS);
              bitRHS->inUse = 0;
            }
          es2s3:;
          } // End of DO block
        // ELSE (2168)
        else
          // IF T = VECTOR THEN (2169)
          if (1
              & (xEQ (COREHALFWORD (mINITIALISExCONSTERMxT), BYTE0 (mVECTOR))))
            // DO; (2170)
            {
            rs2s4:;
              // IF J = 1 THEN (2171)
              if (1 & (xEQ (COREHALFWORD (mINITIALISExCONSTERMxJ), 1)))
                // TERM1 = TERM1 * (SYT_DIMS(OP)& 255) - 1; (2172)
                {
                  int32_t numberRHS = (int32_t)(xsubtract (
                      xmultiply (getFIXED (mINITIALISExCONSTERMxTERM1),
                                 xAND (COREHALFWORD (
                                           getFIXED (mSYM_TAB)
                                           + 34
                                                 * (COREHALFWORD (
                                                     mINITIALISExCONSTERMxOP))
                                           + 18 + 2 * (0)),
                                       255)),
                      1));
                  putFIXED (mINITIALISExCONSTERMxTERM1, numberRHS);
                }
              // J = 1; (2173)
              {
                int32_t numberRHS = (int32_t)(1);
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mINITIALISExCONSTERMxJ, bitRHS);
                bitRHS->inUse = 0;
              }
            es2s4:;
            } // End of DO block
      // IF J = 2 THEN (2174)
      if (1 & (xEQ (COREHALFWORD (mINITIALISExCONSTERMxJ), 2)))
        // RETURN 0; (2175)
        {
          reentryGuard = 0;
          return 0;
        }
      // RETURN TERM1 * BIGHTS(SYT_TYPE(OP)); (2176)
      {
        reentryGuard = 0;
        return xmultiply (
            getFIXED (mINITIALISExCONSTERMxTERM1),
            BYTE0 (
                mBIGHTS
                + 1
                      * BYTE0 (getFIXED (mSYM_TAB)
                               + 34 * (COREHALFWORD (mINITIALISExCONSTERMxOP))
                               + 32 + 1 * (0))));
      }
    es2:;
    } // End of DO block
  {
    reentryGuard = 0;
    return 0;
  }
}
