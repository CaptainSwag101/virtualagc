/*
  File GENERATExSAVE_LITERAL.c generated by XCOM-I, 2024-08-09 12:39:31.
*/

#include "runtimeC.h"

descriptor_t *
GENERATExSAVE_LITERAL (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (descriptor_t *)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GENERATExSAVE_LITERAL");
  // OPTYPE=OPMODE(OPTYPE); (3769)
  {
    descriptor_t *bitRHS = getBIT (
        8, mOPMODE + 1 * COREHALFWORD (mGENERATExSAVE_LITERALxOPTYPE));
    putBIT (16, mGENERATExSAVE_LITERALxOPTYPE, bitRHS);
    bitRHS->inUse = 0;
  }
  // FORM(OP)=CHARLIT+OPTYPE; (3770)
  {
    int32_t numberRHS = (int32_t)(xadd (
        BYTE0 (mCHARLIT), COREHALFWORD (mGENERATExSAVE_LITERALxOPTYPE)));
    putBIT (16,
            getFIXED (mIND_STACK)
                + 73 * (COREHALFWORD (mGENERATExSAVE_LITERALxOP)) + 32
                + 2 * (0),
            fixedToBit (16, numberRHS));
  }
  // CONSTANT_REFS(OPTYPE) = CONSTANT_REFS(OPTYPE) + 1; (3771)
  {
    int32_t numberRHS = (int32_t)(xadd (
        COREHALFWORD (mCONSTANT_REFS
                      + 2 * COREHALFWORD (mGENERATExSAVE_LITERALxOPTYPE)),
        1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16,
            mCONSTANT_REFS
                + 2 * (COREHALFWORD (mGENERATExSAVE_LITERALxOPTYPE)),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // PTR=CONSTANT_HEAD(OPTYPE); (3772)
  {
    descriptor_t *bitRHS = getBIT (
        16, mCONSTANT_HEAD + 2 * COREHALFWORD (mGENERATExSAVE_LITERALxOPTYPE));
    putBIT (16, mGENERATExSAVE_LITERALxPTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO WHILE PTR~=0; (3773)
  while (1 & (xNEQ (COREHALFWORD (mGENERATExSAVE_LITERALxPTR), 0)))
    {
      // IF OPTYPE = 0 THEN (3774)
      if (1 & (xEQ (COREHALFWORD (mGENERATExSAVE_LITERALxOPTYPE), 0)))
        // DO; (3775)
        {
        rs1s1:;
          // MESSAGE = DESC(CONSTANTS(PTR)); (3776)
          {
            descriptor_t *stringRHS;
            stringRHS = getCHARACTER (
                mCONSTANTS + 4 * COREHALFWORD (mGENERATExSAVE_LITERALxPTR));
            putCHARACTER (mMESSAGE, stringRHS);
            stringRHS->inUse = 0;
          }
          // IF LENGTH(MESSAGE) = LENGTH(DESC(VAL(OP))) THEN (3777)
          if (1
              & (xEQ (LENGTH (getCHARACTER (mMESSAGE)),
                      LENGTH (getCHARACTER (
                          getFIXED (mIND_STACK)
                          + 73 * (COREHALFWORD (mGENERATExSAVE_LITERALxOP))
                          + 12 + 4 * (0))))))
            // IF MESSAGE=DESC(VAL(OP)) THEN (3778)
            if (1
                & (xsEQ (getCHARACTER (mMESSAGE),
                         getCHARACTER (
                             getFIXED (mIND_STACK)
                             + 73 * (COREHALFWORD (mGENERATExSAVE_LITERALxOP))
                             + 12 + 4 * (0)))))
              // GO TO RETURN_PTR; (3779)
              goto RETURN_PTR;
        es1s1:;
        } // End of DO block
      // ELSE (3780)
      else
        // IF CONSTANTS(PTR)=VAL(OP) THEN (3781)
        if (1
            & (xEQ (getFIXED (mCONSTANTS
                              + 4 * COREHALFWORD (mGENERATExSAVE_LITERALxPTR)),
                    getFIXED (getFIXED (mIND_STACK)
                              + 73 * (COREHALFWORD (mGENERATExSAVE_LITERALxOP))
                              + 12 + 4 * (0)))))
          // DO; (3782)
          {
          rs1s2:;
            // IF OPTYPE < 4 THEN (3783)
            if (1 & (xLT (COREHALFWORD (mGENERATExSAVE_LITERALxOPTYPE), 4)))
              // GO TO RETURN_PTR; (3784)
              goto RETURN_PTR;
            // IF CONSTANTS(PTR+1) = XVAL(OP) THEN (3785)
            if (1
                & (xEQ (
                    getFIXED (mCONSTANTS
                              + 4
                                    * xadd (COREHALFWORD (
                                                mGENERATExSAVE_LITERALxPTR),
                                            1)),
                    getFIXED (getFIXED (mIND_STACK)
                              + 73 * (COREHALFWORD (mGENERATExSAVE_LITERALxOP))
                              + 16 + 4 * (0)))))
              // GO TO RETURN_PTR; (3786)
              goto RETURN_PTR;
          es1s2:;
          } // End of DO block
      // PTR=CONSTANT_PTR(PTR); (3787)
      {
        descriptor_t *bitRHS = getBIT (
            16, mCONSTANT_PTR + 2 * COREHALFWORD (mGENERATExSAVE_LITERALxPTR));
        putBIT (16, mGENERATExSAVE_LITERALxPTR, bitRHS);
        bitRHS->inUse = 0;
      }
    } // End of DO WHILE block
  // PTR,CONSTANT_CTR=CONSTANT_CTR+1; (3788)
  {
    int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mCONSTANT_CTR), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mGENERATExSAVE_LITERALxPTR, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mCONSTANT_CTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // CONSTANT_PTR(PTR) = CONSTANT_HEAD(OPTYPE); (3789)
  {
    descriptor_t *bitRHS = getBIT (
        16, mCONSTANT_HEAD + 2 * COREHALFWORD (mGENERATExSAVE_LITERALxOPTYPE));
    putBIT (16,
            mCONSTANT_PTR + 2 * (COREHALFWORD (mGENERATExSAVE_LITERALxPTR)),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // CONSTANT_HEAD(OPTYPE) = PTR; (3790)
  {
    descriptor_t *bitRHS = getBIT (16, mGENERATExSAVE_LITERALxPTR);
    putBIT (16,
            mCONSTANT_HEAD
                + 2 * (COREHALFWORD (mGENERATExSAVE_LITERALxOPTYPE)),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // CONSTANTS(PTR)=VAL(OP); (3791)
  {
    int32_t numberRHS = (int32_t)(getFIXED (
        getFIXED (mIND_STACK) + 73 * (COREHALFWORD (mGENERATExSAVE_LITERALxOP))
        + 12 + 4 * (0)));
    putFIXED (mCONSTANTS + 4 * (COREHALFWORD (mGENERATExSAVE_LITERALxPTR)),
              numberRHS);
  }
  // IF OPTYPE >= 4 THEN (3792)
  if (1 & (xGE (COREHALFWORD (mGENERATExSAVE_LITERALxOPTYPE), 4)))
    // DO; (3793)
    {
    rs2:;
      // CONSTANT_CTR=CONSTANT_CTR+1; (3794)
      {
        int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mCONSTANT_CTR), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mCONSTANT_CTR, bitRHS);
        bitRHS->inUse = 0;
      }
      // CONSTANTS(CONSTANT_CTR)=XVAL(OP); (3795)
      {
        int32_t numberRHS = (int32_t)(getFIXED (
            getFIXED (mIND_STACK)
            + 73 * (COREHALFWORD (mGENERATExSAVE_LITERALxOP)) + 16 + 4 * (0)));
        putFIXED (mCONSTANTS + 4 * (COREHALFWORD (mCONSTANT_CTR)), numberRHS);
      }
    es2:;
    } // End of DO block
  // IF CONSTANT_CTR > CONST_LIM THEN (3796)
  if (1 & (xGT (COREHALFWORD (mCONSTANT_CTR), 2000)))
    // CALL ERRORS(CLASS_BS,109); (3797)
    {
      putBITp (16, mERRORSxCLASS, getBIT (8, mCLASS_BS));
      putBITp (16, mERRORSxNUM, fixedToBit (32, (int32_t)(109)));
      ERRORS (0);
    }
  // IF BINARY_CODE THEN (3798)
  if (1 & (bitToFixed (getBIT (1, mBINARY_CODE))))
    // DO; (3799)
    {
    rs3:;
      // MESSAGE=HEX(VAL(OP),8); (3800)
      {
        descriptor_t *stringRHS;
        stringRHS
            = (putFIXED (
                   mHEXxHVAL,
                   getFIXED (getFIXED (mIND_STACK)
                             + 73 * (COREHALFWORD (mGENERATExSAVE_LITERALxOP))
                             + 12 + 4 * (0))),
               putFIXED (mHEXxN, 8), HEX (0));
        putCHARACTER (mMESSAGE, stringRHS);
        stringRHS->inUse = 0;
      }
      // IF OPTYPE >= 4 THEN (3801)
      if (1 & (xGE (COREHALFWORD (mGENERATExSAVE_LITERALxOPTYPE), 4)))
        // MESSAGE=MESSAGE||BLANK||HEX(XVAL(OP),8); (3802)
        {
          descriptor_t *stringRHS;
          stringRHS = xsCAT (
              xsCAT (getCHARACTER (mMESSAGE), getCHARACTER (mBLANK)),
              (putFIXED (
                   mHEXxHVAL,
                   getFIXED (getFIXED (mIND_STACK)
                             + 73 * (COREHALFWORD (mGENERATExSAVE_LITERALxOP))
                             + 16 + 4 * (0))),
               putFIXED (mHEXxN, 8), HEX (0)));
          putCHARACTER (mMESSAGE, stringRHS);
          stringRHS->inUse = 0;
        }
      // OUTPUT=FORMAT(PTR,6)||COLON||MESSAGE; (3803)
      {
        descriptor_t *stringRHS;
        stringRHS = xsCAT (
            xsCAT ((putFIXED (mFORMATxIVAL,
                              COREHALFWORD (mGENERATExSAVE_LITERALxPTR)),
                    putFIXED (mFORMATxN, 6), FORMAT (0)),
                   getCHARACTER (mCOLON)),
            getCHARACTER (mMESSAGE));
        OUTPUT (0, stringRHS);
        stringRHS->inUse = 0;
      }
    es3:;
    } // End of DO block
// RETURN_PTR: (3804)
RETURN_PTR:
  // LOC(OP) = PTR; (3805)
  {
    descriptor_t *bitRHS = getBIT (16, mGENERATExSAVE_LITERALxPTR);
    putBIT (16,
            getFIXED (mIND_STACK)
                + 73 * (COREHALFWORD (mGENERATExSAVE_LITERALxOP)) + 40
                + 2 * (0),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // RETURN PTR; (3806)
  {
    reentryGuard = 0;
    return getBIT (16, mGENERATExSAVE_LITERALxPTR);
  }
}
