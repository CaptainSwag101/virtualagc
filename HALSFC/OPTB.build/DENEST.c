/*
  File DENEST.c generated by XCOM-I, 2024-08-09 12:41:08.
*/

#include "runtimeC.h"

int32_t
DENEST (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "DENEST");
  // IF C_TRACE THEN (2561)
  if (1 & (bitToFixed (getBIT (8, mC_TRACE))))
    // OUTPUT = 'DENEST:  '||END_PTR||','||TAG; (2562)
    {
      descriptor_t *stringRHS;
      stringRHS = xsCAT (
          xsCAT (xsCAT (cToDescriptor (NULL, "DENEST:  "),
                        bitToCharacter (getBIT (16, mDENESTxEND_PTR))),
                 cToDescriptor (NULL, ",")),
          bitToCharacter (getBIT (8, mDENESTxTAG)));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // IF TAG THEN (2563)
  if (1 & (bitToFixed (getBIT (8, mDENESTxTAG))))
    // DO; (2564)
    {
    rs1:;
      // IF AR_DIMS > 1 OR ~STRUCTURE_COPIES THEN (2565)
      if (1
          & (xOR (xGT (BYTE0 (mAR_DIMS), 1),
                  xNOT (BYTE0 (mSTRUCTURE_COPIES)))))
        // DO; (2566)
        {
        rs1s1:;
          // LAST = LOOP_HEAD(1) + AR_DIMS; (2567)
          {
            int32_t numberRHS = (int32_t)(xadd (
                COREHALFWORD (mLOOP_HEAD + 2 * 1), BYTE0 (mAR_DIMS)));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mDENESTxLAST, bitRHS);
            bitRHS->inUse = 0;
          }
          // PTR = LOOP_HEAD + 1; (2568)
          {
            int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mLOOP_HEAD), 1));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mDENESTxPTR, bitRHS);
            bitRHS->inUse = 0;
          }
          // AR_SIZE(1) = AR_SIZE(1) * SHR(OPR(PTR),16); (2569)
          {
            int32_t numberRHS = (int32_t)(xmultiply (
                COREHALFWORD (mAR_SIZE + 2 * 1),
                SHR (getFIXED (mOPR + 4 * COREHALFWORD (mDENESTxPTR)), 16)));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mAR_SIZE + 2 * (1), bitRHS);
            bitRHS->inUse = 0;
          }
          // CALL MULTIPLY_DIMS(LAST,PTR); (2570)
          {
            putBITp (16, mMULTIPLY_DIMSxLAST, getBIT (16, mDENESTxLAST));
            putBITp (16, mMULTIPLY_DIMSxPTR, getBIT (16, mDENESTxPTR));
            MULTIPLY_DIMS (0);
          }
          // OPR(LAST) = OPR(LAST) | DENEST_TAG; (2571)
          {
            int32_t numberRHS = (int32_t)(xOR (
                getFIXED (mOPR + 4 * COREHALFWORD (mDENESTxLAST)),
                COREHALFWORD (mDENEST_TAG)));
            putFIXED (mOPR + 4 * (COREHALFWORD (mDENESTxLAST)), numberRHS);
          }
          // CALL POP_LOOP_STACKS(1); (2572)
          {
            putBITp (8, mPOP_LOOP_STACKSxVM, fixedToBit (32, (int32_t)(1)));
            POP_LOOP_STACKS (0);
          }
          // OPR(END_PTR) = 0; (2573)
          {
            int32_t numberRHS = (int32_t)(0);
            putFIXED (mOPR + 4 * (COREHALFWORD (mDENESTxEND_PTR)), numberRHS);
          }
          // OPR(PTR - 1) =  65536; (2574)
          {
            int32_t numberRHS = (int32_t)(65536);
            putFIXED (mOPR + 4 * (xsubtract (COREHALFWORD (mDENESTxPTR), 1)),
                      numberRHS);
          }
          // N_INX = N_INX - 1; (2575)
          {
            int32_t numberRHS
                = (int32_t)(xsubtract (COREHALFWORD (mN_INX), 1));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mN_INX, bitRHS);
            bitRHS->inUse = 0;
          }
          // A_PARITY(N_INX) = A_PARITY(N_INX) & A_PARITY(N_INX + 1); (2576)
          {
            int32_t numberRHS = (int32_t)(xAND (
                BYTE0 (mA_PARITY + 1 * COREHALFWORD (mN_INX)),
                BYTE0 (mA_PARITY + 1 * xadd (COREHALFWORD (mN_INX), 1))));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (8, mA_PARITY + 1 * (COREHALFWORD (mN_INX)), bitRHS);
            bitRHS->inUse = 0;
          }
          // IF C_TRACE THEN (2577)
          if (1 & (bitToFixed (getBIT (8, mC_TRACE))))
            // DO; (2578)
            {
            rs1s1s1:;
              // CALL VU(LAST,1); (2579)
              {
                putBITp (16, mVUxBEGIN, getBIT (16, mDENESTxLAST));
                putBITp (16, mVUxNO, fixedToBit (32, (int32_t)(1)));
                VU (0);
              }
              // CALL VU(PTR - 1,1); (2580)
              {
                putBITp (16, mVUxBEGIN,
                         fixedToBit (32, (int32_t)(xsubtract (
                                             COREHALFWORD (mDENESTxPTR), 1))));
                putBITp (16, mVUxNO, fixedToBit (32, (int32_t)(1)));
                VU (0);
              }
            es1s1s1:;
            } // End of DO block
          // DENEST# = DENEST# + 1; (2581)
          {
            int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mDENESTp), 1));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mDENESTp, bitRHS);
            bitRHS->inUse = 0;
          }
        es1s1:;
        } // End of DO block
      // TAG = 0; (2582)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (8, mDENESTxTAG, bitRHS);
        bitRHS->inUse = 0;
      }
    es1:;
    } // End of DO block
  // ELSE (2583)
  else
    // DO; (2584)
    {
    rs2:;
      // COUNT = 0; (2585)
      {
        int32_t numberRHS = (int32_t)(0);
        putFIXED (mDENESTxCOUNT, numberRHS);
      }
      // DO FOR I = 1 TO AR_DIMS - 1 - STRUCTURE_COPIES; (2586)
      {
        int32_t from59, to59, by59;
        from59 = 1;
        to59 = xsubtract (xsubtract (BYTE0 (mAR_DIMS), 1),
                          BYTE0 (mSTRUCTURE_COPIES));
        by59 = 1;
        for (putBIT (16, mDENESTxI, fixedToBit (16, from59));
             bitToFixed (getBIT (16, mDENESTxI)) <= to59; putBIT (
                 16, mDENESTxI,
                 fixedToBit (16, bitToFixed (getBIT (16, mDENESTxI)) + by59)))
          {
            // TEMP = LOOP_HEAD + AR_DIMS - I; (2587)
            {
              int32_t numberRHS = (int32_t)(xsubtract (
                  xadd (COREHALFWORD (mLOOP_HEAD), BYTE0 (mAR_DIMS)),
                  COREHALFWORD (mDENESTxI)));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mDENESTxTEMP, bitRHS);
              bitRHS->inUse = 0;
            }
            // CALL MULTIPLY_DIMS(TEMP,TEMP + 1); (2588)
            {
              putBITp (16, mMULTIPLY_DIMSxLAST, getBIT (16, mDENESTxTEMP));
              putBITp (16, mMULTIPLY_DIMSxPTR,
                       fixedToBit (32, (int32_t)(xadd (
                                           COREHALFWORD (mDENESTxTEMP), 1))));
              MULTIPLY_DIMS (0);
            }
            // COUNT = COUNT + 1; (2589)
            {
              int32_t numberRHS
                  = (int32_t)(xadd (getFIXED (mDENESTxCOUNT), 1));
              putFIXED (mDENESTxCOUNT, numberRHS);
            }
          }
      } // End of DO for-loop block
      // AR_DIMS = AR_DIMS - COUNT; (2590)
      {
        int32_t numberRHS = (int32_t)(xsubtract (BYTE0 (mAR_DIMS),
                                                 getFIXED (mDENESTxCOUNT)));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (8, mAR_DIMS, bitRHS);
        bitRHS->inUse = 0;
      }
      // OPR(LOOP_HEAD) = OPR(LOOP_HEAD) - SHL(COUNT,16); (2591)
      {
        int32_t numberRHS = (int32_t)(xsubtract (
            getFIXED (mOPR + 4 * COREHALFWORD (mLOOP_HEAD)),
            SHL (getFIXED (mDENESTxCOUNT), 16)));
        putFIXED (mOPR + 4 * (COREHALFWORD (mLOOP_HEAD)), numberRHS);
      }
      // OPR(LOOP_HEAD + AR_DIMS) = OPR(LOOP_HEAD + AR_DIMS) | DENEST_TAG;
      // (2592)
      {
        int32_t numberRHS = (int32_t)(xOR (
            getFIXED (
                mOPR + 4 * xadd (COREHALFWORD (mLOOP_HEAD), BYTE0 (mAR_DIMS))),
            COREHALFWORD (mDENEST_TAG)));
        putFIXED (
            mOPR + 4 * (xadd (COREHALFWORD (mLOOP_HEAD), BYTE0 (mAR_DIMS))),
            numberRHS);
      }
      // IF C_TRACE THEN (2593)
      if (1 & (bitToFixed (getBIT (8, mC_TRACE))))
        // CALL VU(LOOP_HEAD,AR_DIMS); (2594)
        {
          putBITp (16, mVUxBEGIN, getBIT (16, mLOOP_HEAD));
          putBITp (16, mVUxNO, getBIT (8, mAR_DIMS));
          VU (0);
        }
      // DENEST# = DENEST# + 1; (2595)
      {
        int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mDENESTp), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mDENESTp, bitRHS);
        bitRHS->inUse = 0;
      }
    es2:;
    } // End of DO block
  {
    reentryGuard = 0;
    return 0;
  }
}
