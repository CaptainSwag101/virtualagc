/*
  File RELOCATE_HALMAT.c generated by XCOM-I, 2024-08-09 12:41:08.
*/

#include "runtimeC.h"

int32_t
RELOCATE_HALMAT (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "RELOCATE_HALMAT");
  // IF TRACE THEN (2955)
  if (1 & (bitToFixed (getBIT (8, mTRACE))))
    // OUTPUT = 'RELOCATE_HALMAT:'; (2956)
    {
      descriptor_t *stringRHS;
      stringRHS = cToDescriptor (NULL, "RELOCATE_HALMAT:");
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // D_N_INX = 0; (2957)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mD_N_INX, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO FOR I = 1 TO CSE_L_INX; (2958)
  {
    int32_t from68, to68, by68;
    from68 = 1;
    to68 = bitToFixed (getBIT (16, mCSE_L_INX));
    by68 = 1;
    for (putBIT (16, mRELOCATE_HALMATxI, fixedToBit (16, from68));
         bitToFixed (getBIT (16, mRELOCATE_HALMATxI)) <= to68;
         putBIT (16, mRELOCATE_HALMATxI,
                 fixedToBit (16, bitToFixed (getBIT (16, mRELOCATE_HALMATxI))
                                     + by68)))
      {
        // PTR = CSE_LIST(I); (2959)
        {
          descriptor_t *bitRHS = getBIT (
              16, getFIXED (mCOMMONSE_LIST)
                      + 2 * (COREHALFWORD (mRELOCATE_HALMATxI)) + 0 + 2 * (0));
          putBIT (16, mRELOCATE_HALMATxPTR, bitRHS);
          bitRHS->inUse = 0;
        }
        // IF TRACE THEN (2960)
        if (1 & (bitToFixed (getBIT (8, mTRACE))))
          // OUTPUT = '   CSE_LIST(' ||I||') = '||PTR; (2961)
          {
            descriptor_t *stringRHS;
            stringRHS = xsCAT (
                xsCAT (
                    xsCAT (cToDescriptor (NULL, "   CSE_LIST("),
                           bitToCharacter (getBIT (16, mRELOCATE_HALMATxI))),
                    cToDescriptor (NULL, ") = ")),
                bitToCharacter (getBIT (16, mRELOCATE_HALMATxPTR)));
            OUTPUT (0, stringRHS);
            stringRHS->inUse = 0;
          }
        // IF VAC_OR_XPT(PTR) & (OPR(PTR) &  12) =  12 THEN (2962)
        if (1
            & (xAND (
                bitToFixed ((putBITp (16, mVAC_OR_XPTxPTR,
                                      getBIT (16, mRELOCATE_HALMATxPTR)),
                             VAC_OR_XPT (0))),
                xEQ (xAND (getFIXED (
                               mOPR + 4 * COREHALFWORD (mRELOCATE_HALMATxPTR)),
                           12),
                     12))))
          // DO; (2963)
          {
          rs1s1:;
            // NODE_PTR = SHR(OPR(PTR),16); (2964)
            {
              int32_t numberRHS = (int32_t)(SHR (
                  getFIXED (mOPR + 4 * COREHALFWORD (mRELOCATE_HALMATxPTR)),
                  16));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mRELOCATE_HALMATxNODE_PTR, bitRHS);
              bitRHS->inUse = 0;
            }
            // TEMP = LAST_OP(PTR); (2965)
            {
              int32_t numberRHS
                  = (int32_t)((putBITp (16, mLAST_OPxPTR,
                                        getBIT (16, mRELOCATE_HALMATxPTR)),
                               LAST_OP (0)));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mRELOCATE_HALMATxTEMP, bitRHS);
              bitRHS->inUse = 0;
            }
            // IF (OPR(TEMP)& 65521)=XEXTN THEN (2966)
            if (1
                & (xEQ (
                    xAND (getFIXED (
                              mOPR + 4 * COREHALFWORD (mRELOCATE_HALMATxTEMP)),
                          65521),
                    COREHALFWORD (mXEXTN))))
              // DO; (2967)
              {
              rs1s1s1:;
                // IF (OPR(TEMP) &  8) = 0 THEN (2968)
                if (1
                    & (xEQ (
                        xAND (getFIXED (
                                  mOPR
                                  + 4 * COREHALFWORD (mRELOCATE_HALMATxTEMP)),
                              8),
                        0)))
                  // DO; (2969)
                  {
                  rs1s1s1s1:;
                    // XPT_LOC = REFERENCE(TEMP); (2970)
                    {
                      descriptor_t *bitRHS
                          = (putBITp (16, mREFERENCExPTR,
                                      getBIT (16, mRELOCATE_HALMATxTEMP)),
                             REFERENCE (0));
                      putBIT (16, mRELOCATE_HALMATxXPT_LOC, bitRHS);
                      bitRHS->inUse = 0;
                    }
                  // NON_CSE_EXTN: (2971)
                  NON_CSE_EXTN:
                    // OPR(XPT_LOC) = OPR(XPT_LOC) |  8; (2972)
                    {
                      int32_t numberRHS = (int32_t)(xOR (
                          getFIXED (
                              mOPR
                              + 4 * COREHALFWORD (mRELOCATE_HALMATxXPT_LOC)),
                          8));
                      putFIXED (
                          mOPR + 4 * (COREHALFWORD (mRELOCATE_HALMATxXPT_LOC)),
                          numberRHS);
                    }
                    // SECOND_REF = NODE2(NODE_PTR+1) < 0; (2973)
                    {
                      int32_t numberRHS = (int32_t)(xLT (
                          COREHALFWORD (
                              mNODE2
                              + 2
                                    * xadd (COREHALFWORD (
                                                mRELOCATE_HALMATxNODE_PTR),
                                            1)),
                          0));
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (8, mRELOCATE_HALMATxSECOND_REF, bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // IF SECOND_REF THEN (2974)
                    if (1
                        & (bitToFixed (
                            getBIT (8, mRELOCATE_HALMATxSECOND_REF))))
                      // NODE2(NODE_PTR+1) = NODE2(NODE_PTR+1) - 1; (2975)
                      {
                        int32_t numberRHS = (int32_t)(xsubtract (
                            COREHALFWORD (
                                mNODE2
                                + 2
                                      * xadd (COREHALFWORD (
                                                  mRELOCATE_HALMATxNODE_PTR),
                                              1)),
                            1));
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (
                            16,
                            mNODE2
                                + 2
                                      * (xadd (COREHALFWORD (
                                                   mRELOCATE_HALMATxNODE_PTR),
                                               1)),
                            bitRHS);
                        bitRHS->inUse = 0;
                      }
                    // ELSE (2976)
                    else
                      // NODE2(NODE_PTR+1) = -1; (2977)
                      {
                        int32_t numberRHS = (int32_t)(-1);
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (
                            16,
                            mNODE2
                                + 2
                                      * (xadd (COREHALFWORD (
                                                   mRELOCATE_HALMATxNODE_PTR),
                                               1)),
                            bitRHS);
                        bitRHS->inUse = 0;
                      }
                    // TEMP = SHR(NODE(NODE_PTR+1),16); (2978)
                    {
                      int32_t numberRHS = (int32_t)(SHR (
                          getFIXED (
                              mNODE
                              + 4
                                    * xadd (COREHALFWORD (
                                                mRELOCATE_HALMATxNODE_PTR),
                                            1)),
                          16));
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (16, mRELOCATE_HALMATxTEMP, bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // IF ~SECOND_REF OR XPT_LOC > TEMP THEN (2979)
                    if (1
                        & (xOR (xNOT (BYTE0 (mRELOCATE_HALMATxSECOND_REF)),
                                xGT (COREHALFWORD (mRELOCATE_HALMATxXPT_LOC),
                                     COREHALFWORD (mRELOCATE_HALMATxTEMP)))))
                      // NODE(NODE_PTR+1)=(NODE(NODE_PTR+1)&
                      // 65535)|SHL(XPT_LOC,16); (2980)
                      {
                        int32_t numberRHS = (int32_t)(xOR (
                            xAND (getFIXED (
                                      mNODE
                                      + 4
                                            * xadd (
                                                COREHALFWORD (
                                                    mRELOCATE_HALMATxNODE_PTR),
                                                1)),
                                  65535),
                            SHL (COREHALFWORD (mRELOCATE_HALMATxXPT_LOC),
                                 16)));
                        putFIXED (
                            mNODE
                                + 4
                                      * (xadd (COREHALFWORD (
                                                   mRELOCATE_HALMATxNODE_PTR),
                                               1)),
                            numberRHS);
                      }
                    // D_N_INX = D_N_INX + 1; (2981)
                    {
                      int32_t numberRHS
                          = (int32_t)(xadd (COREHALFWORD (mD_N_INX), 1));
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (16, mD_N_INX, bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // DIFF_PTR(D_N_INX) = NODE_PTR + 1; (2982)
                    {
                      int32_t numberRHS = (int32_t)(xadd (
                          COREHALFWORD (mRELOCATE_HALMATxNODE_PTR), 1));
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (16, mDIFF_PTR + 2 * (COREHALFWORD (mD_N_INX)),
                              bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // IF TRACE THEN (2983)
                    if (1 & (bitToFixed (getBIT (8, mTRACE))))
                      // OUTPUT='     NODE_PTR '||(NODE_PTR+1)||' XPT '||
                      // HEX(OPR(XPT_LOC),8)||' NODE
                      // '||HEX(NODE(NODE_PTR+1),8); (2984)
                      {
                        descriptor_t *stringRHS;
                        stringRHS = xsCAT (
                            xsCAT (
                                xsCAT (
                                    xsCAT (
                                        xsCAT (
                                            cToDescriptor (NULL,
                                                           "     NODE_PTR "),
                                            fixedToCharacter (xadd (
                                                COREHALFWORD (
                                                    mRELOCATE_HALMATxNODE_PTR),
                                                1))),
                                        cToDescriptor (NULL, " XPT ")),
                                    (putFIXED (
                                         mHEXxHVAL,
                                         getFIXED (
                                             mOPR
                                             + 4
                                                   * COREHALFWORD (
                                                       mRELOCATE_HALMATxXPT_LOC))),
                                     putFIXED (mHEXxN, 8), HEX (0))),
                                cToDescriptor (NULL, " NODE ")),
                            (putFIXED (
                                 mHEXxHVAL,
                                 getFIXED (
                                     mNODE
                                     + 4
                                           * xadd (
                                               COREHALFWORD (
                                                   mRELOCATE_HALMATxNODE_PTR),
                                               1))),
                             putFIXED (mHEXxN, 8), HEX (0)));
                        OUTPUT (0, stringRHS);
                        stringRHS->inUse = 0;
                      }
                  es1s1s1s1:;
                  } // End of DO block
                // ELSE (2985)
                else
                  // DO; (2986)
                  {
                  rs1s1s1s2:;
                    // K = VAC_PTR | TEMP; (2987)
                    {
                      int32_t numberRHS = (int32_t)(xOR (
                          getFIXED (mVAC_PTR),
                          COREHALFWORD (mRELOCATE_HALMATxTEMP)));
                      putFIXED (mRELOCATE_HALMATxK, numberRHS);
                    }
                    // J = N_INX; (2988)
                    {
                      descriptor_t *bitRHS = getBIT (16, mN_INX);
                      putBIT (16, mRELOCATE_HALMATxJ, bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // DO WHILE J>0; (2989)
                    while (1 & (xGT (COREHALFWORD (mRELOCATE_HALMATxJ), 0)))
                      {
                        // IF NODE(J) = K THEN (2990)
                        if (1
                            & (xEQ (
                                getFIXED (
                                    mNODE
                                    + 4 * COREHALFWORD (mRELOCATE_HALMATxJ)),
                                getFIXED (mRELOCATE_HALMATxK))))
                          // DO; (2991)
                          {
                          rs1s1s1s2s1s1:;
                            // IF NODE2(J) = 0 THEN (2992)
                            if (1
                                & (xEQ (COREHALFWORD (
                                            mNODE2
                                            + 2
                                                  * COREHALFWORD (
                                                      mRELOCATE_HALMATxJ)),
                                        0)))
                              // DO; (2993)
                              {
                              rs1s1s1s2s1s1s1:;
                                // CTR = TEMP; (2994)
                                {
                                  descriptor_t *bitRHS
                                      = getBIT (16, mRELOCATE_HALMATxTEMP);
                                  putBIT (16, mRELOCATE_HALMATxCTR, bitRHS);
                                  bitRHS->inUse = 0;
                                }
                                // DO WHILE (OPR(CTR)& 65521)~=XSMRK; (2995)
                                while (
                                    1
                                    & (xNEQ (
                                        xAND (
                                            getFIXED (
                                                mOPR
                                                + 4
                                                      * COREHALFWORD (
                                                          mRELOCATE_HALMATxCTR)),
                                            65521),
                                        COREHALFWORD (mXSMRK))))
                                  {
                                    // DO FOR K = CTR+1 TO
                                    // CTR+NO_OPERANDS(CTR); (2996)
                                    {
                                      int32_t from69, to69, by69;
                                      from69 = xadd (
                                          COREHALFWORD (mRELOCATE_HALMATxCTR),
                                          1);
                                      to69 = xadd (
                                          COREHALFWORD (mRELOCATE_HALMATxCTR),
                                          bitToFixed (
                                              (putBITp (
                                                   16, mNO_OPERANDSxPTR,
                                                   getBIT (
                                                       16,
                                                       mRELOCATE_HALMATxCTR)),
                                               NO_OPERANDS (0))));
                                      by69 = 1;
                                      for (putFIXED (mRELOCATE_HALMATxK,
                                                     from69);
                                           getFIXED (mRELOCATE_HALMATxK)
                                           <= to69;
                                           putFIXED (
                                               mRELOCATE_HALMATxK,
                                               getFIXED (mRELOCATE_HALMATxK)
                                                   + by69))
                                        {
                                          // IF (OPR(K)& 253)= 77 THEN (2997)
                                          if (1
                                              & (xEQ (
                                                  xAND (
                                                      getFIXED (
                                                          mOPR
                                                          + 4
                                                                * getFIXED (
                                                                    mRELOCATE_HALMATxK)),
                                                      253),
                                                  77)))
                                            // IF SHR(OPR(K),16)=J THEN (2998)
                                            if (1
                                                & (xEQ (
                                                    SHR (
                                                        getFIXED (
                                                            mOPR
                                                            + 4
                                                                  * getFIXED (
                                                                      mRELOCATE_HALMATxK)),
                                                        16),
                                                    COREHALFWORD (
                                                        mRELOCATE_HALMATxJ))))
                                              // DO; (2999)
                                              {
                                              rs1s1s1s2s1s1s1s1s1s1:;
                                                // XPT_LOC = K; (3000)
                                                {
                                                  int32_t numberRHS
                                                      = (int32_t)(getFIXED (
                                                          mRELOCATE_HALMATxK));
                                                  descriptor_t *bitRHS;
                                                  bitRHS = fixedToBit (
                                                      32,
                                                      (int32_t)(numberRHS));
                                                  putBIT (
                                                      16,
                                                      mRELOCATE_HALMATxXPT_LOC,
                                                      bitRHS);
                                                  bitRHS->inUse = 0;
                                                }
                                                // IF TRACE THEN (3001)
                                                if (1
                                                    & (bitToFixed (
                                                        getBIT (8, mTRACE))))
                                                  // OUTPUT = 'REFERENCE '||
                                                  // TEMP || ' IS ' || K;
                                                  // (3002)
                                                  {
                                                    descriptor_t *stringRHS;
                                                    stringRHS = xsCAT (
                                                        xsCAT (
                                                            xsCAT (
                                                                cToDescriptor (
                                                                    NULL,
                                                                    "REFERENCE"
                                                                    " "),
                                                                bitToCharacter (getBIT (
                                                                    16,
                                                                    mRELOCATE_HALMATxTEMP))),
                                                            cToDescriptor (
                                                                NULL, " IS ")),
                                                        fixedToCharacter (getFIXED (
                                                            mRELOCATE_HALMATxK)));
                                                    OUTPUT (0, stringRHS);
                                                    stringRHS->inUse = 0;
                                                  }
                                                // GO TO NON_CSE_EXTN; (3003)
                                                goto NON_CSE_EXTN;
                                              es1s1s1s2s1s1s1s1s1s1:;
                                              } // End of DO block
                                        }
                                    } // End of DO for-loop block
                                    // CTR = CTR + 1 + NO_OPERANDS(CTR); (3004)
                                    {
                                      int32_t numberRHS = (int32_t)(xadd (
                                          xadd (COREHALFWORD (
                                                    mRELOCATE_HALMATxCTR),
                                                1),
                                          bitToFixed (
                                              (putBITp (
                                                   16, mNO_OPERANDSxPTR,
                                                   getBIT (
                                                       16,
                                                       mRELOCATE_HALMATxCTR)),
                                               NO_OPERANDS (0)))));
                                      descriptor_t *bitRHS;
                                      bitRHS = fixedToBit (
                                          32, (int32_t)(numberRHS));
                                      putBIT (16, mRELOCATE_HALMATxCTR,
                                              bitRHS);
                                      bitRHS->inUse = 0;
                                    }
                                  } // End of DO WHILE block
                              es1s1s1s2s1s1s1:;
                              } // End of DO block
                            // ELSE (3005)
                            else
                              // J = 0; (3006)
                              {
                                int32_t numberRHS = (int32_t)(0);
                                descriptor_t *bitRHS;
                                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                                putBIT (16, mRELOCATE_HALMATxJ, bitRHS);
                                bitRHS->inUse = 0;
                              }
                          es1s1s1s2s1s1:;
                          } // End of DO block
                        // ELSE (3007)
                        else
                          // J = J - 1; (3008)
                          {
                            int32_t numberRHS = (int32_t)(xsubtract (
                                COREHALFWORD (mRELOCATE_HALMATxJ), 1));
                            descriptor_t *bitRHS;
                            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                            putBIT (16, mRELOCATE_HALMATxJ, bitRHS);
                            bitRHS->inUse = 0;
                          }
                      } // End of DO WHILE block
                  es1s1s1s2:;
                  } // End of DO block
              es1s1s1:;
              } // End of DO block
            // OPR(PTR) = (OPR(PTR) &  65531) | SHL(NODE(NODE_PTR),16); (3009)
            {
              int32_t numberRHS = (int32_t)(xOR (
                  xAND (getFIXED (mOPR
                                  + 4 * COREHALFWORD (mRELOCATE_HALMATxPTR)),
                        65531),
                  SHL (getFIXED (
                           mNODE
                           + 4 * COREHALFWORD (mRELOCATE_HALMATxNODE_PTR)),
                       16)));
              putFIXED (mOPR + 4 * (COREHALFWORD (mRELOCATE_HALMATxPTR)),
                        numberRHS);
            }
            // IF WATCH THEN (3010)
            if (1 & (bitToFixed (getBIT (8, mWATCH))))
              // OUTPUT = 'REPLACE '||PTR||' PTR BY '|| (NODE(NODE_PTR) &
              // 65535); (3011)
              {
                descriptor_t *stringRHS;
                stringRHS = xsCAT (
                    xsCAT (xsCAT (cToDescriptor (NULL, "REPLACE "),
                                  bitToCharacter (
                                      getBIT (16, mRELOCATE_HALMATxPTR))),
                           cToDescriptor (NULL, " PTR BY ")),
                    fixedToCharacter (xAND (
                        getFIXED (
                            mNODE
                            + 4 * COREHALFWORD (mRELOCATE_HALMATxNODE_PTR)),
                        65535)));
                OUTPUT (0, stringRHS);
                stringRHS->inUse = 0;
              }
            // IF (OPR(PTR) &  241) = XXPT THEN (3012)
            if (1
                & (xEQ (
                    xAND (getFIXED (mOPR
                                    + 4 * COREHALFWORD (mRELOCATE_HALMATxPTR)),
                          241),
                    COREHALFWORD (mXXPT))))
              // IF (NODE(NODE_PTR+2) & TYPE_MASK) = OUTER_TERMINAL_VAC THEN
              // (3013)
              if (1
                  & (xEQ (
                      xAND (getFIXED (
                                mNODE
                                + 4
                                      * xadd (COREHALFWORD (
                                                  mRELOCATE_HALMATxNODE_PTR),
                                              2)),
                            getFIXED (mTYPE_MASK)),
                      getFIXED (mOUTER_TERMINAL_VAC))))
                // NODE_PTR = (NODE(NODE_PTR+2) &  65535) + 1; (3014)
                {
                  int32_t numberRHS = (int32_t)(xadd (
                      xAND (getFIXED (
                                mNODE
                                + 4
                                      * xadd (COREHALFWORD (
                                                  mRELOCATE_HALMATxNODE_PTR),
                                              2)),
                            65535),
                      1));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mRELOCATE_HALMATxNODE_PTR, bitRHS);
                  bitRHS->inUse = 0;
                }
            // SECOND_REF = NODE2(NODE_PTR) < 0; (3015)
            {
              int32_t numberRHS = (int32_t)(xLT (
                  COREHALFWORD (
                      mNODE2 + 2 * COREHALFWORD (mRELOCATE_HALMATxNODE_PTR)),
                  0));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (8, mRELOCATE_HALMATxSECOND_REF, bitRHS);
              bitRHS->inUse = 0;
            }
            // IF SECOND_REF THEN (3016)
            if (1 & (bitToFixed (getBIT (8, mRELOCATE_HALMATxSECOND_REF))))
              // NODE2(NODE_PTR) = NODE2(NODE_PTR) - 1; (3017)
              {
                int32_t numberRHS = (int32_t)(xsubtract (
                    COREHALFWORD (
                        mNODE2 + 2 * COREHALFWORD (mRELOCATE_HALMATxNODE_PTR)),
                    1));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16,
                        mNODE2
                            + 2 * (COREHALFWORD (mRELOCATE_HALMATxNODE_PTR)),
                        bitRHS);
                bitRHS->inUse = 0;
              }
            // ELSE (3018)
            else
              // NODE2(NODE_PTR) = -1; (3019)
              {
                int32_t numberRHS = (int32_t)(-1);
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16,
                        mNODE2
                            + 2 * (COREHALFWORD (mRELOCATE_HALMATxNODE_PTR)),
                        bitRHS);
                bitRHS->inUse = 0;
              }
            // TEMP = SHR(NODE(NODE_PTR),16); (3020)
            {
              int32_t numberRHS = (int32_t)(SHR (
                  getFIXED (mNODE
                            + 4 * COREHALFWORD (mRELOCATE_HALMATxNODE_PTR)),
                  16));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mRELOCATE_HALMATxTEMP, bitRHS);
              bitRHS->inUse = 0;
            }
            // IF ~SECOND_REF OR PTR > TEMP THEN (3021)
            if (1
                & (xOR (xNOT (BYTE0 (mRELOCATE_HALMATxSECOND_REF)),
                        xGT (COREHALFWORD (mRELOCATE_HALMATxPTR),
                             COREHALFWORD (mRELOCATE_HALMATxTEMP)))))
              // NODE(NODE_PTR) = (NODE(NODE_PTR) &  65535) | SHL(PTR,16);
              // (3022)
              {
                int32_t numberRHS = (int32_t)(xOR (
                    xAND (getFIXED (
                              mNODE
                              + 4 * COREHALFWORD (mRELOCATE_HALMATxNODE_PTR)),
                          65535),
                    SHL (COREHALFWORD (mRELOCATE_HALMATxPTR), 16)));
                putFIXED (mNODE
                              + 4 * (COREHALFWORD (mRELOCATE_HALMATxNODE_PTR)),
                          numberRHS);
              }
            // CSE_LIST(I) = NODE_PTR; (3023)
            {
              descriptor_t *bitRHS = getBIT (16, mRELOCATE_HALMATxNODE_PTR);
              putBIT (16,
                      getFIXED (mCOMMONSE_LIST)
                          + 2 * (COREHALFWORD (mRELOCATE_HALMATxI)) + 0
                          + 2 * (0),
                      bitRHS);
              bitRHS->inUse = 0;
            }
            // IF TRACE THEN (3024)
            if (1 & (bitToFixed (getBIT (8, mTRACE))))
              // OUTPUT = '      NODE_PTR '||NODE_PTR|| ' OPR
              // '||HEX(OPR(PTR),8)||' NODE '||HEX(NODE(NODE_PTR),8)|| '
              // CSE_LIST '||CSE_LIST(I); (3025)
              {
                descriptor_t *stringRHS;
                stringRHS = xsCAT (
                    xsCAT (
                        xsCAT (
                            xsCAT (
                                xsCAT (
                                    xsCAT (
                                        xsCAT (
                                            cToDescriptor (NULL,
                                                           "      NODE_PTR "),
                                            bitToCharacter (getBIT (
                                                16,
                                                mRELOCATE_HALMATxNODE_PTR))),
                                        cToDescriptor (NULL, " OPR ")),
                                    (putFIXED (
                                         mHEXxHVAL,
                                         getFIXED (
                                             mOPR
                                             + 4
                                                   * COREHALFWORD (
                                                       mRELOCATE_HALMATxPTR))),
                                     putFIXED (mHEXxN, 8), HEX (0))),
                                cToDescriptor (NULL, " NODE ")),
                            (putFIXED (
                                 mHEXxHVAL,
                                 getFIXED (
                                     mNODE
                                     + 4
                                           * COREHALFWORD (
                                               mRELOCATE_HALMATxNODE_PTR))),
                             putFIXED (mHEXxN, 8), HEX (0))),
                        cToDescriptor (NULL, " CSE_LIST ")),
                    bitToCharacter (getBIT (
                        16, getFIXED (mCOMMONSE_LIST)
                                + 2 * (COREHALFWORD (mRELOCATE_HALMATxI)) + 0
                                + 2 * (0))));
                OUTPUT (0, stringRHS);
                stringRHS->inUse = 0;
              }
          es1s1:;
          } // End of DO block
        // ELSE (3026)
        else
          // CSE_LIST(I) = 0; (3027)
          {
            int32_t numberRHS = (int32_t)(0);
            putBIT (16,
                    getFIXED (mCOMMONSE_LIST)
                        + 2 * (COREHALFWORD (mRELOCATE_HALMATxI)) + 0
                        + 2 * (0),
                    fixedToBit (16, numberRHS));
          }
      }
  } // End of DO for-loop block
  // DO FOR I = 1 TO D_N_INX; (3028)
  {
    int32_t from70, to70, by70;
    from70 = 1;
    to70 = bitToFixed (getBIT (16, mD_N_INX));
    by70 = 1;
    for (putBIT (16, mRELOCATE_HALMATxI, fixedToBit (16, from70));
         bitToFixed (getBIT (16, mRELOCATE_HALMATxI)) <= to70;
         putBIT (16, mRELOCATE_HALMATxI,
                 fixedToBit (16, bitToFixed (getBIT (16, mRELOCATE_HALMATxI))
                                     + by70)))
      {
        // TEMP = SHR(NODE(DIFF_PTR(I)),16); (3029)
        {
          int32_t numberRHS = (int32_t)(SHR (
              getFIXED (mNODE
                        + 4
                              * COREHALFWORD (
                                  mDIFF_PTR
                                  + 2 * COREHALFWORD (mRELOCATE_HALMATxI))),
              16));
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (16, mRELOCATE_HALMATxTEMP, bitRHS);
          bitRHS->inUse = 0;
        }
        // IF SHR(OPR(TEMP),3) THEN (3030)
        if (1
            & (SHR (getFIXED (mOPR + 4 * COREHALFWORD (mRELOCATE_HALMATxTEMP)),
                    3)))
          // CALL DETAG(TEMP); (3031)
          {
            putBITp (16, mDETAGxPTR, getBIT (16, mRELOCATE_HALMATxTEMP));
            DETAG (0);
          }
      }
  } // End of DO for-loop block
  // DO FOR I = 1 TO CSE_L_INX; (3032)
  {
    int32_t from71, to71, by71;
    from71 = 1;
    to71 = bitToFixed (getBIT (16, mCSE_L_INX));
    by71 = 1;
    for (putBIT (16, mRELOCATE_HALMATxI, fixedToBit (16, from71));
         bitToFixed (getBIT (16, mRELOCATE_HALMATxI)) <= to71;
         putBIT (16, mRELOCATE_HALMATxI,
                 fixedToBit (16, bitToFixed (getBIT (16, mRELOCATE_HALMATxI))
                                     + by71)))
      {
        // NODE_PTR = CSE_LIST(I); (3033)
        {
          descriptor_t *bitRHS = getBIT (
              16, getFIXED (mCOMMONSE_LIST)
                      + 2 * (COREHALFWORD (mRELOCATE_HALMATxI)) + 0 + 2 * (0));
          putBIT (16, mRELOCATE_HALMATxNODE_PTR, bitRHS);
          bitRHS->inUse = 0;
        }
        // IF TRACE THEN (3034)
        if (1 & (bitToFixed (getBIT (8, mTRACE))))
          // OUTPUT = '   NODE_PTR = '||NODE_PTR; (3035)
          {
            descriptor_t *stringRHS;
            stringRHS = xsCAT (
                cToDescriptor (NULL, "   NODE_PTR = "),
                bitToCharacter (getBIT (16, mRELOCATE_HALMATxNODE_PTR)));
            OUTPUT (0, stringRHS);
            stringRHS->inUse = 0;
          }
        // IF NODE_PTR ~= 0 THEN (3036)
        if (1 & (xNEQ (COREHALFWORD (mRELOCATE_HALMATxNODE_PTR), 0)))
          // DO; (3037)
          {
          rs3s1:;
            // TEMP = SHR(NODE(NODE_PTR),16); (3038)
            {
              int32_t numberRHS = (int32_t)(SHR (
                  getFIXED (mNODE
                            + 4 * COREHALFWORD (mRELOCATE_HALMATxNODE_PTR)),
                  16));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mRELOCATE_HALMATxTEMP, bitRHS);
              bitRHS->inUse = 0;
            }
            // IF SHR(OPR(TEMP),3) THEN (3039)
            if (1
                & (SHR (
                    getFIXED (mOPR + 4 * COREHALFWORD (mRELOCATE_HALMATxTEMP)),
                    3)))
              // CALL DETAG(TEMP); (3040)
              {
                putBITp (16, mDETAGxPTR, getBIT (16, mRELOCATE_HALMATxTEMP));
                DETAG (0);
              }
            // PTR = NODE(NODE_PTR) &  65535; (3041)
            {
              int32_t numberRHS = (int32_t)(xAND (
                  getFIXED (mNODE
                            + 4 * COREHALFWORD (mRELOCATE_HALMATxNODE_PTR)),
                  65535));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mRELOCATE_HALMATxPTR, bitRHS);
              bitRHS->inUse = 0;
            }
            // IF ~OPR(PTR) THEN (3042)
            if (1
                & (xNOT (getFIXED (
                    mOPR + 4 * COREHALFWORD (mRELOCATE_HALMATxPTR)))))
              // IF ~TWIN_HALMATTED(PTR) THEN (3043)
              if (1
                  & (xNOT (
                      bitToFixed ((putBITp (16, mTWIN_HALMATTEDxPTR,
                                            getBIT (16, mRELOCATE_HALMATxPTR)),
                                   TWIN_HALMATTED (0))))))
                // IF NODE2(NODE_PTR) = -1 THEN (3044)
                if (1
                    & (xEQ (
                        COREHALFWORD (
                            mNODE2
                            + 2 * COREHALFWORD (mRELOCATE_HALMATxNODE_PTR)),
                        -1)))
                  // DO; (3045)
                  {
                  rs3s1s1:;
                    // IF OPOP(PTR) = TSUB & OPOP(LAST_OP(TEMP)) = EXTN THEN
                    // (3046)
                    if (1
                        & (xAND (
                            xEQ (bitToFixed (
                                     (putBITp (
                                          16, mOPOPxPTR,
                                          getBIT (16, mRELOCATE_HALMATxPTR)),
                                      OPOP (0))),
                                 COREHALFWORD (mTSUB)),
                            xEQ (
                                bitToFixed ((
                                    putBITp (
                                        16, mOPOPxPTR,
                                        fixedToBit (
                                            32,
                                            (int32_t)((
                                                putBITp (
                                                    16, mLAST_OPxPTR,
                                                    getBIT (
                                                        16,
                                                        mRELOCATE_HALMATxTEMP)),
                                                LAST_OP (0))))),
                                    OPOP (0))),
                                COREHALFWORD (mEXTN)))))
                      // DO; (3047)
                      {
                      rs3s1s1s1:;
                        // IF NODE2(NODE_PTR+1) = -1 THEN (3048)
                        if (1
                            & (xEQ (
                                COREHALFWORD (
                                    mNODE2
                                    + 2
                                          * xadd (
                                              COREHALFWORD (
                                                  mRELOCATE_HALMATxNODE_PTR),
                                              1)),
                                -1)))
                          // CALL DETAG(PTR); (3049)
                          {
                            putBITp (16, mDETAGxPTR,
                                     getBIT (16, mRELOCATE_HALMATxPTR));
                            DETAG (0);
                          }
                      es3s1s1s1:;
                      } // End of DO block
                    // ELSE (3050)
                    else
                      // CALL DETAG(PTR); (3051)
                      {
                        putBITp (16, mDETAGxPTR,
                                 getBIT (16, mRELOCATE_HALMATxPTR));
                        DETAG (0);
                      }
                  es3s1s1:;
                  } // End of DO block
          es3s1:;
          } // End of DO block
      }
  } // End of DO for-loop block
  // CSE_L_INX = 0; (3052)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mCSE_L_INX, bitRHS);
    bitRHS->inUse = 0;
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
