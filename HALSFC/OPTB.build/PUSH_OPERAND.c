/*
  File PUSH_OPERAND.c generated by XCOM-I, 2024-08-09 12:41:08.
*/

#include "runtimeC.h"

int32_t
PUSH_OPERAND (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "PUSH_OPERAND");
  // IF ~TERMINAL(ORIG,1) THEN (4324)
  if (1
      & (xNOT (bitToFixed (
          (putBITp (16, mTERMINALxPTR, getBIT (16, mPUSH_OPERANDxORIG)),
           putBITp (8, mTERMINALxTAG, fixedToBit (32, (int32_t)(1))),
           TERMINAL (0))))))
    // DO; (4325)
    {
    rs1:;
      // IF TRACE THEN (4326)
      if (1 & (bitToFixed (getBIT (8, mTRACE))))
        // OUTPUT = 'PUSH_OPERAND: '||ORIG||' GOES TO '||ORIG; (4327)
        {
          descriptor_t *stringRHS;
          stringRHS = xsCAT (
              xsCAT (xsCAT (cToDescriptor (NULL, "PUSH_OPERAND: "),
                            bitToCharacter (getBIT (16, mPUSH_OPERANDxORIG))),
                     cToDescriptor (NULL, " GOES TO ")),
              bitToCharacter (getBIT (16, mPUSH_OPERANDxORIG)));
          OUTPUT (0, stringRHS);
          stringRHS->inUse = 0;
        }
      // RETURN; (4328)
      {
        reentryGuard = 0;
        return 0;
      }
    es1:;
    } // End of DO block
  // PTR = ORIG + 1; (4329)
  {
    int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mPUSH_OPERANDxORIG), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mPUSH_OPERANDxPTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO WHILE PTR <= HALMAT_NODE_END; (4330)
  while (1
         & (xLE (COREHALFWORD (mPUSH_OPERANDxPTR),
                 COREHALFWORD (mHALMAT_NODE_END))))
    {
      // IF ~OPR(PTR) THEN (4331)
      if (1 & (xNOT (getFIXED (mOPR + 4 * COREHALFWORD (mPUSH_OPERANDxPTR)))))
        // PTR=NEXT_FLAG(PTR) + 1; (4332)
        {
          int32_t numberRHS = (int32_t)(xadd (
              (putBITp (16, mNEXT_FLAGxPTR, getBIT (16, mPUSH_OPERANDxPTR)),
               NEXT_FLAG (0)),
              1));
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (16, mPUSH_OPERANDxPTR, bitRHS);
          bitRHS->inUse = 0;
        }
      // IF ~TERMINAL(PTR,1) THEN (4333)
      if (1
          & (xNOT (bitToFixed (
              (putBITp (16, mTERMINALxPTR, getBIT (16, mPUSH_OPERANDxPTR)),
               putBITp (8, mTERMINALxTAG, fixedToBit (32, (int32_t)(1))),
               TERMINAL (0))))))
        // DO; (4334)
        {
        rs2s1:;
          // OPR(PTR) = OPR(ORIG); (4335)
          {
            int32_t numberRHS = (int32_t)(getFIXED (
                mOPR + 4 * COREHALFWORD (mPUSH_OPERANDxORIG)));
            putFIXED (mOPR + 4 * (COREHALFWORD (mPUSH_OPERANDxPTR)),
                      numberRHS);
          }
          // FLAG(PTR) = FLAG(ORIG); (4336)
          {
            descriptor_t *bitRHS
                = getBIT (8, mFLAG + 1 * COREHALFWORD (mPUSH_OPERANDxORIG));
            putBIT (8, mFLAG + 1 * (COREHALFWORD (mPUSH_OPERANDxPTR)), bitRHS);
            bitRHS->inUse = 0;
          }
          // IF HALMAT_FLAG(PTR) THEN (4337)
          if (1
              & (bitToFixed ((putBITp (16, mHALMAT_FLAGxPTR,
                                       getBIT (16, mPUSH_OPERANDxPTR)),
                              HALMAT_FLAG (0)))))
            // CALL ENTER(PTR); (4338)
            {
              putBITp (16, mENTERxPTR, getBIT (16, mPUSH_OPERANDxPTR));
              ENTER (0);
            }
          // IF TRACE THEN (4339)
          if (1 & (bitToFixed (getBIT (8, mTRACE))))
            // OUTPUT = 'PUSH_OPERAND: '||ORIG|| ' GOES TO '||PTR; (4340)
            {
              descriptor_t *stringRHS;
              stringRHS = xsCAT (
                  xsCAT (
                      xsCAT (cToDescriptor (NULL, "PUSH_OPERAND: "),
                             bitToCharacter (getBIT (16, mPUSH_OPERANDxORIG))),
                      cToDescriptor (NULL, " GOES TO ")),
                  bitToCharacter (getBIT (16, mPUSH_OPERANDxPTR)));
              OUTPUT (0, stringRHS);
              stringRHS->inUse = 0;
            }
          // RETURN; (4341)
          {
            reentryGuard = 0;
            return 0;
          }
        es2s1:;
        } // End of DO block
      // ELSE (4342)
      else
        // PTR = PTR + 1; (4343)
        {
          int32_t numberRHS
              = (int32_t)(xadd (COREHALFWORD (mPUSH_OPERANDxPTR), 1));
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (16, mPUSH_OPERANDxPTR, bitRHS);
          bitRHS->inUse = 0;
        }
    } // End of DO WHILE block
  // IF WATCH THEN (4344)
  if (1 & (bitToFixed (getBIT (8, mWATCH))))
    // OUTPUT = 'PUSH_OPERAND: '||ORIG|| 'FAILED'; (4345)
    {
      descriptor_t *stringRHS;
      stringRHS
          = xsCAT (xsCAT (cToDescriptor (NULL, "PUSH_OPERAND: "),
                          bitToCharacter (getBIT (16, mPUSH_OPERANDxORIG))),
                   cToDescriptor (NULL, "FAILED"));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  {
    reentryGuard = 0;
    return 0;
  }
}
