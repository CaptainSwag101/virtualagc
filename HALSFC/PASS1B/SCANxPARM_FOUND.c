/*
  File SCANxPARM_FOUND.c generated by XCOM-I, 2024-08-08 04:33:34.
*/

#include "runtimeC.h"

descriptor_t *
SCANxPARM_FOUND (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (descriptor_t *)0;
    }
  reentryGuard = guardReentry (reentryGuard, "SCANxPARM_FOUND");
  // TEMP_INDEX=MACRO_EXPAN_LEVEL; (6787)
  {
    descriptor_t *bitRHS = getBIT (16, mMACRO_EXPAN_LEVEL);
    putBIT (16, mTEMP_INDEX, bitRHS);
    bitRHS->inUse = 0;
  }
  // PARM_COUNT=NUM_OF_PARM(TEMP_INDEX); (6788)
  {
    descriptor_t *bitRHS
        = getBIT (16, mNUM_OF_PARM + 2 * COREHALFWORD (mTEMP_INDEX));
    putBIT (16, mPARM_COUNT, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO WHILE TEMP_INDEX>0; (6789)
  while (1 & (xGT (COREHALFWORD (mTEMP_INDEX), 0)))
    {
      // DO I=1 TO NUM_OF_PARM(TEMP_INDEX); (6790)
      {
        int32_t from106, to106, by106;
        from106 = 1;
        to106 = bitToFixed (
            getBIT (16, mNUM_OF_PARM + 2 * COREHALFWORD (mTEMP_INDEX)));
        by106 = 1;
        for (putFIXED (mI, from106); getFIXED (mI) <= to106;
             putFIXED (mI, getFIXED (mI) + by106))
          {
            // IF BCD=SYT_NAME(MACRO_EXPAN_STACK(TEMP_INDEX)+I) THEN (6791)
            if (1
                & (xsEQ (
                    getCHARACTER (mBCD),
                    getCHARACTER (
                        getFIXED (mSYM_TAB)
                        + 34
                              * (xadd (COREHALFWORD (
                                           mMACRO_EXPAN_STACK
                                           + 2 * COREHALFWORD (mTEMP_INDEX)),
                                       getFIXED (mI)))
                        + 0 + 4 * (0)))))
              // DO; (6792)
              {
              rs1s1s1:;
                // PARM_EXPAN_LEVEL = PARM_EXPAN_LEVEL + 1; (6793)
                {
                  int32_t numberRHS
                      = (int32_t)(xadd (COREHALFWORD (mPARM_EXPAN_LEVEL), 1));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mPARM_EXPAN_LEVEL, bitRHS);
                  bitRHS->inUse = 0;
                }
                // FIRST_TIME_PARM(PARM_EXPAN_LEVEL)=TRUE; (6794)
                {
                  int32_t numberRHS = (int32_t)(1);
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (1,
                          mFIRST_TIME_PARM
                              + 1 * (COREHALFWORD (mPARM_EXPAN_LEVEL)),
                          bitRHS);
                  bitRHS->inUse = 0;
                }
                // PARM_REPLACE_PTR(PARM_EXPAN_LEVEL) = 0; (6795)
                {
                  int32_t numberRHS = (int32_t)(0);
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16,
                          mPARM_REPLACE_PTR
                              + 2 * (COREHALFWORD (mPARM_EXPAN_LEVEL)),
                          bitRHS);
                  bitRHS->inUse = 0;
                }
                // PARM_STACK_PTR(PARM_EXPAN_LEVEL) = I +
                // TOP_OF_PARM_STACK-PARM_COUNT; (6796)
                {
                  int32_t numberRHS = (int32_t)(xsubtract (
                      xadd (getFIXED (mI), COREHALFWORD (mTOP_OF_PARM_STACK)),
                      COREHALFWORD (mPARM_COUNT)));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16,
                          mPARM_STACK_PTR
                              + 2 * (COREHALFWORD (mPARM_EXPAN_LEVEL)),
                          bitRHS);
                  bitRHS->inUse = 0;
                }
                // IF BASE_PARM_LEVEL(MACRO_EXPAN_LEVEL)+1 = PARM_EXPAN_LEVEL
                // THEN (6797)
                if (1
                    & (xEQ (xadd (COREHALFWORD (
                                      mBASE_PARM_LEVEL
                                      + 2 * COREHALFWORD (mMACRO_EXPAN_LEVEL)),
                                  1),
                            COREHALFWORD (mPARM_EXPAN_LEVEL))))
                  // DO; (6798)
                  {
                  rs1s1s1s1:;
                    // IF ~FOUND_CENT THEN (6799)
                    if (1 & (xNOT (BYTE0 (mFOUND_CENT))))
                      // DO; (6800)
                      {
                      rs1s1s1s1s1:;
                        // IF ~END_OF_MACRO THEN (6801)
                        if (1 & (xNOT (bitToFixed (SCANxEND_OF_MACRO (0)))))
                          // DO; (6802)
                          {
                          rs1s1s1s1s1s1:;
                            // IF MACRO_TEXT(MACRO_POINT-2)= 238 THEN (6803)
                            if (1
                                & (xEQ (
                                    BYTE0 (
                                        getFIXED (mMACRO_TEXTS)
                                        + 1
                                              * (xsubtract (
                                                  getFIXED (mMACRO_POINT), 2))
                                        + 0 + 1 * (0)),
                                    238)))
                              // MACRO_POINT=MACRO_POINT-1; (6804)
                              {
                                int32_t numberRHS = (int32_t)(xsubtract (
                                    getFIXED (mMACRO_POINT), 1));
                                putFIXED (mMACRO_POINT, numberRHS);
                              }
                            // MACRO_POINT=MACRO_POINT-1; (6805)
                            {
                              int32_t numberRHS = (int32_t)(xsubtract (
                                  getFIXED (mMACRO_POINT), 1));
                              putFIXED (mMACRO_POINT, numberRHS);
                            }
                          es1s1s1s1s1s1:;
                          } // End of DO block
                      es1s1s1s1s1:;
                      } // End of DO block
                  es1s1s1s1:;
                  } // End of DO block
                // ELSE (6806)
                else
                  // DO; (6807)
                  {
                  rs1s1s1s2:;
                    // IF FIRST_TIME_PARM(PARM_EXPAN_LEVEL-1) THEN (6808)
                    if (1
                        & (bitToFixed (getBIT (
                            1, mFIRST_TIME_PARM
                                   + 1
                                         * xsubtract (
                                             COREHALFWORD (mPARM_EXPAN_LEVEL),
                                             1)))))
                      // DO; (6809)
                      {
                      rs1s1s1s2s1:;
                        // IF NEXT_CHAR~=BYTE('`') THEN (6810)
                        if (1
                            & (xNEQ (BYTE0 (mNEXT_CHAR),
                                     BYTE1 (cToDescriptor (NULL, "`")))))
                          // PARM_REPLACE_PTR(PARM_EXPAN_LEVEL-1)=
                          // PARM_REPLACE_PTR(PARM_EXPAN_LEVEL-1)-1; (6811)
                          {
                            int32_t numberRHS = (int32_t)(xsubtract (
                                COREHALFWORD (
                                    mPARM_REPLACE_PTR
                                    + 2
                                          * xsubtract (
                                              COREHALFWORD (mPARM_EXPAN_LEVEL),
                                              1)),
                                1));
                            descriptor_t *bitRHS;
                            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                            putBIT (
                                16,
                                mPARM_REPLACE_PTR
                                    + 2
                                          * (xsubtract (
                                              COREHALFWORD (mPARM_EXPAN_LEVEL),
                                              1)),
                                bitRHS);
                            bitRHS->inUse = 0;
                          }
                      es1s1s1s2s1:;
                      } // End of DO block
                    // ELSE (6812)
                    else
                      // FIRST_TIME_PARM(PARM_EXPAN_LEVEL-1)=TRUE; (6813)
                      {
                        int32_t numberRHS = (int32_t)(1);
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (1,
                                mFIRST_TIME_PARM
                                    + 1
                                          * (xsubtract (
                                              COREHALFWORD (mPARM_EXPAN_LEVEL),
                                              1)),
                                bitRHS);
                        bitRHS->inUse = 0;
                      }
                  es1s1s1s2:;
                  } // End of DO block
                // BLANK_COUNT, OVER_PUNCH = 0; (6814)
                {
                  int32_t numberRHS = (int32_t)(0);
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mBLANK_COUNT, bitRHS);
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (8, mOVER_PUNCH, bitRHS);
                  bitRHS->inUse = 0;
                }
                // P_CENT(PARM_EXPAN_LEVEL)=FOUND_CENT; (6815)
                {
                  descriptor_t *bitRHS = getBIT (1, mFOUND_CENT);
                  putBIT (8, mP_CENT + 1 * (COREHALFWORD (mPARM_EXPAN_LEVEL)),
                          bitRHS);
                  bitRHS->inUse = 0;
                }
                // CALL STREAM; (6816)
                STREAM (0);
                // RETURN 1; (6817)
                {
                  reentryGuard = 0;
                  return fixedToBit (32, (int32_t)(1));
                }
              es1s1s1:;
              } // End of DO block
          }
      } // End of DO for-loop block
      // TEMP_INDEX=TEMP_INDEX-1; (6818)
      {
        int32_t numberRHS
            = (int32_t)(xsubtract (COREHALFWORD (mTEMP_INDEX), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mTEMP_INDEX, bitRHS);
        bitRHS->inUse = 0;
      }
      // PARM_COUNT=PARM_COUNT + NUM_OF_PARM(TEMP_INDEX); (6819)
      {
        int32_t numberRHS = (int32_t)(xadd (
            COREHALFWORD (mPARM_COUNT),
            COREHALFWORD (mNUM_OF_PARM + 2 * COREHALFWORD (mTEMP_INDEX))));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mPARM_COUNT, bitRHS);
        bitRHS->inUse = 0;
      }
    } // End of DO WHILE block
  // RETURN 0; (6820)
  {
    reentryGuard = 0;
    return fixedToBit (32, (int32_t)(0));
  }
}
