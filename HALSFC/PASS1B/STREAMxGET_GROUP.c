/*
  File STREAMxGET_GROUP.c generated by XCOM-I, 2024-08-09 12:40:41.
*/

#include "runtimeC.h"

int32_t
STREAMxGET_GROUP (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "STREAMxGET_GROUP");
  // E_LINE = BLANKS || BLANKS; (4535)
  {
    descriptor_t *stringRHS;
    stringRHS
        = xsCAT (getCHARACTER (mSTREAMxBLANKS), getCHARACTER (mSTREAMxBLANKS));
    putCHARACTER (mSTREAMxE_LINE, stringRHS);
    stringRHS->inUse = 0;
  }
  // S_LINE = BLANKS || BLANKS; (4536)
  {
    descriptor_t *stringRHS;
    stringRHS
        = xsCAT (getCHARACTER (mSTREAMxBLANKS), getCHARACTER (mSTREAMxBLANKS));
    putCHARACTER (mSTREAMxS_LINE, stringRHS);
    stringRHS->inUse = 0;
  }
  // LAST_E_COUNT = E_COUNT; (4537)
  {
    descriptor_t *bitRHS = getBIT (16, mSTREAMxE_COUNT);
    putBIT (16, mSTREAMxLAST_E_COUNT, bitRHS);
    bitRHS->inUse = 0;
  }
  // LAST_S_COUNT = S_COUNT; (4538)
  {
    descriptor_t *bitRHS = getBIT (16, mSTREAMxS_COUNT);
    putBIT (16, mSTREAMxLAST_S_COUNT, bitRHS);
    bitRHS->inUse = 0;
  }
  // E_COUNT, S_COUNT = 0; (4539)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mSTREAMxE_COUNT, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mSTREAMxS_COUNT, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF ~INCREMENT_DOWN_STMT THEN (4540)
  if (1 & (xNOT (BYTE0 (mINCREMENT_DOWN_STMT))))
    // INCREMENT_DOWN_STMT = (LAST_WRITE <= STMT_PTR); (4541)
    {
      int32_t numberRHS = (int32_t)(xLE (COREHALFWORD (mLAST_WRITE),
                                         COREHALFWORD (mSTMT_PTR)));
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (1, mINCREMENT_DOWN_STMT, bitRHS);
      bitRHS->inUse = 0;
    }
  // CALL OUTPUT_GROUP; (4542)
  OUTPUT_GROUP (0);
  // IF INCLUDE_END THEN (4543)
  if (1 & (bitToFixed (getBIT (1, mINCLUDE_END))))
    // DO; (4544)
    {
    rs1:;
      // CALL OUTPUT_WRITER(LAST_WRITE, STMT_PTR); (4545)
      {
        putBITp (16, mOUTPUT_WRITERxPTR_START, getBIT (16, mLAST_WRITE));
        putBITp (16, mOUTPUT_WRITERxPTR_END, getBIT (16, mSTMT_PTR));
        OUTPUT_WRITER (0);
      }
      // OUTPUT = X8 || STARS || 'END' || INCLUDE_MSG || STARS; (4546)
      {
        descriptor_t *stringRHS;
        stringRHS = xsCAT (
            xsCAT (xsCAT (xsCAT (getCHARACTER (mX8), getCHARACTER (mSTARS)),
                          cToDescriptor (NULL, "END")),
                   getCHARACTER (mINCLUDE_MSG)),
            getCHARACTER (mSTARS));
        OUTPUT (0, stringRHS);
        stringRHS->inUse = 0;
      }
      // NEXT_CC = DOUBLE; (4547)
      {
        descriptor_t *stringRHS;
        stringRHS = getCHARACTER (mDOUBLE);
        putCHARACTER (mNEXT_CC, stringRHS);
        stringRHS->inUse = 0;
      }
      // INCLUDE_LIST = TRUE; (4548)
      {
        int32_t numberRHS = (int32_t)(1);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (1, mINCLUDE_LIST, bitRHS);
        bitRHS->inUse = 0;
      }
      // SRN_COUNT=0; (4549)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mSRN_COUNT, bitRHS);
        bitRHS->inUse = 0;
      }
      // IF TPL_REMOTE THEN (4550)
      if (1 & (bitToFixed (getBIT (1, mTPL_REMOTE))))
        // DO; (4551)
        {
        rs1s1:;
          // CALL ERROR(CLASS_XI,5); (4552)
          {
            putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_XI));
            putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(5)));
            ERROR (0);
          }
          // TPL_REMOTE = FALSE; (4553)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (1, mTPL_REMOTE, bitRHS);
            bitRHS->inUse = 0;
          }
        es1s1:;
        } // End of DO block
      // INCLUDE_END = FALSE; (4554)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (1, mINCLUDE_END, bitRHS);
        bitRHS->inUse = 0;
      }
    es1:;
    } // End of DO block
  // GO TO LOOP; (4555)
  goto LOOP;
// READ: (4556)
READ:
  // CALL READ_CARD; (4557)
  STREAMxREAD_CARD (0);
// CHECK_ORDER: (4558)
CHECK_ORDER:
  // IF ~ ORDER_OK(PREV_CARD) THEN (4559)
  if (1
      & (xNOT (
          bitToFixed ((putFIXED (mORDER_OKxTYPE, getFIXED (mSTREAMxPREV_CARD)),
                       ORDER_OK (0))))))
    // DO; (4560)
    {
    rs2:;
      // CALL ERROR(CLASS_M,2); (4561)
      {
        putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_M));
        putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(2)));
        ERROR (0);
      }
      // GO TO COMMENT_CARD; (4562)
      goto COMMENT_CARD;
    es2:;
    } // End of DO block
// LOOP: (4563)
LOOP:
  // IF END_GROUP THEN (4564)
  if (1 & (bitToFixed (getBIT (1, mEND_GROUP))))
    // GO TO FOUND_GROUP; (4565)
    goto FOUND_GROUP;
  // DO CASE CARD_TYPE(BYTE(CURRENT_CARD)); (4566)
  {
  rs3:
    switch (
        COREHALFWORD (mCARD_TYPE + 2 * BYTE1 (getCHARACTER (mCURRENT_CARD))))
      {
      case 0:
          // ; (4568)
          ;
        break;
      case 1:
        // DO; (4569)
        {
        rs3s1:;
          // CALL COMP(0); (4569)
          {
            putFIXED (mSTREAMxCOMPxTYPE, 0);
            STREAMxCOMP (0);
          }
          // GO TO LOOP; (4570)
          goto LOOP;
        es3s1:;
        } // End of DO block
        break;
      case 2:
        // DO; (4572)
        {
        rs3s2:;
          // M_LINE = CURRENT_CARD; (4572)
          {
            descriptor_t *stringRHS;
            stringRHS = getCHARACTER (mCURRENT_CARD);
            putCHARACTER (mSTREAMxM_LINE, stringRHS);
            stringRHS->inUse = 0;
          }
          // IF SRN_PRESENT THEN (4573)
          if (1 & (bitToFixed (getBIT (1, mSRN_PRESENT))))
            // DO; (4574)
            {
            rs3s2s1:;
              // IF INCLUDING THEN (4575)
              if (1 & (bitToFixed (getBIT (1, mINCLUDING))))
                // DO; (4576)
                {
                rs3s2s1s1:;
                  // INCL_SRN = SUBSTR(CURRENT_CARD,TEXT_LIMIT+1); (4577)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = SUBSTR2 (getCHARACTER (mCURRENT_CARD),
                                         xadd (COREHALFWORD (mTEXT_LIMIT), 1));
                    putCHARACTER (mINCL_SRN, stringRHS);
                    stringRHS->inUse = 0;
                  }
                  // SRN_COUNT = SRN_COUNT + 1; (4578)
                  {
                    int32_t numberRHS
                        = (int32_t)(xadd (COREHALFWORD (mSRN_COUNT), 1));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mSRN_COUNT, bitRHS);
                    bitRHS->inUse = 0;
                  }
                es3s2s1s1:;
                } // End of DO block
              // ELSE (4579)
              else
                // DO; (4580)
                {
                rs3s2s1s2:;
                  // SRN=SUBSTR(CURRENT_CARD,TEXT_LIMIT+1); (4581)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = SUBSTR2 (getCHARACTER (mCURRENT_CARD),
                                         xadd (COREHALFWORD (mTEXT_LIMIT), 1));
                    putCHARACTER (mSRN, stringRHS);
                    stringRHS->inUse = 0;
                  }
                  // RVL(1) = SUBSTR(SRN,6,2); (4582)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = SUBSTR (getCHARACTER (mSRN), 6, 2);
                    putCHARACTER (mRVL + 4 * (1), stringRHS);
                    stringRHS->inUse = 0;
                  }
                es3s2s1s2:;
                } // End of DO block
            es3s2s1:;
            } // End of DO block
          // BYTE(SAVE_CARD) = BYTE('M'); (4583)
          {
            int32_t numberRHS = (int32_t)(BYTE1 (cToDescriptor (NULL, "M")));
            lBYTEb (ADDR (NULL, 0, "SAVE_CARD", 0), 0,
                    BYTE1 (cToDescriptor (NULL, "M")));
          }
          // PREV_CARD = BYTE(CURRENT_CARD); (4584)
          {
            int32_t numberRHS
                = (int32_t)(BYTE1 (getCHARACTER (mCURRENT_CARD)));
            putFIXED (mSTREAMxPREV_CARD, numberRHS);
          }
          // GO TO READ; (4585)
          goto READ;
        es3s2:;
        } // End of DO block
        break;
      case 3:
        // DO; (4587)
        {
        rs3s3:;
          // CALL COMP(1); (4587)
          {
            putFIXED (mSTREAMxCOMPxTYPE, 1);
            STREAMxCOMP (0);
          }
          // GO TO LOOP; (4588)
          goto LOOP;
        es3s3:;
        } // End of DO block
        break;
      case 4:
        // DO; (4590)
        {
        rs3s4:;
          // BYTE(CURRENT_CARD) = BYTE('C'); (4590)
          {
            int32_t numberRHS = (int32_t)(BYTE1 (cToDescriptor (NULL, "C")));
            lBYTEb (ADDR (NULL, 0, "CURRENT_CARD", 0), 0,
                    BYTE1 (cToDescriptor (NULL, "C")));
          }
        // COMMENT_CARD: (4591)
        COMMENT_CARD:
          // IF PREV_CARD = BYTE('C') THEN (4592)
          if (1
              & (xEQ (getFIXED (mSTREAMxPREV_CARD),
                      BYTE1 (cToDescriptor (NULL, "C")))))
            // COMMENTING = TRUE; (4593)
            {
              int32_t numberRHS = (int32_t)(1);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (1, mCOMMENTING, bitRHS);
              bitRHS->inUse = 0;
            }
          // ELSE (4594)
          else
            // COMMENTING = FALSE; (4595)
            {
              int32_t numberRHS = (int32_t)(0);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (1, mCOMMENTING, bitRHS);
              bitRHS->inUse = 0;
            }
          // PREV_CARD = BYTE('C'); (4596)
          {
            int32_t numberRHS = (int32_t)(BYTE1 (cToDescriptor (NULL, "C")));
            putFIXED (mSTREAMxPREV_CARD, numberRHS);
          }
          // IF SRN_PRESENT THEN (4597)
          if (1 & (bitToFixed (getBIT (1, mSRN_PRESENT))))
            // DO; (4598)
            {
            rs3s4s1:;
              // IF ~INCLUDING THEN (4599)
              if (1 & (xNOT (BYTE0 (mINCLUDING))))
                // DO; (4600)
                {
                rs3s4s1s1:;
                  // SRN=SUBSTR(CURRENT_CARD,TEXT_LIMIT+1); (4601)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = SUBSTR2 (getCHARACTER (mCURRENT_CARD),
                                         xadd (COREHALFWORD (mTEXT_LIMIT), 1));
                    putCHARACTER (mSRN, stringRHS);
                    stringRHS->inUse = 0;
                  }
                  // RVL = ''; (4602)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = cToDescriptor (NULL, "");
                    putCHARACTER (mRVL, stringRHS);
                    stringRHS->inUse = 0;
                  }
                  // RVL(1) = ''; (4603)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = cToDescriptor (NULL, "");
                    putCHARACTER (mRVL + 4 * (1), stringRHS);
                    stringRHS->inUse = 0;
                  }
                  // NEXT_CHAR_RVL = ''; (4604)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = cToDescriptor (NULL, "");
                    putCHARACTER (mNEXT_CHAR_RVL, stringRHS);
                    stringRHS->inUse = 0;
                  }
                es3s4s1s1:;
                } // End of DO block
            es3s4s1:;
            } // End of DO block
          // CALL PROCESS_COMMENT; (4605)
          STREAMxPROCESS_COMMENT (0);
          // CALL READ_CARD; (4606)
          STREAMxREAD_CARD (0);
          // IF INCLUDE_END THEN (4607)
          if (1 & (bitToFixed (getBIT (1, mINCLUDE_END))))
            // DO; (4608)
            {
            rs3s4s2:;
              // OUTPUT = X8 || STARS || 'END' || INCLUDE_MSG || STARS; (4609)
              {
                descriptor_t *stringRHS;
                stringRHS = xsCAT (xsCAT (xsCAT (xsCAT (getCHARACTER (mX8),
                                                        getCHARACTER (mSTARS)),
                                                 cToDescriptor (NULL, "END")),
                                          getCHARACTER (mINCLUDE_MSG)),
                                   getCHARACTER (mSTARS));
                OUTPUT (0, stringRHS);
                stringRHS->inUse = 0;
              }
              // NEXT_CC = DOUBLE; (4610)
              {
                descriptor_t *stringRHS;
                stringRHS = getCHARACTER (mDOUBLE);
                putCHARACTER (mNEXT_CC, stringRHS);
                stringRHS->inUse = 0;
              }
              // INCLUDE_LIST = TRUE; (4611)
              {
                int32_t numberRHS = (int32_t)(1);
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (1, mINCLUDE_LIST, bitRHS);
                bitRHS->inUse = 0;
              }
              // SRN_COUNT=0; (4612)
              {
                int32_t numberRHS = (int32_t)(0);
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mSRN_COUNT, bitRHS);
                bitRHS->inUse = 0;
              }
              // IF TPL_REMOTE THEN (4613)
              if (1 & (bitToFixed (getBIT (1, mTPL_REMOTE))))
                // DO; (4614)
                {
                rs3s4s2s1:;
                  // CALL ERROR(CLASS_XI,5); (4615)
                  {
                    putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_XI));
                    putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(5)));
                    ERROR (0);
                  }
                  // TPL_REMOTE = FALSE; (4616)
                  {
                    int32_t numberRHS = (int32_t)(0);
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (1, mTPL_REMOTE, bitRHS);
                    bitRHS->inUse = 0;
                  }
                es3s4s2s1:;
                } // End of DO block
              // INCLUDE_END = FALSE; (4617)
              {
                int32_t numberRHS = (int32_t)(0);
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (1, mINCLUDE_END, bitRHS);
                bitRHS->inUse = 0;
              }
            es3s4s2:;
            } // End of DO block
          // GO TO CHECK_ORDER; (4618)
          goto CHECK_ORDER;
        es3s4:;
        } // End of DO block
        break;
      case 5:
        // DO; (4620)
        {
        rs3s5:;
          // BYTE(CURRENT_CARD) = BYTE('D'); (4620)
          {
            int32_t numberRHS = (int32_t)(BYTE1 (cToDescriptor (NULL, "D")));
            lBYTEb (ADDR (NULL, 0, "CURRENT_CARD", 0), 0,
                    BYTE1 (cToDescriptor (NULL, "D")));
          }
          // GO TO COMMENT_CARD; (4621)
          goto COMMENT_CARD;
        es3s5:;
        } // End of DO block
        break;
      }
  } // End of DO CASE block
// FOUND_GROUP: (4622)
FOUND_GROUP:
  // END_GROUP = FALSE; (4623)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (1, mEND_GROUP, bitRHS);
    bitRHS->inUse = 0;
  }
  // E_LINE = SUBSTR(E_LINE, 0, LENGTH(M_LINE)); (4624)
  {
    descriptor_t *stringRHS;
    stringRHS = SUBSTR (getCHARACTER (mSTREAMxE_LINE), 0,
                        LENGTH (getCHARACTER (mSTREAMxM_LINE)));
    putCHARACTER (mSTREAMxE_LINE, stringRHS);
    stringRHS->inUse = 0;
  }
  // IF E_COUNT ~> 0 THEN (4625)
  if (1 & (xLE (COREHALFWORD (mSTREAMxE_COUNT), 0)))
    // DO; (4626)
    {
    rs4:;
      // DO CP = 1 TO TEXT_LIMIT; (4627)
      {
        int32_t from80, to80, by80;
        from80 = 1;
        to80 = bitToFixed (getBIT (16, mTEXT_LIMIT));
        by80 = 1;
        for (putBIT (16, mSTREAMxCP, fixedToBit (16, from80));
             bitToFixed (getBIT (16, mSTREAMxCP)) <= to80; putBIT (
                 16, mSTREAMxCP,
                 fixedToBit (16, bitToFixed (getBIT (16, mSTREAMxCP)) + by80)))
          {
            // E_INDICATOR(CP) = 0; (4628)
            {
              int32_t numberRHS = (int32_t)(0);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16,
                      mSTREAMxE_INDICATOR + 2 * (COREHALFWORD (mSTREAMxCP)),
                      bitRHS);
              bitRHS->inUse = 0;
            }
          }
      } // End of DO for-loop block
      // E_COUNT = LAST_E_COUNT; (4629)
      {
        descriptor_t *bitRHS = getBIT (16, mSTREAMxLAST_E_COUNT);
        putBIT (16, mSTREAMxE_COUNT, bitRHS);
        bitRHS->inUse = 0;
      }
    es4:;
    } // End of DO block
  // S_LINE = SUBSTR(S_LINE, 0, LENGTH(M_LINE)); (4630)
  {
    descriptor_t *stringRHS;
    stringRHS = SUBSTR (getCHARACTER (mSTREAMxS_LINE), 0,
                        LENGTH (getCHARACTER (mSTREAMxM_LINE)));
    putCHARACTER (mSTREAMxS_LINE, stringRHS);
    stringRHS->inUse = 0;
  }
  // IF S_COUNT ~> 0 THEN (4631)
  if (1 & (xLE (COREHALFWORD (mSTREAMxS_COUNT), 0)))
    // DO; (4632)
    {
    rs5:;
      // DO CP = 1 TO TEXT_LIMIT; (4633)
      {
        int32_t from81, to81, by81;
        from81 = 1;
        to81 = bitToFixed (getBIT (16, mTEXT_LIMIT));
        by81 = 1;
        for (putBIT (16, mSTREAMxCP, fixedToBit (16, from81));
             bitToFixed (getBIT (16, mSTREAMxCP)) <= to81; putBIT (
                 16, mSTREAMxCP,
                 fixedToBit (16, bitToFixed (getBIT (16, mSTREAMxCP)) + by81)))
          {
            // S_INDICATOR(CP) = 0; (4634)
            {
              int32_t numberRHS = (int32_t)(0);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16,
                      mSTREAMxS_INDICATOR + 2 * (COREHALFWORD (mSTREAMxCP)),
                      bitRHS);
              bitRHS->inUse = 0;
            }
          }
      } // End of DO for-loop block
      // S_COUNT = LAST_S_COUNT; (4635)
      {
        descriptor_t *bitRHS = getBIT (16, mSTREAMxLAST_S_COUNT);
        putBIT (16, mSTREAMxS_COUNT, bitRHS);
        bitRHS->inUse = 0;
      }
    es5:;
    } // End of DO block
  {
    reentryGuard = 0;
    return 0;
  }
}
