/*
  File SET_LABEL_TYPE.c generated by XCOM-I, 2024-08-08 04:33:34.
*/

#include "runtimeC.h"

int32_t
SET_LABEL_TYPE (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "SET_LABEL_TYPE");
  // OLDTYPE = SYT_TYPE(LOC); (9843)
  {
    descriptor_t *bitRHS = getBIT (
        8, getFIXED (mSYM_TAB) + 34 * (getFIXED (mSET_LABEL_TYPExLOC)) + 32
               + 1 * (0));
    int32_t numberRHS;
    numberRHS = bitToFixed (bitRHS);
    putFIXED (mSET_LABEL_TYPExOLDTYPE, numberRHS);
    bitRHS->inUse = 0;
  }
  // IF NEWTYPE < UNSPEC_LABEL THEN (9844)
  if (1 & (xLT (getFIXED (mSET_LABEL_TYPExNEWTYPE), 67)))
    // DO; (9845)
    {
    rs1:;
      // IF OLDTYPE > UNSPEC_LABEL THEN (9846)
      if (1 & (xGT (getFIXED (mSET_LABEL_TYPExOLDTYPE), 67)))
      // LABEL_TYPE_CONFLICT: (9847)
      LABEL_TYPE_CONFLICT:
      // CALL ERROR(CLASS_DT,3,SYT_NAME(LOC)); (9848)
      {
        putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_DT));
        putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(3)));
        putCHARACTERp (mERRORxTEXT,
                       getCHARACTER (getFIXED (mSYM_TAB)
                                     + 34 * (getFIXED (mSET_LABEL_TYPExLOC))
                                     + 0 + 4 * (0)));
        ERROR (0);
      }
      // IF EXTERNAL_MODE ~= 0 THEN (9849)
      if (1 & (xNEQ (BYTE0 (mEXTERNAL_MODE), 0)))
        // SYT_TYPE(LOC) = 0; (9850)
        {
          int32_t numberRHS = (int32_t)(0);
          putBIT (8,
                  getFIXED (mSYM_TAB) + 34 * (getFIXED (mSET_LABEL_TYPExLOC))
                      + 32 + 1 * (0),
                  fixedToBit (8, numberRHS));
        }
      // ELSE (9851)
      else
        // SYT_TYPE(LOC) = NEWTYPE; (9852)
        {
          int32_t numberRHS = (int32_t)(getFIXED (mSET_LABEL_TYPExNEWTYPE));
          putBIT (8,
                  getFIXED (mSYM_TAB) + 34 * (getFIXED (mSET_LABEL_TYPExLOC))
                      + 32 + 1 * (0),
                  fixedToBit (8, numberRHS));
        }
    es1:;
    } // End of DO block
  // ELSE (9853)
  else
    // DO; (9854)
    {
    rs2:;
      // IF OLDTYPE < UNSPEC_LABEL THEN (9855)
      if (1 & (xLT (getFIXED (mSET_LABEL_TYPExOLDTYPE), 67)))
        // GO TO LABEL_TYPE_CONFLICT; (9856)
        goto LABEL_TYPE_CONFLICT;
      // IF (OLDTYPE >= PROC_LABEL) & (OLDTYPE <= COMPOOL_LABEL) THEN (9857)
      if (1
          & (xAND (xGE (getFIXED (mSET_LABEL_TYPExOLDTYPE), 71),
                   xLE (getFIXED (mSET_LABEL_TYPExOLDTYPE), 74))))
        // IF OLDTYPE ~= NEWTYPE THEN (9858)
        if (1
            & (xNEQ (getFIXED (mSET_LABEL_TYPExOLDTYPE),
                     getFIXED (mSET_LABEL_TYPExNEWTYPE))))
          // CALL ERROR(CLASS_DT, 3, SYT_NAME(LOC)); (9859)
          {
            putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_DT));
            putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(3)));
            putCHARACTERp (
                mERRORxTEXT,
                getCHARACTER (getFIXED (mSYM_TAB)
                              + 34 * (getFIXED (mSET_LABEL_TYPExLOC)) + 0
                              + 4 * (0)));
            ERROR (0);
          }
      // IF OLDTYPE = IND_CALL_LAB THEN (9860)
      if (1 & (xEQ (getFIXED (mSET_LABEL_TYPExOLDTYPE), 69)))
        // DO; (9861)
        {
        rs2s1:;
          // J = LOC; (9862)
          {
            int32_t numberRHS = (int32_t)(getFIXED (mSET_LABEL_TYPExLOC));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSET_LABEL_TYPExJ, bitRHS);
            bitRHS->inUse = 0;
          }
          // I = SYT_PTR(LOC); (9863)
          {
            descriptor_t *bitRHS = getBIT (
                16, getFIXED (mSYM_TAB) + 34 * (getFIXED (mSET_LABEL_TYPExLOC))
                        + 22 + 2 * (0));
            putBIT (16, mSET_LABEL_TYPExI, bitRHS);
            bitRHS->inUse = 0;
          }
          // DO WHILE SYT_NEST(I) >= NEST; (9864)
          while (1
                 & (xGE (BYTE0 (getFIXED (mSYM_TAB)
                                + 34 * (COREHALFWORD (mSET_LABEL_TYPExI)) + 28
                                + 1 * (0)),
                         getFIXED (mNEST))))
            {
              // J = I; (9865)
              {
                descriptor_t *bitRHS = getBIT (16, mSET_LABEL_TYPExI);
                putBIT (16, mSET_LABEL_TYPExJ, bitRHS);
                bitRHS->inUse = 0;
              }
              // IF SYT_TYPE(I) = IND_CALL_LAB THEN (9866)
              if (1
                  & (xEQ (BYTE0 (getFIXED (mSYM_TAB)
                                 + 34 * (COREHALFWORD (mSET_LABEL_TYPExI)) + 32
                                 + 1 * (0)),
                          69)))
                // I = SYT_PTR(I); (9867)
                {
                  descriptor_t *bitRHS = getBIT (
                      16, getFIXED (mSYM_TAB)
                              + 34 * (COREHALFWORD (mSET_LABEL_TYPExI)) + 22
                              + 2 * (0));
                  putBIT (16, mSET_LABEL_TYPExI, bitRHS);
                  bitRHS->inUse = 0;
                }
              // ELSE (9868)
              else
                // IF SYT_TYPE(I) = PROC_LABEL THEN (9869)
                if (1
                    & (xEQ (BYTE0 (getFIXED (mSYM_TAB)
                                   + 34 * (COREHALFWORD (mSET_LABEL_TYPExI))
                                   + 32 + 1 * (0)),
                            71)))
                  // DO; (9870)
                  {
                  rs2s1s1s1:;
                    // SYT_TYPE(I) = IND_CALL_LAB; (9871)
                    {
                      int32_t numberRHS = (int32_t)(69);
                      putBIT (8,
                              getFIXED (mSYM_TAB)
                                  + 34 * (COREHALFWORD (mSET_LABEL_TYPExI))
                                  + 32 + 1 * (0),
                              fixedToBit (8, numberRHS));
                    }
                    // GO TO LINKUP; (9872)
                    goto LINKUP;
                  es2s1s1s1:;
                  } // End of DO block
            }       // End of DO WHILE block
        // LINKUP: (9873)
        LINKUP:
          // SYT_PTR(J) = LOC; (9874)
          {
            int32_t numberRHS = (int32_t)(getFIXED (mSET_LABEL_TYPExLOC));
            putBIT (16,
                    getFIXED (mSYM_TAB)
                        + 34 * (COREHALFWORD (mSET_LABEL_TYPExJ)) + 22
                        + 2 * (0),
                    fixedToBit (16, numberRHS));
          }
          // IF SYT_LINK1(J)>0 THEN (9875)
          if (1
              & (xGT (COREHALFWORD (getFIXED (mSYM_TAB)
                                    + 34 * (COREHALFWORD (mSET_LABEL_TYPExJ))
                                    + 24 + 2 * (0)),
                      0)))
            // IF DO_LEVEL>0 THEN (9876)
            if (1 & (xGT (COREHALFWORD (mDO_LEVEL), 0)))
              // IF DO_STMT#(DO_LEVEL) > SYT_LINK1(J) THEN (9877)
              if (1
                  & (xGT (
                      COREHALFWORD (mDO_STMTp + 2 * COREHALFWORD (mDO_LEVEL)),
                      COREHALFWORD (getFIXED (mSYM_TAB)
                                    + 34 * (COREHALFWORD (mSET_LABEL_TYPExJ))
                                    + 24 + 2 * (0)))))
                // CALL ERROR(CLASS_PL, 10); (9878)
                {
                  putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_PL));
                  putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(10)));
                  ERROR (0);
                }
          // IF SYT_LINK1(LOC) >= 0 THEN (9879)
          if (1
              & (xGE (COREHALFWORD (getFIXED (mSYM_TAB)
                                    + 34 * (getFIXED (mSET_LABEL_TYPExLOC))
                                    + 24 + 2 * (0)),
                      0)))
            // DO; (9880)
            {
            rs2s1s2:;
              // SYT_LINK1(LOC) = -DO_LEVEL; (9881)
              {
                int32_t numberRHS
                    = (int32_t)(xminus (COREHALFWORD (mDO_LEVEL)));
                putBIT (16,
                        getFIXED (mSYM_TAB)
                            + 34 * (getFIXED (mSET_LABEL_TYPExLOC)) + 24
                            + 2 * (0),
                        fixedToBit (16, numberRHS));
              }
              // SYT_LINK2(LOC) = SYT_LINK2(0); (9882)
              {
                descriptor_t *bitRHS = getBIT (
                    16, getFIXED (mSYM_TAB) + 34 * (0) + 26 + 2 * (0));
                putBIT (16,
                        getFIXED (mSYM_TAB)
                            + 34 * (getFIXED (mSET_LABEL_TYPExLOC)) + 26
                            + 2 * (0),
                        bitRHS);
                bitRHS->inUse = 0;
              }
              // SYT_LINK2(0) = LOC; (9883)
              {
                int32_t numberRHS = (int32_t)(getFIXED (mSET_LABEL_TYPExLOC));
                putBIT (16, getFIXED (mSYM_TAB) + 34 * (0) + 26 + 2 * (0),
                        fixedToBit (16, numberRHS));
              }
            es2s1s2:;
            } // End of DO block
        es2s1:;
        } // End of DO block
      // SYT_TYPE(LOC) = NEWTYPE; (9884)
      {
        int32_t numberRHS = (int32_t)(getFIXED (mSET_LABEL_TYPExNEWTYPE));
        putBIT (8,
                getFIXED (mSYM_TAB) + 34 * (getFIXED (mSET_LABEL_TYPExLOC))
                    + 32 + 1 * (0),
                fixedToBit (8, numberRHS));
      }
    es2:;
    } // End of DO block
  {
    reentryGuard = 0;
    return 0;
  }
}
