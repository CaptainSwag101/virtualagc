/*
  File STREAMxINCLUDE_SDFxENTER_COMPOOL_VARS.c generated by XCOM-I, 2024-08-09
  12:40:41.
*/

#include "runtimeC.h"

int32_t
STREAMxINCLUDE_SDFxENTER_COMPOOL_VARS (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard
      = guardReentry (reentryGuard, "STREAMxINCLUDE_SDFxENTER_COMPOOL_VARS");
  // IF CONTROL( 3) THEN (3910)
  if (1 & (bitToFixed (getBIT (1, mCONTROL + 1 * 3))))
    // OUTPUT = 'ENTER_COMPOOL_VARS: ENTERED'; (3911)
    {
      descriptor_t *stringRHS;
      stringRHS = cToDescriptor (NULL, "ENTER_COMPOOL_VARS: ENTERED");
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // ACCESS_COMPOOL = ((SYT_FLAGS(BLOCK_SYTREF(NEST)) & ACCESS_FLAG) ~= 0);
  // (3912)
  {
    int32_t numberRHS = (int32_t)(xNEQ (
        xAND (getFIXED (
                  getFIXED (mSYM_TAB)
                  + 34 * (COREHALFWORD (mBLOCK_SYTREF + 2 * getFIXED (mNEST)))
                  + 8 + 4 * (0)),
              65536),
        0));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (1, mSTREAMxINCLUDE_SDFxACCESS_COMPOOL, bitRHS);
    bitRHS->inUse = 0;
  }
  // PROCMARK = 1; (3913)
  {
    int32_t numberRHS = (int32_t)(1);
    putFIXED (mPROCMARK, numberRHS);
  }
  // TEMP=RECORD_ALLOC(SYM_TAB)-RECORD_USED(SYM_TAB); (3914)
  {
    int32_t numberRHS = (int32_t)(xsubtract (
        COREWORD (xadd (ADDR ("SYM_TAB", 0x80000000, NULL, 0), 8)),
        COREWORD (xadd (ADDR ("SYM_TAB", 0x80000000, NULL, 0), 12))));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mSTREAMxINCLUDE_SDFxENTER_COMPOOL_VARSxTEMP, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF TEMP <= #BLK_SYMBS THEN (3915)
  if (1
      & (xLE (BYTE0 (mSTREAMxINCLUDE_SDFxENTER_COMPOOL_VARSxTEMP),
              COREHALFWORD (mSTREAMxINCLUDE_SDFxpBLK_SYMBS))))
    // DO; (3916)
    {
    rs1:;
      // TEMP = RECORD_USED(SYM_TAB) + #BLK_SYMBS; (3917)
      {
        int32_t numberRHS = (int32_t)(xadd (
            COREWORD (xadd (ADDR ("SYM_TAB", 0x80000000, NULL, 0), 12)),
            COREHALFWORD (mSTREAMxINCLUDE_SDFxpBLK_SYMBS)));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (8, mSTREAMxINCLUDE_SDFxENTER_COMPOOL_VARSxTEMP, bitRHS);
        bitRHS->inUse = 0;
      }
      // DO WHILE RECORD_ALLOC(SYM_TAB)<=TEMP; (3918)
      while (
          1
          & (xLE (COREWORD (xadd (ADDR ("SYM_TAB", 0x80000000, NULL, 0), 8)),
                  BYTE0 (mSTREAMxINCLUDE_SDFxENTER_COMPOOL_VARSxTEMP))))
        {
          // NEEDMORE_SPACE(SYM_TAB); (3919)
          {
            putFIXED (m_NEEDMORE_SPACExDOPE,
                      ADDR ("SYM_TAB", 0x80000000, NULL, 0));
            _NEEDMORE_SPACE (0);
          }
        } // End of DO WHILE block
    es1:;
    } // End of DO block
  // SDFPKG_NPAGES=(FREELIMIT-FREESTRING_MIN-FREEPOINT-32*#BLK_SYMBS)/1680;
  // (3920)
  {
    int32_t numberRHS = (int32_t)(xdivide (
        xsubtract (
            xsubtract (xsubtract (FREELIMIT (), getFIXED (mFREESTRING_MIN)),
                       FREEPOINT ()),
            xmultiply (32, COREHALFWORD (mSTREAMxINCLUDE_SDFxpBLK_SYMBS))),
        1680));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_HALFWORD) + 2 * (4),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // SDFPKG_NPAGES = MIN(SDFPKG_NPAGES, #SDF_PAGES - 3); (3921)
  {
    int32_t numberRHS = (int32_t)((
        putFIXED (mMINxI, COREHALFWORD (
                              getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_HALFWORD)
                              + 2 * 4)),
        putFIXED (
            mMINxJ,
            xsubtract (COREHALFWORD (mSTREAMxINCLUDE_SDFxpSDF_PAGES), 3)),
        MIN (0)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_HALFWORD) + 2 * (4),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // SDFPKG_NPAGES = MIN(SDFPKG_NPAGES, SDFPKG_PAGES_LEFT); (3922)
  {
    int32_t numberRHS = (int32_t)((
        putFIXED (mMINxI, COREHALFWORD (
                              getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_HALFWORD)
                              + 2 * 4)),
        putFIXED (mMINxJ,
                  COREHALFWORD (mSTREAMxINCLUDE_SDFxSDFPKG_PAGES_LEFT)),
        MIN (0)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_HALFWORD) + 2 * (4),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // IF SDFPKG_NPAGES > 0 THEN (3923)
  if (1
      & (xGT (COREHALFWORD (getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_HALFWORD)
                            + 2 * 4),
              0)))
    // DO; (3924)
    {
    rs2:;
      // RECORD_CONSTANT(PGING,SDFPKG_NPAGES,UNMOVEABLE); (3925)
      {
        putFIXED (m_RECORD_CONSTANTxDOPE,
                  ADDR ("STREAMxINCLUDE_SDFxPGING", 0x80000000, NULL, 0));
        putFIXED (
            m_RECORD_CONSTANTxHIREC,
            COREHALFWORD (getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_HALFWORD)
                          + 2 * 4));
        putBITp (1, m_RECORD_CONSTANTxMOVEABLE, fixedToBit (32, (int32_t)(0)));
        _RECORD_CONSTANT (0);
      }
      // SDFPKG_APGAREA=ADDR(PGING(0).PAGEADDR(0)); (3926)
      {
        int32_t numberRHS
            = (int32_t)(ADDR ("STREAMxINCLUDE_SDFxPGING", 0, "PAGEADDR", 0));
        putFIXED (getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD) + 4 * (0),
                  numberRHS);
      }
      // SDFPKG_AFCBAREA, SDFPKG_NBYTES = 0; (3927)
      {
        int32_t numberRHS = (int32_t)(0);
        putFIXED (getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD) + 4 * (1),
                  numberRHS);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_HALFWORD) + 2 * (5),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // CALL_SDFPKG(2); (3928)
      MONITOR22 (2);
    es2:;
    } // End of DO block
  // DO WHILE NEXT_SYMBOL ~= 0; (3929)
  while (1 & (xNEQ (COREHALFWORD (mSTREAMxINCLUDE_SDFxNEXT_SYMBOL), 0)))
    {
      // DO ; (3930)
      {
      rs3s1:;
        // COMMTABL_HALFWORD ( 9 ) = NEXT_SYMBOL ; (3931)
        {
          descriptor_t *bitRHS = getBIT (16, mSTREAMxINCLUDE_SDFxNEXT_SYMBOL);
          putBIT (16,
                  getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_HALFWORD) + 2 * (9),
                  bitRHS);
          bitRHS->inUse = 0;
        }
        // CALL MONITOR ( 22 , 9 ) ; (3932)
        MONITOR22 (9);
        // COREWORD ( ADDR ( SDF_B ) ) , COREWORD ( ADDR ( SDF_H ) ) , COREWORD
        // ( ADDR ( SDF_F ) ) = COMMTABL_FULLWORD(7) ; (3933)
        {
          int32_t numberRHS = (int32_t)(getFIXED (
              getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD) + 4 * 7));
          COREWORD2 (ADDR ("STREAMxINCLUDE_SDFxSDF_B", 0x80000000, NULL, 0),
                     numberRHS);
          COREWORD2 (ADDR ("STREAMxINCLUDE_SDFxSDF_H", 0x80000000, NULL, 0),
                     numberRHS);
          COREWORD2 (ADDR ("STREAMxINCLUDE_SDFxSDF_F", 0x80000000, NULL, 0),
                     numberRHS);
        }
        // ; (3934)
        ;
      es3s1:;
      } // End of DO block
      // ; (3935)
      ;
      // NEXT_SYMBOL = SDF_SYMB_DECLARE_LINK; (3936)
      {
        descriptor_t *bitRHS
            = getBIT (16, getFIXED (mSTREAMxINCLUDE_SDFxSDF_H) + 2 * -5);
        putBIT (16, mSTREAMxINCLUDE_SDFxNEXT_SYMBOL, bitRHS);
        bitRHS->inUse = 0;
      }
      // IF SDF_SYMB_CLASS = SDF_VAR_CLASS THEN (3937)
      if (1 & (xEQ (BYTE0 (getFIXED (mSTREAMxINCLUDE_SDFxSDF_B) + 1 * 6), 1)))
        // IF (SDF_SYMB_FLAGS & SDF_LIT_FLAG) = 0 THEN (3938)
        if (1
            & (xEQ (
                xAND (getFIXED (getFIXED (mSTREAMxINCLUDE_SDFxSDF_F) + 4 * 2),
                      4096),
                0)))
          // CSECT_LENGTH((SDF_SYMB_FLAGS&SDF_REMOTE_FLAG)~=0) =
          // MAX(CSECT_LENGTH((SDF_SYMB_FLAGS&SDF_REMOTE_FLAG)~=0),
          // (SDF_SYMB_ADDR+SDF_SYMB_EXTENT)); (3939)
          {
            int32_t numberRHS = (int32_t)((
                putFIXED (
                    mMAXxI,
                    COREHALFWORD (
                        mSTREAMxINCLUDE_SDFxCSECT_LENGTH
                        + 2
                              * xNEQ (xAND (getFIXED (
                                                getFIXED (
                                                    mSTREAMxINCLUDE_SDFxSDF_F)
                                                + 4 * 2),
                                            65536),
                                      0))),
                putFIXED (
                    mMAXxJ,
                    xadd (xAND (getFIXED (getFIXED (mSTREAMxINCLUDE_SDFxSDF_F)
                                          + 4 * 3),
                                16777215),
                          xAND (getFIXED (getFIXED (mSTREAMxINCLUDE_SDFxSDF_F)
                                          + 4 * 5),
                                16777215))),
                MAX (0)));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16,
                    mSTREAMxINCLUDE_SDFxCSECT_LENGTH
                        + 2
                              * (xNEQ (xAND (getFIXED (
                                                 getFIXED (
                                                     mSTREAMxINCLUDE_SDFxSDF_F)
                                                 + 4 * 2),
                                             65536),
                                       0)),
                    bitRHS);
            bitRHS->inUse = 0;
          }
      // IF C ~= ':' THEN (3940)
      if (1 & (xsNEQ (getCHARACTER (mC), cToDescriptor (NULL, ":"))))
        // CALL ENTER_SDF_THING; (3941)
        STREAMxINCLUDE_SDFxENTER_SDF_THING (0);
    } // End of DO WHILE block
  // IF C = ':' THEN (3942)
  if (1 & (xsEQ (getCHARACTER (mC), cToDescriptor (NULL, ":"))))
    // DO; (3943)
    {
    rs4:;
      // SYT_FLAGS(BLOCK_SYTREF(NEST)) = SYT_FLAGS(BLOCK_SYTREF(NEST)) |
      // SDF_INCL_LIST; (3944)
      {
        int32_t numberRHS = (int32_t)(xOR (
            getFIXED (
                getFIXED (mSYM_TAB)
                + 34 * (COREHALFWORD (mBLOCK_SYTREF + 2 * getFIXED (mNEST)))
                + 8 + 4 * (0)),
            4096));
        putFIXED (
            getFIXED (mSYM_TAB)
                + 34 * (COREHALFWORD (mBLOCK_SYTREF + 2 * getFIXED (mNEST)))
                + 8 + 4 * (0),
            numberRHS);
      }
      // D_CONTINUATION_OK = TRUE; (3945)
      {
        int32_t numberRHS = (int32_t)(1);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (1, mSTREAMxD_CONTINUATION_OK, bitRHS);
        bitRHS->inUse = 0;
      }
      // C = D_TOKEN; (3946)
      {
        descriptor_t *stringRHS;
        stringRHS = STREAMxD_TOKEN (0);
        putCHARACTER (mC, stringRHS);
        stringRHS->inUse = 0;
      }
    // LIST: (3947)
    LIST:
      // DO WHILE C ~= ''; (3948)
      while (1 & (xsNEQ (getCHARACTER (mC), cToDescriptor (NULL, ""))))
        {
          // IF C = ',' THEN (3949)
          if (1 & (xsEQ (getCHARACTER (mC), cToDescriptor (NULL, ","))))
            // DO; (3950)
            {
            rs4s1s1:;
              // C = D_TOKEN; (3951)
              {
                descriptor_t *stringRHS;
                stringRHS = STREAMxD_TOKEN (0);
                putCHARACTER (mC, stringRHS);
                stringRHS->inUse = 0;
              }
              // REPEAT LIST; (3952)
              goto rs4s1;
            es4s1s1:;
            } // End of DO block
          // IF C = ';' THEN (3953)
          if (1 & (xsEQ (getCHARACTER (mC), cToDescriptor (NULL, ";"))))
            // ESCAPE LIST; (3954)
            goto es4s1;
          // IF C = 'STRUCTURE' THEN (3955)
          if (1
              & (xsEQ (getCHARACTER (mC), cToDescriptor (NULL, "STRUCTURE"))))
            // C = X1 || D_TOKEN; (3956)
            {
              descriptor_t *stringRHS;
              stringRHS = xsCAT (getCHARACTER (mX1), STREAMxD_TOKEN (0));
              putCHARACTER (mC, stringRHS);
              stringRHS->inUse = 0;
            }
          // DO ; (3957)
          {
          rs4s1s2:;
            // COMMTABL_BYTE ( 23 ) = LENGTH ( C ) ; (3958)
            {
              int32_t numberRHS = (int32_t)(LENGTH (getCHARACTER (mC)));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (8,
                      getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_BYTE) + 1 * (23),
                      bitRHS);
              bitRHS->inUse = 0;
            }
            // CALL MOVE ( COMMTABL_BYTE ( 23 ) , C , COMMTABL_ADDR + 88 ) ;
            // (3959)
            {
              putBITp (16, mMOVExLEGNTH,
                       getBIT (8, getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_BYTE)
                                      + 1 * 23));
              putFIXED (mMOVExFROM, getFIXED (mC));
              putFIXED (
                  mMOVExINTO,
                  xadd (getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_ADDR), 88));
              MOVE (0);
            }
            // CALL MONITOR ( 22 , 13 ) ; (3960)
            MONITOR22 (13);
            // COREWORD ( ADDR ( SDF_B ) ) , COREWORD ( ADDR ( SDF_H ) ) ,
            // COREWORD ( ADDR ( SDF_F ) ) = COMMTABL_FULLWORD(7) ; (3961)
            {
              int32_t numberRHS = (int32_t)(getFIXED (
                  getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD) + 4 * 7));
              COREWORD2 (
                  ADDR ("STREAMxINCLUDE_SDFxSDF_B", 0x80000000, NULL, 0),
                  numberRHS);
              COREWORD2 (
                  ADDR ("STREAMxINCLUDE_SDFxSDF_H", 0x80000000, NULL, 0),
                  numberRHS);
              COREWORD2 (
                  ADDR ("STREAMxINCLUDE_SDFxSDF_F", 0x80000000, NULL, 0),
                  numberRHS);
            }
            // ; (3962)
            ;
          es4s1s2:;
          } // End of DO block
          // ; (3963)
          ;
          // IF SDFPKG_CRETURN = 0 THEN (3964)
          if (1
              & (xEQ (COREHALFWORD (
                          getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_HALFWORD)
                          + 2 * 7),
                      0)))
            // DO; (3965)
            {
            rs4s1s3:;
              // NEXT_SYMBOL = SDF_SYMB_DECLARE_LINK; (3966)
              {
                descriptor_t *bitRHS = getBIT (
                    16, getFIXED (mSTREAMxINCLUDE_SDFxSDF_H) + 2 * -5);
                putBIT (16, mSTREAMxINCLUDE_SDFxNEXT_SYMBOL, bitRHS);
                bitRHS->inUse = 0;
              }
              // CALL ENTER_SDF_THING; (3967)
              STREAMxINCLUDE_SDFxENTER_SDF_THING (0);
            es4s1s3:;
            } // End of DO block
          // ELSE (3968)
          else
            // IF BYTE(C) = BYTE(' ') THEN (3969)
            if (1
                & (xEQ (BYTE1 (getCHARACTER (mC)),
                        BYTE1 (cToDescriptor (NULL, " ")))))
              // CALL ERROR(CLASS_XI, 6, SUBSTR(C,1)); (3970)
              {
                putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_XI));
                putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(6)));
                putCHARACTERp (mERRORxTEXT, SUBSTR2 (getCHARACTER (mC), 1));
                ERROR (0);
              }
            // ELSE (3971)
            else
              // CALL ERROR(CLASS_XI, 7, C); (3972)
              {
                putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_XI));
                putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(7)));
                putCHARACTERp (mERRORxTEXT, getCHARACTER (mC));
                ERROR (0);
              }
          // C = D_TOKEN; (3973)
          {
            descriptor_t *stringRHS;
            stringRHS = STREAMxD_TOKEN (0);
            putCHARACTER (mC, stringRHS);
            stringRHS->inUse = 0;
          }
          if (0)
            {
            rs4s1:
              continue;
            es4s1:
              break;
            } // block labeled LIST
        }     // End of DO WHILE block
      // D_CONTINUATION_OK = FALSE; (3974)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (1, mSTREAMxD_CONTINUATION_OK, bitRHS);
        bitRHS->inUse = 0;
      }
    es4:;
    } // End of DO block
  // ACCESS_COMPOOL = FALSE; (3975)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (1, mSTREAMxINCLUDE_SDFxACCESS_COMPOOL, bitRHS);
    bitRHS->inUse = 0;
  }
  // RETURN; (3976)
  {
    reentryGuard = 0;
    return 0;
  }
}
