/*
  File ICQ_ARRAYNESS_OUTPUT.c generated by XCOM-I, 2024-08-08 04:33:34.
*/

#include "runtimeC.h"

int32_t
ICQ_ARRAYNESS_OUTPUT (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "ICQ_ARRAYNESS_OUTPUT");
  // IF NAME_IMPLIED THEN (8945)
  if (1 & (bitToFixed (getBIT (1, mNAME_IMPLIED))))
    // RETURN; (8946)
    {
      reentryGuard = 0;
      return 0;
    }
  // IF SYT_ARRAY(ID_LOC)~=0 THEN (8947)
  if (1
      & (xNEQ (COREHALFWORD (getFIXED (mSYM_TAB) + 34 * (getFIXED (mID_LOC))
                             + 20 + 2 * (0)),
               0)))
    // DO; (8948)
    {
    rs1:;
      // IF (SYT_FLAGS(ID_LOC)&AUTO_FLAG)~=0 THEN (8949)
      if (1
          & (xNEQ (xAND (getFIXED (getFIXED (mSYM_TAB)
                                   + 34 * (getFIXED (mID_LOC)) + 8 + 4 * (0)),
                         256),
                   0)))
        // I=XADLP; (8950)
        {
          descriptor_t *bitRHS = getBIT (16, mXADLP);
          int32_t numberRHS;
          numberRHS = bitToFixed (bitRHS);
          putFIXED (mI, numberRHS);
          bitRHS->inUse = 0;
        }
      // ELSE (8951)
      else
        // I=XIDLP; (8952)
        {
          descriptor_t *bitRHS = getBIT (16, mXIDLP);
          int32_t numberRHS;
          numberRHS = bitToFixed (bitRHS);
          putFIXED (mI, numberRHS);
          bitRHS->inUse = 0;
        }
      // CALL HALMAT_POP(I,0,XCO_D,0); (8953)
      {
        putBITp (16, mHALMAT_POPxPOPCODE,
                 fixedToBit (32, (int32_t)(getFIXED (mI))));
        putBITp (8, mHALMAT_POPxPIPp, fixedToBit (32, (int32_t)(0)));
        putBITp (8, mHALMAT_POPxCOPT, getBIT (8, mXCO_D));
        putBITp (8, mHALMAT_POPxTAG, fixedToBit (32, (int32_t)(0)));
        HALMAT_POP (0);
      }
      // IF SYT_TYPE(ID_LOC)=MAJ_STRUC THEN (8954)
      if (1
          & (xEQ (BYTE0 (getFIXED (mSYM_TAB) + 34 * (getFIXED (mID_LOC)) + 32
                         + 1 * (0)),
                  10)))
        // DO; (8955)
        {
        rs1s1:;
          // I=2; (8956)
          {
            int32_t numberRHS = (int32_t)(2);
            putFIXED (mI, numberRHS);
          }
          // CALL HALMAT_PIP(SYT_ARRAY(ID_LOC),XIMD,0,0); (8957)
          {
            putBITp (16, mHALMAT_PIPxOPERAND,
                     getBIT (16, getFIXED (mSYM_TAB)
                                     + 34 * (getFIXED (mID_LOC)) + 20
                                     + 2 * (0)));
            putBITp (8, mHALMAT_PIPxQUAL, getBIT (8, mXIMD));
            putBITp (8, mHALMAT_PIPxTAG1, fixedToBit (32, (int32_t)(0)));
            putBITp (8, mHALMAT_PIPxTAG2, fixedToBit (32, (int32_t)(0)));
            HALMAT_PIP (0);
          }
        es1s1:;
        } // End of DO block
      // ELSE (8958)
      else
        // DO I=1 TO EXT_ARRAY(SYT_ARRAY(ID_LOC)); (8959)
        {
          int32_t from136, to136, by136;
          from136 = 1;
          to136 = bitToFixed (
              getBIT (16, mEXT_ARRAY
                              + 2
                                    * COREHALFWORD (getFIXED (mSYM_TAB)
                                                    + 34 * (getFIXED (mID_LOC))
                                                    + 20 + 2 * (0))));
          by136 = 1;
          for (putFIXED (mI, from136); getFIXED (mI) <= to136;
               putFIXED (mI, getFIXED (mI) + by136))
            {
              // CALL HALMAT_PIP(EXT_ARRAY(SYT_ARRAY(ID_LOC)+I),XIMD,0,0);
              // (8960)
              {
                putBITp (
                    16, mHALMAT_PIPxOPERAND,
                    getBIT (16,
                            mEXT_ARRAY
                                + 2
                                      * xadd (COREHALFWORD (
                                                  getFIXED (mSYM_TAB)
                                                  + 34 * (getFIXED (mID_LOC))
                                                  + 20 + 2 * (0)),
                                              getFIXED (mI))));
                putBITp (8, mHALMAT_PIPxQUAL, getBIT (8, mXIMD));
                putBITp (8, mHALMAT_PIPxTAG1, fixedToBit (32, (int32_t)(0)));
                putBITp (8, mHALMAT_PIPxTAG2, fixedToBit (32, (int32_t)(0)));
                HALMAT_PIP (0);
              }
            }
        } // End of DO for-loop block
      // CALL HALMAT_FIX_PIP#(LAST_POP#,I-1); (8961)
      {
        putFIXED (mHALMAT_FIX_PIPpxPOP_LOC, getFIXED (mLAST_POPp));
        putBITp (8, mHALMAT_FIX_PIPpxPIPp,
                 fixedToBit (32, (int32_t)(xsubtract (getFIXED (mI), 1))));
        HALMAT_FIX_PIPp (0);
      }
      // CALL HALMAT_POP(XDLPE,0,XCO_N,0); (8962)
      {
        putBITp (16, mHALMAT_POPxPOPCODE, getBIT (16, mXDLPE));
        putBITp (8, mHALMAT_POPxPIPp, fixedToBit (32, (int32_t)(0)));
        putBITp (8, mHALMAT_POPxCOPT, getBIT (8, mXCO_N));
        putBITp (8, mHALMAT_POPxTAG, fixedToBit (32, (int32_t)(0)));
        HALMAT_POP (0);
      }
    es1:;
    } // End of DO block
  {
    reentryGuard = 0;
    return 0;
  }
}
