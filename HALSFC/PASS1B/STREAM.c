/*
  File STREAM.c generated by XCOM-I, 2024-08-09 12:40:41.
*/

#include "runtimeC.h"

int32_t
STREAM (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "STREAM");
  // GO TO STREAM_START; (3088)
  goto STREAM_START;
// STREAM_START: (3089)
STREAM_START:
// CHECK_STRING_POSITION: (3090)
CHECK_STRING_POSITION:
  // IF MACRO_EXPAN_LEVEL > 0 THEN (3091)
  if (1 & (xGT (COREHALFWORD (mMACRO_EXPAN_LEVEL), 0)))
    // DO; (3092)
    {
    rs1:;
      // OVER_PUNCH = 0; (3093)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (8, mOVER_PUNCH, bitRHS);
        bitRHS->inUse = 0;
      }
      // IF PARM_EXPAN_LEVEL > BASE_PARM_LEVEL(MACRO_EXPAN_LEVEL) THEN (3094)
      if (1
          & (xGT (COREHALFWORD (mPARM_EXPAN_LEVEL),
                  COREHALFWORD (mBASE_PARM_LEVEL
                                + 2 * COREHALFWORD (mMACRO_EXPAN_LEVEL)))))
        // IF PARM_EXPAN_LEVEL>=PARM_EXPAN_LIMIT THEN (3095)
        if (1 & (xGE (COREHALFWORD (mPARM_EXPAN_LEVEL), 8)))
          // DO; (3096)
          {
          rs1s1:;
            // CALL ERROR(CLASS_IR,6, 0); (3097)
            {
              putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_IR));
              putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(6)));
              putCHARACTERp (mERRORxTEXT, fixedToCharacter (0));
              ERROR (0);
            }
            // MACRO_EXPAN_LEVEL,PARM_EXPAN_LEVEL,MACRO_FOUND=0; (3098)
            {
              int32_t numberRHS = (int32_t)(0);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mMACRO_EXPAN_LEVEL, bitRHS);
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mPARM_EXPAN_LEVEL, bitRHS);
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (1, mMACRO_FOUND, bitRHS);
              bitRHS->inUse = 0;
            }
            // GO TO MACRO_DONE; (3099)
            goto MACRO_DONE;
          es1s1:;
          } // End of DO block
        // ELSE (3100)
        else
          // IF PARM_REPLACE_PTR(PARM_EXPAN_LEVEL) <
          // LENGTH(MACRO_CALL_PARM_TABLE( PARM_STACK_PTR(PARM_EXPAN_LEVEL)))
          // THEN (3101)
          if (1
              & (xLT (
                  COREHALFWORD (mPARM_REPLACE_PTR
                                + 2 * COREHALFWORD (mPARM_EXPAN_LEVEL)),
                  LENGTH (getCHARACTER (
                      mMACRO_CALL_PARM_TABLE
                      + 4
                            * COREHALFWORD (
                                mPARM_STACK_PTR
                                + 2 * COREHALFWORD (mPARM_EXPAN_LEVEL)))))))
            // DO; (3102)
            {
            rs1s2:;
              // NEXT_CHAR=BYTE(MACRO_CALL_PARM_TABLE(PARM_STACK_PTR(
              // PARM_EXPAN_LEVEL)),PARM_REPLACE_PTR(PARM_EXPAN_LEVEL)); (3103)
              {
                int32_t numberRHS = (int32_t)(BYTE (
                    getCHARACTER (
                        mMACRO_CALL_PARM_TABLE
                        + 4
                              * COREHALFWORD (
                                  mPARM_STACK_PTR
                                  + 2 * COREHALFWORD (mPARM_EXPAN_LEVEL))),
                    COREHALFWORD (mPARM_REPLACE_PTR
                                  + 2 * COREHALFWORD (mPARM_EXPAN_LEVEL))));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (8, mNEXT_CHAR, bitRHS);
                bitRHS->inUse = 0;
              }
              // PARM_REPLACE_PTR(PARM_EXPAN_LEVEL) =
              // PARM_REPLACE_PTR(PARM_EXPAN_LEVEL) + 1 ; (3104)
              {
                int32_t numberRHS = (int32_t)(xadd (
                    COREHALFWORD (mPARM_REPLACE_PTR
                                  + 2 * COREHALFWORD (mPARM_EXPAN_LEVEL)),
                    1));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16,
                        mPARM_REPLACE_PTR
                            + 2 * (COREHALFWORD (mPARM_EXPAN_LEVEL)),
                        bitRHS);
                bitRHS->inUse = 0;
              }
              // IF CONTROL(3) THEN (3105)
              if (1 & (bitToFixed (getBIT (1, mCONTROL + 1 * 3))))
                // CALL MACRO_DIAGNOSTICS(1); (3106)
                {
                  putBITp (16, mSTREAMxMACRO_DIAGNOSTICSxWHERE,
                           fixedToBit (32, (int32_t)(1)));
                  STREAMxMACRO_DIAGNOSTICS (0);
                }
              // RETURN; (3107)
              {
                reentryGuard = 0;
                return 0;
              }
            es1s2:;
            } // End of DO block
          // ELSE (3108)
          else
            // DO; (3109)
            {
            rs1s3:;
              // IF FIRST_TIME_PARM(PARM_EXPAN_LEVEL) THEN (3110)
              if (1
                  & (bitToFixed (
                      getBIT (1, mFIRST_TIME_PARM
                                     + 1 * COREHALFWORD (mPARM_EXPAN_LEVEL)))))
                // DO; (3111)
                {
                rs1s3s1:;
                  // IF P_CENT(PARM_EXPAN_LEVEL) THEN (3112)
                  if (1
                      & (bitToFixed (getBIT (
                          8, mP_CENT + 1 * COREHALFWORD (mPARM_EXPAN_LEVEL)))))
                    // DO; (3113)
                    {
                    rs1s3s1s1:;
                      // P_CENT(PARM_EXPAN_LEVEL)=FALSE; (3114)
                      {
                        int32_t numberRHS = (int32_t)(0);
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (8,
                                mP_CENT
                                    + 1 * (COREHALFWORD (mPARM_EXPAN_LEVEL)),
                                bitRHS);
                        bitRHS->inUse = 0;
                      }
                    // PARM_DONE: (3115)
                    PARM_DONE:
                      // FIRST_TIME_PARM(PARM_EXPAN_LEVEL)=TRUE; (3116)
                      {
                        int32_t numberRHS = (int32_t)(1);
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (1,
                                mFIRST_TIME_PARM
                                    + 1 * (COREHALFWORD (mPARM_EXPAN_LEVEL)),
                                bitRHS);
                        bitRHS->inUse = 0;
                      }
                      // PARM_EXPAN_LEVEL=PARM_EXPAN_LEVEL-1; (3117)
                      {
                        int32_t numberRHS = (int32_t)(xsubtract (
                            COREHALFWORD (mPARM_EXPAN_LEVEL), 1));
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (16, mPARM_EXPAN_LEVEL, bitRHS);
                        bitRHS->inUse = 0;
                      }
                      // GO TO CHECK_STRING_POSITION; (3118)
                      goto CHECK_STRING_POSITION;
                    es1s3s1s1:;
                    } // End of DO block
                  // NEXT_CHAR=BYTE(X1); (3119)
                  {
                    int32_t numberRHS = (int32_t)(BYTE1 (getCHARACTER (mX1)));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (8, mNEXT_CHAR, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // FIRST_TIME_PARM(PARM_EXPAN_LEVEL)=FALSE; (3120)
                  {
                    int32_t numberRHS = (int32_t)(0);
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (1,
                            mFIRST_TIME_PARM
                                + 1 * (COREHALFWORD (mPARM_EXPAN_LEVEL)),
                            bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // IF CONTROL(3) THEN (3121)
                  if (1 & (bitToFixed (getBIT (1, mCONTROL + 1 * 3))))
                    // CALL MACRO_DIAGNOSTICS(2); (3122)
                    {
                      putBITp (16, mSTREAMxMACRO_DIAGNOSTICSxWHERE,
                               fixedToBit (32, (int32_t)(2)));
                      STREAMxMACRO_DIAGNOSTICS (0);
                    }
                  // RETURN; (3123)
                  {
                    reentryGuard = 0;
                    return 0;
                  }
                es1s3s1:;
                } // End of DO block
              // ELSE (3124)
              else
                // GO TO PARM_DONE; (3125)
                goto PARM_DONE;
            es1s3:;
            } // End of DO block
      // IF MACRO_TEXT(MACRO_POINT) ~=  239 THEN (3126)
      if (1
          & (xNEQ (BYTE0 (getFIXED (mMACRO_TEXTS)
                          + 1 * (getFIXED (mMACRO_POINT)) + 0 + 1 * (0)),
                   239)))
        // DO; (3127)
        {
        rs1s4:;
          // BLANK_COUNT = 0; (3128)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mBLANK_COUNT, bitRHS);
            bitRHS->inUse = 0;
          }
          // IF MACRO_TEXT(MACRO_POINT) =  238 THEN (3129)
          if (1
              & (xEQ (BYTE0 (getFIXED (mMACRO_TEXTS)
                             + 1 * (getFIXED (mMACRO_POINT)) + 0 + 1 * (0)),
                      238)))
            // DO; (3130)
            {
            rs1s4s1:;
              // MACRO_POINT=MACRO_POINT+1; (3131)
              {
                int32_t numberRHS
                    = (int32_t)(xadd (getFIXED (mMACRO_POINT), 1));
                putFIXED (mMACRO_POINT, numberRHS);
              }
              // BLANK_COUNT=MACRO_TEXT(MACRO_POINT); (3132)
              {
                descriptor_t *bitRHS = getBIT (
                    8, getFIXED (mMACRO_TEXTS) + 1 * (getFIXED (mMACRO_POINT))
                           + 0 + 1 * (0));
                putBIT (16, mBLANK_COUNT, bitRHS);
                bitRHS->inUse = 0;
              }
              // NEXT_CHAR = BYTE(X1); (3133)
              {
                int32_t numberRHS = (int32_t)(BYTE1 (getCHARACTER (mX1)));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (8, mNEXT_CHAR, bitRHS);
                bitRHS->inUse = 0;
              }
            es1s4s1:;
            } // End of DO block
          // ELSE (3134)
          else
            // NEXT_CHAR=MACRO_TEXT(MACRO_POINT); (3135)
            {
              descriptor_t *bitRHS = getBIT (
                  8, getFIXED (mMACRO_TEXTS) + 1 * (getFIXED (mMACRO_POINT))
                         + 0 + 1 * (0));
              putBIT (8, mNEXT_CHAR, bitRHS);
              bitRHS->inUse = 0;
            }
          // MACRO_POINT=MACRO_POINT + 1; (3136)
          {
            int32_t numberRHS = (int32_t)(xadd (getFIXED (mMACRO_POINT), 1));
            putFIXED (mMACRO_POINT, numberRHS);
          }
          // IF CONTROL(3) THEN (3137)
          if (1 & (bitToFixed (getBIT (1, mCONTROL + 1 * 3))))
            // CALL MACRO_DIAGNOSTICS(3); (3138)
            {
              putBITp (16, mSTREAMxMACRO_DIAGNOSTICSxWHERE,
                       fixedToBit (32, (int32_t)(3)));
              STREAMxMACRO_DIAGNOSTICS (0);
            }
          // RETURN; (3139)
          {
            reentryGuard = 0;
            return 0;
          }
        es1s4:;
        } // End of DO block
      // IF FIRST_TIME(MACRO_EXPAN_LEVEL) THEN (3140)
      if (1
          & (bitToFixed (getBIT (
              1, mFIRST_TIME + 1 * COREHALFWORD (mMACRO_EXPAN_LEVEL)))))
        // DO; (3141)
        {
        rs1s5:;
          // IF ~M_CENT(MACRO_EXPAN_LEVEL) THEN (3142)
          if (1
              & (xNOT (
                  BYTE0 (mM_CENT + 1 * COREHALFWORD (mMACRO_EXPAN_LEVEL)))))
            // DO; (3143)
            {
            rs1s5s1:;
              // FIRST_TIME(MACRO_EXPAN_LEVEL)= FALSE; (3144)
              {
                int32_t numberRHS = (int32_t)(0);
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (1,
                        mFIRST_TIME + 1 * (COREHALFWORD (mMACRO_EXPAN_LEVEL)),
                        bitRHS);
                bitRHS->inUse = 0;
              }
              // NEXT_CHAR = BYTE(X1); (3145)
              {
                int32_t numberRHS = (int32_t)(BYTE1 (getCHARACTER (mX1)));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (8, mNEXT_CHAR, bitRHS);
                bitRHS->inUse = 0;
              }
              // IF CONTROL(3) THEN (3146)
              if (1 & (bitToFixed (getBIT (1, mCONTROL + 1 * 3))))
                // CALL MACRO_DIAGNOSTICS(4); (3147)
                {
                  putBITp (16, mSTREAMxMACRO_DIAGNOSTICSxWHERE,
                           fixedToBit (32, (int32_t)(4)));
                  STREAMxMACRO_DIAGNOSTICS (0);
                }
              // RETURN; (3148)
              {
                reentryGuard = 0;
                return 0;
              }
            es1s5s1:;
            } // End of DO block
        es1s5:;
        } // End of DO block
      // ELSE (3149)
      else
        // FIRST_TIME(MACRO_EXPAN_LEVEL)=TRUE; (3150)
        {
          int32_t numberRHS = (int32_t)(1);
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (1, mFIRST_TIME + 1 * (COREHALFWORD (mMACRO_EXPAN_LEVEL)),
                  bitRHS);
          bitRHS->inUse = 0;
        }
      // TOP_OF_PARM_STACK=TOP_OF_PARM_STACK-NUM_OF_PARM(MACRO_EXPAN_LEVEL);
      // (3151)
      {
        int32_t numberRHS = (int32_t)(xsubtract (
            COREHALFWORD (mTOP_OF_PARM_STACK),
            COREHALFWORD (mNUM_OF_PARM
                          + 2 * COREHALFWORD (mMACRO_EXPAN_LEVEL))));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mTOP_OF_PARM_STACK, bitRHS);
        bitRHS->inUse = 0;
      }
      // PRINTING_ENABLED=M_PRINT(MACRO_EXPAN_LEVEL); (3152)
      {
        descriptor_t *bitRHS
            = getBIT (16, mM_PRINT + 2 * COREHALFWORD (mMACRO_EXPAN_LEVEL));
        putBIT (16, mPRINTING_ENABLED, bitRHS);
        bitRHS->inUse = 0;
      }
      // IF ~M_CENT(MACRO_EXPAN_LEVEL) THEN (3153)
      if (1 & (xNOT (BYTE0 (mM_CENT + 1 * COREHALFWORD (mMACRO_EXPAN_LEVEL)))))
        // IF ~DONT_SET_WAIT THEN (3154)
        if (1 & (xNOT (BYTE0 (mDONT_SET_WAIT))))
          // WAIT = TRUE; (3155)
          {
            int32_t numberRHS = (int32_t)(1);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (1, mWAIT, bitRHS);
            bitRHS->inUse = 0;
          }
      // MACRO_EXPAN_LEVEL = MACRO_EXPAN_LEVEL - 1; (3156)
      {
        int32_t numberRHS
            = (int32_t)(xsubtract (COREHALFWORD (mMACRO_EXPAN_LEVEL), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mMACRO_EXPAN_LEVEL, bitRHS);
        bitRHS->inUse = 0;
      }
      // MACRO_POINT=M_P(MACRO_EXPAN_LEVEL); (3157)
      {
        int32_t numberRHS = (int32_t)(getFIXED (
            mM_P + 4 * COREHALFWORD (mMACRO_EXPAN_LEVEL)));
        putFIXED (mMACRO_POINT, numberRHS);
      }
      // BLANK_COUNT = M_BLANK_COUNT(MACRO_EXPAN_LEVEL); (3158)
      {
        descriptor_t *bitRHS = getBIT (
            16, mM_BLANK_COUNT + 2 * COREHALFWORD (mMACRO_EXPAN_LEVEL));
        putBIT (16, mBLANK_COUNT, bitRHS);
        bitRHS->inUse = 0;
      }
      // IF MACRO_EXPAN_LEVEL = 0 THEN (3159)
      if (1 & (xEQ (COREHALFWORD (mMACRO_EXPAN_LEVEL), 0)))
        // DO; (3160)
        {
        rs1s6:;
          // MACRO_FOUND = FALSE ; (3161)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (1, mMACRO_FOUND, bitRHS);
            bitRHS->inUse = 0;
          }
        // MACRO_DONE: (3162)
        MACRO_DONE:
          // NEXT_CHAR = SAVE_NEXT_CHAR; (3163)
          {
            descriptor_t *bitRHS = getBIT (8, mSAVE_NEXT_CHAR);
            putBIT (8, mNEXT_CHAR, bitRHS);
            bitRHS->inUse = 0;
          }
          // OVER_PUNCH = SAVE_OVER_PUNCH; (3164)
          {
            descriptor_t *bitRHS = getBIT (8, mSAVE_OVER_PUNCH);
            putBIT (8, mOVER_PUNCH, bitRHS);
            bitRHS->inUse = 0;
          }
          // PRINTING_ENABLED=PRINT_FLAG; (3165)
          {
            descriptor_t *bitRHS = getBIT (16, mPRINT_FLAG);
            putBIT (16, mPRINTING_ENABLED, bitRHS);
            bitRHS->inUse = 0;
          }
          // IF CONTROL(3) THEN (3166)
          if (1 & (bitToFixed (getBIT (1, mCONTROL + 1 * 3))))
            // CALL MACRO_DIAGNOSTICS(5); (3167)
            {
              putBITp (16, mSTREAMxMACRO_DIAGNOSTICSxWHERE,
                       fixedToBit (32, (int32_t)(5)));
              STREAMxMACRO_DIAGNOSTICS (0);
            }
          // RETURN; (3168)
          {
            reentryGuard = 0;
            return 0;
          }
        es1s6:;
        } // End of DO block
      // ELSE (3169)
      else
        // GO TO CHECK_STRING_POSITION; (3170)
        goto CHECK_STRING_POSITION;
    es1:;
    } // End of DO block
  // BLANK_COUNT = -1; (3171)
  {
    int32_t numberRHS = (int32_t)(-1);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mBLANK_COUNT, bitRHS);
    bitRHS->inUse = 0;
  }
// STACK_CHECK: (3172)
STACK_CHECK:
  // DO II = II TO 2; (3173)
  {
    int32_t from62, to62, by62;
    from62 = bitToFixed (getBIT (16, mSTREAMxII));
    to62 = 2;
    by62 = 1;
    for (putBIT (16, mSTREAMxII, fixedToBit (16, from62));
         bitToFixed (getBIT (16, mSTREAMxII)) <= to62;
         putBIT (16, mSTREAMxII,
                 fixedToBit (16, bitToFixed (getBIT (16, mSTREAMxII)) + by62)))
      {
        // IF RETURN_CHAR(II) ~= 0 THEN (3174)
        if (1
            & (xNEQ (COREHALFWORD (mSTREAMxRETURN_CHAR
                                   + 2 * COREHALFWORD (mSTREAMxII)),
                     0)))
          // DO; (3175)
          {
          rs2s1:;
            // ARROW_FLAG = TRUE; (3176)
            {
              int32_t numberRHS = (int32_t)(1);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (1, mSTREAMxARROW_FLAG, bitRHS);
              bitRHS->inUse = 0;
            }
            // RETURN_CHAR(II) = RETURN_CHAR(II) - 1; (3177)
            {
              int32_t numberRHS = (int32_t)(xsubtract (
                  COREHALFWORD (mSTREAMxRETURN_CHAR
                                + 2 * COREHALFWORD (mSTREAMxII)),
                  1));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16,
                      mSTREAMxRETURN_CHAR + 2 * (COREHALFWORD (mSTREAMxII)),
                      bitRHS);
              bitRHS->inUse = 0;
            }
            // NEXT_CHAR = TYPE_CHAR(II); (3178)
            {
              descriptor_t *bitRHS = getBIT (
                  8, mSTREAMxTYPE_CHAR + 1 * COREHALFWORD (mSTREAMxII));
              putBIT (8, mNEXT_CHAR, bitRHS);
              bitRHS->inUse = 0;
            }
            // OVER_PUNCH = 0; (3179)
            {
              int32_t numberRHS = (int32_t)(0);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (8, mOVER_PUNCH, bitRHS);
              bitRHS->inUse = 0;
            }
            // RETURN; (3180)
            {
              reentryGuard = 0;
              return 0;
            }
          es2s1:;
          } // End of DO block
        if (0)
          {
          rs2:
            continue;
          es2:
            break;
          } // loop of block labeled STACK_CHECK
      }
  } // End of DO for-loop block
  // II = 0; (3181)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mSTREAMxII, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF ARROW_FLAG THEN (3182)
  if (1 & (bitToFixed (getBIT (1, mSTREAMxARROW_FLAG))))
    // DO; (3183)
    {
    rs3:;
      // ARROW_FLAG = FALSE; (3184)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (1, mSTREAMxARROW_FLAG, bitRHS);
        bitRHS->inUse = 0;
      }
      // NEXT_CHAR = SAVE_NEXT_CHAR1; (3185)
      {
        descriptor_t *bitRHS = getBIT (8, mSTREAMxSAVE_NEXT_CHAR1);
        putBIT (8, mNEXT_CHAR, bitRHS);
        bitRHS->inUse = 0;
      }
      // OVER_PUNCH = SAVE_OVER_PUNCH1; (3186)
      {
        descriptor_t *bitRHS = getBIT (8, mSTREAMxSAVE_OVER_PUNCH1);
        putBIT (8, mOVER_PUNCH, bitRHS);
        bitRHS->inUse = 0;
      }
      // BLANK_COUNT = SAVE_BLANK_COUNT1; (3187)
      {
        descriptor_t *bitRHS = getBIT (16, mSTREAMxSAVE_BLANK_COUNT1);
        putBIT (16, mBLANK_COUNT, bitRHS);
        bitRHS->inUse = 0;
      }
      // RETURN; (3188)
      {
        reentryGuard = 0;
        return 0;
      }
    es3:;
    } // End of DO block
  // IF GROUP_NEEDED THEN (3189)
  if (1 & (bitToFixed (getBIT (1, mGROUP_NEEDED))))
    // DO; (3190)
    {
    rs4:;
      // CALL GET_GROUP; (3191)
      STREAMxGET_GROUP (0);
      // INDEX = 1; (3192)
      {
        int32_t numberRHS = (int32_t)(1);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mSTREAMxINDEX, bitRHS);
        bitRHS->inUse = 0;
      }
      // GROUP_NEEDED = FALSE; (3193)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (1, mGROUP_NEEDED, bitRHS);
        bitRHS->inUse = 0;
      }
    es4:;
    } // End of DO block
// BEGINNING: (3194)
BEGINNING:
  // IF RETURNING_M THEN (3195)
  if (1 & (bitToFixed (getBIT (8, mSTREAMxRETURNING_M))))
    // DO; (3196)
    {
    rs5:;
      // IF M_BLANKS >= 0 THEN (3197)
      if (1 & (xGE (COREHALFWORD (mSTREAMxM_BLANKS), 0)))
        // DO; (3198)
        {
        rs5s1:;
          // NEXT_CHAR = BYTE(X1); (3199)
          {
            int32_t numberRHS = (int32_t)(BYTE1 (getCHARACTER (mX1)));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (8, mNEXT_CHAR, bitRHS);
            bitRHS->inUse = 0;
          }
          // ARROW = -LAST_E_IND; (3200)
          {
            int32_t numberRHS
                = (int32_t)(xminus (COREHALFWORD (mSTREAMxLAST_E_IND)));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxARROW, bitRHS);
            bitRHS->inUse = 0;
          }
          // LAST_E_IND = 0; (3201)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxLAST_E_IND, bitRHS);
            bitRHS->inUse = 0;
          }
          // BLANK_COUNT = M_BLANKS; (3202)
          {
            descriptor_t *bitRHS = getBIT (16, mSTREAMxM_BLANKS);
            putBIT (16, mBLANK_COUNT, bitRHS);
            bitRHS->inUse = 0;
          }
          // M_BLANKS = -1; (3203)
          {
            int32_t numberRHS = (int32_t)(-1);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxM_BLANKS, bitRHS);
            bitRHS->inUse = 0;
          }
          // GO TO FOUND_CHAR; (3204)
          goto FOUND_CHAR;
        es5s1:;
        } // End of DO block
      // IF BYTE(M_LINE, INDEX) ~= BYTE(X1) THEN (3205)
      if (1
          & (xNEQ (BYTE (getCHARACTER (mSTREAMxM_LINE),
                         COREHALFWORD (mSTREAMxINDEX)),
                   BYTE1 (getCHARACTER (mX1)))))
        // DO; (3206)
        {
        rs5s2:;
          // IF E_COUNT > 0 THEN (3207)
          if (1 & (xGT (COREHALFWORD (mSTREAMxE_COUNT), 0)))
            // DO; (3208)
            {
            rs5s2s1:;
              // IF BYTE(E_LINE, INDEX) ~= BYTE(X1) THEN (3209)
              if (1
                  & (xNEQ (BYTE (getCHARACTER (mSTREAMxE_LINE),
                                 COREHALFWORD (mSTREAMxINDEX)),
                           BYTE1 (getCHARACTER (mX1)))))
                // DO; (3210)
                {
                rs5s2s1s1:;
                  // IF E_INDICATOR(INDEX) ~= 1 THEN (3211)
                  if (1
                      & (xNEQ (
                          COREHALFWORD (mSTREAMxE_INDICATOR
                                        + 2 * COREHALFWORD (mSTREAMxINDEX)),
                          1)))
                    // CALL ERROR(CLASS_ME,3); (3212)
                    {
                      putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_ME));
                      putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(3)));
                      ERROR (0);
                    }
                  // ELSE (3213)
                  else
                    // OVER_PUNCH = BYTE(E_LINE, INDEX); (3214)
                    {
                      int32_t numberRHS
                          = (int32_t)(BYTE (getCHARACTER (mSTREAMxE_LINE),
                                            COREHALFWORD (mSTREAMxINDEX)));
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (8, mOVER_PUNCH, bitRHS);
                      bitRHS->inUse = 0;
                    }
                es5s2s1s1:;
                } // End of DO block
              // ELSE (3215)
              else
                // OVER_PUNCH = 0; (3216)
                {
                  int32_t numberRHS = (int32_t)(0);
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (8, mOVER_PUNCH, bitRHS);
                  bitRHS->inUse = 0;
                }
            es5s2s1:;
            } // End of DO block
          // ELSE (3217)
          else
            // OVER_PUNCH = 0; (3218)
            {
              int32_t numberRHS = (int32_t)(0);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (8, mOVER_PUNCH, bitRHS);
              bitRHS->inUse = 0;
            }
          // IF S_COUNT > 0 THEN (3219)
          if (1 & (xGT (COREHALFWORD (mSTREAMxS_COUNT), 0)))
            // IF BYTE(S_LINE, INDEX) ~= BYTE(X1) THEN (3220)
            if (1
                & (xNEQ (BYTE (getCHARACTER (mSTREAMxS_LINE),
                               COREHALFWORD (mSTREAMxINDEX)),
                         BYTE1 (getCHARACTER (mX1)))))
              // CALL ERROR(CLASS_MS,3); (3221)
              {
                putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_MS));
                putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(3)));
                ERROR (0);
              }
          // ARROW = -LAST_E_IND; (3222)
          {
            int32_t numberRHS
                = (int32_t)(xminus (COREHALFWORD (mSTREAMxLAST_E_IND)));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxARROW, bitRHS);
            bitRHS->inUse = 0;
          }
          // LAST_E_IND = 0; (3223)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxLAST_E_IND, bitRHS);
            bitRHS->inUse = 0;
          }
          // IF ~INCLUDING THEN (3224)
          if (1 & (xNOT (BYTE0 (mINCLUDING))))
            // DO; (3225)
            {
            rs5s2s2:;
              // IF STRING_GT(NEXT_CHAR_RVL,RVL) THEN (3226)
              if (1
                  & (STRING_GT (getCHARACTER (mNEXT_CHAR_RVL),
                                getCHARACTER (mRVL))))
                // RVL = NEXT_CHAR_RVL; (3227)
                {
                  descriptor_t *stringRHS;
                  stringRHS = getCHARACTER (mNEXT_CHAR_RVL);
                  putCHARACTER (mRVL, stringRHS);
                  stringRHS->inUse = 0;
                }
              // NEXT_CHAR_RVL = RVL(1); (3228)
              {
                descriptor_t *stringRHS;
                stringRHS = getCHARACTER (mRVL + 4 * 1);
                putCHARACTER (mNEXT_CHAR_RVL, stringRHS);
                stringRHS->inUse = 0;
              }
            es5s2s2:;
            } // End of DO block
          // NEXT_CHAR = BYTE(M_LINE, INDEX); (3229)
          {
            int32_t numberRHS = (int32_t)(BYTE (getCHARACTER (mSTREAMxM_LINE),
                                                COREHALFWORD (mSTREAMxINDEX)));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (8, mNEXT_CHAR, bitRHS);
            bitRHS->inUse = 0;
          }
          // CALL CHOP; (3230)
          STREAMxCHOP (0);
          // GO TO FOUND_CHAR; (3231)
          goto FOUND_CHAR;
        es5s2:;
        } // End of DO block
      // ELSE (3232)
      else
        // DO; (3233)
        {
        rs5s3:;
          // CALL BUILD_XSCRIPTS; (3234)
          STREAMxBUILD_XSCRIPTS (0);
          // OVER_PUNCH = 0; (3235)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (8, mOVER_PUNCH, bitRHS);
            bitRHS->inUse = 0;
          }
          // RETURNING_M = FALSE; (3236)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (8, mSTREAMxRETURNING_M, bitRHS);
            bitRHS->inUse = 0;
          }
          // LAST_S_IND = 0; (3237)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxLAST_S_IND, bitRHS);
            bitRHS->inUse = 0;
          }
          // RETURNING_S = TRUE; (3238)
          {
            int32_t numberRHS = (int32_t)(1);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxRETURNING_S, bitRHS);
            bitRHS->inUse = 0;
          }
          // PNTR = 0; (3239)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxPNTR, bitRHS);
            bitRHS->inUse = 0;
          }
        es5s3:;
        } // End of DO block
    es5:;
    } // End of DO block
  // IF RETURNING_S THEN (3240)
  if (1 & (bitToFixed (getBIT (16, mSTREAMxRETURNING_S))))
    // DO; (3241)
    {
    rs6:;
      // IF LENGTH(S_STACK) > 0 & PNTR < LENGTH(S_STACK) THEN (3242)
      if (1
          & (xAND (xGT (LENGTH (getCHARACTER (mSTREAMxS_STACK)), 0),
                   xLT (COREHALFWORD (mSTREAMxPNTR),
                        LENGTH (getCHARACTER (mSTREAMxS_STACK))))))
        // DO; (3243)
        {
        rs6s1:;
          // IF BYTE(S_STACK, PNTR) = BYTE(X1) THEN (3244)
          if (1
              & (xEQ (BYTE (getCHARACTER (mSTREAMxS_STACK),
                            COREHALFWORD (mSTREAMxPNTR)),
                      BYTE1 (getCHARACTER (mX1)))))
            // DO; (3245)
            {
            rs6s1s1:;
              // IF S_IND(PNTR) >= 0 THEN (3246)
              if (1
                  & (xGE (COREHALFWORD (mSTREAMxS_IND
                                        + 2 * COREHALFWORD (mSTREAMxPNTR)),
                          0)))
                // DO; (3247)
                {
                rs6s1s1s1:;
                  // NEXT_CHAR = BYTE(X1); (3248)
                  {
                    int32_t numberRHS = (int32_t)(BYTE1 (getCHARACTER (mX1)));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (8, mNEXT_CHAR, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // BLANK_COUNT = S_IND(PNTR); (3249)
                  {
                    descriptor_t *bitRHS = getBIT (
                        16, mSTREAMxS_IND + 2 * COREHALFWORD (mSTREAMxPNTR));
                    putBIT (16, mBLANK_COUNT, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // PNTR = PNTR + 1; (3250)
                  {
                    int32_t numberRHS
                        = (int32_t)(xadd (COREHALFWORD (mSTREAMxPNTR), 1));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mSTREAMxPNTR, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // ARROW = LAST_S_IND - S_IND(PNTR); (3251)
                  {
                    int32_t numberRHS = (int32_t)(xsubtract (
                        COREHALFWORD (mSTREAMxLAST_S_IND),
                        COREHALFWORD (mSTREAMxS_IND
                                      + 2 * COREHALFWORD (mSTREAMxPNTR))));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mSTREAMxARROW, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // LAST_S_IND = S_IND(PNTR); (3252)
                  {
                    descriptor_t *bitRHS = getBIT (
                        16, mSTREAMxS_IND + 2 * COREHALFWORD (mSTREAMxPNTR));
                    putBIT (16, mSTREAMxLAST_S_IND, bitRHS);
                    bitRHS->inUse = 0;
                  }
                es6s1s1s1:;
                } // End of DO block
            es6s1s1:;
            } // End of DO block
          // ELSE (3253)
          else
            // DO; (3254)
            {
            rs6s1s2:;
              // NEXT_CHAR = BYTE(S_STACK, PNTR); (3255)
              {
                int32_t numberRHS
                    = (int32_t)(BYTE (getCHARACTER (mSTREAMxS_STACK),
                                      COREHALFWORD (mSTREAMxPNTR)));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (8, mNEXT_CHAR, bitRHS);
                bitRHS->inUse = 0;
              }
              // ARROW = LAST_S_IND - S_IND(PNTR); (3256)
              {
                int32_t numberRHS = (int32_t)(xsubtract (
                    COREHALFWORD (mSTREAMxLAST_S_IND),
                    COREHALFWORD (mSTREAMxS_IND
                                  + 2 * COREHALFWORD (mSTREAMxPNTR))));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mSTREAMxARROW, bitRHS);
                bitRHS->inUse = 0;
              }
              // LAST_S_IND = S_IND(PNTR); (3257)
              {
                descriptor_t *bitRHS = getBIT (
                    16, mSTREAMxS_IND + 2 * COREHALFWORD (mSTREAMxPNTR));
                putBIT (16, mSTREAMxLAST_S_IND, bitRHS);
                bitRHS->inUse = 0;
              }
              // PNTR = PNTR + 1; (3258)
              {
                int32_t numberRHS
                    = (int32_t)(xadd (COREHALFWORD (mSTREAMxPNTR), 1));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mSTREAMxPNTR, bitRHS);
                bitRHS->inUse = 0;
              }
            es6s1s2:;
            } // End of DO block
          // GO TO FOUND_CHAR; (3259)
          goto FOUND_CHAR;
        es6s1:;
        } // End of DO block
      // ELSE (3260)
      else
        // DO; (3261)
        {
        rs6s2:;
          // RETURNING_S = FALSE; (3262)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxRETURNING_S, bitRHS);
            bitRHS->inUse = 0;
          }
          // RETURNING_E = TRUE; (3263)
          {
            int32_t numberRHS = (int32_t)(1);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxRETURNING_E, bitRHS);
            bitRHS->inUse = 0;
          }
          // LAST_E_IND = -LAST_S_IND; (3264)
          {
            int32_t numberRHS
                = (int32_t)(xminus (COREHALFWORD (mSTREAMxLAST_S_IND)));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxLAST_E_IND, bitRHS);
            bitRHS->inUse = 0;
          }
          // PNTR = 0; (3265)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxPNTR, bitRHS);
            bitRHS->inUse = 0;
          }
        es6s2:;
        } // End of DO block
    es6:;
    } // End of DO block
  // IF RETURNING_E THEN (3266)
  if (1 & (bitToFixed (getBIT (16, mSTREAMxRETURNING_E))))
    // DO; (3267)
    {
    rs7:;
      // IF LENGTH(E_STACK) > 0 & PNTR < LENGTH(E_STACK) THEN (3268)
      if (1
          & (xAND (xGT (LENGTH (getCHARACTER (mSTREAMxE_STACK)), 0),
                   xLT (COREHALFWORD (mSTREAMxPNTR),
                        LENGTH (getCHARACTER (mSTREAMxE_STACK))))))
        // DO; (3269)
        {
        rs7s1:;
          // IF BYTE(E_STACK, PNTR) = BYTE(X1) THEN (3270)
          if (1
              & (xEQ (BYTE (getCHARACTER (mSTREAMxE_STACK),
                            COREHALFWORD (mSTREAMxPNTR)),
                      BYTE1 (getCHARACTER (mX1)))))
            // DO; (3271)
            {
            rs7s1s1:;
              // IF E_IND(PNTR) >= 0 THEN (3272)
              if (1
                  & (xGE (COREHALFWORD (mSTREAMxE_IND
                                        + 2 * COREHALFWORD (mSTREAMxPNTR)),
                          0)))
                // DO; (3273)
                {
                rs7s1s1s1:;
                  // NEXT_CHAR = BYTE(X1); (3274)
                  {
                    int32_t numberRHS = (int32_t)(BYTE1 (getCHARACTER (mX1)));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (8, mNEXT_CHAR, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // BLANK_COUNT = E_IND(PNTR); (3275)
                  {
                    descriptor_t *bitRHS = getBIT (
                        16, mSTREAMxE_IND + 2 * COREHALFWORD (mSTREAMxPNTR));
                    putBIT (16, mBLANK_COUNT, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // PNTR = PNTR + 1; (3276)
                  {
                    int32_t numberRHS
                        = (int32_t)(xadd (COREHALFWORD (mSTREAMxPNTR), 1));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mSTREAMxPNTR, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // ARROW = E_IND(PNTR) - LAST_E_IND; (3277)
                  {
                    int32_t numberRHS = (int32_t)(xsubtract (
                        COREHALFWORD (mSTREAMxE_IND
                                      + 2 * COREHALFWORD (mSTREAMxPNTR)),
                        COREHALFWORD (mSTREAMxLAST_E_IND)));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mSTREAMxARROW, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // LAST_E_IND = E_IND(PNTR); (3278)
                  {
                    descriptor_t *bitRHS = getBIT (
                        16, mSTREAMxE_IND + 2 * COREHALFWORD (mSTREAMxPNTR));
                    putBIT (16, mSTREAMxLAST_E_IND, bitRHS);
                    bitRHS->inUse = 0;
                  }
                es7s1s1s1:;
                } // End of DO block
            es7s1s1:;
            } // End of DO block
          // ELSE (3279)
          else
            // DO; (3280)
            {
            rs7s1s2:;
              // NEXT_CHAR = BYTE(E_STACK, PNTR); (3281)
              {
                int32_t numberRHS
                    = (int32_t)(BYTE (getCHARACTER (mSTREAMxE_STACK),
                                      COREHALFWORD (mSTREAMxPNTR)));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (8, mNEXT_CHAR, bitRHS);
                bitRHS->inUse = 0;
              }
              // ARROW = E_IND(PNTR) - LAST_E_IND; (3282)
              {
                int32_t numberRHS = (int32_t)(xsubtract (
                    COREHALFWORD (mSTREAMxE_IND
                                  + 2 * COREHALFWORD (mSTREAMxPNTR)),
                    COREHALFWORD (mSTREAMxLAST_E_IND)));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mSTREAMxARROW, bitRHS);
                bitRHS->inUse = 0;
              }
              // LAST_E_IND = E_IND(PNTR); (3283)
              {
                descriptor_t *bitRHS = getBIT (
                    16, mSTREAMxE_IND + 2 * COREHALFWORD (mSTREAMxPNTR));
                putBIT (16, mSTREAMxLAST_E_IND, bitRHS);
                bitRHS->inUse = 0;
              }
              // PNTR = PNTR + 1; (3284)
              {
                int32_t numberRHS
                    = (int32_t)(xadd (COREHALFWORD (mSTREAMxPNTR), 1));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mSTREAMxPNTR, bitRHS);
                bitRHS->inUse = 0;
              }
            es7s1s2:;
            } // End of DO block
          // GO TO FOUND_CHAR; (3285)
          goto FOUND_CHAR;
        es7s1:;
        } // End of DO block
      // ELSE (3286)
      else
        // DO; (3287)
        {
        rs7s2:;
          // RETURNING_E = FALSE; (3288)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mSTREAMxRETURNING_E, bitRHS);
            bitRHS->inUse = 0;
          }
          // RETURNING_M = TRUE; (3289)
          {
            int32_t numberRHS = (int32_t)(1);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (8, mSTREAMxRETURNING_M, bitRHS);
            bitRHS->inUse = 0;
          }
        es7s2:;
        } // End of DO block
    es7:;
    } // End of DO block
  // GO TO BEGINNING; (3290)
  goto BEGINNING;
// FOUND_CHAR: (3291)
FOUND_CHAR:
  // IF ARROW ~= 0 THEN (3292)
  if (1 & (xNEQ (COREHALFWORD (mSTREAMxARROW), 0)))
    // DO; (3293)
    {
    rs8:;
      // OLD_LEVEL = NEW_LEVEL; (3294)
      {
        descriptor_t *bitRHS = getBIT (16, mNEW_LEVEL);
        putBIT (16, mOLD_LEVEL, bitRHS);
        bitRHS->inUse = 0;
      }
      // NEW_LEVEL = NEW_LEVEL + ARROW; (3295)
      {
        int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mNEW_LEVEL),
                                            COREHALFWORD (mSTREAMxARROW)));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mNEW_LEVEL, bitRHS);
        bitRHS->inUse = 0;
      }
      // SAVE_OVER_PUNCH1 = OVER_PUNCH; (3296)
      {
        descriptor_t *bitRHS = getBIT (8, mOVER_PUNCH);
        putBIT (8, mSTREAMxSAVE_OVER_PUNCH1, bitRHS);
        bitRHS->inUse = 0;
      }
      // SAVE_NEXT_CHAR1 = NEXT_CHAR; (3297)
      {
        descriptor_t *bitRHS = getBIT (8, mNEXT_CHAR);
        putBIT (8, mSTREAMxSAVE_NEXT_CHAR1, bitRHS);
        bitRHS->inUse = 0;
      }
      // SAVE_BLANK_COUNT1 = BLANK_COUNT; (3298)
      {
        descriptor_t *bitRHS = getBIT (16, mBLANK_COUNT);
        putBIT (16, mSTREAMxSAVE_BLANK_COUNT1, bitRHS);
        bitRHS->inUse = 0;
      }
      // IF OLD_LEVEL > 0 THEN (3299)
      if (1 & (xGT (COREHALFWORD (mOLD_LEVEL), 0)))
        // DO; (3300)
        {
        rs8s1:;
          // IF ARROW < 0 THEN (3301)
          if (1 & (xLT (COREHALFWORD (mSTREAMxARROW), 0)))
            // CALL STACK_RETURN_CHAR(-ARROW, BYTE(')')); (3302)
            {
              putBITp (16, mSTREAMxSTACK_RETURN_CHARxNUMBER,
                       fixedToBit (32, (int32_t)(xminus (
                                           COREHALFWORD (mSTREAMxARROW)))));
              putBITp (8, mSTREAMxSTACK_RETURN_CHARxCHAR,
                       fixedToBit (
                           32, (int32_t)(BYTE1 (cToDescriptor (NULL, ")")))));
              STREAMxSTACK_RETURN_CHAR (0);
            }
          // ELSE (3303)
          else
          // EXPONENT: (3304)
          EXPONENT:
          // DO; (3305)
          {
          rs8s1s1:;
            // IF ARROW > 1 THEN (3306)
            if (1 & (xGT (COREHALFWORD (mSTREAMxARROW), 1)))
              // CALL ERROR(CLASS_ME,2); (3307)
              {
                putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_ME));
                putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(2)));
                ERROR (0);
              }
            // CALL STACK_RETURN_CHAR(2, BYTE('*')); (3308)
            {
              putBITp (16, mSTREAMxSTACK_RETURN_CHARxNUMBER,
                       fixedToBit (32, (int32_t)(2)));
              putBITp (8, mSTREAMxSTACK_RETURN_CHARxCHAR,
                       fixedToBit (
                           32, (int32_t)(BYTE1 (cToDescriptor (NULL, "*")))));
              STREAMxSTACK_RETURN_CHAR (0);
            }
            // CALL STACK_RETURN_CHAR(ARROW, BYTE('(')); (3309)
            {
              putBITp (16, mSTREAMxSTACK_RETURN_CHARxNUMBER,
                       getBIT (16, mSTREAMxARROW));
              putBITp (8, mSTREAMxSTACK_RETURN_CHARxCHAR,
                       fixedToBit (
                           32, (int32_t)(BYTE1 (cToDescriptor (NULL, "(")))));
              STREAMxSTACK_RETURN_CHAR (0);
            }
          es8s1s1:;
          } // End of DO block
        es8s1:;
        } // End of DO block
      // ELSE (3310)
      else
        // IF OLD_LEVEL = 0 THEN (3311)
        if (1 & (xEQ (COREHALFWORD (mOLD_LEVEL), 0)))
          // DO; (3312)
          {
          rs8s2:;
            // IF ARROW < 0 THEN (3313)
            if (1 & (xLT (COREHALFWORD (mSTREAMxARROW), 0)))
            // SUBS: (3314)
            SUBS:
            // DO; (3315)
            {
            rs8s2s1:;
              // IF ARROW < -1 THEN (3316)
              if (1 & (xLT (COREHALFWORD (mSTREAMxARROW), -1)))
                // CALL ERROR(CLASS_MS,2); (3317)
                {
                  putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_MS));
                  putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(2)));
                  ERROR (0);
                }
              // CALL STACK_RETURN_CHAR(1, BYTE('$')); (3318)
              {
                putBITp (16, mSTREAMxSTACK_RETURN_CHARxNUMBER,
                         fixedToBit (32, (int32_t)(1)));
                putBITp (8, mSTREAMxSTACK_RETURN_CHARxCHAR,
                         fixedToBit (32, (int32_t)(BYTE1 (
                                             cToDescriptor (NULL, "$")))));
                STREAMxSTACK_RETURN_CHAR (0);
              }
              // CALL STACK_RETURN_CHAR(-ARROW, BYTE('(')); (3319)
              {
                putBITp (16, mSTREAMxSTACK_RETURN_CHARxNUMBER,
                         fixedToBit (32, (int32_t)(xminus (
                                             COREHALFWORD (mSTREAMxARROW)))));
                putBITp (8, mSTREAMxSTACK_RETURN_CHARxCHAR,
                         fixedToBit (32, (int32_t)(BYTE1 (
                                             cToDescriptor (NULL, "(")))));
                STREAMxSTACK_RETURN_CHAR (0);
              }
            es8s2s1:;
            } // End of DO block
            // ELSE (3320)
            else
                // GO TO EXPONENT; (3321)
                goto EXPONENT;
          es8s2:;
          } // End of DO block
        // ELSE (3322)
        else
          // DO; (3323)
          {
          rs8s3:;
            // IF ARROW < 0 THEN (3324)
            if (1 & (xLT (COREHALFWORD (mSTREAMxARROW), 0)))
              // GO TO SUBS; (3325)
              goto SUBS;
            // IF NEW_LEVEL <= 0 THEN (3326)
            if (1 & (xLE (COREHALFWORD (mNEW_LEVEL), 0)))
              // CALL STACK_RETURN_CHAR(ARROW, BYTE(')')); (3327)
              {
                putBITp (16, mSTREAMxSTACK_RETURN_CHARxNUMBER,
                         getBIT (16, mSTREAMxARROW));
                putBITp (8, mSTREAMxSTACK_RETURN_CHARxCHAR,
                         fixedToBit (32, (int32_t)(BYTE1 (
                                             cToDescriptor (NULL, ")")))));
                STREAMxSTACK_RETURN_CHAR (0);
              }
            // ELSE (3328)
            else
              // DO; (3329)
              {
              rs8s3s1:;
                // CALL STACK_RETURN_CHAR(-OLD_LEVEL, BYTE(')')); (3330)
                {
                  putBITp (16, mSTREAMxSTACK_RETURN_CHARxNUMBER,
                           fixedToBit (32, (int32_t)(xminus (
                                               COREHALFWORD (mOLD_LEVEL)))));
                  putBITp (8, mSTREAMxSTACK_RETURN_CHARxCHAR,
                           fixedToBit (32, (int32_t)(BYTE1 (
                                               cToDescriptor (NULL, ")")))));
                  STREAMxSTACK_RETURN_CHAR (0);
                }
                // IF NEW_LEVEL > 1 THEN (3331)
                if (1 & (xGT (COREHALFWORD (mNEW_LEVEL), 1)))
                  // CALL ERROR(CLASS_ME,2); (3332)
                  {
                    putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_ME));
                    putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(2)));
                    ERROR (0);
                  }
                // CALL STACK_RETURN_CHAR(2, BYTE('*')); (3333)
                {
                  putBITp (16, mSTREAMxSTACK_RETURN_CHARxNUMBER,
                           fixedToBit (32, (int32_t)(2)));
                  putBITp (8, mSTREAMxSTACK_RETURN_CHARxCHAR,
                           fixedToBit (32, (int32_t)(BYTE1 (
                                               cToDescriptor (NULL, "*")))));
                  STREAMxSTACK_RETURN_CHAR (0);
                }
                // CALL STACK_RETURN_CHAR(NEW_LEVEL, BYTE('(')); (3334)
                {
                  putBITp (16, mSTREAMxSTACK_RETURN_CHARxNUMBER,
                           getBIT (16, mNEW_LEVEL));
                  putBITp (8, mSTREAMxSTACK_RETURN_CHARxCHAR,
                           fixedToBit (32, (int32_t)(BYTE1 (
                                               cToDescriptor (NULL, "(")))));
                  STREAMxSTACK_RETURN_CHAR (0);
                }
              es8s3s1:;
              } // End of DO block
          es8s3:;
          } // End of DO block
      // ARROW = 0; (3335)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mSTREAMxARROW, bitRHS);
        bitRHS->inUse = 0;
      }
      // GO TO STACK_CHECK; (3336)
      goto STACK_CHECK;
    es8:;
    } // End of DO block
  // RETURN; (3337)
  {
    reentryGuard = 0;
    return 0;
  }
}
