/*
  File SCANxPUSH_MACRO.c generated by XCOM-I, 2024-08-08 04:33:34.
*/

#include "runtimeC.h"

int32_t
SCANxPUSH_MACRO (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "SCANxPUSH_MACRO");
  // SUPPRESS_THIS_TOKEN_ONLY = FALSE; (6821)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (1, mSUPPRESS_THIS_TOKEN_ONLY, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO WHILE NEXT_CHAR=BYTE(X1); (6822)
  while (1 & (xEQ (BYTE0 (mNEXT_CHAR), BYTE1 (getCHARACTER (mX1)))))
    {
      // CALL STREAM; (6823)
      STREAM (0);
    } // End of DO WHILE block
  // IF MACRO_EXPAN_LEVEL+1 > MACRO_EXPAN_LIMIT THEN (6824)
  if (1 & (xGT (xadd (COREHALFWORD (mMACRO_EXPAN_LEVEL), 1), 8)))
    // DO; (6825)
    {
    rs2:;
      // CALL ERROR(CLASS_IR,9,BCD); (6826)
      {
        putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_IR));
        putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(9)));
        putCHARACTERp (mERRORxTEXT, getCHARACTER (mBCD));
        ERROR (0);
      }
      // MACRO_EXPAN_LEVEL,PARM_EXPAN_LEVEL,MACRO_FOUND=0; (6827)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mMACRO_EXPAN_LEVEL, bitRHS);
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mPARM_EXPAN_LEVEL, bitRHS);
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (1, mMACRO_FOUND, bitRHS);
        bitRHS->inUse = 0;
      }
      // NEXT_CHAR=SAVE_NEXT_CHAR; (6828)
      {
        descriptor_t *bitRHS = getBIT (8, mSAVE_NEXT_CHAR);
        putBIT (8, mNEXT_CHAR, bitRHS);
        bitRHS->inUse = 0;
      }
      // OVER_PUNCH=SAVE_OVER_PUNCH; (6829)
      {
        descriptor_t *bitRHS = getBIT (8, mSAVE_OVER_PUNCH);
        putBIT (8, mOVER_PUNCH, bitRHS);
        bitRHS->inUse = 0;
      }
      // PRINTING_ENABLED=PRINT_FLAG; (6830)
      {
        descriptor_t *bitRHS = getBIT (16, mPRINT_FLAG);
        putBIT (16, mPRINTING_ENABLED, bitRHS);
        bitRHS->inUse = 0;
      }
      // RETURN; (6831)
      {
        reentryGuard = 0;
        return 0;
      }
    es2:;
    } // End of DO block
  // MACRO_EXPAN_STACK(MACRO_EXPAN_LEVEL+1) = SYT_INDEX; (6832)
  {
    int32_t numberRHS = (int32_t)(getFIXED (mSYT_INDEX));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16,
            mMACRO_EXPAN_STACK
                + 2 * (xadd (COREHALFWORD (mMACRO_EXPAN_LEVEL), 1)),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // IF PRINTING_ENABLED=PRINT_FLAG THEN (6833)
  if (1 & (xEQ (COREHALFWORD (mPRINTING_ENABLED), COREHALFWORD (mPRINT_FLAG))))
    // DO; (6834)
    {
    rs3:;
      // RESTORE=PRINT_FLAG; (6835)
      {
        descriptor_t *bitRHS = getBIT (16, mPRINT_FLAG);
        putBIT (16, mRESTORE, bitRHS);
        bitRHS->inUse = 0;
      }
      // IF FOUND_CENT THEN (6836)
      if (1 & (bitToFixed (getBIT (1, mFOUND_CENT))))
        // DO; (6837)
        {
        rs3s1:;
          // PASS=PRINT_FLAG; (6838)
          {
            descriptor_t *bitRHS = getBIT (16, mPRINT_FLAG);
            putBIT (16, mPASS, bitRHS);
            bitRHS->inUse = 0;
          }
          // PRINTING_ENABLED=0; (6839)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mPRINTING_ENABLED, bitRHS);
            bitRHS->inUse = 0;
          }
        es3s1:;
        } // End of DO block
      // ELSE (6840)
      else
        // PASS=0; (6841)
        {
          int32_t numberRHS = (int32_t)(0);
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (16, mPASS, bitRHS);
          bitRHS->inUse = 0;
        }
    es3:;
    } // End of DO block
  // ELSE (6842)
  else
    // RESTORE,PASS=0; (6843)
    {
      int32_t numberRHS = (int32_t)(0);
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mRESTORE, bitRHS);
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mPASS, bitRHS);
      bitRHS->inUse = 0;
    }
  // CALL SAVE_TOKEN(ID_TOKEN,BCD,7); (6844)
  {
    putBITp (16, mSAVE_TOKENxTOKEN,
             fixedToBit (32, (int32_t)(getFIXED (mID_TOKEN))));
    putCHARACTERp (mSAVE_TOKENxCHAR, getCHARACTER (mBCD));
    putBITp (16, mSAVE_TOKENxTYPE, fixedToBit (32, (int32_t)(7)));
    SAVE_TOKEN (0);
  }
  // GRAMMAR_FLAGS(STMT_PTR) = GRAMMAR_FLAGS(STMT_PTR) | MACRO_ARG_FLAG; (6845)
  {
    int32_t numberRHS = (int32_t)(xOR (
        COREHALFWORD (mGRAMMAR_FLAGS + 2 * COREHALFWORD (mSTMT_PTR)),
        COREHALFWORD (mMACRO_ARG_FLAG)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mGRAMMAR_FLAGS + 2 * (COREHALFWORD (mSTMT_PTR)), bitRHS);
    bitRHS->inUse = 0;
  }
  // NUM_OF_PARM(MACRO_EXPAN_LEVEL+1)= VAR_LENGTH(SYT_INDEX); (6846)
  {
    descriptor_t *bitRHS = getBIT (
        16, getFIXED (mSYM_TAB) + 34 * (getFIXED (mSYT_INDEX)) + 18 + 2 * (0));
    putBIT (16,
            mNUM_OF_PARM + 2 * (xadd (COREHALFWORD (mMACRO_EXPAN_LEVEL), 1)),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // CALL PARAMETER_PROCESSING; (6847)
  SCANxPARAMETER_PROCESSING (0);
  // PRINTING_ENABLED=PASS; (6848)
  {
    descriptor_t *bitRHS = getBIT (16, mPASS);
    putBIT (16, mPRINTING_ENABLED, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF TEMP_STRING = '' THEN (6849)
  if (1 & (xsEQ (getCHARACTER (mTEMP_STRING), cToDescriptor (NULL, ""))))
    // DO; (6850)
    {
    rs4:;
      // BASE_PARM_LEVEL(MACRO_EXPAN_LEVEL)=PARM_EXPAN_LEVEL; (6851)
      {
        descriptor_t *bitRHS = getBIT (16, mPARM_EXPAN_LEVEL);
        putBIT (16, mBASE_PARM_LEVEL + 2 * (COREHALFWORD (mMACRO_EXPAN_LEVEL)),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // M_TOKENS(MACRO_EXPAN_LEVEL)=0; (6852)
      {
        int32_t numberRHS = (int32_t)(0);
        putFIXED (mM_TOKENS + 4 * (COREHALFWORD (mMACRO_EXPAN_LEVEL)),
                  numberRHS);
      }
      // M_CENT(MACRO_EXPAN_LEVEL)=FOUND_CENT; (6853)
      {
        descriptor_t *bitRHS = getBIT (1, mFOUND_CENT);
        putBIT (8, mM_CENT + 1 * (COREHALFWORD (mMACRO_EXPAN_LEVEL)), bitRHS);
        bitRHS->inUse = 0;
      }
      // M_PRINT(MACRO_EXPAN_LEVEL)=RESTORE; (6854)
      {
        descriptor_t *bitRHS = getBIT (16, mRESTORE);
        putBIT (16, mM_PRINT + 2 * (COREHALFWORD (mMACRO_EXPAN_LEVEL)),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // FOUND_CENT=FALSE; (6855)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (1, mFOUND_CENT, bitRHS);
        bitRHS->inUse = 0;
      }
      // MACRO_POINT = SYT_ADDR(SYT_INDEX); (6856)
      {
        int32_t numberRHS = (int32_t)(getFIXED (
            getFIXED (mSYM_TAB) + 34 * (getFIXED (mSYT_INDEX)) + 4 + 4 * (0)));
        putFIXED (mMACRO_POINT, numberRHS);
      }
      // IF MACRO_EXPAN_LEVEL = 1 THEN (6857)
      if (1 & (xEQ (COREHALFWORD (mMACRO_EXPAN_LEVEL), 1)))
        // DO; (6858)
        {
        rs4s1:;
          // MACRO_FOUND = TRUE ; (6859)
          {
            int32_t numberRHS = (int32_t)(1);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (1, mMACRO_FOUND, bitRHS);
            bitRHS->inUse = 0;
          }
          // SAVE_NEXT_CHAR=NEXT_CHAR; (6860)
          {
            descriptor_t *bitRHS = getBIT (8, mNEXT_CHAR);
            putBIT (8, mSAVE_NEXT_CHAR, bitRHS);
            bitRHS->inUse = 0;
          }
          // SAVE_OVER_PUNCH = OVER_PUNCH; (6861)
          {
            descriptor_t *bitRHS = getBIT (8, mOVER_PUNCH);
            putBIT (8, mSAVE_OVER_PUNCH, bitRHS);
            bitRHS->inUse = 0;
          }
          // BLANK_COUNT,OVER_PUNCH=0; (6862)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mBLANK_COUNT, bitRHS);
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (8, mOVER_PUNCH, bitRHS);
            bitRHS->inUse = 0;
          }
        es4s1:;
        } // End of DO block
    es4:;
    } // End of DO block
  // ELSE (6863)
  else
    // FOUND_CENT=FALSE; (6864)
    {
      int32_t numberRHS = (int32_t)(0);
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (1, mFOUND_CENT, bitRHS);
      bitRHS->inUse = 0;
    }
  // CALL STREAM; (6865)
  STREAM (0);
  // RETURN; (6866)
  {
    reentryGuard = 0;
    return 0;
  }
}
