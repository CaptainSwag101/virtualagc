/*
  File GENERATExRETURN_STACK_ENTRYxRETURN_ENTRY.c generated by XCOM-I,
  2024-08-09 12:39:31.
*/

#include "runtimeC.h"

int32_t
GENERATExRETURN_STACK_ENTRYxRETURN_ENTRY (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard,
                               "GENERATExRETURN_STACK_ENTRYxRETURN_ENTRY");
  // IF PTR=0 THEN (2913)
  if (1
      & (xEQ (COREHALFWORD (mGENERATExRETURN_STACK_ENTRYxRETURN_ENTRYxPTR),
              0)))
    // RETURN; (2914)
    {
      reentryGuard = 0;
      return 0;
    }
  // IF (NR_STACK(PTR) >0) THEN (2915)
  if (1
      & (xGT (COREHALFWORD (
                  getFIXED (mIND_STACK)
                  + 73
                        * (COREHALFWORD (
                            mGENERATExRETURN_STACK_ENTRYxRETURN_ENTRYxPTR))
                  + 56 + 2 * (0)),
              0)))
    // DO; (2916)
    {
    rs1:;
      // SAVEPTR = SAVEPTR + 1; (2917)
      {
        int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mSAVEPTR), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mSAVEPTR, bitRHS);
        bitRHS->inUse = 0;
      }
      // SAVEPOINT(SAVEPTR) = NR_STACK(PTR); (2918)
      {
        descriptor_t *bitRHS = getBIT (
            16, getFIXED (mIND_STACK)
                    + 73
                          * (COREHALFWORD (
                              mGENERATExRETURN_STACK_ENTRYxRETURN_ENTRYxPTR))
                    + 56 + 2 * (0));
        putBIT (16, mSAVEPOINT + 2 * (COREHALFWORD (mSAVEPTR)), bitRHS);
        bitRHS->inUse = 0;
      }
    es1:;
    } // End of DO block
  // STACK_PTR(PTR) = STACK_PTR; (2919)
  {
    descriptor_t *bitRHS = getBIT (16, mSTACK_PTR);
    putBIT (16,
            mSTACK_PTR
                + 2
                      * (COREHALFWORD (
                          mGENERATExRETURN_STACK_ENTRYxRETURN_ENTRYxPTR)),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // STACK_PTR = PTR; (2920)
  {
    descriptor_t *bitRHS
        = getBIT (16, mGENERATExRETURN_STACK_ENTRYxRETURN_ENTRYxPTR);
    putBIT (16, mSTACK_PTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF STACK_DUMP THEN (2921)
  if (1 & (bitToFixed (getBIT (1, mSTACK_DUMP))))
    // CALL DUMP_STACK(PTR); (2922)
    {
      putBITp (16, mGENERATExDUMP_STACKxOP,
               getBIT (16, mGENERATExRETURN_STACK_ENTRYxRETURN_ENTRYxPTR));
      GENERATExDUMP_STACK (0);
    }
  // ELSE (2923)
  else
    // IF DIAGNOSTICS THEN (2924)
    if (1 & (bitToFixed (getBIT (1, mDIAGNOSTICS))))
      // OUTPUT = 'RET STACK ' || PTR; (2925)
      {
        descriptor_t *stringRHS;
        stringRHS
            = xsCAT (cToDescriptor (NULL, "RET STACK "),
                     bitToCharacter (getBIT (
                         16, mGENERATExRETURN_STACK_ENTRYxRETURN_ENTRYxPTR)));
        OUTPUT (0, stringRHS);
        stringRHS->inUse = 0;
      }
  {
    reentryGuard = 0;
    return 0;
  }
}
