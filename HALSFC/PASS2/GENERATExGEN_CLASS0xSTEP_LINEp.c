/*
  File GENERATExGEN_CLASS0xSTEP_LINEp.c generated by XCOM-I, 2024-08-08
  04:32:26.
*/

#include "runtimeC.h"

int32_t
GENERATExGEN_CLASS0xSTEP_LINEp (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GENERATExGEN_CLASS0xSTEP_LINEp");
  // IMRK_CTR = CTR + NUMOP + 1; (12257)
  {
    int32_t numberRHS = (int32_t)(xadd (
        xadd (COREHALFWORD (mCTR), COREHALFWORD (mNUMOP)), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mGENERATExGEN_CLASS0xSTEP_LINEpxIMRK_CTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // CALL OPDECODE(IMRK_CTR); (12258)
  {
    putBITp (16, mGENERATExGEN_CLASS0xSTEP_LINEpxOPDECODExCTR,
             getBIT (16, mGENERATExGEN_CLASS0xSTEP_LINEpxIMRK_CTR));
    GENERATExGEN_CLASS0xSTEP_LINEpxOPDECODE (0);
  }
  // DO WHILE OPRTR ~= XSMRK & OPRTR ~= XIMRK; (12259)
  while (1
         & (xAND (xNEQ (COREHALFWORD (mGENERATExGEN_CLASS0xSTEP_LINEpxOPRTR),
                        COREHALFWORD (mXSMRK)),
                  xNEQ (COREHALFWORD (mGENERATExGEN_CLASS0xSTEP_LINEpxOPRTR),
                        COREHALFWORD (mXIMRK)))))
    {
      // IMRK_CTR = IMRK_CTR + OPNUM + 1; (12260)
      {
        int32_t numberRHS = (int32_t)(xadd (
            xadd (COREHALFWORD (mGENERATExGEN_CLASS0xSTEP_LINEpxIMRK_CTR),
                  COREHALFWORD (mGENERATExGEN_CLASS0xSTEP_LINEpxOPNUM)),
            1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGENERATExGEN_CLASS0xSTEP_LINEpxIMRK_CTR, bitRHS);
        bitRHS->inUse = 0;
      }
      // CALL OPDECODE(IMRK_CTR); (12261)
      {
        putBITp (16, mGENERATExGEN_CLASS0xSTEP_LINEpxOPDECODExCTR,
                 getBIT (16, mGENERATExGEN_CLASS0xSTEP_LINEpxIMRK_CTR));
        GENERATExGEN_CLASS0xSTEP_LINEpxOPDECODE (0);
      }
    } // End of DO WHILE block
  // LINE# = SHR(OPR(IMRK_CTR+1), 16); (12262)
  {
    int32_t numberRHS = (int32_t)(SHR (
        getFIXED (getFIXED (mFOR_ATOMS)
                  + 4
                        * (xadd (COREHALFWORD (
                                     mGENERATExGEN_CLASS0xSTEP_LINEpxIMRK_CTR),
                                 1))
                  + 0 + 4 * (0)),
        16));
    putFIXED (mLINEp, numberRHS);
  }
  // IF ASSEMBLER_CODE THEN (12263)
  if (1 & (bitToFixed (getBIT (1, mASSEMBLER_CODE))))
    // OUTPUT = '*** HAL/S STATEMENT ' || LINE#; (12264)
    {
      descriptor_t *stringRHS;
      stringRHS = xsCAT (cToDescriptor (NULL, "*** HAL/S STATEMENT "),
                         fixedToCharacter (getFIXED (mLINEp)));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // CALL EMITC(STMTNO, LINE#); (12265)
  {
    putBITp (16, mEMITCxTYPE, getBIT (8, mSTMTNO));
    putBITp (16, mEMITCxINST, fixedToBit (32, (int32_t)(getFIXED (mLINEp))));
    EMITC (0);
  }
  // IF OPTAG > 0 THEN (12266)
  if (1 & (xGT (COREHALFWORD (mGENERATExGEN_CLASS0xSTEP_LINEpxOPTAG), 0)))
    // CALL ERRORS(CLASS_B,100); (12267)
    {
      putBITp (16, mERRORSxCLASS, getBIT (8, mCLASS_B));
      putBITp (16, mERRORSxNUM, fixedToBit (32, (int32_t)(100)));
      ERRORS (0);
    }
  {
    reentryGuard = 0;
    return 0;
  }
}
