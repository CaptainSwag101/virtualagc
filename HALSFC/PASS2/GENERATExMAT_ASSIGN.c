/*
  File GENERATExMAT_ASSIGN.c generated by XCOM-I, 2024-08-09 12:39:31.
*/

#include "runtimeC.h"

int32_t
GENERATExMAT_ASSIGN (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GENERATExMAT_ASSIGN");
  // NEED_TEMP = FALSE; (8997)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (1, mGENERATExMAT_ASSIGNxNEED_TEMP, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF VDLP_IN_EFFECT THEN (8998)
  if (1 & (bitToFixed (getBIT (1, mVDLP_IN_EFFECT))))
    // DO LHSPTR=2 TO NUMOP; (8999)
    {
      int32_t from97, to97, by97;
      from97 = 2;
      to97 = bitToFixed (getBIT (16, mNUMOP));
      by97 = 1;
      for (putBIT (16, mLHSPTR, fixedToBit (16, from97));
           bitToFixed (getBIT (16, mLHSPTR)) <= to97;
           putBIT (16, mLHSPTR,
                   fixedToBit (16, bitToFixed (getBIT (16, mLHSPTR)) + by97)))
        {
          // VDLP_ACTIVE = VDLP_ACTIVE | SHR(X_BITS(LHSPTR), 1); (9000)
          {
            int32_t numberRHS = (int32_t)(xOR (
                BYTE0 (mVDLP_ACTIVE),
                SHR (bitToFixed ((putBITp (16, mGENERATExX_BITSxOP,
                                           getBIT (16, mLHSPTR)),
                                  GENERATExX_BITS (0))),
                     1)));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (1, mVDLP_ACTIVE, bitRHS);
            bitRHS->inUse = 0;
          }
        }
    } // End of DO for-loop block
  // IF VDLP_ACTIVE THEN (9001)
  if (1 & (bitToFixed (getBIT (1, mVDLP_ACTIVE))))
    // CALL DO_ASSIGNMENT; (9002)
    GENERATExDO_ASSIGNMENT (0);
  // ELSE (9003)
  else
    // DO; (9004)
    {
    rs2:;
      // RIGHTOP = GET_OPERAND(1); (9005)
      {
        descriptor_t *bitRHS = (putBITp (16, mGENERATExGET_OPERANDxOP,
                                         fixedToBit (32, (int32_t)(1))),
                                GENERATExGET_OPERAND (0));
        putBIT (16, mRIGHTOP, bitRHS);
        bitRHS->inUse = 0;
      }
      // IF NUMOP > 2 THEN (9006)
      if (1 & (xGT (COREHALFWORD (mNUMOP), 2)))
        // RIGHTOP = CHECK_AGGREGATE_ASSIGN(RIGHTOP); (9007)
        {
          descriptor_t *bitRHS
              = (putBITp (16, mGENERATExCHECK_AGGREGATE_ASSIGNxOP,
                          getBIT (16, mRIGHTOP)),
                 GENERATExCHECK_AGGREGATE_ASSIGN (0));
          putBIT (16, mRIGHTOP, bitRHS);
          bitRHS->inUse = 0;
        }
      // IF SYMFORM( FORM(RIGHTOP) ) THEN (9008)
      if (1
          & (bitToFixed (getBIT (
              1, mSYMFORM
                     + 1
                           * COREHALFWORD (getFIXED (mIND_STACK)
                                           + 73 * (COREHALFWORD (mRIGHTOP))
                                           + 32 + 2 * (0))))))
        // IF (TAG_BITS(1)=VAC) | (SYT_FLAGS(LOC(RIGHTOP)) & PARM_FLAGS) ~= 0
        // THEN (9009)
        if (1
            & (xOR (xEQ (bitToFixed ((putBITp (16, mGENERATExTAG_BITSxOP,
                                               fixedToBit (32, (int32_t)(1))),
                                      GENERATExTAG_BITS (0))),
                         BYTE0 (mVAC)),
                    xNEQ (xAND (getFIXED (
                                    getFIXED (mSYM_TAB)
                                    + 34
                                          * (COREHALFWORD (
                                              getFIXED (mIND_STACK)
                                              + 73 * (COREHALFWORD (mRIGHTOP))
                                              + 40 + 2 * (0)))
                                    + 8 + 4 * (0)),
                                getFIXED (mPARM_FLAGS)),
                          0))))
          // DO; (9010)
          {
          rs2s1:;
            // TEMPOPER = MOD_GET_OPERAND(1); (9011)
            {
              descriptor_t *bitRHS
                  = (putBITp (16, mGENERATExMOD_GET_OPERANDxOP,
                              fixedToBit (32, (int32_t)(1))),
                     GENERATExMOD_GET_OPERAND (0));
              putBIT (16, mGENERATExMAT_ASSIGNxTEMPOPER, bitRHS);
              bitRHS->inUse = 0;
            }
            // IF NAME_OP_FLAG | SUBSTRUCT_FLAG THEN (9012)
            if (1
                & (xOR (BYTE0 (mGENERATExNAME_OP_FLAG),
                        BYTE0 (mGENERATExSUBSTRUCT_FLAG))))
              // NEED_TEMP = TRUE; (9013)
              {
                int32_t numberRHS = (int32_t)(1);
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (1, mGENERATExMAT_ASSIGNxNEED_TEMP, bitRHS);
                bitRHS->inUse = 0;
              }
            // IF ~VAC_FLAG THEN (9014)
            if (1 & (xNOT (BYTE0 (mGENERATExVAC_FLAG))))
              // CALL RETURN_STACK_ENTRY(TEMPOPER); (9015)
              {
                putBITp (16, mGENERATExRETURN_STACK_ENTRYxP,
                         getBIT (16, mGENERATExMAT_ASSIGNxTEMPOPER));
                GENERATExRETURN_STACK_ENTRY (0);
              }
            // STMT_PREC = (TYPE(RIGHTOP) & 8); (9016)
            {
              int32_t numberRHS = (int32_t)(xAND (
                  COREHALFWORD (getFIXED (mIND_STACK)
                                + 73 * (COREHALFWORD (mRIGHTOP)) + 50
                                + 2 * (0)),
                  8));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mGENERATExSTMT_PREC, bitRHS);
              bitRHS->inUse = 0;
            }
            // LHSPTR = 2; (9017)
            {
              int32_t numberRHS = (int32_t)(2);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mLHSPTR, bitRHS);
              bitRHS->inUse = 0;
            }
            // DO WHILE ~NEED_TEMP & (LHSPTR <= NUMOP); (9018)
            while (
                1
                & (xAND (xNOT (BYTE0 (mGENERATExMAT_ASSIGNxNEED_TEMP)),
                         xLE (COREHALFWORD (mLHSPTR), COREHALFWORD (mNUMOP)))))
              {
                // LEFTOP = MOD_GET_OPERAND(LHSPTR); (9019)
                {
                  descriptor_t *bitRHS
                      = (putBITp (16, mGENERATExMOD_GET_OPERANDxOP,
                                  getBIT (16, mLHSPTR)),
                         GENERATExMOD_GET_OPERAND (0));
                  putBIT (16, mLEFTOP, bitRHS);
                  bitRHS->inUse = 0;
                }
                // IF NAME_OP_FLAG | SUBSTRUCT_FLAG THEN (9020)
                if (1
                    & (xOR (BYTE0 (mGENERATExNAME_OP_FLAG),
                            BYTE0 (mGENERATExSUBSTRUCT_FLAG))))
                  // NEED_TEMP = TRUE; (9021)
                  {
                    int32_t numberRHS = (int32_t)(1);
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (1, mGENERATExMAT_ASSIGNxNEED_TEMP, bitRHS);
                    bitRHS->inUse = 0;
                  }
                // ELSE (9022)
                else
                  // IF VAC_FLAG THEN (9023)
                  if (1 & (bitToFixed (getBIT (1, mGENERATExVAC_FLAG))))
                    // DO; (9024)
                    {
                    rs2s1s1s1:;
                      // CALL GET_RECVR_INFO(LEFTOP); (9025)
                      {
                        putBITp (16, mGENERATExGET_RECVR_INFOxRECVR,
                                 getBIT (16, mLEFTOP));
                        GENERATExGET_RECVR_INFO (0);
                      }
                      // CALL IDENT_DISJOINT_CHECK(RIGHTOP,1); (9026)
                      {
                        putBITp (16, mGENERATExIDENT_DISJOINT_CHECKxOP,
                                 getBIT (16, mRIGHTOP));
                        putBITp (16, mGENERATExIDENT_DISJOINT_CHECKxN,
                                 fixedToBit (32, (int32_t)(1)));
                        GENERATExIDENT_DISJOINT_CHECK (0);
                      }
                      // IF ~LEFT_DISJOINT THEN (9027)
                      if (1 & (xNOT (BYTE0 (mGENERATExLEFT_DISJOINT))))
                        // NEED_TEMP = TRUE; (9028)
                        {
                          int32_t numberRHS = (int32_t)(1);
                          descriptor_t *bitRHS;
                          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                          putBIT (1, mGENERATExMAT_ASSIGNxNEED_TEMP, bitRHS);
                          bitRHS->inUse = 0;
                        }
                    es2s1s1s1:;
                    } // End of DO block
                // IF ~VAC_FLAG THEN (9029)
                if (1 & (xNOT (BYTE0 (mGENERATExVAC_FLAG))))
                  // CALL RETURN_STACK_ENTRY( LEFTOP ); (9030)
                  {
                    putBITp (16, mGENERATExRETURN_STACK_ENTRYxP,
                             getBIT (16, mLEFTOP));
                    GENERATExRETURN_STACK_ENTRY (0);
                  }
                // LHSPTR = LHSPTR + 1; (9031)
                {
                  int32_t numberRHS
                      = (int32_t)(xadd (COREHALFWORD (mLHSPTR), 1));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mLHSPTR, bitRHS);
                  bitRHS->inUse = 0;
                }
              } // End of DO WHILE block
            // IF NEED_TEMP THEN (9032)
            if (1 & (bitToFixed (getBIT (1, mGENERATExMAT_ASSIGNxNEED_TEMP))))
              // RIGHTOP = VECMAT_CONVERT( RIGHTOP ); (9033)
              {
                int32_t numberRHS
                    = (int32_t)((putBITp (16, mGENERATExVECMAT_CONVERTxOP,
                                          getBIT (16, mRIGHTOP)),
                                 GENERATExVECMAT_CONVERT (0)));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mRIGHTOP, bitRHS);
                bitRHS->inUse = 0;
              }
          es2s1:;
          } // End of DO block
      // CALL DROPSAVE(RIGHTOP); (9034)
      {
        putBITp (16, mGENERATExDROPSAVExENTRY, getBIT (16, mRIGHTOP));
        GENERATExDROPSAVE (0);
      }
      // DO LHSPTR = 2 TO NUMOP; (9035)
      {
        int32_t from98, to98, by98;
        from98 = 2;
        to98 = bitToFixed (getBIT (16, mNUMOP));
        by98 = 1;
        for (putBIT (16, mLHSPTR, fixedToBit (16, from98));
             bitToFixed (getBIT (16, mLHSPTR)) <= to98; putBIT (
                 16, mLHSPTR,
                 fixedToBit (16, bitToFixed (getBIT (16, mLHSPTR)) + by98)))
          {
            // LEFTOP = GET_OPERAND( LHSPTR ); (9036)
            {
              descriptor_t *bitRHS = (putBITp (16, mGENERATExGET_OPERANDxOP,
                                               getBIT (16, mLHSPTR)),
                                      GENERATExGET_OPERAND (0));
              putBIT (16, mLEFTOP, bitRHS);
              bitRHS->inUse = 0;
            }
            // CALL ASSIGN_CLEAR(LEFTOP, 1); (9037)
            {
              putBITp (16, mGENERATExASSIGN_CLEARxOP, getBIT (16, mLEFTOP));
              putBITp (1, mGENERATExASSIGN_CLEARxFLAG,
                       fixedToBit (32, (int32_t)(1)));
              GENERATExASSIGN_CLEAR (0);
            }
            // TEMPSPACE = ROW(LEFTOP) * COLUMN(LEFTOP); (9038)
            {
              int32_t numberRHS = (int32_t)(xmultiply (
                  COREHALFWORD (getFIXED (mIND_STACK)
                                + 73 * (COREHALFWORD (mLEFTOP)) + 48
                                + 2 * (0)),
                  COREHALFWORD (getFIXED (mIND_STACK)
                                + 73 * (COREHALFWORD (mLEFTOP)) + 24
                                + 2 * (0))));
              putFIXED (mTEMPSPACE, numberRHS);
            }
            // CALL VECMAT_ASSIGN(LEFTOP,RIGHTOP); (9039)
            {
              putBITp (16, mGENERATExVECMAT_ASSIGNxOP0, getBIT (16, mLEFTOP));
              putBITp (16, mGENERATExVECMAT_ASSIGNxOP1, getBIT (16, mRIGHTOP));
              GENERATExVECMAT_ASSIGN (0);
            }
            // CALL CLEAR_NAME_SAFE(LEFTOP); (9040)
            {
              putBITp (16, mGENERATExCLEAR_NAME_SAFExOP, getBIT (16, mLEFTOP));
              GENERATExCLEAR_NAME_SAFE (0);
            }
            // CALL RETURN_STACK_ENTRY(LEFTOP); (9041)
            {
              putBITp (16, mGENERATExRETURN_STACK_ENTRYxP,
                       getBIT (16, mLEFTOP));
              GENERATExRETURN_STACK_ENTRY (0);
            }
          }
      } // End of DO for-loop block
      // CALL RETURN_STACK_ENTRY(RIGHTOP); (9042)
      {
        putBITp (16, mGENERATExRETURN_STACK_ENTRYxP, getBIT (16, mRIGHTOP));
        GENERATExRETURN_STACK_ENTRY (0);
      }
    es2:;
    } // End of DO block
  {
    reentryGuard = 0;
    return 0;
  }
}
