/*
  File GENERATExARRAY_INDEX_MOD.c generated by XCOM-I, 2024-08-08 04:32:26.
*/

#include "runtimeC.h"

descriptor_t *
GENERATExARRAY_INDEX_MOD (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (descriptor_t *)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GENERATExARRAY_INDEX_MOD");
  // IF INDEX = 0 THEN (5678)
  if (1 & (xEQ (COREHALFWORD (mGENERATExARRAY_INDEX_MODxINDEX), 0)))
    // GO TO RETURN_OP; (5679)
    goto RETURN_OP;
  // IF SELF_ALIGNING THEN (5680)
  if (1 & (bitToFixed (getBIT (1, mSELF_ALIGNING))))
    // SHIFTCT = 0; (5681)
    {
      int32_t numberRHS = (int32_t)(0);
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mGENERATExARRAY_INDEX_MODxSHIFTCT, bitRHS);
      bitRHS->inUse = 0;
    }
  // IF OP = 0 THEN (5682)
  if (1 & (xEQ (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP), 0)))
    // DO; (5683)
    {
    rs1:;
      // OP = GET_STACK_ENTRY; (5684)
      {
        int32_t numberRHS = (int32_t)(GENERATExGET_STACK_ENTRY (0));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGENERATExARRAY_INDEX_MODxOP, bitRHS);
        bitRHS->inUse = 0;
      }
      // FORM(OP) = AIDX; (5685)
      {
        descriptor_t *bitRHS = getBIT (8, mAIDX);
        putBIT (16,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP)) + 32
                    + 2 * (0),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // LOC(OP) = INDEX; (5686)
      {
        descriptor_t *bitRHS = getBIT (16, mGENERATExARRAY_INDEX_MODxINDEX);
        putBIT (16,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP)) + 40
                    + 2 * (0),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // TYPE(OP) = INTEGER; (5687)
      {
        descriptor_t *bitRHS = getBIT (8, mINTEGER);
        putBIT (16,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP)) + 50
                    + 2 * (0),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // INX_SHIFT(OP) = SHIFTCT; (5688)
      {
        descriptor_t *bitRHS = getBIT (16, mGENERATExARRAY_INDEX_MODxSHIFTCT);
        putBIT (8,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP)) + 64
                    + 1 * (0),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // NEXT_USE(OP) = FORM(INDEX) = VAC; (5689)
      {
        int32_t numberRHS = (int32_t)(xEQ (
            COREHALFWORD (
                getFIXED (mIND_STACK)
                + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxINDEX)) + 32
                + 2 * (0)),
            BYTE0 (mVAC)));
        putBIT (16,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP)) + 44
                    + 2 * (0),
                fixedToBit (16, numberRHS));
      }
      // DO I = 0 TO SHIFTCT~=0; (5690)
      {
        int32_t from64, to64, by64;
        from64 = 0;
        to64 = xNEQ (COREHALFWORD (mGENERATExARRAY_INDEX_MODxSHIFTCT), 0);
        by64 = 1;
        for (putBIT (16, mGENERATExARRAY_INDEX_MODxI, fixedToBit (16, from64));
             bitToFixed (getBIT (16, mGENERATExARRAY_INDEX_MODxI)) <= to64;
             putBIT (16, mGENERATExARRAY_INDEX_MODxI,
                     fixedToBit (16, bitToFixed (getBIT (
                                         16, mGENERATExARRAY_INDEX_MODxI))
                                         + by64)))
          {
            // REG(OP) = SEARCH_REGS(OP); (5691)
            {
              int32_t numberRHS = (int32_t)((
                  putBITp (16, mGENERATExSEARCH_REGSxOP,
                           getBIT (16, mGENERATExARRAY_INDEX_MODxOP)),
                  GENERATExSEARCH_REGS (0)));
              putBIT (16,
                      getFIXED (mIND_STACK)
                          + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP))
                          + 46 + 2 * (0),
                      fixedToBit (16, numberRHS));
            }
            // IF REG(OP) >= 0 THEN (5692)
            if (1
                & (xGE (
                    COREHALFWORD (
                        getFIXED (mIND_STACK)
                        + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP))
                        + 46 + 2 * (0)),
                    0)))
              // DO; (5693)
              {
              rs1s1s1:;
                // CALL UPDATE_INX_USAGE(OP); (5694)
                {
                  putBITp (16, mGENERATExUPDATE_INX_USAGExOP,
                           getBIT (16, mGENERATExARRAY_INDEX_MODxOP));
                  GENERATExUPDATE_INX_USAGE (0);
                }
                // GO TO FOUND_AIDX; (5695)
                goto FOUND_AIDX;
              es1s1s1:;
              } // End of DO block
            // INX_SHIFT(OP) = 0; (5696)
            {
              int32_t numberRHS = (int32_t)(0);
              putBIT (8,
                      getFIXED (mIND_STACK)
                          + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP))
                          + 64 + 1 * (0),
                      fixedToBit (8, numberRHS));
            }
            // TO_BE_MODIFIED = TRUE; (5697)
            {
              int32_t numberRHS = (int32_t)(1);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (1, mGENERATExTO_BE_MODIFIED, bitRHS);
              bitRHS->inUse = 0;
            }
          }
      } // End of DO for-loop block
      // REG(OP) = FINDAC(INDEX_REG); (5698)
      {
        descriptor_t *bitRHS = (putBITp (16, mGENERATExFINDACxRCLASS,
                                         fixedToBit (32, (int32_t)(4))),
                                GENERATExFINDAC (0));
        putBIT (16,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP)) + 46
                    + 2 * (0),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // CALL EMITOP(LH, REG(OP), INDEX); (5699)
      {
        putBITp (16, mGENERATExEMITOPxINST, getBIT (8, mLH));
        putBITp (
            16, mGENERATExEMITOPxXREG,
            getBIT (16,
                    getFIXED (mIND_STACK)
                        + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP))
                        + 46 + 2 * (0)));
        putBITp (16, mGENERATExEMITOPxOP,
                 getBIT (16, mGENERATExARRAY_INDEX_MODxINDEX));
        GENERATExEMITOP (0);
      }
      // CALL SET_USAGE(REG(OP), AIDX, INDEX); (5700)
      {
        putBITp (
            16, mGENERATExSET_USAGExR,
            getBIT (16,
                    getFIXED (mIND_STACK)
                        + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP))
                        + 46 + 2 * (0)));
        putBITp (16, mGENERATExSET_USAGExRFORM, getBIT (8, mAIDX));
        putFIXED (mGENERATExSET_USAGExRVAR,
                  COREHALFWORD (mGENERATExARRAY_INDEX_MODxINDEX));
        GENERATExSET_USAGE (0);
      }
      // NEXT_USE(OP) = 0; (5701)
      {
        int32_t numberRHS = (int32_t)(0);
        putBIT (16,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP)) + 44
                    + 2 * (0),
                fixedToBit (16, numberRHS));
      }
    // FOUND_AIDX: (5702)
    FOUND_AIDX:
      // FORM(OP) = VAC; (5703)
      {
        descriptor_t *bitRHS = getBIT (8, mVAC);
        putBIT (16,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP)) + 32
                    + 2 * (0),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // LOC2(OP) = -1; (5704)
      {
        int32_t numberRHS = (int32_t)(-1);
        putBIT (16,
                getFIXED (mIND_STACK)
                    + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP)) + 42
                    + 2 * (0),
                fixedToBit (16, numberRHS));
      }
    es1:;
    } // End of DO block
  // ELSE (5705)
  else
    // DO; (5706)
    {
    rs2:;
      // INX_SHIFT(0) = 0; (5707)
      {
        int32_t numberRHS = (int32_t)(0);
        putBIT (8, getFIXED (mIND_STACK) + 73 * (0) + 64 + 1 * (0),
                fixedToBit (8, numberRHS));
      }
      // FORM(0) = AIDX; (5708)
      {
        descriptor_t *bitRHS = getBIT (8, mAIDX);
        putBIT (16, getFIXED (mIND_STACK) + 73 * (0) + 32 + 2 * (0), bitRHS);
        bitRHS->inUse = 0;
      }
      // LOC(0) = INDEX; (5709)
      {
        descriptor_t *bitRHS = getBIT (16, mGENERATExARRAY_INDEX_MODxINDEX);
        putBIT (16, getFIXED (mIND_STACK) + 73 * (0) + 40 + 2 * (0), bitRHS);
        bitRHS->inUse = 0;
      }
      // TYPE(0) = INTEGER; (5710)
      {
        descriptor_t *bitRHS = getBIT (8, mINTEGER);
        putBIT (16, getFIXED (mIND_STACK) + 73 * (0) + 50 + 2 * (0), bitRHS);
        bitRHS->inUse = 0;
      }
      // REG(0) = SEARCH_REGS(0); (5711)
      {
        int32_t numberRHS = (int32_t)((putBITp (16, mGENERATExSEARCH_REGSxOP,
                                                fixedToBit (32, (int32_t)(0))),
                                       GENERATExSEARCH_REGS (0)));
        putBIT (16, getFIXED (mIND_STACK) + 73 * (0) + 46 + 2 * (0),
                fixedToBit (16, numberRHS));
      }
      // IF REG(0) >= 0 THEN (5712)
      if (1
          & (xGE (
              COREHALFWORD (getFIXED (mIND_STACK) + 73 * (0) + 46 + 2 * (0)),
              0)))
        // CALL EMITRR(AR, REG(OP), REG(0)); (5713)
        {
          putBITp (16, mGENERATExEMITRRxINST, getBIT (8, mAR));
          putBITp (
              16, mGENERATExEMITRRxREG1,
              getBIT (16,
                      getFIXED (mIND_STACK)
                          + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP))
                          + 46 + 2 * (0)));
          putBITp (
              16, mGENERATExEMITRRxREG2,
              getBIT (16, getFIXED (mIND_STACK) + 73 * (0) + 46 + 2 * (0)));
          GENERATExEMITRR (0);
        }
      // ELSE (5714)
      else
        // CALL EMITOP(AH, REG(OP), INDEX); (5715)
        {
          putBITp (16, mGENERATExEMITOPxINST, getBIT (8, mAH));
          putBITp (
              16, mGENERATExEMITOPxXREG,
              getBIT (16,
                      getFIXED (mIND_STACK)
                          + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP))
                          + 46 + 2 * (0)));
          putBITp (16, mGENERATExEMITOPxOP,
                   getBIT (16, mGENERATExARRAY_INDEX_MODxINDEX));
          GENERATExEMITOP (0);
        }
      // CALL UNRECOGNIZABLE(REG(OP)); (5716)
      {
        putBITp (
            16, mGENERATExUNRECOGNIZABLExR,
            getBIT (16,
                    getFIXED (mIND_STACK)
                        + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP))
                        + 46 + 2 * (0)));
        GENERATExUNRECOGNIZABLE (0);
      }
      // IF NEXT_USE(OP) = 1 THEN (5717)
      if (1
          & (xEQ (COREHALFWORD (
                      getFIXED (mIND_STACK)
                      + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP)) + 44
                      + 2 * (0)),
                  1)))
        // NEXT_USE(OP) = 0; (5718)
        {
          int32_t numberRHS = (int32_t)(0);
          putBIT (16,
                  getFIXED (mIND_STACK)
                      + 73 * (COREHALFWORD (mGENERATExARRAY_INDEX_MODxOP)) + 44
                      + 2 * (0),
                  fixedToBit (16, numberRHS));
        }
    es2:;
    } // End of DO block
// RETURN_OP: (5719)
RETURN_OP:
  // TO_BE_MODIFIED, SHIFTCT = 0; (5720)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (1, mGENERATExTO_BE_MODIFIED, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mGENERATExARRAY_INDEX_MODxSHIFTCT, bitRHS);
    bitRHS->inUse = 0;
  }
  // RETURN OP; (5721)
  {
    reentryGuard = 0;
    return getBIT (16, mGENERATExARRAY_INDEX_MODxOP);
  }
}
