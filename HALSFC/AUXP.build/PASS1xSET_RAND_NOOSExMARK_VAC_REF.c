/*
  File PASS1xSET_RAND_NOOSExMARK_VAC_REF.c generated by XCOM-I, 2024-08-09
  12:39:13.
*/

#include "runtimeC.h"

int32_t
PASS1xSET_RAND_NOOSExMARK_VAC_REF (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard
      = guardReentry (reentryGuard, "PASS1xSET_RAND_NOOSExMARK_VAC_REF");
  // IF (FRAME_FLAGS(STACK_PTR) & ZAP_OR_FLUSH) ~= 0 THEN (1545)
  if (1
      & (xNEQ (xAND (BYTE0 (getFIXED (mSTACK_FRAME)
                            + 32 * (COREHALFWORD (mSTACK_PTR)) + 31 + 1 * (0)),
                     5),
               0)))
    // RETURN; (1546)
    {
      reentryGuard = 0;
      return 0;
    }
  // IF (FRAME_FLAGS(STACK_PTR) & PREV_BLOCK_FLAG) ~= 0 THEN (1547)
  if (1
      & (xNEQ (xAND (BYTE0 (getFIXED (mSTACK_FRAME)
                            + 32 * (COREHALFWORD (mSTACK_PTR)) + 31 + 1 * (0)),
                     2),
               0)))
    // DO; (1548)
    {
    rs1:;
      // IF FRAME_VAC_REF(STACK_PTR) = 0 THEN (1549)
      if (1
          & (xEQ (COREHALFWORD (getFIXED (mSTACK_FRAME)
                                + 32 * (COREHALFWORD (mSTACK_PTR)) + 12
                                + 2 * (0)),
                  0)))
        // FRAME_VAC_REF(STACK_PTR) = NEW_ZERO_VAC_REF_FRAME; (1550)
        {
          descriptor_t *bitRHS = NEW_ZERO_VAC_REF_FRAME (0);
          putBIT (16,
                  getFIXED (mSTACK_FRAME) + 32 * (COREHALFWORD (mSTACK_PTR))
                      + 12 + 2 * (0),
                  bitRHS);
          bitRHS->inUse = 0;
        }
    es1:;
    } // End of DO block
  // TEMP_PTR = FRAME_VAC_REF(STACK_PTR) + SHR(RAND, 5); (1551)
  {
    int32_t numberRHS = (int32_t)(xadd (
        COREHALFWORD (getFIXED (mSTACK_FRAME)
                      + 32 * (COREHALFWORD (mSTACK_PTR)) + 12 + 2 * (0)),
        SHR (COREHALFWORD (mPASS1xSET_RAND_NOOSExMARK_VAC_REFxRAND), 5)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mPASS1xSET_RAND_NOOSExMARK_VAC_REFxTEMP_PTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // VAC_REF_POOL(TEMP_PTR) = VAC_REF_POOL(TEMP_PTR) | MAP_INDICES(RAND &  31);
  // (1552)
  {
    int32_t numberRHS = (int32_t)(xOR (
        COREWORD (
            getFIXED (mV_POOL)
            + 4 * (COREHALFWORD (mPASS1xSET_RAND_NOOSExMARK_VAC_REFxTEMP_PTR))
            + 0 + 4 * (0)),
        getFIXED (mMAP_INDICES
                  + 4
                        * xAND (COREHALFWORD (
                                    mPASS1xSET_RAND_NOOSExMARK_VAC_REFxRAND),
                                31))));
    putBIT (
        32,
        getFIXED (mV_POOL)
            + 4 * (COREHALFWORD (mPASS1xSET_RAND_NOOSExMARK_VAC_REFxTEMP_PTR))
            + 0 + 4 * (0),
        fixedToBit (32, numberRHS));
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
