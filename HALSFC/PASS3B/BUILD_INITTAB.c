/*
  File BUILD_INITTAB.c generated by XCOM-I, 2024-08-09 12:42:16.
*/

#include "runtimeC.h"

int32_t
BUILD_INITTAB (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "BUILD_INITTAB");
  // INIT_TOP = RECORD_TOP(INIT_TAB); (1363)
  {
    int32_t numberRHS = (int32_t)(xsubtract (
        COREWORD (xadd (ADDR ("INIT_TAB", 0x80000000, NULL, 0), 12)), 1));
    putFIXED (mBUILD_INITTABxINIT_TOP, numberRHS);
  }
  // FIRST#D_PAGE = LAST_PAGE+1; (1364)
  {
    int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mLAST_PAGE), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mFIRSTpD_PAGE, bitRHS);
    bitRHS->inUse = 0;
  }
  // INITIAL_TAB,PTR = SHL((FIRST#D_PAGE),16); (1365)
  {
    int32_t numberRHS = (int32_t)(SHL (COREHALFWORD (mFIRSTpD_PAGE), 16));
    putFIXED (mBUILD_INITTABxINITIAL_TAB, numberRHS);
    putFIXED (mBUILD_INITTABxPTR, numberRHS);
  }
  // CALL P3_LOCATE(ROOT_PTR,ADDR(DIR_NODE),MODF); (1366)
  {
    putFIXED (mP3_LOCATExPTR, getFIXED (mROOT_PTR));
    putFIXED (mP3_LOCATExBVAR,
              ADDR ("BUILD_INITTABxDIR_NODE", 0x80000000, NULL, 0));
    putBITp (8, mP3_LOCATExFLAGS, getBIT (8, mMODF));
    P3_LOCATE (0);
  }
  // DIR_NODE(INIT_PTR) = INITIAL_TAB; (1367)
  {
    int32_t numberRHS = (int32_t)(getFIXED (mBUILD_INITTABxINITIAL_TAB));
    putFIXED (getFIXED (mBUILD_INITTABxDIR_NODE) + 4 * (39), numberRHS);
  }
  // DIR_NODE(INIT_PTR+1) = INIT_TOP+1; (1368)
  {
    int32_t numberRHS
        = (int32_t)(xadd (getFIXED (mBUILD_INITTABxINIT_TOP), 1));
    putFIXED (getFIXED (mBUILD_INITTABxDIR_NODE) + 4 * (40), numberRHS);
  }
  // CALL P3_PTR_LOCATE(INITIAL_TAB,RESV|MODF); (1369)
  {
    putFIXED (mP3_PTR_LOCATExPTR, getFIXED (mBUILD_INITTABxINITIAL_TAB));
    putBITp (8, mP3_PTR_LOCATExFLAGS,
             fixedToBit (32, (int32_t)(xOR (BYTE0 (mRESV), BYTE0 (mMODF)))));
    P3_PTR_LOCATE (0);
  }
  // COREWORD(ADDR(NODE_H)) = LOC_ADDR; (1370)
  {
    int32_t numberRHS = (int32_t)(getFIXED (mLOC_ADDR));
    COREWORD2 (ADDR ("BUILD_INITTABxNODE_H", 0x80000000, NULL, 0), numberRHS);
  }
  // INIT_TAB_INDEX = 0; (1371)
  {
    int32_t numberRHS = (int32_t)(0);
    putFIXED (mBUILD_INITTABxINIT_TAB_INDEX, numberRHS);
  }
  // DO I = 0 TO INIT_TOP; (1372)
  {
    int32_t from33, to33, by33;
    from33 = 0;
    to33 = getFIXED (mBUILD_INITTABxINIT_TOP);
    by33 = 1;
    for (putFIXED (mBUILD_INITTABxI, from33);
         getFIXED (mBUILD_INITTABxI) <= to33;
         putFIXED (mBUILD_INITTABxI, getFIXED (mBUILD_INITTABxI) + by33))
      {
        // IF INIT_TAB_INDEX >= PAGE_SIZE/2 THEN (1373)
        if (1 & (xGE (getFIXED (mBUILD_INITTABxINIT_TAB_INDEX), 840)))
          // DO; (1374)
          {
          rs1s1:;
            // CALL P3_PTR_LOCATE(PTR,RELS); (1375)
            {
              putFIXED (mP3_PTR_LOCATExPTR, getFIXED (mBUILD_INITTABxPTR));
              putBITp (8, mP3_PTR_LOCATExFLAGS, getBIT (8, mRELS));
              P3_PTR_LOCATE (0);
            }
            // PTR = PTR+ 65536; (1376)
            {
              int32_t numberRHS
                  = (int32_t)(xadd (getFIXED (mBUILD_INITTABxPTR), 65536));
              putFIXED (mBUILD_INITTABxPTR, numberRHS);
            }
            // CALL P3_PTR_LOCATE(PTR,RESV|MODF); (1377)
            {
              putFIXED (mP3_PTR_LOCATExPTR, getFIXED (mBUILD_INITTABxPTR));
              putBITp (8, mP3_PTR_LOCATExFLAGS,
                       fixedToBit (
                           32, (int32_t)(xOR (BYTE0 (mRESV), BYTE0 (mMODF)))));
              P3_PTR_LOCATE (0);
            }
            // COREWORD(ADDR(NODE_H)) = LOC_ADDR; (1378)
            {
              int32_t numberRHS = (int32_t)(getFIXED (mLOC_ADDR));
              COREWORD2 (ADDR ("BUILD_INITTABxNODE_H", 0x80000000, NULL, 0),
                         numberRHS);
            }
            // INIT_TAB_INDEX = 0; (1379)
            {
              int32_t numberRHS = (int32_t)(0);
              putFIXED (mBUILD_INITTABxINIT_TAB_INDEX, numberRHS);
            }
          es1s1:;
          } // End of DO block
        // NODE_H(INIT_TAB_INDEX) = INIT_VAL(I); (1380)
        {
          descriptor_t *bitRHS = getBIT (
              16, getFIXED (mINIT_TAB) + 2 * (getFIXED (mBUILD_INITTABxI)) + 0
                      + 2 * (0));
          putBIT (16,
                  getFIXED (mBUILD_INITTABxNODE_H)
                      + 2 * (getFIXED (mBUILD_INITTABxINIT_TAB_INDEX)),
                  bitRHS);
          bitRHS->inUse = 0;
        }
        // INIT_TAB_INDEX = INIT_TAB_INDEX + 1; (1381)
        {
          int32_t numberRHS
              = (int32_t)(xadd (getFIXED (mBUILD_INITTABxINIT_TAB_INDEX), 1));
          putFIXED (mBUILD_INITTABxINIT_TAB_INDEX, numberRHS);
        }
      }
  } // End of DO for-loop block
  // CALL P3_PTR_LOCATE(PTR,RELS); (1382)
  {
    putFIXED (mP3_PTR_LOCATExPTR, getFIXED (mBUILD_INITTABxPTR));
    putBITp (8, mP3_PTR_LOCATExFLAGS, getBIT (8, mRELS));
    P3_PTR_LOCATE (0);
  }
  // #D_FREE_SPACE = PAGE_SIZE - (INIT_TAB_INDEX * 2); (1383)
  {
    int32_t numberRHS = (int32_t)(xsubtract (
        1680, xmultiply (getFIXED (mBUILD_INITTABxINIT_TAB_INDEX), 2)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mpD_FREE_SPACE, bitRHS);
    bitRHS->inUse = 0;
  }
  // RECORD_FREE(INIT_TAB); (1384)
  {
    putFIXED (m_RECORD_FREExDOPE, ADDR ("INIT_TAB", 0x80000000, NULL, 0));
    _RECORD_FREE (0);
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
