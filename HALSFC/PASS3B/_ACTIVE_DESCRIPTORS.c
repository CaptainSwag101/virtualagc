/*
  File _ACTIVE_DESCRIPTORS.c generated by XCOM-I, 2024-08-09 12:42:16.
*/

#include "runtimeC.h"

int32_t
_ACTIVE_DESCRIPTORS (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "_ACTIVE_DESCRIPTORS");
  // ANS=0; (116)
  {
    int32_t numberRHS = (int32_t)(0);
    putFIXED (m_ACTIVE_DESCRIPTORSxANS, numberRHS);
  }
  // IF (_DOPE_USED(DOPE) = 0) | (_DOPE_#DESCRIPTORS(DOPE)=0) THEN (117)
  if (1
      & (xOR (
          xEQ (COREWORD (xadd (getFIXED (m_ACTIVE_DESCRIPTORSxDOPE), 12)), 0),
          xEQ (COREHALFWORD (xadd (getFIXED (m_ACTIVE_DESCRIPTORSxDOPE), 6)),
               0))))
    // RETURN 0; (118)
    {
      reentryGuard = 0;
      return 0;
    }
  // DW=_DOPE_WIDTH(DOPE); (119)
  {
    int32_t numberRHS = (int32_t)(COREHALFWORD (
        xadd (getFIXED (m_ACTIVE_DESCRIPTORSxDOPE), 4)));
    putFIXED (m_ACTIVE_DESCRIPTORSxDW, numberRHS);
  }
  // DND=SHL(_DOPE_#DESCRIPTORS(DOPE),2); (120)
  {
    int32_t numberRHS = (int32_t)(SHL (
        COREHALFWORD (xadd (getFIXED (m_ACTIVE_DESCRIPTORSxDOPE), 6)), 2));
    putFIXED (m_ACTIVE_DESCRIPTORSxDND, numberRHS);
  }
  // DP=_DOPE_POINTER(DOPE); (121)
  {
    int32_t numberRHS
        = (int32_t)(COREWORD (getFIXED (m_ACTIVE_DESCRIPTORSxDOPE)));
    putFIXED (m_ACTIVE_DESCRIPTORSxDP, numberRHS);
  }
  // DLAST=DP+(DW*(_DOPE_USED(DOPE)-1)); (122)
  {
    int32_t numberRHS = (int32_t)(xadd (
        getFIXED (m_ACTIVE_DESCRIPTORSxDP),
        xmultiply (getFIXED (m_ACTIVE_DESCRIPTORSxDW),
                   xsubtract (COREWORD (xadd (
                                  getFIXED (m_ACTIVE_DESCRIPTORSxDOPE), 12)),
                              1))));
    putFIXED (m_ACTIVE_DESCRIPTORSxDLAST, numberRHS);
  }
  // DO I=DP TO DLAST BY DW; (123)
  {
    int32_t from4, to4, by4;
    from4 = getFIXED (m_ACTIVE_DESCRIPTORSxDP);
    to4 = getFIXED (m_ACTIVE_DESCRIPTORSxDLAST);
    by4 = getFIXED (m_ACTIVE_DESCRIPTORSxDW);
    for (putFIXED (m_ACTIVE_DESCRIPTORSxI, from4);
         getFIXED (m_ACTIVE_DESCRIPTORSxI) <= to4; putFIXED (
             m_ACTIVE_DESCRIPTORSxI, getFIXED (m_ACTIVE_DESCRIPTORSxI) + by4))
      {
        // DO J=I TO I+DND-4 BY 4; (124)
        {
          int32_t from5, to5, by5;
          from5 = getFIXED (m_ACTIVE_DESCRIPTORSxI);
          to5 = xsubtract (xadd (getFIXED (m_ACTIVE_DESCRIPTORSxI),
                                 getFIXED (m_ACTIVE_DESCRIPTORSxDND)),
                           4);
          by5 = 4;
          for (putFIXED (m_ACTIVE_DESCRIPTORSxJ, from5);
               getFIXED (m_ACTIVE_DESCRIPTORSxJ) <= to5;
               putFIXED (m_ACTIVE_DESCRIPTORSxJ,
                         getFIXED (m_ACTIVE_DESCRIPTORSxJ) + by5))
            {
              // IF COREWORD(J) ~= 0 THEN (125)
              if (1 & (xNEQ (COREWORD (getFIXED (m_ACTIVE_DESCRIPTORSxJ)), 0)))
                // ANS=ANS+1; (126)
                {
                  int32_t numberRHS = (int32_t)(xadd (
                      getFIXED (m_ACTIVE_DESCRIPTORSxANS), 1));
                  putFIXED (m_ACTIVE_DESCRIPTORSxANS, numberRHS);
                }
            }
        } // End of DO for-loop block
      }
  } // End of DO for-loop block
  // RETURN ANS; (127)
  {
    reentryGuard = 0;
    return getFIXED (m_ACTIVE_DESCRIPTORSxANS);
  }
}
