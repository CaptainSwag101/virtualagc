/*
  File INITIALIZExTRAVERSE.c generated by XCOM-I, 2024-08-09 12:42:16.
*/

#include "runtimeC.h"

int32_t
INITIALIZExTRAVERSE (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "INITIALIZExTRAVERSE");
  // LINK = OP1; (2440)
  {
    descriptor_t *bitRHS = getBIT (16, mOP1);
    putBIT (16, mINITIALIZExTRAVERSExLINK, bitRHS);
    bitRHS->inUse = 0;
  }
  // STACK_INX = 0; (2441)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mINITIALIZExTRAVERSExSTACK_INX, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF PSEUDO_TPL_FLAG THEN (2442)
  if (1 & (bitToFixed (getBIT (1, mPSEUDO_TPL_FLAG))))
    // DO; (2443)
    {
    rs1:;
      // TEMP = LINK; (2444)
      {
        descriptor_t *bitRHS = getBIT (16, mINITIALIZExTRAVERSExLINK);
        putBIT (16, mINITIALIZExTRAVERSExTEMP, bitRHS);
        bitRHS->inUse = 0;
      }
      // GO TO ALT_ENTRY; (2445)
      goto ALT_ENTRY;
    es1:;
    } // End of DO block
  // ELSE (2446)
  else
    // SYT_LINK1(LINK) = 0; (2447)
    {
      int32_t numberRHS = (int32_t)(0);
      putBIT (16,
              getFIXED (mSYM_TAB)
                  + 34 * (COREHALFWORD (mINITIALIZExTRAVERSExLINK)) + 24
                  + 2 * (0),
              fixedToBit (16, numberRHS));
    }
  // DO FOREVER; (2448)
  while (1 & (1))
    {
      // IF SYT_LINK1(LINK) ~= 0 THEN (2449)
      if (1
          & (xNEQ (
              COREHALFWORD (getFIXED (mSYM_TAB)
                            + 34 * (COREHALFWORD (mINITIALIZExTRAVERSExLINK))
                            + 24 + 2 * (0)),
              0)))
        // LINK = SYT_LINK1(LINK); (2450)
        {
          descriptor_t *bitRHS = getBIT (
              16, getFIXED (mSYM_TAB)
                      + 34 * (COREHALFWORD (mINITIALIZExTRAVERSExLINK)) + 24
                      + 2 * (0));
          putBIT (16, mINITIALIZExTRAVERSExLINK, bitRHS);
          bitRHS->inUse = 0;
        }
      // ELSE (2451)
      else
        // IF SYT_TYPE(LINK) = STRUCTURE THEN (2452)
        if (1
            & (xEQ (BYTE0 (getFIXED (mSYM_TAB)
                           + 34 * (COREHALFWORD (mINITIALIZExTRAVERSExLINK))
                           + 32 + 1 * (0)),
                    COREHALFWORD (mSTRUCTURE))))
          // DO; (2453)
          {
          rs2s1:;
            // TEMP = SYT_DIMS(LINK); (2454)
            {
              descriptor_t *bitRHS = getBIT (
                  16, getFIXED (mSYM_TAB)
                          + 34 * (COREHALFWORD (mINITIALIZExTRAVERSExLINK))
                          + 18 + 2 * (0));
              putBIT (16, mINITIALIZExTRAVERSExTEMP, bitRHS);
              bitRHS->inUse = 0;
            }
          // ALT_ENTRY: (2455)
          ALT_ENTRY:
            // DO I = 0 TO #TPLS2 - 1; (2456)
            {
              int32_t from76, to76, by76;
              from76 = 0;
              to76 = xsubtract (COREHALFWORD (mpTPLS2), 1);
              by76 = 1;
              for (putBIT (16, mINITIALIZExTRAVERSExI,
                           fixedToBit (16, from76));
                   bitToFixed (getBIT (16, mINITIALIZExTRAVERSExI)) <= to76;
                   putBIT (16, mINITIALIZExTRAVERSExI,
                           fixedToBit (16, bitToFixed (getBIT (
                                               16, mINITIALIZExTRAVERSExI))
                                               + by76)))
                {
                  // IF TPL_TAB2(I) = TEMP THEN (2457)
                  if (1
                      & (xEQ (COREHALFWORD (
                                  mTPL_TAB2
                                  + 2 * COREHALFWORD (mINITIALIZExTRAVERSExI)),
                              COREHALFWORD (mINITIALIZExTRAVERSExTEMP))))
                    // DO; (2458)
                    {
                    rs2s1s1s1:;
                      // IF STACK_INX = 0 THEN (2459)
                      if (1
                          & (xEQ (
                              COREHALFWORD (mINITIALIZExTRAVERSExSTACK_INX),
                              0)))
                        // RETURN; (2460)
                        {
                          reentryGuard = 0;
                          return 0;
                        }
                      // ELSE (2461)
                      else
                        // GO TO BROTHER; (2462)
                        goto BROTHER;
                    es2s1s1s1:;
                    } // End of DO block
                  if (0)
                    {
                    rs2s1s1:
                      continue;
                    es2s1s1:
                      break;
                    } // loop of block labeled ALT_ENTRY
                }
            } // End of DO for-loop block
            // TPL_STACK(STACK_INX) = LINK; (2463)
            {
              descriptor_t *bitRHS = getBIT (16, mINITIALIZExTRAVERSExLINK);
              putBIT (
                  16,
                  mTPL_STACK
                      + 2 * (COREHALFWORD (mINITIALIZExTRAVERSExSTACK_INX)),
                  bitRHS);
              bitRHS->inUse = 0;
            }
            // STACK_INX = STACK_INX + 1; (2464)
            {
              int32_t numberRHS = (int32_t)(xadd (
                  COREHALFWORD (mINITIALIZExTRAVERSExSTACK_INX), 1));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mINITIALIZExTRAVERSExSTACK_INX, bitRHS);
              bitRHS->inUse = 0;
            }
            // IF STACK_INX > STRUC_NEST THEN (2465)
            if (1 & (xGT (COREHALFWORD (mINITIALIZExTRAVERSExSTACK_INX), 100)))
              // DO; (2466)
              {
              rs2s1s2:;
                // OUTPUT = X1; (2467)
                {
                  descriptor_t *stringRHS;
                  stringRHS = getCHARACTER (mX1);
                  OUTPUT (0, stringRHS);
                  stringRHS->inUse = 0;
                }
                // OUTPUT = P3ERR || 'STRUCTURE TRAVERSAL STACK LIMIT EXCEEDED
                // ***'; (2468)
                {
                  descriptor_t *stringRHS;
                  stringRHS = xsCAT (
                      getCHARACTER (mP3ERR),
                      cToDescriptor (
                          NULL,
                          "STRUCTURE TRAVERSAL STACK LIMIT EXCEEDED ***"));
                  OUTPUT (0, stringRHS);
                  stringRHS->inUse = 0;
                }
                // OUTPUT = X1; (2469)
                {
                  descriptor_t *stringRHS;
                  stringRHS = getCHARACTER (mX1);
                  OUTPUT (0, stringRHS);
                  stringRHS->inUse = 0;
                }
                // OUTPUT = '  TPL_STACK CONTENTS:'; (2470)
                {
                  descriptor_t *stringRHS;
                  stringRHS = cToDescriptor (NULL, "  TPL_STACK CONTENTS:");
                  OUTPUT (0, stringRHS);
                  stringRHS->inUse = 0;
                }
                // OUTPUT = X1; (2471)
                {
                  descriptor_t *stringRHS;
                  stringRHS = getCHARACTER (mX1);
                  OUTPUT (0, stringRHS);
                  stringRHS->inUse = 0;
                }
                // DO I = 0 TO STRUC_NEST; (2472)
                {
                  int32_t from77, to77, by77;
                  from77 = 0;
                  to77 = 100;
                  by77 = 1;
                  for (putBIT (16, mINITIALIZExTRAVERSExI,
                               fixedToBit (16, from77));
                       bitToFixed (getBIT (16, mINITIALIZExTRAVERSExI))
                       <= to77;
                       putBIT (16, mINITIALIZExTRAVERSExI,
                               fixedToBit (16, bitToFixed (getBIT (
                                                   16, mINITIALIZExTRAVERSExI))
                                                   + by77)))
                    {
                      // OUTPUT = I || X3 || TPL_STACK(I) || X3 ||
                      // SYT_NAME(TPL_STACK(I)); (2473)
                      {
                        descriptor_t *stringRHS;
                        stringRHS = xsCAT (
                            xsCAT (
                                xsCAT (
                                    xsCAT (bitToCharacter (getBIT (
                                               16, mINITIALIZExTRAVERSExI)),
                                           getCHARACTER (mX3)),
                                    bitToCharacter (getBIT (
                                        16,
                                        mTPL_STACK
                                            + 2
                                                  * COREHALFWORD (
                                                      mINITIALIZExTRAVERSExI)))),
                                getCHARACTER (mX3)),
                            getCHARACTER (
                                getFIXED (mSYM_TAB)
                                + 34
                                      * (COREHALFWORD (
                                          mTPL_STACK
                                          + 2
                                                * COREHALFWORD (
                                                    mINITIALIZExTRAVERSExI)))
                                + 0 + 4 * (0)));
                        OUTPUT (0, stringRHS);
                        stringRHS->inUse = 0;
                      }
                    }
                } // End of DO for-loop block
                // GO TO COMMON_ERROR; (2474)
                {
                  resetAllReentryGuards ();
                  longjmp (jbCOMMON_ERROR, 1);
                }
              es2s1s2:;
              } // End of DO block
            // LINK = TEMP; (2475)
            {
              descriptor_t *bitRHS = getBIT (16, mINITIALIZExTRAVERSExTEMP);
              putBIT (16, mINITIALIZExTRAVERSExLINK, bitRHS);
              bitRHS->inUse = 0;
            }
            // TPL_TAB2(#TPLS2) = LINK; (2476)
            {
              descriptor_t *bitRHS = getBIT (16, mINITIALIZExTRAVERSExLINK);
              putBIT (16, mTPL_TAB2 + 2 * (COREHALFWORD (mpTPLS2)), bitRHS);
              bitRHS->inUse = 0;
            }
            // #TPLS2 = #TPLS2 + 1; (2477)
            {
              int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mpTPLS2), 1));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mpTPLS2, bitRHS);
              bitRHS->inUse = 0;
            }
          es2s1:;
          } // End of DO block
        // ELSE (2478)
        else
          // DO; (2479)
          {
          rs2s2:;
          // BROTHER: (2480)
          BROTHER:
            // LINK = SYT_LINK2(LINK); (2481)
            {
              descriptor_t *bitRHS = getBIT (
                  16, getFIXED (mSYM_TAB)
                          + 34 * (COREHALFWORD (mINITIALIZExTRAVERSExLINK))
                          + 26 + 2 * (0));
              putBIT (16, mINITIALIZExTRAVERSExLINK, bitRHS);
              bitRHS->inUse = 0;
            }
            // DO WHILE LINK < 0; (2482)
            while (1 & (xLT (COREHALFWORD (mINITIALIZExTRAVERSExLINK), 0)))
              {
                // LINK = SYT_LINK2(-LINK); (2483)
                {
                  descriptor_t *bitRHS
                      = getBIT (16, getFIXED (mSYM_TAB)
                                        + 34
                                              * (xminus (COREHALFWORD (
                                                  mINITIALIZExTRAVERSExLINK)))
                                        + 26 + 2 * (0));
                  putBIT (16, mINITIALIZExTRAVERSExLINK, bitRHS);
                  bitRHS->inUse = 0;
                }
              } // End of DO WHILE block
          es2s2:;
          } // End of DO block
      // DO WHILE LINK = 0; (2484)
      while (1 & (xEQ (COREHALFWORD (mINITIALIZExTRAVERSExLINK), 0)))
        {
          // IF STACK_INX = 1 THEN (2485)
          if (1 & (xEQ (COREHALFWORD (mINITIALIZExTRAVERSExSTACK_INX), 1)))
            // RETURN; (2486)
            {
              reentryGuard = 0;
              return 0;
            }
          // ELSE (2487)
          else
            // DO; (2488)
            {
            rs2s3s1:;
              // STACK_INX = STACK_INX - 1; (2489)
              {
                int32_t numberRHS = (int32_t)(xsubtract (
                    COREHALFWORD (mINITIALIZExTRAVERSExSTACK_INX), 1));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mINITIALIZExTRAVERSExSTACK_INX, bitRHS);
                bitRHS->inUse = 0;
              }
              // LINK = SYT_LINK2(TPL_STACK(STACK_INX)); (2490)
              {
                descriptor_t *bitRHS = getBIT (
                    16,
                    getFIXED (mSYM_TAB)
                        + 34
                              * (COREHALFWORD (
                                  mTPL_STACK
                                  + 2
                                        * COREHALFWORD (
                                            mINITIALIZExTRAVERSExSTACK_INX)))
                        + 26 + 2 * (0));
                putBIT (16, mINITIALIZExTRAVERSExLINK, bitRHS);
                bitRHS->inUse = 0;
              }
              // DO WHILE LINK < 0; (2491)
              while (1 & (xLT (COREHALFWORD (mINITIALIZExTRAVERSExLINK), 0)))
                {
                  // LINK = SYT_LINK2(-LINK); (2492)
                  {
                    descriptor_t *bitRHS = getBIT (
                        16, getFIXED (mSYM_TAB)
                                + 34
                                      * (xminus (COREHALFWORD (
                                          mINITIALIZExTRAVERSExLINK)))
                                + 26 + 2 * (0));
                    putBIT (16, mINITIALIZExTRAVERSExLINK, bitRHS);
                    bitRHS->inUse = 0;
                  }
                } // End of DO WHILE block
            es2s3s1:;
            } // End of DO block
        }     // End of DO WHILE block
    }         // End of DO WHILE block
  {
    reentryGuard = 0;
    return 0;
  }
}
