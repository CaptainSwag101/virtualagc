/*
  File MOVE_LIMB.c generated by XCOM-I, 2024-08-09 12:38:53.
*/

#include "runtimeC.h"

int32_t
MOVE_LIMB (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "MOVE_LIMB");
  // IF TRACE THEN (1690)
  if (1 & (bitToFixed (getBIT (8, mTRACE))))
    // OUTPUT = 'MOVE_LIMB:  LOW '||LOW||'  HIGH '||HIGH || '  BIG '||BIG|| '
    // QUICK_MOVE '||QUICK_MOVE; (1691)
    {
      descriptor_t *stringRHS;
      stringRHS = xsCAT (
          xsCAT (
              xsCAT (
                  xsCAT (xsCAT (xsCAT (xsCAT (cToDescriptor (
                                                  NULL, "MOVE_LIMB:  LOW "),
                                              bitToCharacter (getBIT (
                                                  16, mMOVE_LIMBxLOW))),
                                       cToDescriptor (NULL, "  HIGH ")),
                                bitToCharacter (getBIT (16, mMOVE_LIMBxHIGH))),
                         cToDescriptor (NULL, "  BIG ")),
                  bitToCharacter (getBIT (16, mMOVE_LIMBxBIG))),
              cToDescriptor (NULL, "  QUICK_MOVE ")),
          bitToCharacter (getBIT (8, mMOVE_LIMBxQUICK_MOVE)));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // IF BIG ~= 0 THEN (1692)
  if (1 & (xNEQ (COREHALFWORD (mMOVE_LIMBxBIG), 0)))
    // DO; (1693)
    {
    rs1:;
      // IF FBRA_FLAG & ~QUICK_MOVE THEN (1694)
      if (1
          & (xAND (BYTE0 (mFBRA_FLAG), xNOT (BYTE0 (mMOVE_LIMBxQUICK_MOVE)))))
        // DO; (1695)
        {
        rs1s1:;
          // I = HIGH - 1; (1696)
          {
            int32_t numberRHS
                = (int32_t)(xsubtract (COREHALFWORD (mMOVE_LIMBxHIGH), 1));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mMOVE_LIMBxI, bitRHS);
            bitRHS->inUse = 0;
          }
          // ZO3_FLAG = FALSE; (1697)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (1, mMOVE_LIMBxZO3_FLAG, bitRHS);
            bitRHS->inUse = 0;
          }
          // DO WHILE (I >= LOW & ~ZO3_FLAG); (1698)
          while (1
                 & (xAND (xGE (COREHALFWORD (mMOVE_LIMBxI),
                               COREHALFWORD (mMOVE_LIMBxLOW)),
                          xNOT (BYTE0 (mMOVE_LIMBxZO3_FLAG)))))
            {
              // IF (OPR(I) &  65521) =  160 THEN (1699)
              if (1
                  & (xEQ (
                      xAND (getFIXED (mOPR + 4 * COREHALFWORD (mMOVE_LIMBxI)),
                            65521),
                      160)))
                // DO; (1700)
                {
                rs1s1s1s1:;
                  // FBRA_FLO_NUM = SHR(OPR(I+1),16); (1701)
                  {
                    int32_t numberRHS = (int32_t)(SHR (
                        getFIXED (mOPR
                                  + 4 * xadd (COREHALFWORD (mMOVE_LIMBxI), 1)),
                        16));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mMOVE_LIMBxFBRA_FLO_NUM, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // J = I + 3; (1702)
                  {
                    int32_t numberRHS
                        = (int32_t)(xadd (COREHALFWORD (mMOVE_LIMBxI), 3));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mMOVE_LIMBxJ, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // LBL_FOUND = FALSE; (1703)
                  {
                    int32_t numberRHS = (int32_t)(0);
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (1, mMOVE_LIMBxLBL_FOUND, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // DO WHILE (J < HIGH) & ~LBL_FOUND; (1704)
                  while (1
                         & (xAND (xLT (COREHALFWORD (mMOVE_LIMBxJ),
                                       COREHALFWORD (mMOVE_LIMBxHIGH)),
                                  xNOT (BYTE0 (mMOVE_LIMBxLBL_FOUND)))))
                    {
                      // IF (OPR(J) &  65521) =  128 THEN (1705)
                      if (1
                          & (xEQ (xAND (getFIXED (
                                            mOPR
                                            + 4 * COREHALFWORD (mMOVE_LIMBxJ)),
                                        65521),
                                  128)))
                        // IF FBRA_FLO_NUM = SHR(OPR(J+1),16) THEN (1706)
                        if (1
                            & (xEQ (
                                COREHALFWORD (mMOVE_LIMBxFBRA_FLO_NUM),
                                SHR (getFIXED (mOPR
                                               + 4
                                                     * xadd (COREHALFWORD (
                                                                 mMOVE_LIMBxJ),
                                                             1)),
                                     16))))
                          // LBL_FOUND = TRUE; (1707)
                          {
                            int32_t numberRHS = (int32_t)(1);
                            descriptor_t *bitRHS;
                            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                            putBIT (1, mMOVE_LIMBxLBL_FOUND, bitRHS);
                            bitRHS->inUse = 0;
                          }
                      // J = J + 1; (1708)
                      {
                        int32_t numberRHS
                            = (int32_t)(xadd (COREHALFWORD (mMOVE_LIMBxJ), 1));
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (16, mMOVE_LIMBxJ, bitRHS);
                        bitRHS->inUse = 0;
                      }
                    } // End of DO WHILE block
                  // IF ~LBL_FOUND THEN (1709)
                  if (1 & (xNOT (BYTE0 (mMOVE_LIMBxLBL_FOUND))))
                    // DO; (1710)
                    {
                    rs1s1s1s1s2:;
                      // ZO3_FLAG = TRUE; (1711)
                      {
                        int32_t numberRHS = (int32_t)(1);
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (1, mMOVE_LIMBxZO3_FLAG, bitRHS);
                        bitRHS->inUse = 0;
                      }
                      // CALL ERRORS(CLASS_ZO, 3, ''||STT#); (1712)
                      {
                        putBITp (16, mERRORSxCLASS, getBIT (16, mCLASS_ZO));
                        putBITp (16, mERRORSxNUM,
                                 fixedToBit (32, (int32_t)(3)));
                        putCHARACTERp (
                            mERRORSxTEXT,
                            xsCAT (cToDescriptor (NULL, ""),
                                   bitToCharacter (getBIT (16, mSTTp))));
                        ERRORS (0);
                      }
                    es1s1s1s1s2:;
                    } // End of DO block
                es1s1s1s1:;
                } // End of DO block
              // I = I - 1; (1713)
              {
                int32_t numberRHS
                    = (int32_t)(xsubtract (COREHALFWORD (mMOVE_LIMBxI), 1));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mMOVE_LIMBxI, bitRHS);
                bitRHS->inUse = 0;
              }
            } // End of DO WHILE block
        es1s1:;
        } // End of DO block
      // IF ~QUICK_MOVE THEN (1714)
      if (1 & (xNOT (BYTE0 (mMOVE_LIMBxQUICK_MOVE))))
        // DO; (1715)
        {
        rs1s2:;
          // CALL MOVECODE(LOW,HIGH,BIG,1); (1716)
          {
            putBITp (16, mMOVECODExLOW, getBIT (16, mMOVE_LIMBxLOW));
            putBITp (16, mMOVECODExHIGH, getBIT (16, mMOVE_LIMBxHIGH));
            putBITp (16, mMOVECODExBIG, getBIT (16, mMOVE_LIMBxBIG));
            putBITp (8, mMOVECODExENTER_TAG, fixedToBit (32, (int32_t)(1)));
            MOVECODE (0);
          }
          // CALL RELOCATE(LOW,HIGH,BIG,1,NOT_TOTAL_RELOCATE); (1717)
          {
            putBITp (16, mRELOCATExNEW, getBIT (16, mMOVE_LIMBxLOW));
            putBITp (16, mRELOCATExSTART, getBIT (16, mMOVE_LIMBxHIGH));
            putBITp (16, mRELOCATExROW, getBIT (16, mMOVE_LIMBxBIG));
            putBITp (8, mRELOCATExCHECKTAG, fixedToBit (32, (int32_t)(1)));
            putBITp (8, mRELOCATExNOT_TOTAL_RELOCATE,
                     getBIT (8, mMOVE_LIMBxNOT_TOTAL_RELOCATE));
            RELOCATE (0);
          }
        es1s2:;
        } // End of DO block
      // STOP = HIGH + BIG; (1718)
      {
        int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mMOVE_LIMBxHIGH),
                                            COREHALFWORD (mMOVE_LIMBxBIG)));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mMOVE_LIMBxSTOP, bitRHS);
        bitRHS->inUse = 0;
      }
      // BACK = LOW - HIGH; (1719)
      {
        int32_t numberRHS = (int32_t)(xsubtract (
            COREHALFWORD (mMOVE_LIMBxLOW), COREHALFWORD (mMOVE_LIMBxHIGH)));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mMOVE_LIMBxBACK, bitRHS);
        bitRHS->inUse = 0;
      }
      // I = 2; (1720)
      {
        int32_t numberRHS = (int32_t)(2);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mMOVE_LIMBxI, bitRHS);
        bitRHS->inUse = 0;
      }
      // DO WHILE I <= N_INX - 1; (1721)
      while (1
             & (xLE (COREHALFWORD (mMOVE_LIMBxI),
                     xsubtract (COREHALFWORD (mN_INX), 1))))
        {
          // IF NODE(I) = END_OF_LIST THEN (1722)
          if (1
              & (xEQ (getFIXED (mNODE + 4 * COREHALFWORD (mMOVE_LIMBxI)),
                      getFIXED (mEND_OF_LIST))))
            // I = I + 1; (1723)
            {
              int32_t numberRHS
                  = (int32_t)(xadd (COREHALFWORD (mMOVE_LIMBxI), 1));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mMOVE_LIMBxI, bitRHS);
              bitRHS->inUse = 0;
            }
          // ELSE (1724)
          else
            // DO; (1725)
            {
            rs1s3s1:;
              // NODE(I)=VAC_PTR | RELP(NODE(I) &  65535); (1726)
              {
                int32_t numberRHS = (int32_t)(xOR (
                    getFIXED (mVAC_PTR),
                    bitToFixed ((
                        putBITp (
                            16, mMOVE_LIMBxRELPxTEMP,
                            fixedToBit (
                                32, (int32_t)(xAND (
                                        getFIXED (
                                            mNODE
                                            + 4 * COREHALFWORD (mMOVE_LIMBxI)),
                                        65535)))),
                        MOVE_LIMBxRELP (0)))));
                putFIXED (mNODE + 4 * (COREHALFWORD (mMOVE_LIMBxI)),
                          numberRHS);
              }
              // IF I = N_INX - 1 THEN (1727)
              if (1
                  & (xEQ (COREHALFWORD (mMOVE_LIMBxI),
                          xsubtract (COREHALFWORD (mN_INX), 1))))
                // I = N_INX; (1728)
                {
                  descriptor_t *bitRHS = getBIT (16, mN_INX);
                  putBIT (16, mMOVE_LIMBxI, bitRHS);
                  bitRHS->inUse = 0;
                }
              // ELSE (1729)
              else
                // I = NODE2(I + 1) + 1; (1730)
                {
                  int32_t numberRHS = (int32_t)(xadd (
                      COREHALFWORD (
                          mNODE2 + 2 * xadd (COREHALFWORD (mMOVE_LIMBxI), 1)),
                      1));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mMOVE_LIMBxI, bitRHS);
                  bitRHS->inUse = 0;
                }
              // IF I = 1 THEN (1731)
              if (1 & (xEQ (COREHALFWORD (mMOVE_LIMBxI), 1)))
                // I = N_INX; (1732)
                {
                  descriptor_t *bitRHS = getBIT (16, mN_INX);
                  putBIT (16, mMOVE_LIMBxI, bitRHS);
                  bitRHS->inUse = 0;
                }
            es1s3s1:;
            } // End of DO block
        }     // End of DO WHILE block
      // DO FOR I = 0 TO LEVEL; (1733)
      {
        int32_t from42, to42, by42;
        from42 = 0;
        to42 = bitToFixed (getBIT (16, mLEVEL));
        by42 = 1;
        for (putBIT (16, mMOVE_LIMBxI, fixedToBit (16, from42));
             bitToFixed (getBIT (16, mMOVE_LIMBxI)) <= to42;
             putBIT (16, mMOVE_LIMBxI,
                     fixedToBit (16, bitToFixed (getBIT (16, mMOVE_LIMBxI))
                                         + by42)))
          {
            // PULL_LOOP_HEAD(I) = RELP(PULL_LOOP_HEAD(I)); (1734)
            {
              descriptor_t *bitRHS
                  = (putBITp (
                         16, mMOVE_LIMBxRELPxTEMP,
                         getBIT (16, getFIXED (mLEVEL_STACK_VARS)
                                         + 11 * (COREHALFWORD (mMOVE_LIMBxI))
                                         + 4 + 2 * (0))),
                     MOVE_LIMBxRELP (0));
              putBIT (16,
                      getFIXED (mLEVEL_STACK_VARS)
                          + 11 * (COREHALFWORD (mMOVE_LIMBxI)) + 4 + 2 * (0),
                      bitRHS);
              bitRHS->inUse = 0;
            }
          }
      } // End of DO for-loop block
      // AR_PTR = RELP(AR_PTR); (1735)
      {
        descriptor_t *bitRHS
            = (putBITp (16, mMOVE_LIMBxRELPxTEMP, getBIT (16, mAR_PTR)),
               MOVE_LIMBxRELP (0));
        putBIT (16, mAR_PTR, bitRHS);
        bitRHS->inUse = 0;
      }
      // HALMAT_NODE_START = RELP(HALMAT_NODE_START); (1736)
      {
        descriptor_t *bitRHS = (putBITp (16, mMOVE_LIMBxRELPxTEMP,
                                         getBIT (16, mHALMAT_NODE_START)),
                                MOVE_LIMBxRELP (0));
        putBIT (16, mHALMAT_NODE_START, bitRHS);
        bitRHS->inUse = 0;
      }
      // IF ~KEEP_D_N THEN (1737)
      if (1 & (xNOT (BYTE0 (mMOVE_LIMBxKEEP_D_N))))
        // DO FOR I = 0 TO D_N_INX; (1738)
        {
          int32_t from43, to43, by43;
          from43 = 0;
          to43 = bitToFixed (getBIT (16, mD_N_INX));
          by43 = 1;
          for (putBIT (16, mMOVE_LIMBxI, fixedToBit (16, from43));
               bitToFixed (getBIT (16, mMOVE_LIMBxI)) <= to43;
               putBIT (16, mMOVE_LIMBxI,
                       fixedToBit (16, bitToFixed (getBIT (16, mMOVE_LIMBxI))
                                           + by43)))
            {
              // DIFF_NODE(I) = RELP(DIFF_NODE(I)); (1739)
              {
                descriptor_t *bitRHS
                    = (putBITp (
                           16, mMOVE_LIMBxRELPxTEMP,
                           getBIT (16, mDIFF_NODE
                                           + 2 * COREHALFWORD (mMOVE_LIMBxI))),
                       MOVE_LIMBxRELP (0));
                putBIT (16, mDIFF_NODE + 2 * (COREHALFWORD (mMOVE_LIMBxI)),
                        bitRHS);
                bitRHS->inUse = 0;
              }
            }
        } // End of DO for-loop block
      // IF RELOCATE_ADD THEN (1740)
      if (1 & (bitToFixed (getBIT (8, mMOVE_LIMBxRELOCATE_ADD))))
        // DO; (1741)
        {
        rs1s6:;
          // DO FOR I = 0 TO A_INX; (1742)
          {
            int32_t from44, to44, by44;
            from44 = 0;
            to44 = bitToFixed (getBIT (16, mA_INX));
            by44 = 1;
            for (putBIT (16, mMOVE_LIMBxI, fixedToBit (16, from44));
                 bitToFixed (getBIT (16, mMOVE_LIMBxI)) <= to44;
                 putBIT (16, mMOVE_LIMBxI,
                         fixedToBit (16, bitToFixed (getBIT (16, mMOVE_LIMBxI))
                                             + by44)))
              {
                // ADD(I) = RELP(ADD(I)); (1743)
                {
                  descriptor_t *bitRHS
                      = (putBITp (
                             16, mMOVE_LIMBxRELPxTEMP,
                             getBIT (16,
                                     mADD + 2 * COREHALFWORD (mMOVE_LIMBxI))),
                         MOVE_LIMBxRELP (0));
                  putBIT (16, mADD + 2 * (COREHALFWORD (mMOVE_LIMBxI)),
                          bitRHS);
                  bitRHS->inUse = 0;
                }
              }
          } // End of DO for-loop block
        es1s6:;
        } // End of DO block
    es1:;
    } // End of DO block
  // CTR = RELP(CTR); (1744)
  {
    descriptor_t *bitRHS
        = (putBITp (16, mMOVE_LIMBxRELPxTEMP, getBIT (16, mCTR)),
           MOVE_LIMBxRELP (0));
    putBIT (16, mCTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // SMRK_CTR = RELP(SMRK_CTR); (1745)
  {
    descriptor_t *bitRHS
        = (putBITp (16, mMOVE_LIMBxRELPxTEMP, getBIT (16, mSMRK_CTR)),
           MOVE_LIMBxRELP (0));
    putBIT (16, mSMRK_CTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // LAST_SMRK = RELP(LAST_SMRK); (1746)
  {
    descriptor_t *bitRHS
        = (putBITp (16, mMOVE_LIMBxRELPxTEMP, getBIT (16, mLAST_SMRK)),
           MOVE_LIMBxRELP (0));
    putBIT (16, mLAST_SMRK, bitRHS);
    bitRHS->inUse = 0;
  }
  // H_INX = LOW + BIG; (1747)
  {
    int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mMOVE_LIMBxLOW),
                                        COREHALFWORD (mMOVE_LIMBxBIG)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mH_INX, bitRHS);
    bitRHS->inUse = 0;
  }
  // LAST_INX = LOW + BIG - 3; (1748)
  {
    int32_t numberRHS = (int32_t)(xsubtract (
        xadd (COREHALFWORD (mMOVE_LIMBxLOW), COREHALFWORD (mMOVE_LIMBxBIG)),
        3));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mLAST_INX, bitRHS);
    bitRHS->inUse = 0;
  }
  // RELOCATE_ADD, NOT_TOTAL_RELOCATE, QUICK_MOVE = 0; (1749)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mMOVE_LIMBxRELOCATE_ADD, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mMOVE_LIMBxNOT_TOTAL_RELOCATE, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mMOVE_LIMBxQUICK_MOVE, bitRHS);
    bitRHS->inUse = 0;
  }
  // KEEP_D_N = 0; (1750)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mMOVE_LIMBxKEEP_D_N, bitRHS);
    bitRHS->inUse = 0;
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
