/*
  File STACK_DUMP.c generated by XCOM-I, 2024-08-09 12:38:53.
*/

#include "runtimeC.h"

int32_t
STACK_DUMP (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "STACK_DUMP");
  // OUTPUT = ''; (689)
  {
    descriptor_t *stringRHS;
    stringRHS = cToDescriptor (NULL, "");
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // IF ~REL_LIST THEN (690)
  if (1 & (xNOT (BYTE0 (mSTACK_DUMPxREL_LIST))))
    // DO; (691)
    {
    rs1:;
      // REL_LIST = TRUE; (692)
      {
        int32_t numberRHS = (int32_t)(1);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (8, mSTACK_DUMPxREL_LIST, bitRHS);
        bitRHS->inUse = 0;
      }
      // OUTPUT = ' NO REL'; (693)
      {
        descriptor_t *stringRHS;
        stringRHS = cToDescriptor (NULL, " NO REL");
        OUTPUT (0, stringRHS);
        stringRHS->inUse = 0;
      }
      // DO FOR K = 2 TO COMM(10); (694)
      {
        int32_t from16, to16, by16;
        from16 = 2;
        to16 = getFIXED (mCOMM + 4 * 10);
        by16 = 1;
        for (putBIT (16, mSTACK_DUMPxK, fixedToBit (16, from16));
             bitToFixed (getBIT (16, mSTACK_DUMPxK)) <= to16;
             putBIT (16, mSTACK_DUMPxK,
                     fixedToBit (16, bitToFixed (getBIT (16, mSTACK_DUMPxK))
                                         + by16)))
          {
            // IF REL(K) > 1 THEN (695)
            if (1
                & (xGT (COREHALFWORD (getFIXED (mSYM_SHRINK)
                                      + 2 * (COREHALFWORD (mSTACK_DUMPxK)) + 0
                                      + 2 * (0)),
                        1)))
              // OUTPUT = FORMAT(K,3) || FORMAT(REL(K),4) || '  ' ||
              // SYT_NAME(K); (696)
              {
                descriptor_t *stringRHS;
                stringRHS = xsCAT (
                    xsCAT (xsCAT ((putFIXED (mFORMATxIVAL,
                                             COREHALFWORD (mSTACK_DUMPxK)),
                                   putFIXED (mFORMATxN, 3), FORMAT (0)),
                                  (putFIXED (
                                       mFORMATxIVAL,
                                       COREHALFWORD (
                                           getFIXED (mSYM_SHRINK)
                                           + 2 * (COREHALFWORD (mSTACK_DUMPxK))
                                           + 0 + 2 * (0))),
                                   putFIXED (mFORMATxN, 4), FORMAT (0))),
                           cToDescriptor (NULL, "  ")),
                    getCHARACTER (getFIXED (mSYM_TAB)
                                  + 34 * (COREHALFWORD (mSTACK_DUMPxK)) + 0
                                  + 4 * (0)));
                OUTPUT (0, stringRHS);
                stringRHS->inUse = 0;
              }
          }
      } // End of DO for-loop block
    es1:;
    } // End of DO block
  // OUTPUT = 'STACK_DUMP:  LEVEL=' || LEVEL|| ', BLOCK#=' ||BLOCK#|| ', INL#='
  // ||INL#|| ', OLD_LEVEL=' ||OLD_LEVEL|| ', OLD_BLOCK#=' || OLD_BLOCK# || ',
  // VAL_SIZE=' || VAL_SIZE; (697)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (
        xsCAT (
            xsCAT (
                xsCAT (
                    xsCAT (
                        xsCAT (
                            xsCAT (
                                xsCAT (
                                    xsCAT (
                                        xsCAT (
                                            xsCAT (cToDescriptor (
                                                       NULL,
                                                       "STACK_DUMP:  LEVEL="),
                                                   bitToCharacter (
                                                       getBIT (16, mLEVEL))),
                                            cToDescriptor (NULL, ", BLOCK#=")),
                                        bitToCharacter (getBIT (16, mBLOCKp))),
                                    cToDescriptor (NULL, ", INL#=")),
                                bitToCharacter (getBIT (16, mINLp))),
                            cToDescriptor (NULL, ", OLD_LEVEL=")),
                        bitToCharacter (getBIT (16, mOLD_LEVEL))),
                    cToDescriptor (NULL, ", OLD_BLOCK#=")),
                bitToCharacter (getBIT (16, mOLD_BLOCKp))),
            cToDescriptor (NULL, ", VAL_SIZE=")),
        bitToCharacter (getBIT (16, mVAL_SIZE)));
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // OUTPUT = ''; (698)
  {
    descriptor_t *stringRHS;
    stringRHS = cToDescriptor (NULL, "");
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // OUTPUT = '   LEVEL STACKED_BLOCK# STACK_TAGS PULL_LOOP_HEAD'; (699)
  {
    descriptor_t *stringRHS;
    stringRHS = cToDescriptor (
        NULL, "   LEVEL STACKED_BLOCK# STACK_TAGS PULL_LOOP_HEAD");
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // DO FOR K = 0 TO LEVEL; (700)
  {
    int32_t from17, to17, by17;
    from17 = 0;
    to17 = bitToFixed (getBIT (16, mLEVEL));
    by17 = 1;
    for (putBIT (16, mSTACK_DUMPxK, fixedToBit (16, from17));
         bitToFixed (getBIT (16, mSTACK_DUMPxK)) <= to17; putBIT (
             16, mSTACK_DUMPxK,
             fixedToBit (16, bitToFixed (getBIT (16, mSTACK_DUMPxK)) + by17)))
      {
        // OUTPUT = FORMAT(K,8)|| FORMAT(STACKED_BLOCK#(K),15) || '   '||
        // HEX(STACK_TAGS(K),8)||'      '||FORMAT(PULL_LOOP_HEAD(K),4); (701)
        {
          descriptor_t *stringRHS;
          stringRHS = xsCAT (
              xsCAT (
                  xsCAT (
                      xsCAT (
                          xsCAT ((putFIXED (mFORMATxIVAL,
                                            COREHALFWORD (mSTACK_DUMPxK)),
                                  putFIXED (mFORMATxN, 8), FORMAT (0)),
                                 (putFIXED (
                                      mFORMATxIVAL,
                                      COREHALFWORD (
                                          getFIXED (mLEVEL_STACK_VARS)
                                          + 11 * (COREHALFWORD (mSTACK_DUMPxK))
                                          + 8 + 2 * (0))),
                                  putFIXED (mFORMATxN, 15), FORMAT (0))),
                          cToDescriptor (NULL, "   ")),
                      (putFIXED (mHEXxHVAL,
                                 BYTE0 (getFIXED (mLEVEL_STACK_VARS)
                                        + 11 * (COREHALFWORD (mSTACK_DUMPxK))
                                        + 10 + 1 * (0))),
                       putFIXED (mHEXxN, 8), HEX (0))),
                  cToDescriptor (NULL, "      ")),
              (putFIXED (mFORMATxIVAL,
                         COREHALFWORD (getFIXED (mLEVEL_STACK_VARS)
                                       + 11 * (COREHALFWORD (mSTACK_DUMPxK))
                                       + 4 + 2 * (0))),
               putFIXED (mFORMATxN, 4), FORMAT (0)));
          OUTPUT (0, stringRHS);
          stringRHS->inUse = 0;
        }
      }
  } // End of DO for-loop block
  // OUTPUT = ''; (702)
  {
    descriptor_t *stringRHS;
    stringRHS = cToDescriptor (NULL, "");
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // OUTPUT = 'RECORD_TOP(CATALOG_ARRAY)= ' ||RECORD_TOP(PAR_SYM); (703)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (
        cToDescriptor (NULL, "RECORD_TOP(CATALOG_ARRAY)= "),
        fixedToCharacter (xsubtract (
            COREWORD (xadd (ADDR ("PAR_SYM", 0x80000000, NULL, 0), 12)), 1)));
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // OUTPUT= 'RECORD_TOP(VALIDITY_ARRAY)= ' ||RECORD_TOP(VAL_TABLE); (704)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (
        cToDescriptor (NULL, "RECORD_TOP(VALIDITY_ARRAY)= "),
        fixedToCharacter (xsubtract (
            COREWORD (xadd (ADDR ("VAL_TABLE", 0x80000000, NULL, 0), 12)),
            1)));
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // OUTPUT= 'RECORD_TOP(ZAPS)= ' ||RECORD_TOP(OBPS); (705)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (
        cToDescriptor (NULL, "RECORD_TOP(ZAPS)= "),
        fixedToCharacter (xsubtract (
            COREWORD (xadd (ADDR ("OBPS", 0x80000000, NULL, 0), 12)), 1)));
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // OUTPUT = '   ZAP_BASE=' || ZAP_BASE(LEVEL) || ', PULL_LOOP_HEAD(LEVEL)='
  // || PULL_LOOP_HEAD(LEVEL); (706)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (
        xsCAT (xsCAT (cToDescriptor (NULL, "   ZAP_BASE="),
                      fixedToCharacter (getFIXED (
                          getFIXED (mLEVEL_STACK_VARS)
                          + 11 * (COREHALFWORD (mLEVEL)) + 0 + 4 * (0)))),
               cToDescriptor (NULL, ", PULL_LOOP_HEAD(LEVEL)=")),
        bitToCharacter (getBIT (16, getFIXED (mLEVEL_STACK_VARS)
                                        + 11 * (COREHALFWORD (mLEVEL)) + 4
                                        + 2 * (0))));
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // OUTPUT = '   SYT_SIZE=' ||SYT_SIZE||', SYT_WORDS='||SYT_WORDS|| ',
  // SYT_USED='||SYT_USED; (707)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (
        xsCAT (xsCAT (xsCAT (xsCAT (cToDescriptor (NULL, "   SYT_SIZE="),
                                    bitToCharacter (getBIT (16, mSYT_SIZE))),
                             cToDescriptor (NULL, ", SYT_WORDS=")),
                      fixedToCharacter (SHR (COREHALFWORD (mSYT_USED), 5))),
               cToDescriptor (NULL, ", SYT_USED=")),
        bitToCharacter (getBIT (16, mSYT_USED)));
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // OUTPUT = ''; (708)
  {
    descriptor_t *stringRHS;
    stringRHS = cToDescriptor (NULL, "");
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // OUTPUT = '   VALIDITY     ZAPS LOOP_ZAPS'; (709)
  {
    descriptor_t *stringRHS;
    stringRHS = cToDescriptor (NULL, "   VALIDITY     ZAPS LOOP_ZAPS");
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // DO FOR K = 0 TO SYT_WORDS; (710)
  {
    int32_t from18, to18, by18;
    from18 = 0;
    to18 = SHR (COREHALFWORD (mSYT_USED), 5);
    by18 = 1;
    for (putBIT (16, mSTACK_DUMPxK, fixedToBit (16, from18));
         bitToFixed (getBIT (16, mSTACK_DUMPxK)) <= to18; putBIT (
             16, mSTACK_DUMPxK,
             fixedToBit (16, bitToFixed (getBIT (16, mSTACK_DUMPxK)) + by18)))
      {
        // OUTPUT = '   ' || HEX(VALIDITY_ARRAY(K),8) || ' ' || HEX(ZAPS(K),8)
        // || '  ' || HEX(LOOP_ZAPS(K),8); (711)
        {
          descriptor_t *stringRHS;
          stringRHS = xsCAT (
              xsCAT (
                  xsCAT (
                      xsCAT (
                          xsCAT (
                              cToDescriptor (NULL, "   "),
                              (putFIXED (
                                   mHEXxHVAL,
                                   getFIXED (
                                       getFIXED (mVAL_TABLE)
                                       + 4 * (COREHALFWORD (mLEVEL)) + 0
                                       + 4 * (COREHALFWORD (mSTACK_DUMPxK)))),
                               putFIXED (mHEXxN, 8), HEX (0))),
                          cToDescriptor (NULL, " ")),
                      (putFIXED (
                           mHEXxHVAL,
                           getFIXED (getFIXED (mOBPS)
                                     + 4 * (COREHALFWORD (mZAP_LEVEL)) + 0
                                     + 4 * (COREHALFWORD (mSTACK_DUMPxK)))),
                       putFIXED (mHEXxN, 8), HEX (0))),
                  cToDescriptor (NULL, "  ")),
              (putFIXED (mHEXxHVAL,
                         getFIXED (getFIXED (mOBPS)
                                   + 4 * (COREHALFWORD (mLOOP_ZAPS_LEVEL)) + 0
                                   + 4 * (COREHALFWORD (mSTACK_DUMPxK)))),
               putFIXED (mHEXxN, 8), HEX (0)));
          OUTPUT (0, stringRHS);
          stringRHS->inUse = 0;
        }
      }
  } // End of DO for-loop block
  {
    reentryGuard = 0;
    return 0;
  }
}
