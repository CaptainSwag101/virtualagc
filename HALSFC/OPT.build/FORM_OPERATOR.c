/*
  File FORM_OPERATOR.c generated by XCOM-I, 2024-08-09 12:38:53.
*/

#include "runtimeC.h"

int32_t
FORM_OPERATOR (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "FORM_OPERATOR");
  // TMP = OPR(H_INX) & TAG_BIT; (1989)
  {
    int32_t numberRHS = (int32_t)(xAND (
        getFIXED (mOPR + 4 * COREHALFWORD (mFORM_OPERATORxH_INX)),
        getFIXED (mTAG_BIT)));
    putFIXED (mFORM_OPERATORxTMP, numberRHS);
  }
  // DO CASE PARITY; (1990)
  {
  rs1:
    switch (BYTE0 (mFORM_OPERATORxPARITY))
      {
      case 0:
        // OPR(H_INX) = SHL( 8192|OP,4) | SHL(TAG,3); (1992)
        {
          int32_t numberRHS
              = (int32_t)(xOR (SHL (xOR (8192, COREHALFWORD (mOP)), 4),
                               SHL (BYTE0 (mFORM_OPERATORxTAG), 3)));
          putFIXED (mOPR + 4 * (COREHALFWORD (mFORM_OPERATORxH_INX)),
                    numberRHS);
        }
        break;
      case 1:
        // OPR(H_INX) = SHL( 8192|REVERSE_OP,4) |SHL(TAG,3); (1993)
        {
          int32_t numberRHS
              = (int32_t)(xOR (SHL (xOR (8192, COREHALFWORD (mREVERSE_OP)), 4),
                               SHL (BYTE0 (mFORM_OPERATORxTAG), 3)));
          putFIXED (mOPR + 4 * (COREHALFWORD (mFORM_OPERATORxH_INX)),
                    numberRHS);
        }
        break;
      }
  } // End of DO CASE block
  // OPR(H_INX) = OPR(H_INX) | TMP; (1993)
  {
    int32_t numberRHS = (int32_t)(xOR (
        getFIXED (mOPR + 4 * COREHALFWORD (mFORM_OPERATORxH_INX)),
        getFIXED (mFORM_OPERATORxTMP)));
    putFIXED (mOPR + 4 * (COREHALFWORD (mFORM_OPERATORxH_INX)), numberRHS);
  }
  // TAG = 0; (1994)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mFORM_OPERATORxTAG, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF TRACE THEN (1995)
  if (1 & (bitToFixed (getBIT (8, mTRACE))))
    // DO; (1996)
    {
    rs2:;
      // MSG = HEX(OPR(H_INX),8); (1997)
      {
        descriptor_t *stringRHS;
        stringRHS
            = (putFIXED (
                   mHEXxHVAL,
                   getFIXED (mOPR + 4 * COREHALFWORD (mFORM_OPERATORxH_INX))),
               putFIXED (mHEXxN, 8), HEX (0));
        putCHARACTER (mFORM_OPERATORxMSG, stringRHS);
        stringRHS->inUse = 0;
      }
      // OUTPUT = 'FORM_OPERATOR(' || H_INX || '): ' || MSG; (1998)
      {
        descriptor_t *stringRHS;
        stringRHS = xsCAT (
            xsCAT (xsCAT (cToDescriptor (NULL, "FORM_OPERATOR("),
                          bitToCharacter (getBIT (16, mFORM_OPERATORxH_INX))),
                   cToDescriptor (NULL, "): ")),
            getCHARACTER (mFORM_OPERATORxMSG));
        OUTPUT (0, stringRHS);
        stringRHS->inUse = 0;
      }
    es2:;
    } // End of DO block
  // PARITY,TAG = 0; (1999)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mFORM_OPERATORxPARITY, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mFORM_OPERATORxTAG, bitRHS);
    bitRHS->inUse = 0;
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
