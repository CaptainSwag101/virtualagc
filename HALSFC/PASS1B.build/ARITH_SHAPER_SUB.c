/*
  File ARITH_SHAPER_SUB.c generated by XCOM-I, 2024-08-09 12:40:41.
*/

#include "runtimeC.h"

int32_t
ARITH_SHAPER_SUB (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "ARITH_SHAPER_SUB");
  // DEF_SIZE=2; (8193)
  {
    int32_t numberRHS = (int32_t)(2);
    putFIXED (mARITH_SHAPER_SUBxDEF_SIZE, numberRHS);
  }
  // NEXT_SUB=NEXT_SUB+1; (8194)
  {
    int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mNEXT_SUB), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mNEXT_SUB, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF INX(NEXT_SUB)~=1 THEN (8195)
  if (1 & (xNEQ (COREHALFWORD (mINX + 2 * COREHALFWORD (mNEXT_SUB)), 1)))
    // DO; (8196)
    {
    rs1:;
      // CALL ERROR(CLASS_QS,5); (8197)
      {
        putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_QS));
        putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(5)));
        ERROR (0);
      }
      // IF INX(NEXT_SUB)>1 THEN (8198)
      if (1 & (xGT (COREHALFWORD (mINX + 2 * COREHALFWORD (mNEXT_SUB)), 1)))
        // NEXT_SUB=NEXT_SUB+1; (8199)
        {
          int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mNEXT_SUB), 1));
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (16, mNEXT_SUB, bitRHS);
          bitRHS->inUse = 0;
        }
    es1:;
    } // End of DO block
  // ELSE (8200)
  else
    // IF VAL_P(NEXT_SUB)>0 THEN (8201)
    if (1 & (xGT (COREHALFWORD (mVAL_P + 2 * COREHALFWORD (mNEXT_SUB)), 0)))
      // CALL ERROR(CLASS_QS,6); (8202)
      {
        putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_QS));
        putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(6)));
        ERROR (0);
      }
    // ELSE (8203)
    else
      // IF PSEUDO_FORM(NEXT_SUB)=XIMD THEN (8204)
      if (1
          & (xEQ (BYTE0 (mPSEUDO_FORM + 1 * COREHALFWORD (mNEXT_SUB)),
                  BYTE0 (mXIMD))))
        // DO; (8205)
        {
        rs2:;
          // DEF_SIZE=LOC_P(NEXT_SUB); (8206)
          {
            descriptor_t *bitRHS
                = getBIT (16, mLOC_P + 2 * COREHALFWORD (mNEXT_SUB));
            int32_t numberRHS;
            numberRHS = bitToFixed (bitRHS);
            putFIXED (mARITH_SHAPER_SUBxDEF_SIZE, numberRHS);
            bitRHS->inUse = 0;
          }
          // GO TO TRY_VAL_SUB; (8207)
          goto TRY_VAL_SUB;
        es2:;
        } // End of DO block
      // ELSE (8208)
      else
        // IF PSEUDO_FORM(NEXT_SUB)~=XLIT THEN (8209)
        if (1
            & (xNEQ (BYTE0 (mPSEUDO_FORM + 1 * COREHALFWORD (mNEXT_SUB)),
                     BYTE0 (mXLIT))))
          // CALL ERROR(CLASS_QS,7); (8210)
          {
            putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_QS));
            putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(7)));
            ERROR (0);
          }
        // ELSE (8211)
        else
          // DO; (8212)
          {
          rs3:;
            // DEF_SIZE=MAKE_FIXED_LIT(LOC_P(NEXT_SUB)); (8213)
            {
              int32_t numberRHS = (int32_t)((
                  putFIXED (
                      mMAKE_FIXED_LITxPTR,
                      COREHALFWORD (mLOC_P + 2 * COREHALFWORD (mNEXT_SUB))),
                  MAKE_FIXED_LIT (0)));
              putFIXED (mARITH_SHAPER_SUBxDEF_SIZE, numberRHS);
            }
          // TRY_VAL_SUB: (8214)
          TRY_VAL_SUB:
            // IF (DEF_SIZE<2)|(DEF_SIZE>SIZE) THEN (8215)
            if (1
                & (xOR (xLT (getFIXED (mARITH_SHAPER_SUBxDEF_SIZE), 2),
                        xGT (getFIXED (mARITH_SHAPER_SUBxDEF_SIZE),
                             getFIXED (mARITH_SHAPER_SUBxSIZE)))))
              // DO; (8216)
              {
              rs3s1:;
                // CALL ERROR(CLASS_QS,8); (8217)
                {
                  putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_QS));
                  putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(8)));
                  ERROR (0);
                }
                // IF DEF_SIZE<2 THEN (8218)
                if (1 & (xLT (getFIXED (mARITH_SHAPER_SUBxDEF_SIZE), 2)))
                  // RETURN 2; (8219)
                  {
                    reentryGuard = 0;
                    return 2;
                  }
                // RETURN SIZE; (8220)
                {
                  reentryGuard = 0;
                  return getFIXED (mARITH_SHAPER_SUBxSIZE);
                }
              es3s1:;
              } // End of DO block
          es3:;
          } // End of DO block
  // RETURN DEF_SIZE; (8221)
  {
    reentryGuard = 0;
    return getFIXED (mARITH_SHAPER_SUBxDEF_SIZE);
  }
}
