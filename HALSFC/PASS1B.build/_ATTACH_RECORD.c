/*
  File _ATTACH_RECORD.c generated by XCOM-I, 2024-08-09 12:40:41.
*/

#include "runtimeC.h"

int32_t
_ATTACH_RECORD (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "_ATTACH_RECORD");
  // IF FIRSTRECORD = 0 THEN (223)
  if (1 & (xEQ (getFIXED (mFIRSTRECORD), 0)))
    // FIRSTRECORD=DOPE; (224)
    {
      int32_t numberRHS = (int32_t)(getFIXED (m_ATTACH_RECORDxDOPE));
      putFIXED (mFIRSTRECORD, numberRHS);
    }
  // ELSE (225)
  else
    // DO; (226)
    {
    rs1:;
      // PREV=0; (227)
      {
        int32_t numberRHS = (int32_t)(0);
        putFIXED (m_ATTACH_RECORDxPREV, numberRHS);
      }
      // CUR=FIRSTRECORD; (228)
      {
        int32_t numberRHS = (int32_t)(getFIXED (mFIRSTRECORD));
        putFIXED (m_ATTACH_RECORDxCUR, numberRHS);
      }
      // LOC=_DOPE_POINTER(DOPE); (229)
      {
        int32_t numberRHS
            = (int32_t)(COREWORD (getFIXED (m_ATTACH_RECORDxDOPE)));
        putFIXED (m_ATTACH_RECORDxLOC, numberRHS);
      }
      // DO UNTIL CUR = 0; (230)
      do
        {
          // IF _DOPE_POINTER(CUR) < LOC THEN (231)
          if (1
              & (xLT (COREWORD (getFIXED (m_ATTACH_RECORDxCUR)),
                      getFIXED (m_ATTACH_RECORDxLOC))))
            // ESCAPE; (232)
            break;
          // PREV=CUR; (233)
          {
            int32_t numberRHS = (int32_t)(getFIXED (m_ATTACH_RECORDxCUR));
            putFIXED (m_ATTACH_RECORDxPREV, numberRHS);
          }
          // CUR=_DOPE_NEXT(CUR); (234)
          {
            int32_t numberRHS = (int32_t)(COREWORD (
                xadd (getFIXED (m_ATTACH_RECORDxCUR), 16)));
            putFIXED (m_ATTACH_RECORDxCUR, numberRHS);
          }
        }
      while (!(1
               & (xEQ (getFIXED (m_ATTACH_RECORDxCUR),
                       0)))); // End of DO UNTIL block
      // _DOPE_NEXT(DOPE)=CUR; (235)
      {
        int32_t numberRHS = (int32_t)(getFIXED (m_ATTACH_RECORDxCUR));
        COREWORD2 (xadd (getFIXED (m_ATTACH_RECORDxDOPE), 16), numberRHS);
      }
      // IF PREV=0 THEN (236)
      if (1 & (xEQ (getFIXED (m_ATTACH_RECORDxPREV), 0)))
        // FIRSTRECORD=DOPE; (237)
        {
          int32_t numberRHS = (int32_t)(getFIXED (m_ATTACH_RECORDxDOPE));
          putFIXED (mFIRSTRECORD, numberRHS);
        }
      // ELSE (238)
      else
        // _DOPE_NEXT(PREV) =DOPE; (239)
        {
          int32_t numberRHS = (int32_t)(getFIXED (m_ATTACH_RECORDxDOPE));
          COREWORD2 (xadd (getFIXED (m_ATTACH_RECORDxPREV), 16), numberRHS);
        }
    es1:;
    } // End of DO block
  // TOTAL_RDESC=TOTAL_RDESC+(_DOPE_#DESCRIPTORS(DOPE)*_DOPE_ALLOC(DOPE));
  // (240)
  {
    int32_t numberRHS = (int32_t)(xadd (
        getFIXED (mTOTAL_RDESC),
        xmultiply (COREHALFWORD (xadd (getFIXED (m_ATTACH_RECORDxDOPE), 6)),
                   COREWORD (xadd (getFIXED (m_ATTACH_RECORDxDOPE), 8)))));
    putFIXED (mTOTAL_RDESC, numberRHS);
  }
  // CALL _FREEBLOCK_CHECK; (241)
  _FREEBLOCK_CHECK (0);
  {
    reentryGuard = 0;
    return 0;
  }
}
