/*
  File GET_SUBSETxGET_TOKEN.c generated by XCOM-I, 2024-08-09 12:40:41.
*/

#include "runtimeC.h"

int32_t
GET_SUBSETxGET_TOKEN (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GET_SUBSETxGET_TOKEN");
  // A_TOKEN=''; (9507)
  {
    descriptor_t *stringRHS;
    stringRHS = cToDescriptor (NULL, "");
    putCHARACTER (mGET_SUBSETxA_TOKEN, stringRHS);
    stringRHS->inUse = 0;
  }
  // DO FOREVER; (9508)
  while (1 & (1))
    {
      // CP=CP+1; (9509)
      {
        int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mGET_SUBSETxCP), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGET_SUBSETxCP, bitRHS);
        bitRHS->inUse = 0;
      }
      // IF CP>LIMIT THEN (9510)
      if (1
          & (xGT (COREHALFWORD (mGET_SUBSETxCP),
                  COREHALFWORD (mGET_SUBSETxLIMIT))))
        // DO; (9511)
        {
        rs1s1:;
        // NEXLINE: (9512)
        NEXLINE:
          // S=INPUT(6); (9513)
          {
            descriptor_t *stringRHS;
            stringRHS = INPUT (6);
            putCHARACTER (mGET_SUBSETxS, stringRHS);
            stringRHS->inUse = 0;
          }
          // I=0; (9514)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mGET_SUBSETxI, bitRHS);
            bitRHS->inUse = 0;
          }
          // IF LENGTH(S)=0 THEN (9515)
          if (1 & (xEQ (LENGTH (getCHARACTER (mGET_SUBSETxS)), 0)))
            // RETURN 0; (9516)
            {
              reentryGuard = 0;
              return 0;
            }
          // IF BYTE(S)=BYTE('C') THEN (9517)
          if (1
              & (xEQ (BYTE1 (getCHARACTER (mGET_SUBSETxS)),
                      BYTE1 (cToDescriptor (NULL, "C")))))
            // GO TO NEXLINE; (9518)
            goto NEXLINE;
          // CP=0; (9519)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mGET_SUBSETxCP, bitRHS);
            bitRHS->inUse = 0;
          }
        es1s1:;
        } // End of DO block
      // IF BYTE(S,CP)~=BYTE(X1) THEN (9520)
      if (1
          & (xNEQ (BYTE (getCHARACTER (mGET_SUBSETxS),
                         COREHALFWORD (mGET_SUBSETxCP)),
                   BYTE1 (getCHARACTER (mX1)))))
        // DO; (9521)
        {
        rs1s2:;
          // DO I=1 TO T#; (9522)
          {
            int32_t from140, to140, by140;
            from140 = 1;
            to140 = 3;
            by140 = 1;
            for (putBIT (16, mGET_SUBSETxI, fixedToBit (16, from140));
                 bitToFixed (getBIT (16, mGET_SUBSETxI)) <= to140; putBIT (
                     16, mGET_SUBSETxI,
                     fixedToBit (16, bitToFixed (getBIT (16, mGET_SUBSETxI))
                                         + by140)))
              {
                // IF BYTE(S,CP)=TERM(I) THEN (9523)
                if (1
                    & (xEQ (BYTE (getCHARACTER (mGET_SUBSETxS),
                                  COREHALFWORD (mGET_SUBSETxCP)),
                            BYTE0 (mGET_SUBSETxGET_TOKENxTERM
                                   + 1 * COREHALFWORD (mGET_SUBSETxI)))))
                  // RETURN I; (9524)
                  {
                    reentryGuard = 0;
                    return COREHALFWORD (mGET_SUBSETxI);
                  }
              }
          } // End of DO for-loop block
          // A_TOKEN=A_TOKEN||SUBSTR(S,CP,1); (9525)
          {
            descriptor_t *stringRHS;
            stringRHS = xsCAT (getCHARACTER (mGET_SUBSETxA_TOKEN),
                               SUBSTR (getCHARACTER (mGET_SUBSETxS),
                                       COREHALFWORD (mGET_SUBSETxCP), 1));
            putCHARACTER (mGET_SUBSETxA_TOKEN, stringRHS);
            stringRHS->inUse = 0;
          }
        es1s2:;
        } // End of DO block
    }     // End of DO WHILE block
  {
    reentryGuard = 0;
    return 0;
  }
}
