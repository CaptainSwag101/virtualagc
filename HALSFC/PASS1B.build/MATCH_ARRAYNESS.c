/*
  File MATCH_ARRAYNESS.c generated by XCOM-I, 2024-08-09 12:40:41.
*/

#include "runtimeC.h"

int32_t
MATCH_ARRAYNESS (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "MATCH_ARRAYNESS");
  // IF VAR_ARRAYNESS=0 THEN (7892)
  if (1 & (xEQ (COREHALFWORD (mVAR_ARRAYNESS), 0)))
    // RETURN; (7893)
    {
      reentryGuard = 0;
      return 0;
    }
  // IF CURRENT_ARRAYNESS=0 THEN (7894)
  if (1 & (xEQ (COREHALFWORD (mCURRENT_ARRAYNESS), 0)))
    // DO; (7895)
    {
    rs1:;
      // DO J=0 TO VAR_ARRAYNESS; (7896)
      {
        int32_t from125, to125, by125;
        from125 = 0;
        to125 = bitToFixed (getBIT (16, mVAR_ARRAYNESS));
        by125 = 1;
        for (putBIT (16, mMATCH_ARRAYNESSxJ, fixedToBit (16, from125));
             bitToFixed (getBIT (16, mMATCH_ARRAYNESSxJ)) <= to125; putBIT (
                 16, mMATCH_ARRAYNESSxJ,
                 fixedToBit (16, bitToFixed (getBIT (16, mMATCH_ARRAYNESSxJ))
                                     + by125)))
          {
            // CURRENT_ARRAYNESS(J)=VAR_ARRAYNESS(J); (7897)
            {
              descriptor_t *bitRHS = getBIT (
                  16, mVAR_ARRAYNESS + 2 * COREHALFWORD (mMATCH_ARRAYNESSxJ));
              putBIT (16,
                      mCURRENT_ARRAYNESS
                          + 2 * (COREHALFWORD (mMATCH_ARRAYNESSxJ)),
                      bitRHS);
              bitRHS->inUse = 0;
            }
          }
      } // End of DO for-loop block
      // RETURN; (7898)
      {
        reentryGuard = 0;
        return 0;
      }
    es1:;
    } // End of DO block
  // DO J=0 TO CURRENT_ARRAYNESS; (7899)
  {
    int32_t from126, to126, by126;
    from126 = 0;
    to126 = bitToFixed (getBIT (16, mCURRENT_ARRAYNESS));
    by126 = 1;
    for (putBIT (16, mMATCH_ARRAYNESSxJ, fixedToBit (16, from126));
         bitToFixed (getBIT (16, mMATCH_ARRAYNESSxJ)) <= to126;
         putBIT (16, mMATCH_ARRAYNESSxJ,
                 fixedToBit (16, bitToFixed (getBIT (16, mMATCH_ARRAYNESSxJ))
                                     + by126)))
      {
        // IF CURRENT_ARRAYNESS(J)>0 THEN (7900)
        if (1
            & (xGT (COREHALFWORD (mCURRENT_ARRAYNESS
                                  + 2 * COREHALFWORD (mMATCH_ARRAYNESSxJ)),
                    0)))
          // DO; (7901)
          {
          rs2s1:;
            // IF VAR_ARRAYNESS(J)>0 THEN (7902)
            if (1
                & (xGT (COREHALFWORD (mVAR_ARRAYNESS
                                      + 2 * COREHALFWORD (mMATCH_ARRAYNESSxJ)),
                        0)))
              // DO; (7903)
              {
              rs2s1s1:;
                // IF CURRENT_ARRAYNESS(J)~=VAR_ARRAYNESS(J) THEN (7904)
                if (1
                    & (xNEQ (
                        COREHALFWORD (mCURRENT_ARRAYNESS
                                      + 2 * COREHALFWORD (mMATCH_ARRAYNESSxJ)),
                        COREHALFWORD (
                            mVAR_ARRAYNESS
                            + 2 * COREHALFWORD (mMATCH_ARRAYNESSxJ)))))
                  // DO; (7905)
                  {
                  rs2s1s1s1:;
                    // IF ARRAYNESS_FLAG THEN (7906)
                    if (1 & (bitToFixed (getBIT (8, mARRAYNESS_FLAG))))
                      // CALL ERROR(CLASS_AA,3,VAR(MP)); (7907)
                      {
                        putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_AA));
                        putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(3)));
                        putCHARACTERp (
                            mERRORxTEXT,
                            getCHARACTER (mVAR + 4 * getFIXED (mMP)));
                        ERROR (0);
                      }
                    // ELSE (7908)
                    else
                      // CALL ERROR(CLASS_EA,1,VAR(MP)); (7909)
                      {
                        putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_EA));
                        putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(1)));
                        putCHARACTERp (
                            mERRORxTEXT,
                            getCHARACTER (mVAR + 4 * getFIXED (mMP)));
                        ERROR (0);
                      }
                    // RETURN; (7910)
                    {
                      reentryGuard = 0;
                      return 0;
                    }
                  es2s1s1s1:;
                  } // End of DO block
              es2s1s1:;
              } // End of DO block
          es2s1:;
          } // End of DO block
        // ELSE (7911)
        else
          // CURRENT_ARRAYNESS(J)=VAR_ARRAYNESS(J); (7912)
          {
            descriptor_t *bitRHS = getBIT (
                16, mVAR_ARRAYNESS + 2 * COREHALFWORD (mMATCH_ARRAYNESSxJ));
            putBIT (16,
                    mCURRENT_ARRAYNESS
                        + 2 * (COREHALFWORD (mMATCH_ARRAYNESSxJ)),
                    bitRHS);
            bitRHS->inUse = 0;
          }
      }
  } // End of DO for-loop block
  {
    reentryGuard = 0;
    return 0;
  }
}
