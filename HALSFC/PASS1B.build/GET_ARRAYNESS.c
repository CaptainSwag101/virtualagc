/*
  File GET_ARRAYNESS.c generated by XCOM-I, 2024-08-09 12:40:41.
*/

#include "runtimeC.h"

descriptor_t *
GET_ARRAYNESS (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (descriptor_t *)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GET_ARRAYNESS");
  // IF SYT_ARRAY(FIXV(MP))~=0 THEN (7724)
  if (1
      & (xNEQ (COREHALFWORD (getFIXED (mSYM_TAB)
                             + 34 * (getFIXED (mFIXV + 4 * getFIXED (mMP)))
                             + 20 + 2 * (0)),
               0)))
    // DO; (7725)
    {
    rs1:;
      // VAR_ARRAYNESS=1; (7726)
      {
        int32_t numberRHS = (int32_t)(1);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mVAR_ARRAYNESS, bitRHS);
        bitRHS->inUse = 0;
      }
      // VAR_ARRAYNESS(1)=SYT_ARRAY(FIXV(MP)); (7727)
      {
        descriptor_t *bitRHS
            = getBIT (16, getFIXED (mSYM_TAB)
                              + 34 * (getFIXED (mFIXV + 4 * getFIXED (mMP)))
                              + 20 + 2 * (0));
        putBIT (16, mVAR_ARRAYNESS + 2 * (1), bitRHS);
        bitRHS->inUse = 0;
      }
      // K=2; (7728)
      {
        int32_t numberRHS = (int32_t)(2);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGET_ARRAYNESSxK, bitRHS);
        bitRHS->inUse = 0;
      }
    es1:;
    } // End of DO block
  // ELSE (7729)
  else
    // K,VAR_ARRAYNESS=0; (7730)
    {
      int32_t numberRHS = (int32_t)(0);
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mGET_ARRAYNESSxK, bitRHS);
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mVAR_ARRAYNESS, bitRHS);
      bitRHS->inUse = 0;
    }
  // I=SYT_ARRAY(FIXL(MP)); (7731)
  {
    descriptor_t *bitRHS = getBIT (
        16, getFIXED (mSYM_TAB) + 34 * (getFIXED (mFIXL + 4 * getFIXED (mMP)))
                + 20 + 2 * (0));
    putBIT (16, mGET_ARRAYNESSxI, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF I>0 THEN (7732)
  if (1 & (xGT (COREHALFWORD (mGET_ARRAYNESSxI), 0)))
    // DO; (7733)
    {
    rs2:;
      // DO J=1 TO EXT_ARRAY(I); (7734)
      {
        int32_t from123, to123, by123;
        from123 = 1;
        to123 = bitToFixed (
            getBIT (16, mEXT_ARRAY + 2 * COREHALFWORD (mGET_ARRAYNESSxI)));
        by123 = 1;
        for (putBIT (16, mGET_ARRAYNESSxJ, fixedToBit (16, from123));
             bitToFixed (getBIT (16, mGET_ARRAYNESSxJ)) <= to123;
             putBIT (16, mGET_ARRAYNESSxJ,
                     fixedToBit (16, bitToFixed (getBIT (16, mGET_ARRAYNESSxJ))
                                         + by123)))
          {
            // VAR_ARRAYNESS(VAR_ARRAYNESS+J)=EXT_ARRAY(I+J); (7735)
            {
              descriptor_t *bitRHS = getBIT (
                  16, mEXT_ARRAY
                          + 2
                                * xadd (COREHALFWORD (mGET_ARRAYNESSxI),
                                        COREHALFWORD (mGET_ARRAYNESSxJ)));
              putBIT (16,
                      mVAR_ARRAYNESS
                          + 2
                                * (xadd (COREHALFWORD (mVAR_ARRAYNESS),
                                         COREHALFWORD (mGET_ARRAYNESSxJ))),
                      bitRHS);
              bitRHS->inUse = 0;
            }
          }
      } // End of DO for-loop block
      // VAR_ARRAYNESS=VAR_ARRAYNESS+EXT_ARRAY(I); (7736)
      {
        int32_t numberRHS = (int32_t)(xadd (
            COREHALFWORD (mVAR_ARRAYNESS),
            COREHALFWORD (mEXT_ARRAY + 2 * COREHALFWORD (mGET_ARRAYNESSxI))));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mVAR_ARRAYNESS, bitRHS);
        bitRHS->inUse = 0;
      }
      // K=K|1; (7737)
      {
        int32_t numberRHS
            = (int32_t)(xOR (COREHALFWORD (mGET_ARRAYNESSxK), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGET_ARRAYNESSxK, bitRHS);
        bitRHS->inUse = 0;
      }
    es2:;
    } // End of DO block
  // I=FIXL(MP); (7738)
  {
    int32_t numberRHS = (int32_t)(getFIXED (mFIXL + 4 * getFIXED (mMP)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mGET_ARRAYNESSxI, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF (SYT_FLAGS(I)&NAME_FLAG)~=0 THEN (7739)
  if (1
      & (xNEQ (xAND (getFIXED (getFIXED (mSYM_TAB)
                               + 34 * (COREHALFWORD (mGET_ARRAYNESSxI)) + 8
                               + 4 * (0)),
                     268435456),
               0)))
    // K=K| 512; (7740)
    {
      int32_t numberRHS
          = (int32_t)(xOR (COREHALFWORD (mGET_ARRAYNESSxK), 512));
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mGET_ARRAYNESSxK, bitRHS);
      bitRHS->inUse = 0;
    }
  // VAL_P(PTR(MP))=VAL_P(PTR(MP))|K; (7741)
  {
    int32_t numberRHS = (int32_t)(xOR (
        COREHALFWORD (mVAL_P + 2 * COREHALFWORD (mPTR + 2 * getFIXED (mMP))),
        COREHALFWORD (mGET_ARRAYNESSxK)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mVAL_P + 2 * (COREHALFWORD (mPTR + 2 * getFIXED (mMP))),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // RETURN SHR(K,9); (7742)
  {
    reentryGuard = 0;
    return fixedToBit (32,
                       (int32_t)(SHR (COREHALFWORD (mGET_ARRAYNESSxK), 9)));
  }
}
