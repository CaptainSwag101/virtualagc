/*
  File GET_VAR_REF_CELL.c generated by XCOM-I, 2024-08-09 12:38:39.
*/

#include "runtimeC.h"

int32_t
GET_VAR_REF_CELL (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GET_VAR_REF_CELL");
  // IF PROC_TRACE THEN (1583)
  if (1 & (bitToFixed (getBIT (8, mPROC_TRACE))))
    // OUTPUT='GET_VAR_REF_CELL('||BLOCK#||':'||TSUB_LOC||
    // ','||EXTN_LOC||','||DSUB_LOC||','||SYT#||')'; (1584)
    {
      descriptor_t *stringRHS;
      stringRHS = xsCAT (
          xsCAT (
              xsCAT (
                  xsCAT (
                      xsCAT (
                          xsCAT (
                              xsCAT (
                                  xsCAT (
                                      xsCAT (xsCAT (cToDescriptor (
                                                        NULL,
                                                        "GET_VAR_REF_CELL("),
                                                    bitToCharacter (
                                                        getBIT (16, mBLOCKp))),
                                             cToDescriptor (NULL, ":")),
                                      bitToCharacter (getBIT (16, mTSUB_LOC))),
                                  cToDescriptor (NULL, ",")),
                              bitToCharacter (getBIT (16, mEXTN_LOC))),
                          cToDescriptor (NULL, ",")),
                      bitToCharacter (getBIT (16, mDSUB_LOC))),
                  cToDescriptor (NULL, ",")),
              bitToCharacter (getBIT (16, mGET_VAR_REF_CELLxSYTp))),
          cToDescriptor (NULL, ")"));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // REF_INX, VAR_INX, PTR_INX = 0; (1585)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mGET_VAR_REF_CELLxREF_INX, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mVAR_INX, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mPTR_INX, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF SYT# ~= 0 THEN (1586)
  if (1 & (xNEQ (COREHALFWORD (mGET_VAR_REF_CELLxSYTp), 0)))
    // DO; (1587)
    {
    rs1:;
      // CELL = GET_CELL(12,ADDR(VMEM_H),MODF); (1588)
      {
        int32_t numberRHS = (int32_t)((
            putFIXED (mGET_CELLxCELL_SIZE, 12),
            putFIXED (mGET_CELLxBVAR, ADDR ("VMEM_H", 0x80000000, NULL, 0)),
            putBITp (8, mGET_CELLxFLAGS, getBIT (8, mMODF)), GET_CELL (0)));
        putFIXED (mGET_VAR_REF_CELLxCELL, numberRHS);
      }
      // VMEM_H(0) = 10; (1589)
      {
        int32_t numberRHS = (int32_t)(10);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, getFIXED (mVMEM_H) + 2 * (0), bitRHS);
        bitRHS->inUse = 0;
      }
      // VMEM_H(1) = 1; (1590)
      {
        int32_t numberRHS = (int32_t)(1);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, getFIXED (mVMEM_H) + 2 * (1), bitRHS);
        bitRHS->inUse = 0;
      }
      // VMEM_H(4) = SYT#; (1591)
      {
        descriptor_t *bitRHS = getBIT (16, mGET_VAR_REF_CELLxSYTp);
        putBIT (16, getFIXED (mVMEM_H) + 2 * (4), bitRHS);
        bitRHS->inUse = 0;
      }
      // SYT# = 0; (1592)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGET_VAR_REF_CELLxSYTp, bitRHS);
        bitRHS->inUse = 0;
      }
    es1:;
    } // End of DO block
  // ELSE (1593)
  else
    // DO; (1594)
    {
    rs2:;
      // IF TSUB_LOC ~= 0 THEN (1595)
      if (1 & (xNEQ (COREHALFWORD (mTSUB_LOC), 0)))
        // DO; (1596)
        {
        rs2s1:;
          // CTR = TSUB_LOC; (1597)
          {
            descriptor_t *bitRHS = getBIT (16, mTSUB_LOC);
            putBIT (16, mGET_VAR_REF_CELLxCTR, bitRHS);
            bitRHS->inUse = 0;
          }
          // REF_INX = REF_INX + 1; (1598)
          {
            int32_t numberRHS = (int32_t)(xadd (
                COREHALFWORD (mGET_VAR_REF_CELLxREF_INX), 1));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mGET_VAR_REF_CELLxREF_INX, bitRHS);
            bitRHS->inUse = 0;
          }
          // REF(REF_INX) = SHR(OPR(CTR+1),16); (1599)
          {
            int32_t numberRHS = (int32_t)(SHR (
                getFIXED (
                    mOPR + 4 * xadd (COREHALFWORD (mGET_VAR_REF_CELLxCTR), 1)),
                16));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16,
                    mGET_VAR_REF_CELLxREF
                        + 2 * (COREHALFWORD (mGET_VAR_REF_CELLxREF_INX)),
                    bitRHS);
            bitRHS->inUse = 0;
          }
          // CALL GET_SUBSCRIPTS; (1600)
          GET_VAR_REF_CELLxGET_SUBSCRIPTS (0);
        es2s1:;
        } // End of DO block
      // IF EXTN_LOC ~= 0 THEN (1601)
      if (1 & (xNEQ (COREHALFWORD (mEXTN_LOC), 0)))
        // DO; (1602)
        {
        rs2s2:;
          // CTR = EXTN_LOC; (1603)
          {
            descriptor_t *bitRHS = getBIT (16, mEXTN_LOC);
            putBIT (16, mGET_VAR_REF_CELLxCTR, bitRHS);
            bitRHS->inUse = 0;
          }
          // IF TYPE_BITS(CTR+1) = SYT THEN (1604)
          if (1
              & (xEQ (
                  bitToFixed (
                      (putBITp (16, mTYPE_BITSxCTR,
                                fixedToBit (32, (int32_t)(xadd (
                                                    COREHALFWORD (
                                                        mGET_VAR_REF_CELLxCTR),
                                                    1)))),
                       TYPE_BITS (0))),
                  COREHALFWORD (mSYT))))
            // START = 1; (1605)
            {
              int32_t numberRHS = (int32_t)(1);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (8, mGET_VAR_REF_CELLxSTART, bitRHS);
              bitRHS->inUse = 0;
            }
          // ELSE (1606)
          else
            // START = 2; (1607)
            {
              int32_t numberRHS = (int32_t)(2);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (8, mGET_VAR_REF_CELLxSTART, bitRHS);
              bitRHS->inUse = 0;
            }
          // DO I = START TO POPNUM(CTR); (1608)
          {
            int32_t from37, to37, by37;
            from37 = bitToFixed (getBIT (8, mGET_VAR_REF_CELLxSTART));
            to37 = bitToFixed (
                (putBITp (16, mPOPNUMxCTR, getBIT (16, mGET_VAR_REF_CELLxCTR)),
                 POPNUM (0)));
            by37 = 1;
            for (putBIT (16, mGET_VAR_REF_CELLxI, fixedToBit (16, from37));
                 bitToFixed (getBIT (16, mGET_VAR_REF_CELLxI)) <= to37;
                 putBIT (16, mGET_VAR_REF_CELLxI,
                         fixedToBit (
                             16, bitToFixed (getBIT (16, mGET_VAR_REF_CELLxI))
                                     + by37)))
              {
                // REF_INX = REF_INX + 1; (1609)
                {
                  int32_t numberRHS = (int32_t)(xadd (
                      COREHALFWORD (mGET_VAR_REF_CELLxREF_INX), 1));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mGET_VAR_REF_CELLxREF_INX, bitRHS);
                  bitRHS->inUse = 0;
                }
                // REF(REF_INX) = REFERENCE; (1610)
                {
                  int32_t numberRHS = (int32_t)(SHR (
                      getFIXED (
                          mOPR
                          + 4
                                * xadd (COREHALFWORD (mGET_VAR_REF_CELLxCTR),
                                        COREHALFWORD (mGET_VAR_REF_CELLxI))),
                      16));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16,
                          mGET_VAR_REF_CELLxREF
                              + 2 * (COREHALFWORD (mGET_VAR_REF_CELLxREF_INX)),
                          bitRHS);
                  bitRHS->inUse = 0;
                }
              }
          } // End of DO for-loop block
          // IF X_BITS(CTR+POPNUM(CTR)-1) = 1 THEN (1611)
          if (1
              & (xEQ (
                  bitToFixed (
                      (putBITp (
                           16, mX_BITSxCTR,
                           fixedToBit (
                               32,
                               (int32_t)(xsubtract (
                                   xadd (
                                       COREHALFWORD (mGET_VAR_REF_CELLxCTR),
                                       bitToFixed ((
                                           putBITp (
                                               16, mPOPNUMxCTR,
                                               getBIT (16,
                                                       mGET_VAR_REF_CELLxCTR)),
                                           POPNUM (0)))),
                                   1)))),
                       X_BITS (0))),
                  1)))
            // REF_INX = REF_INX - 1; (1612)
            {
              int32_t numberRHS = (int32_t)(xsubtract (
                  COREHALFWORD (mGET_VAR_REF_CELLxREF_INX), 1));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mGET_VAR_REF_CELLxREF_INX, bitRHS);
              bitRHS->inUse = 0;
            }
        es2s2:;
        } // End of DO block
      // IF DSUB_LOC ~= 0 THEN (1613)
      if (1 & (xNEQ (COREHALFWORD (mDSUB_LOC), 0)))
        // DO; (1614)
        {
        rs2s3:;
          // CTR = DSUB_LOC; (1615)
          {
            descriptor_t *bitRHS = getBIT (16, mDSUB_LOC);
            putBIT (16, mGET_VAR_REF_CELLxCTR, bitRHS);
            bitRHS->inUse = 0;
          }
          // IF TYPE_BITS(CTR+1) = SYT THEN (1616)
          if (1
              & (xEQ (
                  bitToFixed (
                      (putBITp (16, mTYPE_BITSxCTR,
                                fixedToBit (32, (int32_t)(xadd (
                                                    COREHALFWORD (
                                                        mGET_VAR_REF_CELLxCTR),
                                                    1)))),
                       TYPE_BITS (0))),
                  COREHALFWORD (mSYT))))
            // DO; (1617)
            {
            rs2s3s1:;
              // REF_INX = REF_INX + 1; (1618)
              {
                int32_t numberRHS = (int32_t)(xadd (
                    COREHALFWORD (mGET_VAR_REF_CELLxREF_INX), 1));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mGET_VAR_REF_CELLxREF_INX, bitRHS);
                bitRHS->inUse = 0;
              }
              // REF(REF_INX) = SHR(OPR(CTR+1),16); (1619)
              {
                int32_t numberRHS = (int32_t)(SHR (
                    getFIXED (
                        mOPR
                        + 4 * xadd (COREHALFWORD (mGET_VAR_REF_CELLxCTR), 1)),
                    16));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16,
                        mGET_VAR_REF_CELLxREF
                            + 2 * (COREHALFWORD (mGET_VAR_REF_CELLxREF_INX)),
                        bitRHS);
                bitRHS->inUse = 0;
              }
            es2s3s1:;
            } // End of DO block
          // CALL GET_SUBSCRIPTS; (1620)
          GET_VAR_REF_CELLxGET_SUBSCRIPTS (0);
        es2s3:;
        } // End of DO block
      // CELLSIZE = SHL(REF_INX + SUB_INX + 4,1); (1621)
      {
        int32_t numberRHS = (int32_t)(SHL (
            xadd (xadd (COREHALFWORD (mGET_VAR_REF_CELLxREF_INX),
                        COREHALFWORD (mGET_VAR_REF_CELLxSUB_INX)),
                  4),
            1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mCELLSIZE, bitRHS);
        bitRHS->inUse = 0;
      }
      // CELL = GET_CELL(CELLSIZE,ADDR(VMEM_H),MODF+RESV); (1622)
      {
        int32_t numberRHS = (int32_t)((
            putFIXED (mGET_CELLxCELL_SIZE, COREHALFWORD (mCELLSIZE)),
            putFIXED (mGET_CELLxBVAR, ADDR ("VMEM_H", 0x80000000, NULL, 0)),
            putBITp (8, mGET_CELLxFLAGS,
                     fixedToBit (
                         32, (int32_t)(xadd (BYTE0 (mMODF), BYTE0 (mRESV))))),
            GET_CELL (0)));
        putFIXED (mGET_VAR_REF_CELLxCELL, numberRHS);
      }
      // VMEM_H(0) = CELLSIZE; (1623)
      {
        descriptor_t *bitRHS = getBIT (16, mCELLSIZE);
        putBIT (16, getFIXED (mVMEM_H) + 2 * (0), bitRHS);
        bitRHS->inUse = 0;
      }
      // VMEM_H(1) = REF_INX; (1624)
      {
        descriptor_t *bitRHS = getBIT (16, mGET_VAR_REF_CELLxREF_INX);
        putBIT (16, getFIXED (mVMEM_H) + 2 * (1), bitRHS);
        bitRHS->inUse = 0;
      }
      // DO I = 1 TO REF_INX; (1625)
      {
        int32_t from38, to38, by38;
        from38 = 1;
        to38 = bitToFixed (getBIT (16, mGET_VAR_REF_CELLxREF_INX));
        by38 = 1;
        for (putBIT (16, mGET_VAR_REF_CELLxI, fixedToBit (16, from38));
             bitToFixed (getBIT (16, mGET_VAR_REF_CELLxI)) <= to38; putBIT (
                 16, mGET_VAR_REF_CELLxI,
                 fixedToBit (16, bitToFixed (getBIT (16, mGET_VAR_REF_CELLxI))
                                     + by38)))
          {
            // VMEM_H(I+3) = REF(I); (1626)
            {
              descriptor_t *bitRHS
                  = getBIT (16, mGET_VAR_REF_CELLxREF
                                    + 2 * COREHALFWORD (mGET_VAR_REF_CELLxI));
              putBIT (16,
                      getFIXED (mVMEM_H)
                          + 2 * (xadd (COREHALFWORD (mGET_VAR_REF_CELLxI), 3)),
                      bitRHS);
              bitRHS->inUse = 0;
            }
          }
      } // End of DO for-loop block
      // DO I = 1 TO SUB_INX; (1627)
      {
        int32_t from39, to39, by39;
        from39 = 1;
        to39 = bitToFixed (getBIT (16, mGET_VAR_REF_CELLxSUB_INX));
        by39 = 1;
        for (putBIT (16, mGET_VAR_REF_CELLxI, fixedToBit (16, from39));
             bitToFixed (getBIT (16, mGET_VAR_REF_CELLxI)) <= to39; putBIT (
                 16, mGET_VAR_REF_CELLxI,
                 fixedToBit (16, bitToFixed (getBIT (16, mGET_VAR_REF_CELLxI))
                                     + by39)))
          {
            // VMEM_H(I+REF_INX+3) = SUBS(I); (1628)
            {
              descriptor_t *bitRHS
                  = getBIT (16, mGET_VAR_REF_CELLxSUBS
                                    + 2 * COREHALFWORD (mGET_VAR_REF_CELLxI));
              putBIT (
                  16,
                  getFIXED (mVMEM_H)
                      + 2
                            * (xadd (xadd (COREHALFWORD (mGET_VAR_REF_CELLxI),
                                           COREHALFWORD (
                                               mGET_VAR_REF_CELLxREF_INX)),
                                     3)),
                  bitRHS);
              bitRHS->inUse = 0;
            }
          }
      } // End of DO for-loop block
      // IF SUB_INX > 0 THEN (1629)
      if (1 & (xGT (COREHALFWORD (mGET_VAR_REF_CELLxSUB_INX), 0)))
        // VMEM_H(1) = VMEM_H(1) |  32768; (1630)
        {
          int32_t numberRHS = (int32_t)(xOR (
              COREHALFWORD (getFIXED (mVMEM_H) + 2 * 1), 32768));
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (16, getFIXED (mVMEM_H) + 2 * (1), bitRHS);
          bitRHS->inUse = 0;
        }
      // IF ~INITIALIZING THEN (1631)
      if (1 & (xNOT (BYTE0 (mINITIALIZING))))
        // DO; (1632)
        {
        rs2s6:;
          // COREWORD(ADDR(NODE_F)) = VMEM_LOC_ADDR; (1633)
          {
            int32_t numberRHS = (int32_t)(getFIXED (mVMEM_LOC_ADDR));
            COREWORD2 (ADDR ("GET_VAR_REF_CELLxNODE_F", 0x80000000, NULL, 0),
                       numberRHS);
          }
          // NODE_F(1) = GET_EXP_VARS_CELL; (1634)
          {
            int32_t numberRHS = (int32_t)(GET_EXP_VARS_CELL (0));
            putFIXED (getFIXED (mGET_VAR_REF_CELLxNODE_F) + 4 * (1),
                      numberRHS);
          }
        es2s6:;
        } // End of DO block
      // CALL PTR_LOCATE(CELL,RELS); (1635)
      {
        putFIXED (mPTR_LOCATExPTR, getFIXED (mGET_VAR_REF_CELLxCELL));
        putBITp (8, mPTR_LOCATExFLAGS, getBIT (8, mRELS));
        PTR_LOCATE (0);
      }
      // TSUB_LOC, EXTN_LOC, DSUB_LOC, REF_INX, SUB_INX = 0; (1636)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mTSUB_LOC, bitRHS);
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mEXTN_LOC, bitRHS);
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mDSUB_LOC, bitRHS);
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGET_VAR_REF_CELLxREF_INX, bitRHS);
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGET_VAR_REF_CELLxSUB_INX, bitRHS);
        bitRHS->inUse = 0;
      }
    es2:;
    } // End of DO block
  // RETURN CELL; (1637)
  {
    reentryGuard = 0;
    return getFIXED (mGET_VAR_REF_CELLxCELL);
  }
}
