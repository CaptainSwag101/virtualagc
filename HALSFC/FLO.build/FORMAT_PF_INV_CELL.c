/*
  File FORMAT_PF_INV_CELL.c generated by XCOM-I, 2024-08-09 12:38:39.
*/

#include "runtimeC.h"

int32_t
FORMAT_PF_INV_CELL (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "FORMAT_PF_INV_CELL");
  // CALL LOCATE(PTR,ADDR(VMEM_H),0); (2618)
  {
    putFIXED (mLOCATExPTR, getFIXED (mFORMAT_PF_INV_CELLxPTR));
    putFIXED (mLOCATExBVAR, ADDR ("VMEM_H", 0x80000000, NULL, 0));
    putBITp (8, mLOCATExFLAGS, fixedToBit (32, (int32_t)(0)));
    LOCATE (0);
  }
  // COREWORD(ADDR(VMEM_F)) = VMEM_LOC_ADDR; (2619)
  {
    int32_t numberRHS = (int32_t)(getFIXED (mVMEM_LOC_ADDR));
    COREWORD2 (ADDR ("VMEM_F", 0x80000000, NULL, 0), numberRHS);
  }
  // S = SYT_NAME(VMEM_H(3)); (2620)
  {
    descriptor_t *stringRHS;
    stringRHS = getCHARACTER (
        getFIXED (mSYM_TAB) + 34 * (COREHALFWORD (getFIXED (mVMEM_H) + 2 * 3))
        + 0 + 4 * (0));
    putCHARACTER (mS, stringRHS);
    stringRHS->inUse = 0;
  }
  // #ASSIGN = VMEM_H(1) - VMEM_H(2); (2621)
  {
    int32_t numberRHS
        = (int32_t)(xsubtract (COREHALFWORD (getFIXED (mVMEM_H) + 2 * 1),
                               COREHALFWORD (getFIXED (mVMEM_H) + 2 * 2)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mFORMAT_PF_INV_CELLxpASSIGN, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF #ASSIGN>0 THEN (2622)
  if (1 & (xGT (COREHALFWORD (mFORMAT_PF_INV_CELLxpASSIGN), 0)))
    // DO; (2623)
    {
    rs1:;
      // S(2) = ''; (2624)
      {
        descriptor_t *stringRHS;
        stringRHS = cToDescriptor (NULL, "");
        putCHARACTER (mS + 4 * (2), stringRHS);
        stringRHS->inUse = 0;
      }
      // DO J = 1 TO #ASSIGN; (2625)
      {
        int32_t from55, to55, by55;
        from55 = 1;
        to55 = bitToFixed (getBIT (16, mFORMAT_PF_INV_CELLxpASSIGN));
        by55 = 1;
        for (putBIT (16, mFORMAT_PF_INV_CELLxJ, fixedToBit (16, from55));
             bitToFixed (getBIT (16, mFORMAT_PF_INV_CELLxJ)) <= to55;
             putBIT (16, mFORMAT_PF_INV_CELLxJ,
                     fixedToBit (
                         16, bitToFixed (getBIT (16, mFORMAT_PF_INV_CELLxJ))
                                 + by55)))
          {
            // K = VMEM_H(1) + 2 - J; (2626)
            {
              int32_t numberRHS = (int32_t)(xsubtract (
                  xadd (COREHALFWORD (getFIXED (mVMEM_H) + 2 * 1), 2),
                  COREHALFWORD (mFORMAT_PF_INV_CELLxJ)));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mFORMAT_PF_INV_CELLxK, bitRHS);
              bitRHS->inUse = 0;
            }
            // IF VMEM_F(K) = 0 THEN (2627)
            if (1
                & (xEQ (getFIXED (getFIXED (mVMEM_F)
                                  + 4 * COREHALFWORD (mFORMAT_PF_INV_CELLxK)),
                        0)))
              // S(2) = ',-' || S(2); (2628)
              {
                descriptor_t *stringRHS;
                stringRHS = xsCAT (cToDescriptor (NULL, ",-"),
                                   getCHARACTER (mS + 4 * 2));
                putCHARACTER (mS + 4 * (2), stringRHS);
                stringRHS->inUse = 0;
              }
            // ELSE (2629)
            else
              // IF (VMEM_F(K) &  3221225472) =  3221225472 THEN (2630)
              if (1
                  & (xEQ (
                      xAND (getFIXED (
                                getFIXED (mVMEM_F)
                                + 4 * COREHALFWORD (mFORMAT_PF_INV_CELLxK)),
                            3221225472),
                      3221225472)))
                // S(2) = ','||SYT_NAME(VMEM_F(K) &  1073741823)||S(2); (2631)
                {
                  descriptor_t *stringRHS;
                  stringRHS = xsCAT (
                      xsCAT (
                          cToDescriptor (NULL, ","),
                          getCHARACTER (
                              getFIXED (mSYM_TAB)
                              + 34
                                    * (xAND (
                                        getFIXED (
                                            getFIXED (mVMEM_F)
                                            + 4
                                                  * COREHALFWORD (
                                                      mFORMAT_PF_INV_CELLxK)),
                                        1073741823))
                              + 0 + 4 * (0))),
                      getCHARACTER (mS + 4 * 2));
                  putCHARACTER (mS + 4 * (2), stringRHS);
                  stringRHS->inUse = 0;
                }
              // ELSE (2632)
              else
                // DO; (2633)
                {
                rs1s1s1:;
                  // CALL STACK_PTR(VMEM_F(K),LEVEL+1); (2634)
                  {
                    putFIXED (
                        mSTACK_PTRxPTR,
                        getFIXED (getFIXED (mVMEM_F)
                                  + 4 * COREHALFWORD (mFORMAT_PF_INV_CELLxK)));
                    putBITp (16, mSTACK_PTRxLEVEL,
                             fixedToBit (32, (int32_t)(xadd (
                                                 COREHALFWORD (mLEVEL), 1))));
                    STACK_PTR (0);
                  }
                  // S(2)= ','||HEX(VMEM_F(K) &  1073741823,8)||S(2); (2635)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = xsCAT (
                        xsCAT (
                            cToDescriptor (NULL, ","),
                            (putFIXED (
                                 mHEXxHVAL,
                                 xAND (getFIXED (
                                           getFIXED (mVMEM_F)
                                           + 4
                                                 * COREHALFWORD (
                                                     mFORMAT_PF_INV_CELLxK)),
                                       1073741823)),
                             putFIXED (mHEXxN, 8), HEX (0))),
                        getCHARACTER (mS + 4 * 2));
                    putCHARACTER (mS + 4 * (2), stringRHS);
                    stringRHS->inUse = 0;
                  }
                es1s1s1:;
                } // End of DO block
          }
      } // End of DO for-loop block
      // S(2) = ' ASSIGN(' || SUBSTR(S(2),1) || ')'; (2636)
      {
        descriptor_t *stringRHS;
        stringRHS = xsCAT (xsCAT (cToDescriptor (NULL, " ASSIGN("),
                                  SUBSTR2 (getCHARACTER (mS + 4 * 2), 1)),
                           cToDescriptor (NULL, ")"));
        putCHARACTER (mS + 4 * (2), stringRHS);
        stringRHS->inUse = 0;
      }
    es1:;
    } // End of DO block
  // ELSE (2637)
  else
    // S(2) = ''; (2638)
    {
      descriptor_t *stringRHS;
      stringRHS = cToDescriptor (NULL, "");
      putCHARACTER (mS + 4 * (2), stringRHS);
      stringRHS->inUse = 0;
    }
  // S(1) = ')'; (2639)
  {
    descriptor_t *stringRHS;
    stringRHS = cToDescriptor (NULL, ")");
    putCHARACTER (mS + 4 * (1), stringRHS);
    stringRHS->inUse = 0;
  }
  // IF VMEM_H(2) > 0 THEN (2640)
  if (1 & (xGT (COREHALFWORD (getFIXED (mVMEM_H) + 2 * 2), 0)))
    // DO; (2641)
    {
    rs2:;
      // DO J = 1 TO VMEM_H(2); (2642)
      {
        int32_t from56, to56, by56;
        from56 = 1;
        to56 = bitToFixed (getBIT (16, getFIXED (mVMEM_H) + 2 * 2));
        by56 = 1;
        for (putBIT (16, mFORMAT_PF_INV_CELLxJ, fixedToBit (16, from56));
             bitToFixed (getBIT (16, mFORMAT_PF_INV_CELLxJ)) <= to56;
             putBIT (16, mFORMAT_PF_INV_CELLxJ,
                     fixedToBit (
                         16, bitToFixed (getBIT (16, mFORMAT_PF_INV_CELLxJ))
                                 + by56)))
          {
            // K = VMEM_H(2) + 2 - J; (2643)
            {
              int32_t numberRHS = (int32_t)(xsubtract (
                  xadd (COREHALFWORD (getFIXED (mVMEM_H) + 2 * 2), 2),
                  COREHALFWORD (mFORMAT_PF_INV_CELLxJ)));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mFORMAT_PF_INV_CELLxK, bitRHS);
              bitRHS->inUse = 0;
            }
            // IF VMEM_F(K) = 0 THEN (2644)
            if (1
                & (xEQ (getFIXED (getFIXED (mVMEM_F)
                                  + 4 * COREHALFWORD (mFORMAT_PF_INV_CELLxK)),
                        0)))
              // S(1) = ',-' || S(1); (2645)
              {
                descriptor_t *stringRHS;
                stringRHS = xsCAT (cToDescriptor (NULL, ",-"),
                                   getCHARACTER (mS + 4 * 1));
                putCHARACTER (mS + 4 * (1), stringRHS);
                stringRHS->inUse = 0;
              }
            // ELSE (2646)
            else
              // IF(VMEM_F(K) &  3221225472) =  3221225472 THEN (2647)
              if (1
                  & (xEQ (
                      xAND (getFIXED (
                                getFIXED (mVMEM_F)
                                + 4 * COREHALFWORD (mFORMAT_PF_INV_CELLxK)),
                            3221225472),
                      3221225472)))
                // S(1) = ','||SYT_NAME(VMEM_F(K) &  1073741823)||S(1); (2648)
                {
                  descriptor_t *stringRHS;
                  stringRHS = xsCAT (
                      xsCAT (
                          cToDescriptor (NULL, ","),
                          getCHARACTER (
                              getFIXED (mSYM_TAB)
                              + 34
                                    * (xAND (
                                        getFIXED (
                                            getFIXED (mVMEM_F)
                                            + 4
                                                  * COREHALFWORD (
                                                      mFORMAT_PF_INV_CELLxK)),
                                        1073741823))
                              + 0 + 4 * (0))),
                      getCHARACTER (mS + 4 * 1));
                  putCHARACTER (mS + 4 * (1), stringRHS);
                  stringRHS->inUse = 0;
                }
              // ELSE (2649)
              else
                // DO; (2650)
                {
                rs2s1s1:;
                  // CALL STACK_PTR(VMEM_F(K),LEVEL+1); (2651)
                  {
                    putFIXED (
                        mSTACK_PTRxPTR,
                        getFIXED (getFIXED (mVMEM_F)
                                  + 4 * COREHALFWORD (mFORMAT_PF_INV_CELLxK)));
                    putBITp (16, mSTACK_PTRxLEVEL,
                             fixedToBit (32, (int32_t)(xadd (
                                                 COREHALFWORD (mLEVEL), 1))));
                    STACK_PTR (0);
                  }
                  // S(1) = ','||HEX(VMEM_F(K) &  1073741823,8)||S(1); (2652)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = xsCAT (
                        xsCAT (
                            cToDescriptor (NULL, ","),
                            (putFIXED (
                                 mHEXxHVAL,
                                 xAND (getFIXED (
                                           getFIXED (mVMEM_F)
                                           + 4
                                                 * COREHALFWORD (
                                                     mFORMAT_PF_INV_CELLxK)),
                                       1073741823)),
                             putFIXED (mHEXxN, 8), HEX (0))),
                        getCHARACTER (mS + 4 * 1));
                    putCHARACTER (mS + 4 * (1), stringRHS);
                    stringRHS->inUse = 0;
                  }
                es2s1s1:;
                } // End of DO block
          }
      } // End of DO for-loop block
      // S(1) = SUBSTR(S(1),1); (2653)
      {
        descriptor_t *stringRHS;
        stringRHS = SUBSTR2 (getCHARACTER (mS + 4 * 1), 1);
        putCHARACTER (mS + 4 * (1), stringRHS);
        stringRHS->inUse = 0;
      }
    es2:;
    } // End of DO block
  // S(1) = '(' || S(1); (2654)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (cToDescriptor (NULL, "("), getCHARACTER (mS + 4 * 1));
    putCHARACTER (mS + 4 * (1), stringRHS);
    stringRHS->inUse = 0;
  }
  // CALL FLUSH(2); (2655)
  {
    putBITp (16, mFLUSHxLAST, fixedToBit (32, (int32_t)(2)));
    FLUSH (0);
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
