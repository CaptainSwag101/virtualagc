/*
  File MODIFY_VALIDITY.c generated by XCOM-I, 2024-08-08 04:34:00.
*/

#include "runtimeC.h"

int32_t
MODIFY_VALIDITY (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "MODIFY_VALIDITY");
  // IF ~ZAPS(0) THEN (3252)
  if (1
      & (xNOT (getFIXED (getFIXED (mOBPS) + 4 * (COREHALFWORD (mZAP_LEVEL)) + 0
                         + 4 * (0)))))
    // DO FOR K = 0 TO SYT_WORDS; (3253)
    {
      int32_t from76, to76, by76;
      from76 = 0;
      to76 = SHR (COREHALFWORD (mSYT_USED), 5);
      by76 = 1;
      for (putBIT (16, mMODIFY_VALIDITYxK, fixedToBit (16, from76));
           bitToFixed (getBIT (16, mMODIFY_VALIDITYxK)) <= to76;
           putBIT (16, mMODIFY_VALIDITYxK,
                   fixedToBit (16, bitToFixed (getBIT (16, mMODIFY_VALIDITYxK))
                                       + by76)))
        {
          // VALIDITY_ARRAY(K) = VALIDITY_ARRAY(K) & ~ZAPS(K); (3254)
          {
            int32_t numberRHS = (int32_t)(xAND (
                getFIXED (getFIXED (mVAL_TABLE) + 4 * (COREHALFWORD (mLEVEL))
                          + 0 + 4 * (COREHALFWORD (mMODIFY_VALIDITYxK))),
                xNOT (getFIXED (getFIXED (mOBPS)
                                + 4 * (COREHALFWORD (mZAP_LEVEL)) + 0
                                + 4 * (COREHALFWORD (mMODIFY_VALIDITYxK))))));
            putFIXED (getFIXED (mVAL_TABLE) + 4 * (COREHALFWORD (mLEVEL)) + 0
                          + 4 * (COREHALFWORD (mMODIFY_VALIDITYxK)),
                      numberRHS);
          }
        }
    } // End of DO for-loop block
  // ELSE (3255)
  else
    // DO FOR K = 0 TO SYT_WORDS; (3256)
    {
      int32_t from77, to77, by77;
      from77 = 0;
      to77 = SHR (COREHALFWORD (mSYT_USED), 5);
      by77 = 1;
      for (putBIT (16, mMODIFY_VALIDITYxK, fixedToBit (16, from77));
           bitToFixed (getBIT (16, mMODIFY_VALIDITYxK)) <= to77;
           putBIT (16, mMODIFY_VALIDITYxK,
                   fixedToBit (16, bitToFixed (getBIT (16, mMODIFY_VALIDITYxK))
                                       + by77)))
        {
          // VALIDITY_ARRAY(K) = 0; (3257)
          {
            int32_t numberRHS = (int32_t)(0);
            putFIXED (getFIXED (mVAL_TABLE) + 4 * (COREHALFWORD (mLEVEL)) + 0
                          + 4 * (COREHALFWORD (mMODIFY_VALIDITYxK)),
                      numberRHS);
          }
        }
    } // End of DO for-loop block
  {
    reentryGuard = 0;
    return 0;
  }
}
