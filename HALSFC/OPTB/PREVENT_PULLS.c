/*
  File PREVENT_PULLS.c generated by XCOM-I, 2024-08-08 04:34:00.
*/

#include "runtimeC.h"

int32_t
PREVENT_PULLS (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "PREVENT_PULLS");
  // A_INX = 1; (3403)
  {
    int32_t numberRHS = (int32_t)(1);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mA_INX, bitRHS);
    bitRHS->inUse = 0;
  }
  // ADD(1) = PTR; (3404)
  {
    descriptor_t *bitRHS = getBIT (16, mPREVENT_PULLSxPTR);
    putBIT (16, mADD + 2 * (1), bitRHS);
    bitRHS->inUse = 0;
  }
  // DO WHILE A_INX > 0; (3405)
  while (1 & (xGT (COREHALFWORD (mA_INX), 0)))
    {
      // ADD = ADD(A_INX); (3406)
      {
        descriptor_t *bitRHS = getBIT (16, mADD + 2 * COREHALFWORD (mA_INX));
        putBIT (16, mADD, bitRHS);
        bitRHS->inUse = 0;
      }
      // A_INX = A_INX - 1; (3407)
      {
        int32_t numberRHS = (int32_t)(xsubtract (COREHALFWORD (mA_INX), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mA_INX, bitRHS);
        bitRHS->inUse = 0;
      }
      // DO FOR K = ADD + 1 TO LAST_OPERAND(ADD); (3408)
      {
        int32_t from86, to86, by86;
        from86 = xadd (COREHALFWORD (mADD), 1);
        to86 = bitToFixed ((putBITp (16, mLAST_OPERANDxPTR, getBIT (16, mADD)),
                            LAST_OPERAND (0)));
        by86 = 1;
        for (putBIT (16, mPREVENT_PULLSxK, fixedToBit (16, from86));
             bitToFixed (getBIT (16, mPREVENT_PULLSxK)) <= to86;
             putBIT (16, mPREVENT_PULLSxK,
                     fixedToBit (16, bitToFixed (getBIT (16, mPREVENT_PULLSxK))
                                         + by86)))
          {
            // TYPE = XHALMAT_QUAL(K); (3409)
            {
              descriptor_t *bitRHS = (putBITp (16, mXHALMAT_QUALxPTR,
                                               getBIT (16, mPREVENT_PULLSxK)),
                                      XHALMAT_QUAL (0));
              putBIT (16, mPREVENT_PULLSxTYPE, bitRHS);
              bitRHS->inUse = 0;
            }
            // PTR = SHR(OPR(K),16); (3410)
            {
              int32_t numberRHS = (int32_t)(SHR (
                  getFIXED (mOPR + 4 * COREHALFWORD (mPREVENT_PULLSxK)), 16));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mPREVENT_PULLSxPTR, bitRHS);
              bitRHS->inUse = 0;
            }
            // IF TYPE = XVAC OR TYPE = XXPT THEN (3411)
            if (1
                & (xOR (xEQ (COREHALFWORD (mPREVENT_PULLSxTYPE),
                             COREHALFWORD (mXVAC)),
                        xEQ (COREHALFWORD (mPREVENT_PULLSxTYPE),
                             COREHALFWORD (mXXPT)))))
              // CALL BUMP_ADD(PTR); (3412)
              {
                putBITp (16, mBUMP_ADDxPTR, getBIT (16, mPREVENT_PULLSxPTR));
                BUMP_ADD (0);
              }
            // ELSE (3413)
            else
              // IF TYPE = XSYT THEN (3414)
              if (1
                  & (xEQ (COREHALFWORD (mPREVENT_PULLSxTYPE),
                          COREHALFWORD (mXSYT))))
                // CALL SET_VALIDITY(PTR,0,1); (3415)
                {
                  putBITp (16, mSET_VALIDITYxPTR,
                           getBIT (16, mPREVENT_PULLSxPTR));
                  putBITp (8, mSET_VALIDITYxVAL,
                           fixedToBit (32, (int32_t)(0)));
                  putBITp (8, mSET_VALIDITYxZAPS_ONLY,
                           fixedToBit (32, (int32_t)(1)));
                  SET_VALIDITY (0);
                }
          }
      } // End of DO for-loop block
    }   // End of DO WHILE block
  {
    reentryGuard = 0;
    return 0;
  }
}
