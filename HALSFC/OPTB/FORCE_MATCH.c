/*
  File FORCE_MATCH.c generated by XCOM-I, 2024-08-09 12:41:08.
*/

#include "runtimeC.h"

int32_t
FORCE_MATCH (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "FORCE_MATCH");
  // IF TRACE THEN (4346)
  if (1 & (bitToFixed (getBIT (8, mTRACE))))
    // OUTPUT = 'FORCE_MATCH: ' || PTR ||','||INVERSE; (4347)
    {
      descriptor_t *stringRHS;
      stringRHS = xsCAT (
          xsCAT (xsCAT (cToDescriptor (NULL, "FORCE_MATCH: "),
                        bitToCharacter (getBIT (16, mFORCE_MATCHxPTR))),
                 cToDescriptor (NULL, ",")),
          bitToCharacter (getBIT (8, mFORCE_MATCHxINVERSE)));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // NEW = NEXT_FLAG(PTR,1); (4348)
  {
    int32_t numberRHS = (int32_t)((
        putBITp (16, mNEXT_FLAGxPTR, getBIT (16, mFORCE_MATCHxPTR)),
        putBITp (16, mNEXT_FLAGxBITp, fixedToBit (32, (int32_t)(1))),
        NEXT_FLAG (0)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mFORCE_MATCHxNEW, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO WHILE (SHR(FLAG(NEW),2) &  1) ~= INVERSE; (4349)
  while (
      1
      & (xNEQ (
          xAND (SHR (BYTE0 (mFLAG + 1 * COREHALFWORD (mFORCE_MATCHxNEW)), 2),
                1),
          BYTE0 (mFORCE_MATCHxINVERSE))))
    {
      // NEW = NEW + 1; (4350)
      {
        int32_t numberRHS
            = (int32_t)(xadd (COREHALFWORD (mFORCE_MATCHxNEW), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mFORCE_MATCHxNEW, bitRHS);
        bitRHS->inUse = 0;
      }
      // NEW = NEXT_FLAG(NEW,1); (4351)
      {
        int32_t numberRHS = (int32_t)((
            putBITp (16, mNEXT_FLAGxPTR, getBIT (16, mFORCE_MATCHxNEW)),
            putBITp (16, mNEXT_FLAGxBITp, fixedToBit (32, (int32_t)(1))),
            NEXT_FLAG (0)));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mFORCE_MATCHxNEW, bitRHS);
        bitRHS->inUse = 0;
      }
    } // End of DO WHILE block
  // IF PTR ~= NEW THEN (4352)
  if (1
      & (xNEQ (COREHALFWORD (mFORCE_MATCHxPTR),
               COREHALFWORD (mFORCE_MATCHxNEW))))
    // CALL SWITCH(PTR,NEW); (4353)
    {
      putBITp (16, mSWITCHxORIG, getBIT (16, mFORCE_MATCHxPTR));
      putBITp (16, mSWITCHxPTR, getBIT (16, mFORCE_MATCHxNEW));
      SWITCH (0);
    }
  // INVERSE = 0; (4354)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mFORCE_MATCHxINVERSE, bitRHS);
    bitRHS->inUse = 0;
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
