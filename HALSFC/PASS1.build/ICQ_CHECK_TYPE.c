/*
  File ICQ_CHECK_TYPE.c generated by XCOM-I, 2024-08-09 12:38:15.
*/

#include "runtimeC.h"

descriptor_t *
ICQ_CHECK_TYPE (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (descriptor_t *)0;
    }
  reentryGuard = guardReentry (reentryGuard, "ICQ_CHECK_TYPE");
  // I=IC_TYPE(J)& 127; (8950)
  {
    int32_t numberRHS = (int32_t)(xAND (
        BYTE0 (mIC_TYPE + 1 * COREHALFWORD (mICQ_CHECK_TYPExJ)), 127));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mICQ_CHECK_TYPExI, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF NAME_IMPLIED THEN (8951)
  if (1 & (bitToFixed (getBIT (1, mNAME_IMPLIED))))
    // RETURN XNINT; (8952)
    {
      reentryGuard = 0;
      return getBIT (16, mXNINT);
    }
  // IF SYT_TYPE(ID_LOC)=MAJ_STRUC THEN (8953)
  if (1
      & (xEQ (BYTE0 (getFIXED (mSYM_TAB) + 34 * (getFIXED (mID_LOC)) + 32
                     + 1 * (0)),
              10)))
    // RETURN XTINT; (8954)
    {
      reentryGuard = 0;
      return getBIT (16, mXTINT);
    }
  // ELSE (8955)
  else
    // SYT=ID_LOC; (8956)
    {
      int32_t numberRHS = (int32_t)(getFIXED (mID_LOC));
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mICQ_CHECK_TYPExSYT, bitRHS);
      bitRHS->inUse = 0;
    }
  // IF SYT_TYPE(SYT) = CHAR_TYPE THEN (8957)
  if (1
      & (xEQ (BYTE0 (getFIXED (mSYM_TAB)
                     + 34 * (COREHALFWORD (mICQ_CHECK_TYPExSYT)) + 32
                     + 1 * (0)),
              2)))
    // DO; (8958)
    {
    rs1:;
      // IF I ~= CHAR_TYPE THEN (8959)
      if (1 & (xNEQ (COREHALFWORD (mICQ_CHECK_TYPExI), 2)))
        // CALL ERROR(CLASS_DI,6,VAR(MP)); (8960)
        {
          putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_DI));
          putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(6)));
          putCHARACTERp (mERRORxTEXT,
                         getCHARACTER (mVAR + 4 * getFIXED (mMP)));
          ERROR (0);
        }
      // RETURN XBINT(CHAR_TYPE-BIT_TYPE); (8961)
      {
        reentryGuard = 0;
        return getBIT (16, mXBINT + 2 * 1);
      }
    es1:;
    } // End of DO block
  // IF SYT_TYPE(SYT) = BIT_TYPE THEN (8962)
  if (1
      & (xEQ (BYTE0 (getFIXED (mSYM_TAB)
                     + 34 * (COREHALFWORD (mICQ_CHECK_TYPExSYT)) + 32
                     + 1 * (0)),
              1)))
    // DO; (8963)
    {
    rs2:;
      // IF I ~= BIT_TYPE THEN (8964)
      if (1 & (xNEQ (COREHALFWORD (mICQ_CHECK_TYPExI), 1)))
        // CALL ERROR(CLASS_DI,7,VAR(MP)); (8965)
        {
          putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_DI));
          putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(7)));
          putCHARACTERp (mERRORxTEXT,
                         getCHARACTER (mVAR + 4 * getFIXED (mMP)));
          ERROR (0);
        }
      // RETURN XBINT; (8966)
      {
        reentryGuard = 0;
        return getBIT (16, mXBINT);
      }
    es2:;
    } // End of DO block
  // IF SYT_TYPE(SYT) = EVENT_TYPE THEN (8967)
  if (1
      & (xEQ (BYTE0 (getFIXED (mSYM_TAB)
                     + 34 * (COREHALFWORD (mICQ_CHECK_TYPExSYT)) + 32
                     + 1 * (0)),
              9)))
    // DO; (8968)
    {
    rs3:;
      // IF I ~= BIT_TYPE THEN (8969)
      if (1 & (xNEQ (COREHALFWORD (mICQ_CHECK_TYPExI), 1)))
        // CALL ERROR(CLASS_DI,7,VAR(MP)); (8970)
        {
          putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_DI));
          putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(7)));
          putCHARACTERp (mERRORxTEXT,
                         getCHARACTER (mVAR + 4 * getFIXED (mMP)));
          ERROR (0);
        }
      // RETURN XBINT; (8971)
      {
        reentryGuard = 0;
        return getBIT (16, mXBINT);
      }
    es3:;
    } // End of DO block
  // IF (I~=INT_TYPE)&(I~=SCALAR_TYPE) THEN (8972)
  if (1
      & (xAND (xNEQ (COREHALFWORD (mICQ_CHECK_TYPExI), 6),
               xNEQ (COREHALFWORD (mICQ_CHECK_TYPExI), 5))))
    // CALL ERROR(CLASS_DI,8,VAR(MP)); (8973)
    {
      putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_DI));
      putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(8)));
      putCHARACTERp (mERRORxTEXT, getCHARACTER (mVAR + 4 * getFIXED (mMP)));
      ERROR (0);
    }
  // IF K THEN (8974)
  if (1 & (bitToFixed (getBIT (1, mICQ_CHECK_TYPExK))))
    // RETURN XBINT(SYT_TYPE(SYT)-BIT_TYPE); (8975)
    {
      reentryGuard = 0;
      return getBIT (
          16, mXBINT
                  + 2
                        * xsubtract (
                            BYTE0 (getFIXED (mSYM_TAB)
                                   + 34 * (COREHALFWORD (mICQ_CHECK_TYPExSYT))
                                   + 32 + 1 * (0)),
                            1));
    }
  // RETURN XBINT(SCALAR_TYPE-BIT_TYPE); (8976)
  {
    reentryGuard = 0;
    return getBIT (16, mXBINT + 2 * 4);
  }
}
