/*
  File PRINT_REPLACE_TEXT.c generated by XCOM-I, 2024-08-08 04:33:20.
*/

#include "runtimeC.h"

int32_t
PRINT_REPLACE_TEXT (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "PRINT_REPLACE_TEXT");
  // M_CHAR_PTR,WAS_HERE = 0; (877)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mPRINT_REPLACE_TEXTxM_CHAR_PTR, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mPRINT_REPLACE_TEXTxWAS_HERE, bitRHS);
    bitRHS->inUse = 0;
  }
  // BUILD_M = X10||'REPLACE TEXT('||#BYTES||' BYTE'||S(#BYTES~=1)||'):  "';
  // (878)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (
        xsCAT (xsCAT (xsCAT (xsCAT (getCHARACTER (mX10),
                                    cToDescriptor (NULL, "REPLACE TEXT(")),
                             fixedToCharacter (
                                 getFIXED (mPRINT_REPLACE_TEXTxpBYTES))),
                      cToDescriptor (NULL, " BYTE")),
               getCHARACTER (
                   mPRINT_REPLACE_TEXTxS
                   + 4 * xNEQ (getFIXED (mPRINT_REPLACE_TEXTxpBYTES), 1))),
        cToDescriptor (NULL, "):  \""));
    putCHARACTER (mPRINT_REPLACE_TEXTxBUILD_M, stringRHS);
    stringRHS->inUse = 0;
  }
  // M_PTR = LENGTH(BUILD_M); (879)
  {
    int32_t numberRHS
        = (int32_t)(LENGTH (getCHARACTER (mPRINT_REPLACE_TEXTxBUILD_M)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mPRINT_REPLACE_TEXTxM_PTR, bitRHS);
    bitRHS->inUse = 0;
  }
  // BUILD_M = BUILD_M || X28 || X72; (880)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (xsCAT (getCHARACTER (mPRINT_REPLACE_TEXTxBUILD_M),
                              getCHARACTER (mX28)),
                       getCHARACTER (mX72));
    putCHARACTER (mPRINT_REPLACE_TEXTxBUILD_M, stringRHS);
    stringRHS->inUse = 0;
  }
// NEXT_CELL: (881)
NEXT_CELL:
  // CALL SDF_LOCATE(TEXT_PTR,ADDR(NODE_F),0); (882)
  {
    putFIXED (mSDF_LOCATExPTR, getFIXED (mPRINT_REPLACE_TEXTxTEXT_PTR));
    putFIXED (mSDF_LOCATExBVAR,
              ADDR ("PRINT_REPLACE_TEXTxNODE_F", 0x80000000, NULL, 0));
    putBITp (8, mSDF_LOCATExFLAGS, fixedToBit (32, (int32_t)(0)));
    SDF_LOCATE (0);
  }
  // CELL_SIZE = SHR(NODE_F(1),16); (883)
  {
    int32_t numberRHS = (int32_t)(SHR (
        getFIXED (getFIXED (mPRINT_REPLACE_TEXTxNODE_F) + 4 * 1), 16));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mPRINT_REPLACE_TEXTxCELL_SIZE, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF (CELL_SIZE &  32768) ~= 0 THEN (884)
  if (1
      & (xNEQ (xAND (COREHALFWORD (mPRINT_REPLACE_TEXTxCELL_SIZE), 32768), 0)))
    // DO; (885)
    {
    rs1:;
      // #ARGS = -CELL_SIZE - 1; (886)
      {
        int32_t numberRHS = (int32_t)(xsubtract (
            xminus (COREHALFWORD (mPRINT_REPLACE_TEXTxCELL_SIZE)), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mPRINT_REPLACE_TEXTxpARGS, bitRHS);
        bitRHS->inUse = 0;
      }
      // TEXT_PTR = NODE_F(0); (887)
      {
        int32_t numberRHS = (int32_t)(getFIXED (
            getFIXED (mPRINT_REPLACE_TEXTxNODE_F) + 4 * 0));
        putFIXED (mPRINT_REPLACE_TEXTxTEXT_PTR, numberRHS);
      }
      // IF #ARGS >= 1 THEN (888)
      if (1 & (xGE (COREHALFWORD (mPRINT_REPLACE_TEXTxpARGS), 1)))
        // DO; (889)
        {
        rs1s1:;
          // S1 = X10 || 'REPLACE ARG' || S(#ARGS>1) || ': '; (890)
          {
            descriptor_t *stringRHS;
            stringRHS = xsCAT (
                xsCAT (
                    xsCAT (getCHARACTER (mX10),
                           cToDescriptor (NULL, "REPLACE ARG")),
                    getCHARACTER (
                        mPRINT_REPLACE_TEXTxS
                        + 4
                              * xGT (COREHALFWORD (mPRINT_REPLACE_TEXTxpARGS),
                                     1))),
                cToDescriptor (NULL, ": "));
            putCHARACTER (mPRINT_REPLACE_TEXTxS1, stringRHS);
            stringRHS->inUse = 0;
          }
          // DO J = 1 TO #ARGS; (891)
          {
            int32_t from23, to23, by23;
            from23 = 1;
            to23 = bitToFixed (getBIT (16, mPRINT_REPLACE_TEXTxpARGS));
            by23 = 1;
            for (putBIT (8, mPRINT_REPLACE_TEXTxJ, fixedToBit (8, from23));
                 bitToFixed (getBIT (8, mPRINT_REPLACE_TEXTxJ)) <= to23;
                 putBIT (8, mPRINT_REPLACE_TEXTxJ,
                         fixedToBit (
                             8, bitToFixed (getBIT (8, mPRINT_REPLACE_TEXTxJ))
                                    + by23)))
              {
                // COREWORD(ADDR(S2)) = LOC_ADDR + NODE_F(J+1); (892)
                {
                  int32_t numberRHS = (int32_t)(xadd (
                      getFIXED (mLOC_ADDR),
                      getFIXED (
                          getFIXED (mPRINT_REPLACE_TEXTxNODE_F)
                          + 4 * xadd (BYTE0 (mPRINT_REPLACE_TEXTxJ), 1))));
                  COREWORD2 (ADDR (NULL, 0, "PRINT_REPLACE_TEXTxS2", 0),
                             numberRHS);
                }
                // IF LENGTH(S1) + LENGTH(S2) > LINELENGTH THEN (893)
                if (1
                    & (xGT (
                        xadd (LENGTH (getCHARACTER (mPRINT_REPLACE_TEXTxS1)),
                              LENGTH (getCHARACTER (mPRINT_REPLACE_TEXTxS2))),
                        131)))
                  // DO; (894)
                  {
                  rs1s1s1s1:;
                    // OUTPUT = S1; (895)
                    {
                      descriptor_t *stringRHS;
                      stringRHS = getCHARACTER (mPRINT_REPLACE_TEXTxS1);
                      OUTPUT (0, stringRHS);
                      stringRHS->inUse = 0;
                    }
                    // S1 = X10 || S2 || ','; (896)
                    {
                      descriptor_t *stringRHS;
                      stringRHS = xsCAT (
                          xsCAT (getCHARACTER (mX10),
                                 getCHARACTER (mPRINT_REPLACE_TEXTxS2)),
                          cToDescriptor (NULL, ","));
                      putCHARACTER (mPRINT_REPLACE_TEXTxS1, stringRHS);
                      stringRHS->inUse = 0;
                    }
                  es1s1s1s1:;
                  } // End of DO block
                // ELSE (897)
                else
                  // S1 = S1 || S2 || ','; (898)
                  {
                    descriptor_t *stringRHS;
                    stringRHS
                        = xsCAT (xsCAT (getCHARACTER (mPRINT_REPLACE_TEXTxS1),
                                        getCHARACTER (mPRINT_REPLACE_TEXTxS2)),
                                 cToDescriptor (NULL, ","));
                    putCHARACTER (mPRINT_REPLACE_TEXTxS1, stringRHS);
                    stringRHS->inUse = 0;
                  }
              }
          } // End of DO for-loop block
          // BYTE(S1,LENGTH(S1) - 1) = BYTE(' '); (899)
          {
            int32_t numberRHS = (int32_t)(BYTE1 (cToDescriptor (NULL, " ")));
            lBYTEb (
                ADDR (NULL, 0, "PRINT_REPLACE_TEXTxS1", 0),
                xsubtract (LENGTH (getCHARACTER (mPRINT_REPLACE_TEXTxS1)), 1),
                BYTE1 (cToDescriptor (NULL, " ")));
          }
          // IF LENGTH(S1) + M_PTR < LINELENGTH THEN (900)
          if (1
              & (xLT (xadd (LENGTH (getCHARACTER (mPRINT_REPLACE_TEXTxS1)),
                            COREHALFWORD (mPRINT_REPLACE_TEXTxM_PTR)),
                      131)))
            // DO; (901)
            {
            rs1s1s2:;
              // BUILD_M = S1 || X2 || SUBSTR(BUILD_M,17); (902)
              {
                descriptor_t *stringRHS;
                stringRHS = xsCAT (
                    xsCAT (getCHARACTER (mPRINT_REPLACE_TEXTxS1),
                           getCHARACTER (mX2)),
                    SUBSTR2 (getCHARACTER (mPRINT_REPLACE_TEXTxBUILD_M), 17));
                putCHARACTER (mPRINT_REPLACE_TEXTxBUILD_M, stringRHS);
                stringRHS->inUse = 0;
              }
              // M_PTR = M_PTR + LENGTH(S1) - 15; (903)
              {
                int32_t numberRHS = (int32_t)(xsubtract (
                    xadd (COREHALFWORD (mPRINT_REPLACE_TEXTxM_PTR),
                          LENGTH (getCHARACTER (mPRINT_REPLACE_TEXTxS1))),
                    15));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mPRINT_REPLACE_TEXTxM_PTR, bitRHS);
                bitRHS->inUse = 0;
              }
            es1s1s2:;
            } // End of DO block
          // ELSE (904)
          else
            // OUTPUT = S1; (905)
            {
              descriptor_t *stringRHS;
              stringRHS = getCHARACTER (mPRINT_REPLACE_TEXTxS1);
              OUTPUT (0, stringRHS);
              stringRHS->inUse = 0;
            }
        es1s1:;
        } // End of DO block
      // IF #BYTES ~= 0 THEN (906)
      if (1 & (xNEQ (getFIXED (mPRINT_REPLACE_TEXTxpBYTES), 0)))
        // GO TO NEXT_CELL; (907)
        goto NEXT_CELL;
    es1:;
    } // End of DO block
  // COREWORD(ADDR(NODE_B)) = LOC_ADDR + 6; (908)
  {
    int32_t numberRHS = (int32_t)(xadd (getFIXED (mLOC_ADDR), 6));
    COREWORD2 (ADDR ("PRINT_REPLACE_TEXTxNODE_B", 0x80000000, NULL, 0),
               numberRHS);
  }
  // J = NODE_B(M_CHAR_PTR); (909)
  {
    descriptor_t *bitRHS
        = getBIT (8, getFIXED (mPRINT_REPLACE_TEXTxNODE_B)
                         + 1 * COREHALFWORD (mPRINT_REPLACE_TEXTxM_CHAR_PTR));
    putBIT (8, mPRINT_REPLACE_TEXTxJ, bitRHS);
    bitRHS->inUse = 0;
  }
// LINE_DONE: (910)
LINE_DONE:
  // DO WHILE M_CHAR_PTR<CELL_SIZE & M_PTR<LINELENGTH; (911)
  while (1
         & (xAND (xLT (COREHALFWORD (mPRINT_REPLACE_TEXTxM_CHAR_PTR),
                       COREHALFWORD (mPRINT_REPLACE_TEXTxCELL_SIZE)),
                  xLT (COREHALFWORD (mPRINT_REPLACE_TEXTxM_PTR), 131))))
    {
      // IF J =  238 THEN (912)
      if (1 & (xEQ (BYTE0 (mPRINT_REPLACE_TEXTxJ), 238)))
        // DO; (913)
        {
        rs2s1:;
          // M_CHAR_PTR = M_CHAR_PTR + 1; (914)
          {
            int32_t numberRHS = (int32_t)(xadd (
                COREHALFWORD (mPRINT_REPLACE_TEXTxM_CHAR_PTR), 1));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mPRINT_REPLACE_TEXTxM_CHAR_PTR, bitRHS);
            bitRHS->inUse = 0;
          }
          // J = NODE_B(M_CHAR_PTR); (915)
          {
            descriptor_t *bitRHS = getBIT (
                8, getFIXED (mPRINT_REPLACE_TEXTxNODE_B)
                       + 1 * COREHALFWORD (mPRINT_REPLACE_TEXTxM_CHAR_PTR));
            putBIT (8, mPRINT_REPLACE_TEXTxJ, bitRHS);
            bitRHS->inUse = 0;
          }
          // IF J=0 THEN (916)
          if (1 & (xEQ (BYTE0 (mPRINT_REPLACE_TEXTxJ), 0)))
            // RETURN; (917)
            {
              reentryGuard = 0;
              return 0;
            }
        // NEXT_LINE: (918)
        NEXT_LINE:
          // IF (J + M_PTR)>LINELENGTH THEN (919)
          if (1
              & (xGT (xadd (BYTE0 (mPRINT_REPLACE_TEXTxJ),
                            COREHALFWORD (mPRINT_REPLACE_TEXTxM_PTR)),
                      131)))
            // DO; (920)
            {
            rs2s1s1:;
              // J = J - LINELENGTH + M_PTR; (921)
              {
                int32_t numberRHS = (int32_t)(xadd (
                    xsubtract (BYTE0 (mPRINT_REPLACE_TEXTxJ), 131),
                    COREHALFWORD (mPRINT_REPLACE_TEXTxM_PTR)));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (8, mPRINT_REPLACE_TEXTxJ, bitRHS);
                bitRHS->inUse = 0;
              }
              // OUTPUT = BUILD_M; (922)
              {
                descriptor_t *stringRHS;
                stringRHS = getCHARACTER (mPRINT_REPLACE_TEXTxBUILD_M);
                OUTPUT (0, stringRHS);
                stringRHS->inUse = 0;
              }
              // BUILD_M = X72 || X60; (923)
              {
                descriptor_t *stringRHS;
                stringRHS = xsCAT (getCHARACTER (mX72), getCHARACTER (mX60));
                putCHARACTER (mPRINT_REPLACE_TEXTxBUILD_M, stringRHS);
                stringRHS->inUse = 0;
              }
              // M_PTR = 10; (924)
              {
                int32_t numberRHS = (int32_t)(10);
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mPRINT_REPLACE_TEXTxM_PTR, bitRHS);
                bitRHS->inUse = 0;
              }
              // GO TO NEXT_LINE; (925)
              goto NEXT_LINE;
            es2s1s1:;
            } // End of DO block
          // ELSE (926)
          else
            // M_PTR = M_PTR + J; (927)
            {
              int32_t numberRHS
                  = (int32_t)(xadd (COREHALFWORD (mPRINT_REPLACE_TEXTxM_PTR),
                                    BYTE0 (mPRINT_REPLACE_TEXTxJ)));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mPRINT_REPLACE_TEXTxM_PTR, bitRHS);
              bitRHS->inUse = 0;
            }
        es2s1:;
        } // End of DO block
      // ELSE (928)
      else
        // IF J = BYTE('"') THEN (929)
        if (1
            & (xEQ (BYTE0 (mPRINT_REPLACE_TEXTxJ),
                    BYTE1 (cToDescriptor (NULL, "\"")))))
          // DO; (930)
          {
          rs2s2:;
            // IF WAS_HERE THEN (931)
            if (1 & (bitToFixed (getBIT (8, mPRINT_REPLACE_TEXTxWAS_HERE))))
              // WAS_HERE = FALSE; (932)
              {
                int32_t numberRHS = (int32_t)(0);
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (8, mPRINT_REPLACE_TEXTxWAS_HERE, bitRHS);
                bitRHS->inUse = 0;
              }
            // ELSE (933)
            else
              // DO; (934)
              {
              rs2s2s1:;
                // WAS_HERE = TRUE; (935)
                {
                  int32_t numberRHS = (int32_t)(1);
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (8, mPRINT_REPLACE_TEXTxWAS_HERE, bitRHS);
                  bitRHS->inUse = 0;
                }
                // M_CHAR_PTR = M_CHAR_PTR - 1; (936)
                {
                  int32_t numberRHS = (int32_t)(xsubtract (
                      COREHALFWORD (mPRINT_REPLACE_TEXTxM_CHAR_PTR), 1));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mPRINT_REPLACE_TEXTxM_CHAR_PTR, bitRHS);
                  bitRHS->inUse = 0;
                }
              es2s2s1:;
              } // End of DO block
            // BYTE(BUILD_M,M_PTR) = J; (937)
            {
              descriptor_t *bitRHS = getBIT (8, mPRINT_REPLACE_TEXTxJ);
              lBYTEb (ADDR (NULL, 0, "PRINT_REPLACE_TEXTxBUILD_M", 0),
                      COREHALFWORD (mPRINT_REPLACE_TEXTxM_PTR),
                      BYTE0 (mPRINT_REPLACE_TEXTxJ));
              bitRHS->inUse = 0;
            }
          es2s2:;
          } // End of DO block
        // ELSE (938)
        else
          // BYTE(BUILD_M,M_PTR) = J; (939)
          {
            descriptor_t *bitRHS = getBIT (8, mPRINT_REPLACE_TEXTxJ);
            lBYTEb (ADDR (NULL, 0, "PRINT_REPLACE_TEXTxBUILD_M", 0),
                    COREHALFWORD (mPRINT_REPLACE_TEXTxM_PTR),
                    BYTE0 (mPRINT_REPLACE_TEXTxJ));
            bitRHS->inUse = 0;
          }
      // M_PTR = M_PTR + 1; (940)
      {
        int32_t numberRHS
            = (int32_t)(xadd (COREHALFWORD (mPRINT_REPLACE_TEXTxM_PTR), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mPRINT_REPLACE_TEXTxM_PTR, bitRHS);
        bitRHS->inUse = 0;
      }
      // M_CHAR_PTR = M_CHAR_PTR + 1; (941)
      {
        int32_t numberRHS = (int32_t)(xadd (
            COREHALFWORD (mPRINT_REPLACE_TEXTxM_CHAR_PTR), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mPRINT_REPLACE_TEXTxM_CHAR_PTR, bitRHS);
        bitRHS->inUse = 0;
      }
      // J = NODE_B(M_CHAR_PTR); (942)
      {
        descriptor_t *bitRHS = getBIT (
            8, getFIXED (mPRINT_REPLACE_TEXTxNODE_B)
                   + 1 * COREHALFWORD (mPRINT_REPLACE_TEXTxM_CHAR_PTR));
        putBIT (8, mPRINT_REPLACE_TEXTxJ, bitRHS);
        bitRHS->inUse = 0;
      }
      if (0)
        {
        rs2:
          continue;
        es2:
          break;
        } // block labeled LINE_DONE
    }     // End of DO WHILE block
  // IF M_CHAR_PTR < CELL_SIZE THEN (943)
  if (1
      & (xLT (COREHALFWORD (mPRINT_REPLACE_TEXTxM_CHAR_PTR),
              COREHALFWORD (mPRINT_REPLACE_TEXTxCELL_SIZE))))
    // DO; (944)
    {
    rs3:;
      // OUTPUT = BUILD_M; (945)
      {
        descriptor_t *stringRHS;
        stringRHS = getCHARACTER (mPRINT_REPLACE_TEXTxBUILD_M);
        OUTPUT (0, stringRHS);
        stringRHS->inUse = 0;
      }
      // BUILD_M = X72 || X60; (946)
      {
        descriptor_t *stringRHS;
        stringRHS = xsCAT (getCHARACTER (mX72), getCHARACTER (mX60));
        putCHARACTER (mPRINT_REPLACE_TEXTxBUILD_M, stringRHS);
        stringRHS->inUse = 0;
      }
      // M_PTR = 10; (947)
      {
        int32_t numberRHS = (int32_t)(10);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mPRINT_REPLACE_TEXTxM_PTR, bitRHS);
        bitRHS->inUse = 0;
      }
      // GO TO LINE_DONE; (948)
      goto LINE_DONE;
    es3:;
    } // End of DO block
  // ELSE (949)
  else
    // IF NODE_F(0) ~= 0 THEN (950)
    if (1
        & (xNEQ (getFIXED (getFIXED (mPRINT_REPLACE_TEXTxNODE_F) + 4 * 0), 0)))
      // DO; (951)
      {
      rs4:;
        // TEXT_PTR = NODE_F(0); (952)
        {
          int32_t numberRHS = (int32_t)(getFIXED (
              getFIXED (mPRINT_REPLACE_TEXTxNODE_F) + 4 * 0));
          putFIXED (mPRINT_REPLACE_TEXTxTEXT_PTR, numberRHS);
        }
        // GO TO NEXT_CELL; (953)
        goto NEXT_CELL;
      es4:;
      } // End of DO block
    // ELSE (954)
    else
      // DO; (955)
      {
      rs5:;
        // BYTE(BUILD_M,M_PTR) = BYTE('"'); (956)
        {
          int32_t numberRHS = (int32_t)(BYTE1 (cToDescriptor (NULL, "\"")));
          lBYTEb (ADDR (NULL, 0, "PRINT_REPLACE_TEXTxBUILD_M", 0),
                  COREHALFWORD (mPRINT_REPLACE_TEXTxM_PTR),
                  BYTE1 (cToDescriptor (NULL, "\"")));
        }
        // OUTPUT = BUILD_M; (957)
        {
          descriptor_t *stringRHS;
          stringRHS = getCHARACTER (mPRINT_REPLACE_TEXTxBUILD_M);
          OUTPUT (0, stringRHS);
          stringRHS->inUse = 0;
        }
      es5:;
      } // End of DO block
  {
    reentryGuard = 0;
    return 0;
  }
}
