/*
  File FORMAT_EXP_VARS_CELL.c generated by XCOM-I, 2024-08-08 04:31:35.
*/

#include "runtimeC.h"

int32_t
FORMAT_EXP_VARS_CELL (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "FORMAT_EXP_VARS_CELL");
  // CALL LOCATE(PTR,ADDR(VMEM_H),0); (2583)
  {
    putFIXED (mLOCATExPTR, getFIXED (mFORMAT_EXP_VARS_CELLxPTR));
    putFIXED (mLOCATExBVAR, ADDR ("VMEM_H", 0x80000000, NULL, 0));
    putBITp (8, mLOCATExFLAGS, fixedToBit (32, (int32_t)(0)));
    LOCATE (0);
  }
  // COREWORD(ADDR(VMEM_F)) = VMEM_LOC_ADDR; (2584)
  {
    int32_t numberRHS = (int32_t)(getFIXED (mVMEM_LOC_ADDR));
    COREWORD2 (ADDR ("VMEM_F", 0x80000000, NULL, 0), numberRHS);
  }
  // #SYTS = VMEM_H(1); (2585)
  {
    descriptor_t *bitRHS = getBIT (16, getFIXED (mVMEM_H) + 2 * 1);
    putBIT (16, mFORMAT_EXP_VARS_CELLxpSYTS, bitRHS);
    bitRHS->inUse = 0;
  }
  // S = HEX(PTR,8) || ' --> '; (2586)
  {
    descriptor_t *stringRHS;
    stringRHS
        = xsCAT ((putFIXED (mHEXxHVAL, getFIXED (mFORMAT_EXP_VARS_CELLxPTR)),
                  putFIXED (mHEXxN, 8), HEX (0)),
                 cToDescriptor (NULL, " --> "));
    putCHARACTER (mS, stringRHS);
    stringRHS->inUse = 0;
  }
  // L = 1; (2587)
  {
    int32_t numberRHS = (int32_t)(1);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mFORMAT_EXP_VARS_CELLxL, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF #SYTS > 0 THEN (2588)
  if (1 & (xGT (COREHALFWORD (mFORMAT_EXP_VARS_CELLxpSYTS), 0)))
    // DO; (2589)
    {
    rs1:;
      // J = 2; (2590)
      {
        int32_t numberRHS = (int32_t)(2);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mFORMAT_EXP_VARS_CELLxJ, bitRHS);
        bitRHS->inUse = 0;
      }
      // DO WHILE J<=#SYTS+1; (2591)
      while (1
             & (xLE (COREHALFWORD (mFORMAT_EXP_VARS_CELLxJ),
                     xadd (COREHALFWORD (mFORMAT_EXP_VARS_CELLxpSYTS), 1))))
        {
          // IF LENGTH(S(L)) > LINELENGTH THEN (2592)
          if (1
              & (xGT (LENGTH (getCHARACTER (
                          mS + 4 * COREHALFWORD (mFORMAT_EXP_VARS_CELLxL))),
                      131)))
            // L = L + 1; (2593)
            {
              int32_t numberRHS = (int32_t)(xadd (
                  COREHALFWORD (mFORMAT_EXP_VARS_CELLxL), 1));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mFORMAT_EXP_VARS_CELLxL, bitRHS);
              bitRHS->inUse = 0;
            }
          // IF VMEM_H(J) >= 0 THEN (2594)
          if (1
              & (xGE (
                  COREHALFWORD (getFIXED (mVMEM_H)
                                + 2 * COREHALFWORD (mFORMAT_EXP_VARS_CELLxJ)),
                  0)))
            // S(L) = S(L)||','||SYT_NAME(VMEM_H(J)); (2595)
            {
              descriptor_t *stringRHS;
              stringRHS = xsCAT (
                  xsCAT (getCHARACTER (
                             mS + 4 * COREHALFWORD (mFORMAT_EXP_VARS_CELLxL)),
                         cToDescriptor (NULL, ",")),
                  getCHARACTER (
                      getFIXED (mSYM_TAB)
                      + 34
                            * (COREHALFWORD (
                                getFIXED (mVMEM_H)
                                + 2 * COREHALFWORD (mFORMAT_EXP_VARS_CELLxJ)))
                      + 0 + 4 * (0)));
              putCHARACTER (mS + 4 * (COREHALFWORD (mFORMAT_EXP_VARS_CELLxL)),
                            stringRHS);
              stringRHS->inUse = 0;
            }
          // ELSE (2596)
          else
            // DO; (2597)
            {
            rs1s1s1:;
              // J = J + 1; (2598)
              {
                int32_t numberRHS = (int32_t)(xadd (
                    COREHALFWORD (mFORMAT_EXP_VARS_CELLxJ), 1));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mFORMAT_EXP_VARS_CELLxJ, bitRHS);
                bitRHS->inUse = 0;
              }
              // S(L) = S(L)||','||SYT_NAME(VMEM_H(J)); (2599)
              {
                descriptor_t *stringRHS;
                stringRHS = xsCAT (
                    xsCAT (
                        getCHARACTER (
                            mS + 4 * COREHALFWORD (mFORMAT_EXP_VARS_CELLxL)),
                        cToDescriptor (NULL, ",")),
                    getCHARACTER (
                        getFIXED (mSYM_TAB)
                        + 34
                              * (COREHALFWORD (
                                  getFIXED (mVMEM_H)
                                  + 2
                                        * COREHALFWORD (
                                            mFORMAT_EXP_VARS_CELLxJ)))
                        + 0 + 4 * (0)));
                putCHARACTER (
                    mS + 4 * (COREHALFWORD (mFORMAT_EXP_VARS_CELLxL)),
                    stringRHS);
                stringRHS->inUse = 0;
              }
              // DO K = 2 TO -VMEM_H(J-1); (2600)
              {
                int32_t from53, to53, by53;
                from53 = 2;
                to53 = xminus (COREHALFWORD (
                    getFIXED (mVMEM_H)
                    + 2
                          * xsubtract (COREHALFWORD (mFORMAT_EXP_VARS_CELLxJ),
                                       1)));
                by53 = 1;
                for (putBIT (16, mFORMAT_EXP_VARS_CELLxK,
                             fixedToBit (16, from53));
                     bitToFixed (getBIT (16, mFORMAT_EXP_VARS_CELLxK)) <= to53;
                     putBIT (16, mFORMAT_EXP_VARS_CELLxK,
                             fixedToBit (16, bitToFixed (getBIT (
                                                 16, mFORMAT_EXP_VARS_CELLxK))
                                                 + by53)))
                  {
                    // J = J + 1; (2601)
                    {
                      int32_t numberRHS = (int32_t)(xadd (
                          COREHALFWORD (mFORMAT_EXP_VARS_CELLxJ), 1));
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (16, mFORMAT_EXP_VARS_CELLxJ, bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // S(L) = S(L)||'.'||SYT_NAME(VMEM_H(J)); (2602)
                    {
                      descriptor_t *stringRHS;
                      stringRHS = xsCAT (
                          xsCAT (getCHARACTER (
                                     mS
                                     + 4
                                           * COREHALFWORD (
                                               mFORMAT_EXP_VARS_CELLxL)),
                                 cToDescriptor (NULL, ".")),
                          getCHARACTER (
                              getFIXED (mSYM_TAB)
                              + 34
                                    * (COREHALFWORD (
                                        getFIXED (mVMEM_H)
                                        + 2
                                              * COREHALFWORD (
                                                  mFORMAT_EXP_VARS_CELLxJ)))
                              + 0 + 4 * (0)));
                      putCHARACTER (
                          mS + 4 * (COREHALFWORD (mFORMAT_EXP_VARS_CELLxL)),
                          stringRHS);
                      stringRHS->inUse = 0;
                    }
                  }
              } // End of DO for-loop block
            es1s1s1:;
            } // End of DO block
          // J = J + 1; (2603)
          {
            int32_t numberRHS
                = (int32_t)(xadd (COREHALFWORD (mFORMAT_EXP_VARS_CELLxJ), 1));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mFORMAT_EXP_VARS_CELLxJ, bitRHS);
            bitRHS->inUse = 0;
          }
        } // End of DO WHILE block
    es1:;
    } // End of DO block
  // I = SHR(#SYTS+3,1); (2604)
  {
    int32_t numberRHS = (int32_t)(SHR (
        xadd (COREHALFWORD (mFORMAT_EXP_VARS_CELLxpSYTS), 3), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mFORMAT_EXP_VARS_CELLxI, bitRHS);
    bitRHS->inUse = 0;
  }
  // K = SHR(VMEM_H(0),2)-1; (2605)
  {
    int32_t numberRHS = (int32_t)(xsubtract (
        SHR (COREHALFWORD (getFIXED (mVMEM_H) + 2 * 0), 2), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mFORMAT_EXP_VARS_CELLxK, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO J = I TO K; (2606)
  {
    int32_t from54, to54, by54;
    from54 = bitToFixed (getBIT (16, mFORMAT_EXP_VARS_CELLxI));
    to54 = bitToFixed (getBIT (16, mFORMAT_EXP_VARS_CELLxK));
    by54 = 1;
    for (putBIT (16, mFORMAT_EXP_VARS_CELLxJ, fixedToBit (16, from54));
         bitToFixed (getBIT (16, mFORMAT_EXP_VARS_CELLxJ)) <= to54; putBIT (
             16, mFORMAT_EXP_VARS_CELLxJ,
             fixedToBit (16, bitToFixed (getBIT (16, mFORMAT_EXP_VARS_CELLxJ))
                                 + by54)))
      {
        // IF LENGTH(S(L)) > LINELENGTH THEN (2607)
        if (1
            & (xGT (LENGTH (getCHARACTER (
                        mS + 4 * COREHALFWORD (mFORMAT_EXP_VARS_CELLxL))),
                    131)))
          // L = L + 1; (2608)
          {
            int32_t numberRHS
                = (int32_t)(xadd (COREHALFWORD (mFORMAT_EXP_VARS_CELLxL), 1));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mFORMAT_EXP_VARS_CELLxL, bitRHS);
            bitRHS->inUse = 0;
          }
        // IF (VMEM_F(J) &  3221225472) =  3221225472 THEN (2609)
        if (1
            & (xEQ (
                xAND (getFIXED (getFIXED (mVMEM_F)
                                + 4 * COREHALFWORD (mFORMAT_EXP_VARS_CELLxJ)),
                      3221225472),
                3221225472)))
          // S(L) = S(L) || ',' || (VMEM_F(J) &  1073741823); (2610)
          {
            descriptor_t *stringRHS;
            stringRHS = xsCAT (
                xsCAT (getCHARACTER (
                           mS + 4 * COREHALFWORD (mFORMAT_EXP_VARS_CELLxL)),
                       cToDescriptor (NULL, ",")),
                fixedToCharacter (xAND (
                    getFIXED (getFIXED (mVMEM_F)
                              + 4 * COREHALFWORD (mFORMAT_EXP_VARS_CELLxJ)),
                    1073741823)));
            putCHARACTER (mS + 4 * (COREHALFWORD (mFORMAT_EXP_VARS_CELLxL)),
                          stringRHS);
            stringRHS->inUse = 0;
          }
        // ELSE (2611)
        else
          // DO; (2612)
          {
          rs2s1:;
            // CALL STACK_PTR(VMEM_F(I+K-J),LEVEL+1); (2613)
            {
              putFIXED (
                  mSTACK_PTRxPTR,
                  getFIXED (
                      getFIXED (mVMEM_F)
                      + 4
                            * xsubtract (
                                xadd (COREHALFWORD (mFORMAT_EXP_VARS_CELLxI),
                                      COREHALFWORD (mFORMAT_EXP_VARS_CELLxK)),
                                COREHALFWORD (mFORMAT_EXP_VARS_CELLxJ))));
              putBITp (
                  16, mSTACK_PTRxLEVEL,
                  fixedToBit (32, (int32_t)(xadd (COREHALFWORD (mLEVEL), 1))));
              STACK_PTR (0);
            }
            // S(L) = S(L) || ',' || HEX(VMEM_F(J),8); (2614)
            {
              descriptor_t *stringRHS;
              stringRHS = xsCAT (
                  xsCAT (getCHARACTER (
                             mS + 4 * COREHALFWORD (mFORMAT_EXP_VARS_CELLxL)),
                         cToDescriptor (NULL, ",")),
                  (putFIXED (
                       mHEXxHVAL,
                       getFIXED (
                           getFIXED (mVMEM_F)
                           + 4 * COREHALFWORD (mFORMAT_EXP_VARS_CELLxJ))),
                   putFIXED (mHEXxN, 8), HEX (0)));
              putCHARACTER (mS + 4 * (COREHALFWORD (mFORMAT_EXP_VARS_CELLxL)),
                            stringRHS);
              stringRHS->inUse = 0;
            }
          es2s1:;
          } // End of DO block
      }
  } // End of DO for-loop block
  // S(L) = S(L) || ')'; (2615)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (
        getCHARACTER (mS + 4 * COREHALFWORD (mFORMAT_EXP_VARS_CELLxL)),
        cToDescriptor (NULL, ")"));
    putCHARACTER (mS + 4 * (COREHALFWORD (mFORMAT_EXP_VARS_CELLxL)),
                  stringRHS);
    stringRHS->inUse = 0;
  }
  // BYTE(S(1)) = BYTE('('); (2616)
  {
    int32_t numberRHS = (int32_t)(BYTE1 (cToDescriptor (NULL, "(")));
    lBYTEb (ADDR (NULL, 0, "S", 1), 0, BYTE1 (cToDescriptor (NULL, "(")));
  }
  // CALL FLUSH(L); (2617)
  {
    putBITp (16, mFLUSHxLAST, getBIT (16, mFORMAT_EXP_VARS_CELLxL));
    FLUSH (0);
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
