/*
  File PROCESS_HALMAT.c generated by XCOM-I, 2024-08-08 04:31:35.
*/

#include "runtimeC.h"

int32_t
PROCESS_HALMAT (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "PROCESS_HALMAT");
  // DO FOREVER; (2366)
  while (1 & (1))
    {
      // CALL DECODEPOP(CTR); (2367)
      {
        putBITp (16, mDECODEPOPxCTR, getBIT (16, mCTR));
        DECODEPOP (0);
      }
      // IF CLASS = 0 THEN (2368)
      if (1 & (xEQ (COREHALFWORD (mCLASS), 0)))
        // DO CASE CLASS0(OPCODE); (2369)
        {
        rs1s1:
          switch (BYTE0 (mCLASS0 + 1 * COREHALFWORD (mOPCODE)))
            {
            case 0:
                // ; (2371)
                ;
              break;
            case 1:
              // DO; (2372)
              {
              rs1s1s1:;
                // IF OPCODE=IDEF THEN (2372)
                if (1 & (xEQ (COREHALFWORD (mOPCODE), COREHALFWORD (mIDEF))))
                  // HALMAT_PTR(CTR) = GET_P_F_INV_CELL(CTR); (2373)
                  {
                    int32_t numberRHS = (int32_t)((
                        putBITp (16, mGET_P_F_INV_CELLxCTR, getBIT (16, mCTR)),
                        GET_P_F_INV_CELL (0)));
                    putFIXED (mHALMAT_PTR + 4 * (COREHALFWORD (mCTR)),
                              numberRHS);
                  }
                // CTR = CTR + 2; (2374)
                {
                  int32_t numberRHS = (int32_t)(xadd (COREHALFWORD (mCTR), 2));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mCTR, bitRHS);
                  bitRHS->inUse = 0;
                }
                // INITIALIZING = TRUE; (2375)
                {
                  int32_t numberRHS = (int32_t)(1);
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (8, mINITIALIZING, bitRHS);
                  bitRHS->inUse = 0;
                }
                // CALL GET_NAME_INITIALS; (2376)
                GET_NAME_INITIALS (0);
              es1s1s1:;
              } // End of DO block
              break;
            case 2:
              // DO; (2378)
              {
              rs1s1s2:;
                // TSUB_LOC = CTR; (2378)
                {
                  descriptor_t *bitRHS = getBIT (16, mCTR);
                  putBIT (16, mTSUB_LOC, bitRHS);
                  bitRHS->inUse = 0;
                }
                // PTR = NEXT_OP(CTR); (2379)
                {
                  descriptor_t *bitRHS
                      = (putBITp (16, mNEXT_OPxLOC, getBIT (16, mCTR)),
                         NEXT_OP (0));
                  putBIT (16, mPROCESS_HALMATxPTR, bitRHS);
                  bitRHS->inUse = 0;
                }
                // IF POPCODE(PTR) = EXTN & TYPE_BITS(PTR+1) = VAC THEN (2380)
                if (1
                    & (xAND (
                        xEQ (bitToFixed (
                                 (putBITp (16, mPOPCODExCTR,
                                           getBIT (16, mPROCESS_HALMATxPTR)),
                                  POPCODE (0))),
                             COREHALFWORD (mEXTN)),
                        xEQ (bitToFixed ((
                                 putBITp (16, mTYPE_BITSxCTR,
                                          fixedToBit (
                                              32, (int32_t)(xadd (
                                                      COREHALFWORD (
                                                          mPROCESS_HALMATxPTR),
                                                      1)))),
                                 TYPE_BITS (0))),
                             COREHALFWORD (mVAC)))))
                  // DO; (2381)
                  {
                  rs1s1s2s1:;
                    // EXTN_LOC,CTR = PTR; (2382)
                    {
                      descriptor_t *bitRHS = getBIT (16, mPROCESS_HALMATxPTR);
                      putBIT (16, mEXTN_LOC, bitRHS);
                      putBIT (16, mCTR, bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // PTR = NEXT_OP(CTR); (2383)
                    {
                      descriptor_t *bitRHS
                          = (putBITp (16, mNEXT_OPxLOC, getBIT (16, mCTR)),
                             NEXT_OP (0));
                      putBIT (16, mPROCESS_HALMATxPTR, bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // IF POPCODE(PTR) = DSUB & TYPE_BITS(PTR+1) = XPT THEN
                    // (2384)
                    if (1
                        & (xAND (
                            xEQ (
                                bitToFixed ((
                                    putBITp (16, mPOPCODExCTR,
                                             getBIT (16, mPROCESS_HALMATxPTR)),
                                    POPCODE (0))),
                                COREHALFWORD (mDSUB)),
                            xEQ (bitToFixed (
                                     (putBITp (
                                          16, mTYPE_BITSxCTR,
                                          fixedToBit (
                                              32, (int32_t)(xadd (
                                                      COREHALFWORD (
                                                          mPROCESS_HALMATxPTR),
                                                      1)))),
                                      TYPE_BITS (0))),
                                 COREHALFWORD (mXPT)))))
                      // DSUB_LOC,CTR = PTR; (2385)
                      {
                        descriptor_t *bitRHS
                            = getBIT (16, mPROCESS_HALMATxPTR);
                        putBIT (16, mDSUB_LOC, bitRHS);
                        putBIT (16, mCTR, bitRHS);
                        bitRHS->inUse = 0;
                      }
                  es1s1s2s1:;
                  } // End of DO block
                // HALMAT_PTR(CTR) = GET_VAR_REF_CELL; (2386)
                {
                  int32_t numberRHS = (int32_t)(GET_VAR_REF_CELL (0));
                  putFIXED (mHALMAT_PTR + 4 * (COREHALFWORD (mCTR)),
                            numberRHS);
                }
              es1s1s2:;
              } // End of DO block
              break;
            case 3:
              // DO; (2388)
              {
              rs1s1s3:;
                // EXTN_LOC = CTR; (2388)
                {
                  descriptor_t *bitRHS = getBIT (16, mCTR);
                  putBIT (16, mEXTN_LOC, bitRHS);
                  bitRHS->inUse = 0;
                }
                // PTR = NEXT_OP(CTR); (2389)
                {
                  descriptor_t *bitRHS
                      = (putBITp (16, mNEXT_OPxLOC, getBIT (16, mCTR)),
                         NEXT_OP (0));
                  putBIT (16, mPROCESS_HALMATxPTR, bitRHS);
                  bitRHS->inUse = 0;
                }
                // IF POPCODE(PTR) = DSUB & TYPE_BITS(PTR+1) = XPT THEN (2390)
                if (1
                    & (xAND (
                        xEQ (bitToFixed (
                                 (putBITp (16, mPOPCODExCTR,
                                           getBIT (16, mPROCESS_HALMATxPTR)),
                                  POPCODE (0))),
                             COREHALFWORD (mDSUB)),
                        xEQ (bitToFixed ((
                                 putBITp (16, mTYPE_BITSxCTR,
                                          fixedToBit (
                                              32, (int32_t)(xadd (
                                                      COREHALFWORD (
                                                          mPROCESS_HALMATxPTR),
                                                      1)))),
                                 TYPE_BITS (0))),
                             COREHALFWORD (mXPT)))))
                  // DO; (2391)
                  {
                  rs1s1s3s1:;
                    // DSUB_LOC,CTR = PTR; (2392)
                    {
                      descriptor_t *bitRHS = getBIT (16, mPROCESS_HALMATxPTR);
                      putBIT (16, mDSUB_LOC, bitRHS);
                      putBIT (16, mCTR, bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // HALMAT_PTR(CTR) = GET_VAR_REF_CELL; (2393)
                    {
                      int32_t numberRHS = (int32_t)(GET_VAR_REF_CELL (0));
                      putFIXED (mHALMAT_PTR + 4 * (COREHALFWORD (mCTR)),
                                numberRHS);
                    }
                  es1s1s3s1:;
                  } // End of DO block
                // EXTN_LOC = 0; (2394)
                {
                  int32_t numberRHS = (int32_t)(0);
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mEXTN_LOC, bitRHS);
                  bitRHS->inUse = 0;
                }
              es1s1s3:;
              } // End of DO block
              break;
            case 4:
              // DO; (2396)
              {
              rs1s1s4:;
                // DSUB_LOC = CTR; (2396)
                {
                  descriptor_t *bitRHS = getBIT (16, mCTR);
                  putBIT (16, mDSUB_LOC, bitRHS);
                  bitRHS->inUse = 0;
                }
                // HALMAT_PTR(CTR) = GET_VAR_REF_CELL; (2397)
                {
                  int32_t numberRHS = (int32_t)(GET_VAR_REF_CELL (0));
                  putFIXED (mHALMAT_PTR + 4 * (COREHALFWORD (mCTR)),
                            numberRHS);
                }
              es1s1s4:;
              } // End of DO block
              break;
            case 5:
              // DO; (2399)
              {
              rs1s1s5:;
                // SF_INX = SF_INX + 1; (2399)
                {
                  int32_t numberRHS = (int32_t)(xadd (
                      COREHALFWORD (mPROCESS_HALMATxSF_INX), 1));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mPROCESS_HALMATxSF_INX, bitRHS);
                  bitRHS->inUse = 0;
                }
                // SFST_STACK(SF_INX) = CTR; (2400)
                {
                  descriptor_t *bitRHS = getBIT (16, mCTR);
                  putBIT (16,
                          mPROCESS_HALMATxSFST_STACK
                              + 2 * (COREHALFWORD (mPROCESS_HALMATxSF_INX)),
                          bitRHS);
                  bitRHS->inUse = 0;
                }
              es1s1s5:;
              } // End of DO block
              break;
            case 6:
              // DO; (2402)
              {
              rs1s1s6:;
                // HALMAT_PTR(CTR) = SFST_STACK(SF_INX); (2402)
                {
                  descriptor_t *bitRHS = getBIT (
                      16, mPROCESS_HALMATxSFST_STACK
                              + 2 * COREHALFWORD (mPROCESS_HALMATxSF_INX));
                  int32_t numberRHS;
                  numberRHS = bitToFixed (bitRHS);
                  putFIXED (mHALMAT_PTR + 4 * (COREHALFWORD (mCTR)),
                            numberRHS);
                  bitRHS->inUse = 0;
                }
                // HALMAT_PTR(SFST_STACK(SF_INX)) = CTR; (2403)
                {
                  descriptor_t *bitRHS = getBIT (16, mCTR);
                  int32_t numberRHS;
                  numberRHS = bitToFixed (bitRHS);
                  putFIXED (mHALMAT_PTR
                                + 4
                                      * (COREHALFWORD (
                                          mPROCESS_HALMATxSFST_STACK
                                          + 2
                                                * COREHALFWORD (
                                                    mPROCESS_HALMATxSF_INX))),
                            numberRHS);
                  bitRHS->inUse = 0;
                }
                // SF_INX = SF_INX - 1; (2404)
                {
                  int32_t numberRHS = (int32_t)(xsubtract (
                      COREHALFWORD (mPROCESS_HALMATxSF_INX), 1));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mPROCESS_HALMATxSF_INX, bitRHS);
                  bitRHS->inUse = 0;
                }
              es1s1s6:;
              } // End of DO block
              break;
            case 7:
              // DO; (2406)
              {
              rs1s1s7:;
                // XX_INX = XX_INX + 1; (2406)
                {
                  int32_t numberRHS = (int32_t)(xadd (
                      COREHALFWORD (mPROCESS_HALMATxXX_INX), 1));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mPROCESS_HALMATxXX_INX, bitRHS);
                  bitRHS->inUse = 0;
                }
                // XXST_STACK(XX_INX) = CTR; (2407)
                {
                  descriptor_t *bitRHS = getBIT (16, mCTR);
                  putBIT (16,
                          mPROCESS_HALMATxXXST_STACK
                              + 2 * (COREHALFWORD (mPROCESS_HALMATxXX_INX)),
                          bitRHS);
                  bitRHS->inUse = 0;
                }
              es1s1s7:;
              } // End of DO block
              break;
            case 8:
              // DO; (2409)
              {
              rs1s1s8:;
                // HALMAT_PTR(CTR) = XXST_STACK(XX_INX); (2409)
                {
                  descriptor_t *bitRHS = getBIT (
                      16, mPROCESS_HALMATxXXST_STACK
                              + 2 * COREHALFWORD (mPROCESS_HALMATxXX_INX));
                  int32_t numberRHS;
                  numberRHS = bitToFixed (bitRHS);
                  putFIXED (mHALMAT_PTR + 4 * (COREHALFWORD (mCTR)),
                            numberRHS);
                  bitRHS->inUse = 0;
                }
                // XX_INX = XX_INX - 1; (2410)
                {
                  int32_t numberRHS = (int32_t)(xsubtract (
                      COREHALFWORD (mPROCESS_HALMATxXX_INX), 1));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mPROCESS_HALMATxXX_INX, bitRHS);
                  bitRHS->inUse = 0;
                }
                // HALMAT_PTR(CTR) = GET_P_F_INV_CELL(CTR); (2411)
                {
                  int32_t numberRHS = (int32_t)((
                      putBITp (16, mGET_P_F_INV_CELLxCTR, getBIT (16, mCTR)),
                      GET_P_F_INV_CELL (0)));
                  putFIXED (mHALMAT_PTR + 4 * (COREHALFWORD (mCTR)),
                            numberRHS);
                }
              es1s1s8:;
              } // End of DO block
              break;
            case 9:
              // DO; (2413)
              {
              rs1s1s9:;
                // HALMAT_PTR(CTR) = XXST_STACK(XX_INX); (2413)
                {
                  descriptor_t *bitRHS = getBIT (
                      16, mPROCESS_HALMATxXXST_STACK
                              + 2 * COREHALFWORD (mPROCESS_HALMATxXX_INX));
                  int32_t numberRHS;
                  numberRHS = bitToFixed (bitRHS);
                  putFIXED (mHALMAT_PTR + 4 * (COREHALFWORD (mCTR)),
                            numberRHS);
                  bitRHS->inUse = 0;
                }
                // XX_INX = XX_INX - 1; (2414)
                {
                  int32_t numberRHS = (int32_t)(xsubtract (
                      COREHALFWORD (mPROCESS_HALMATxXX_INX), 1));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mPROCESS_HALMATxXX_INX, bitRHS);
                  bitRHS->inUse = 0;
                }
              es1s1s9:;
              } // End of DO block
              break;
            case 10:
              // DO; (2416)
              {
              rs1s1s10:;
                // PMHD_LOC = CTR; (2416)
                {
                  descriptor_t *bitRHS = getBIT (16, mCTR);
                  putBIT (16, mPROCESS_HALMATxPMHD_LOC, bitRHS);
                  bitRHS->inUse = 0;
                }
              es1s1s10:;
              } // End of DO block
              break;
            case 11:
              // DO; (2418)
              {
              rs1s1s11:;
                // HALMAT_PTR(CTR) = PMHD_LOC; (2418)
                {
                  descriptor_t *bitRHS = getBIT (16, mPROCESS_HALMATxPMHD_LOC);
                  int32_t numberRHS;
                  numberRHS = bitToFixed (bitRHS);
                  putFIXED (mHALMAT_PTR + 4 * (COREHALFWORD (mCTR)),
                            numberRHS);
                  bitRHS->inUse = 0;
                }
              es1s1s11:;
              } // End of DO block
              break;
            case 12:
              // DO; (2420)
              {
              rs1s1s12:;
                // VARS = FALSE; (2420)
                {
                  int32_t numberRHS = (int32_t)(0);
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (1, mPROCESS_HALMATxVARS, bitRHS);
                  bitRHS->inUse = 0;
                }
              es1s1s12:;
              } // End of DO block
              break;
            case 13:
              // DO; (2422)
              {
              rs1s1s13:;
                // DFOR_LOC = CTR; (2422)
                {
                  descriptor_t *bitRHS = getBIT (16, mCTR);
                  putBIT (16, mDFOR_LOC, bitRHS);
                  bitRHS->inUse = 0;
                }
              es1s1s13:;
              } // End of DO block
              break;
            case 14:
              // DO; (2424)
              {
              rs1s1s14:;
                // LAST_BLOCK = SHR(OPR(CTR),24); (2424)
                {
                  int32_t numberRHS = (int32_t)(SHR (
                      getFIXED (mOPR + 4 * COREHALFWORD (mCTR)), 24));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (1, mPROCESS_HALMATxLAST_BLOCK, bitRHS);
                  bitRHS->inUse = 0;
                }
                // IF LAST_BLOCK THEN (2425)
                if (1 & (bitToFixed (getBIT (1, mPROCESS_HALMATxLAST_BLOCK))))
                  // DO; (2426)
                  {
                  rs1s1s14s1:;
                    // IF HMAT_OPT THEN (2427)
                    if (1 & (bitToFixed (getBIT (1, mHMAT_OPT))))
                      // DO; (2428)
                      {
                      rs1s1s14s1s1:;
                        // CALL CREATE_STMT; (2429)
                        CREATE_STMT (0);
                        // IF OLD_SMRK_NODE ~= NILL THEN (2430)
                        if (1 & (xNEQ (getFIXED (mOLD_SMRK_NODE), -1)))
                          // CALL PTR_LOCATE(OLD_SMRK_NODE,RELS); (2431)
                          {
                            putFIXED (mPTR_LOCATExPTR,
                                      getFIXED (mOLD_SMRK_NODE));
                            putBITp (8, mPTR_LOCATExFLAGS, getBIT (8, mRELS));
                            PTR_LOCATE (0);
                          }
                      es1s1s14s1s1:;
                      } // End of DO block
                    // RETURN; (2432)
                    {
                      reentryGuard = 0;
                      return 0;
                    }
                  es1s1s14s1:;
                  } // End of DO block
                // ELSE (2433)
                else
                  // DO; (2434)
                  {
                  rs1s1s14s2:;
                    // CALL NEW_HALMAT_BLOCK; (2435)
                    NEW_HALMAT_BLOCK (0);
                    // IF HMAT_OPT THEN (2436)
                    if (1 & (bitToFixed (getBIT (1, mHMAT_OPT))))
                      // START_NODE = 2; (2437)
                      {
                        int32_t numberRHS = (int32_t)(2);
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (16, mSTART_NODE, bitRHS);
                        bitRHS->inUse = 0;
                      }
                    // CTR = 0; (2438)
                    {
                      int32_t numberRHS = (int32_t)(0);
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (16, mCTR, bitRHS);
                      bitRHS->inUse = 0;
                    }
                  es1s1s14s2:;
                  } // End of DO block
              es1s1s14:;
              } // End of DO block
              break;
            case 15:
              // DO; (2440)
              {
              rs1s1s15:;
                // STMT# = POPVAL(CTR + 1); (2440)
                {
                  descriptor_t *bitRHS
                      = (putBITp (
                             16, mPOPVALxCTR,
                             fixedToBit (32, (int32_t)(xadd (
                                                 COREHALFWORD (mCTR), 1)))),
                         POPVAL (0));
                  putBIT (16, mSTMTp, bitRHS);
                  bitRHS->inUse = 0;
                }
                // CALL PROCESS_DECL_SMRK; (2441)
                PROCESS_DECL_SMRK (0);
                // IF HMAT_OPT THEN (2442)
                if (1 & (bitToFixed (getBIT (1, mHMAT_OPT))))
                  // CALL KEEP_POINTERS; (2443)
                  KEEP_POINTERS (0);
                // OLD_STMT# = STMT#; (2444)
                {
                  descriptor_t *bitRHS = getBIT (16, mSTMTp);
                  putBIT (16, mOLD_STMTp, bitRHS);
                  bitRHS->inUse = 0;
                }
                // IF VARS THEN (2445)
                if (1 & (bitToFixed (getBIT (1, mPROCESS_HALMATxVARS))))
                  // CALL GET_STMT_VARS(STMT#,LAST_OP(CTR)); (2446)
                  {
                    putBITp (16, mGET_STMT_VARSxSTMTp, getBIT (16, mSTMTp));
                    putFIXED (mGET_STMT_VARSxPTR,
                              bitToFixed ((putBITp (16, mLAST_OPxLOC,
                                                    getBIT (16, mCTR)),
                                           LAST_OP (0))));
                    GET_STMT_VARS (0);
                  }
                // ELSE (2447)
                else
                  // VARS = TRUE; (2448)
                  {
                    int32_t numberRHS = (int32_t)(1);
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (1, mPROCESS_HALMATxVARS, bitRHS);
                    bitRHS->inUse = 0;
                  }
                // DEBUG_H = SHR(OPR(CTR+1),8) &  255; (2449)
                {
                  int32_t numberRHS = (int32_t)(xAND (
                      SHR (getFIXED (mOPR + 4 * xadd (COREHALFWORD (mCTR), 1)),
                           8),
                      255));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mPROCESS_HALMATxDEBUG_H, bitRHS);
                  bitRHS->inUse = 0;
                }
                // IF DEBUG_H>99 & DEBUG_H<110 THEN (2450)
                if (1
                    & (xAND (
                        xGT (COREHALFWORD (mPROCESS_HALMATxDEBUG_H), 99),
                        xLT (COREHALFWORD (mPROCESS_HALMATxDEBUG_H), 110))))
                  // CALL SET_DEBUG_TOGGLES(DEBUG_H); (2451)
                  {
                    putBITp (16, mSET_DEBUG_TOGGLESxHVAL,
                             getBIT (16, mPROCESS_HALMATxDEBUG_H));
                    SET_DEBUG_TOGGLES (0);
                  }
              es1s1s15:;
              } // End of DO block
              break;
            }
        } // End of DO CASE block
      // CTR = NEXT_OP(CTR); (2452)
      {
        descriptor_t *bitRHS
            = (putBITp (16, mNEXT_OPxLOC, getBIT (16, mCTR)), NEXT_OP (0));
        putBIT (16, mCTR, bitRHS);
        bitRHS->inUse = 0;
      }
    } // End of DO WHILE block
  {
    reentryGuard = 0;
    return 0;
  }
}
