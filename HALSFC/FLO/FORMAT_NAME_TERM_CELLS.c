/*
  File FORMAT_NAME_TERM_CELLS.c generated by XCOM-I, 2024-08-08 04:31:35.
*/

#include "runtimeC.h"

int32_t
FORMAT_NAME_TERM_CELLS (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "FORMAT_NAME_TERM_CELLS");
  // OUTPUT = X10||HEX(PTR,8)||' --> '|| 'INITIAL VALUES FOR NAME TERMINALS IN
  // STRUCTURE: '||SYT_NAME(SYMB#); (2668)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (
        xsCAT (
            xsCAT (xsCAT (getCHARACTER (mX10),
                          (putFIXED (mHEXxHVAL,
                                     getFIXED (mFORMAT_NAME_TERM_CELLSxPTR)),
                           putFIXED (mHEXxN, 8), HEX (0))),
                   cToDescriptor (NULL, " --> ")),
            cToDescriptor (
                NULL, "INITIAL VALUES FOR NAME TERMINALS IN STRUCTURE: ")),
        getCHARACTER (getFIXED (mSYM_TAB)
                      + 34 * (COREHALFWORD (mFORMAT_NAME_TERM_CELLSxSYMBp)) + 0
                      + 4 * (0)));
    OUTPUT (0, stringRHS);
    stringRHS->inUse = 0;
  }
  // DO WHILE PTR ~= 0; (2669)
  while (1 & (xNEQ (getFIXED (mFORMAT_NAME_TERM_CELLSxPTR), 0)))
    {
      // CALL LOCATE(PTR,ADDR(VMEM_F),0); (2670)
      {
        putFIXED (mLOCATExPTR, getFIXED (mFORMAT_NAME_TERM_CELLSxPTR));
        putFIXED (mLOCATExBVAR,
                  ADDR ("FORMAT_NAME_TERM_CELLSxVMEM_F", 0x80000000, NULL, 0));
        putBITp (8, mLOCATExFLAGS, fixedToBit (32, (int32_t)(0)));
        LOCATE (0);
      }
      // PTR = VMEM_F(1); (2671)
      {
        int32_t numberRHS = (int32_t)(getFIXED (
            getFIXED (mFORMAT_NAME_TERM_CELLSxVMEM_F) + 4 * 1));
        putFIXED (mFORMAT_NAME_TERM_CELLSxPTR, numberRHS);
      }
      // COREWORD(ADDR(VMEM_H)) = VMEM_LOC_ADDR; (2672)
      {
        int32_t numberRHS = (int32_t)(getFIXED (mVMEM_LOC_ADDR));
        COREWORD2 (ADDR ("FORMAT_NAME_TERM_CELLSxVMEM_H", 0x80000000, NULL, 0),
                   numberRHS);
      }
      // K, PTR_INX = 0; (2673)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mFORMAT_NAME_TERM_CELLSxK, bitRHS);
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mPTR_INX, bitRHS);
        bitRHS->inUse = 0;
      }
      // LEVEL = 1; (2674)
      {
        int32_t numberRHS = (int32_t)(1);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mLEVEL, bitRHS);
        bitRHS->inUse = 0;
      }
      // #SYTS = VMEM_H(1); (2675)
      {
        descriptor_t *bitRHS
            = getBIT (16, getFIXED (mFORMAT_NAME_TERM_CELLSxVMEM_H) + 2 * 1);
        putBIT (16, mFORMAT_NAME_TERM_CELLSxpSYTS, bitRHS);
        bitRHS->inUse = 0;
      }
      // FIRSTWORD = (#SYTS+5) &  65534; (2676)
      {
        int32_t numberRHS = (int32_t)(xAND (
            xadd (COREHALFWORD (mFORMAT_NAME_TERM_CELLSxpSYTS), 5), 65534));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mFORMAT_NAME_TERM_CELLSxFIRSTWORD, bitRHS);
        bitRHS->inUse = 0;
      }
      // S = SYT_NAME(VMEM_H(4)); (2677)
      {
        descriptor_t *stringRHS;
        stringRHS = getCHARACTER (
            getFIXED (mSYM_TAB)
            + 34
                  * (COREHALFWORD (getFIXED (mFORMAT_NAME_TERM_CELLSxVMEM_H)
                                   + 2 * 4))
            + 0 + 4 * (0));
        putCHARACTER (mS, stringRHS);
        stringRHS->inUse = 0;
      }
      // DO J = 5 TO #SYTS+3; (2678)
      {
        int32_t from57, to57, by57;
        from57 = 5;
        to57 = xadd (COREHALFWORD (mFORMAT_NAME_TERM_CELLSxpSYTS), 3);
        by57 = 1;
        for (putBIT (16, mFORMAT_NAME_TERM_CELLSxJ, fixedToBit (16, from57));
             bitToFixed (getBIT (16, mFORMAT_NAME_TERM_CELLSxJ)) <= to57;
             putBIT (16, mFORMAT_NAME_TERM_CELLSxJ,
                     fixedToBit (16, bitToFixed (getBIT (
                                         16, mFORMAT_NAME_TERM_CELLSxJ))
                                         + by57)))
          {
            // S = S || '.' || SYT_NAME(VMEM_H(J)); (2679)
            {
              descriptor_t *stringRHS;
              stringRHS = xsCAT (
                  xsCAT (getCHARACTER (mS), cToDescriptor (NULL, ".")),
                  getCHARACTER (
                      getFIXED (mSYM_TAB)
                      + 34
                            * (COREHALFWORD (
                                getFIXED (mFORMAT_NAME_TERM_CELLSxVMEM_H)
                                + 2
                                      * COREHALFWORD (
                                          mFORMAT_NAME_TERM_CELLSxJ)))
                      + 0 + 4 * (0)));
              putCHARACTER (mS, stringRHS);
              stringRHS->inUse = 0;
            }
          }
      } // End of DO for-loop block
      // CALL FLUSH(0); (2680)
      {
        putBITp (16, mFLUSHxLAST, fixedToBit (32, (int32_t)(0)));
        FLUSH (0);
      }
      // S = ''; (2681)
      {
        descriptor_t *stringRHS;
        stringRHS = cToDescriptor (NULL, "");
        putCHARACTER (mS, stringRHS);
        stringRHS->inUse = 0;
      }
      // LEVEL = 2; (2682)
      {
        int32_t numberRHS = (int32_t)(2);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mLEVEL, bitRHS);
        bitRHS->inUse = 0;
      }
      // J = FIRSTWORD; (2683)
      {
        descriptor_t *bitRHS = getBIT (16, mFORMAT_NAME_TERM_CELLSxFIRSTWORD);
        putBIT (16, mFORMAT_NAME_TERM_CELLSxJ, bitRHS);
        bitRHS->inUse = 0;
      }
      // IF VMEM_H(J) = 3 THEN (2684)
      if (1
          & (xEQ (
              COREHALFWORD (getFIXED (mFORMAT_NAME_TERM_CELLSxVMEM_H)
                            + 2 * COREHALFWORD (mFORMAT_NAME_TERM_CELLSxJ)),
              3)))
        // DO; (2685)
        {
        rs1s2:;
          // S = 'ALL COPIES NULL.'; (2686)
          {
            descriptor_t *stringRHS;
            stringRHS = cToDescriptor (NULL, "ALL COPIES NULL.");
            putCHARACTER (mS, stringRHS);
            stringRHS->inUse = 0;
          }
          // CALL FLUSH(0); (2687)
          {
            putBITp (16, mFLUSHxLAST, fixedToBit (32, (int32_t)(0)));
            FLUSH (0);
          }
          // GO TO DONETOO; (2688)
          goto DONETOO;
        es1s2:;
        } // End of DO block
      // DO FOREVER; (2689)
      while (1 & (1))
        {
          // WORDTYPE = VMEM_H(J); (2690)
          {
            descriptor_t *bitRHS = getBIT (
                16, getFIXED (mFORMAT_NAME_TERM_CELLSxVMEM_H)
                        + 2 * COREHALFWORD (mFORMAT_NAME_TERM_CELLSxJ));
            putBIT (16, mFORMAT_NAME_TERM_CELLSxWORDTYPE, bitRHS);
            bitRHS->inUse = 0;
          }
          // IF WORDTYPE<0 | WORDTYPE>3 THEN (2691)
          if (1
              & (xOR (
                  xLT (COREHALFWORD (mFORMAT_NAME_TERM_CELLSxWORDTYPE), 0),
                  xGT (COREHALFWORD (mFORMAT_NAME_TERM_CELLSxWORDTYPE), 3))))
            // DO; (2692)
            {
            rs1s3s1:;
              // CALL ERRORS (CLASS_BI, 217); (2693)
              {
                putBITp (16, mERRORSxCLASS, getBIT (16, mCLASS_BI));
                putBITp (16, mERRORSxNUM, fixedToBit (32, (int32_t)(217)));
                ERRORS (0);
              }
              // GO TO DONE; (2694)
              goto DONE;
            es1s3s1:;
            } // End of DO block
          // IF LENGTH(S(K)) > LINELENGTH THEN (2695)
          if (1
              & (xGT (LENGTH (getCHARACTER (
                          mS + 4 * COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK))),
                      131)))
            // IF K >= MAXLINES THEN (2696)
            if (1 & (xGE (COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK), 20)))
              // DO; (2697)
              {
              rs1s3s2:;
                // CALL FLUSH(K,1); (2698)
                {
                  putBITp (16, mFLUSHxLAST,
                           getBIT (16, mFORMAT_NAME_TERM_CELLSxK));
                  putBITp (8, mFLUSHxNO_PTR, fixedToBit (32, (int32_t)(1)));
                  FLUSH (0);
                }
                // K = 0; (2699)
                {
                  int32_t numberRHS = (int32_t)(0);
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mFORMAT_NAME_TERM_CELLSxK, bitRHS);
                  bitRHS->inUse = 0;
                }
              es1s3s2:;
              } // End of DO block
            // ELSE (2700)
            else
              // K = K + 1; (2701)
              {
                int32_t numberRHS = (int32_t)(xadd (
                    COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK), 1));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mFORMAT_NAME_TERM_CELLSxK, bitRHS);
                bitRHS->inUse = 0;
              }
          // DO CASE WORDTYPE; (2702)
          {
          rs1s3s3:
            switch (COREHALFWORD (mFORMAT_NAME_TERM_CELLSxWORDTYPE))
              {
              case 0:
                // DO; (2704)
                {
                rs1s3s3s1:;
                  // PTR_TEMP = VMEM_F(SHR(J+2,1)); (2704)
                  {
                    int32_t numberRHS = (int32_t)(getFIXED (
                        getFIXED (mFORMAT_NAME_TERM_CELLSxVMEM_F)
                        + 4
                              * SHR (xadd (COREHALFWORD (
                                               mFORMAT_NAME_TERM_CELLSxJ),
                                           2),
                                     1)));
                    putFIXED (mFORMAT_NAME_TERM_CELLSxPTR_TEMP, numberRHS);
                  }
                  // IF PTR_TEMP > 0 THEN (2705)
                  if (1
                      & (xGT (getFIXED (mFORMAT_NAME_TERM_CELLSxPTR_TEMP), 0)))
                    // DO; (2706)
                    {
                    rs1s3s3s1s1:;
                      // CALL FORMAT_VAR_REF_CELL(PTR_TEMP,1); (2707)
                      {
                        putFIXED (mFORMAT_VAR_REF_CELLxPTR,
                                  getFIXED (mFORMAT_NAME_TERM_CELLSxPTR_TEMP));
                        putBITp (8, mFORMAT_VAR_REF_CELLxNO_PRINT,
                                 fixedToBit (32, (int32_t)(1)));
                        FORMAT_VAR_REF_CELL (0);
                      }
                      // S(K) = S(K)||VMEM_H(J+1)||':'||MSG||','; (2708)
                      {
                        descriptor_t *stringRHS;
                        stringRHS = xsCAT (
                            xsCAT (
                                xsCAT (
                                    xsCAT (
                                        getCHARACTER (
                                            mS
                                            + 4
                                                  * COREHALFWORD (
                                                      mFORMAT_NAME_TERM_CELLSxK)),
                                        bitToCharacter (getBIT (
                                            16,
                                            getFIXED (
                                                mFORMAT_NAME_TERM_CELLSxVMEM_H)
                                                + 2
                                                      * xadd (
                                                          COREHALFWORD (
                                                              mFORMAT_NAME_TERM_CELLSxJ),
                                                          1)))),
                                    cToDescriptor (NULL, ":")),
                                getCHARACTER (mMSG)),
                            cToDescriptor (NULL, ","));
                        putCHARACTER (
                            mS
                                + 4
                                      * (COREHALFWORD (
                                          mFORMAT_NAME_TERM_CELLSxK)),
                            stringRHS);
                        stringRHS->inUse = 0;
                      }
                    es1s3s3s1s1:;
                    } // End of DO block
                  // ELSE (2709)
                  else
                    // S(K) =
                    // S(K)||VMEM_H(J+1)||':'||SYT_NAME(VMEM_H(J+3))||',';
                    // (2710)
                    {
                      descriptor_t *stringRHS;
                      stringRHS = xsCAT (
                          xsCAT (
                              xsCAT (
                                  xsCAT (
                                      getCHARACTER (
                                          mS
                                          + 4
                                                * COREHALFWORD (
                                                    mFORMAT_NAME_TERM_CELLSxK)),
                                      bitToCharacter (getBIT (
                                          16,
                                          getFIXED (
                                              mFORMAT_NAME_TERM_CELLSxVMEM_H)
                                              + 2
                                                    * xadd (
                                                        COREHALFWORD (
                                                            mFORMAT_NAME_TERM_CELLSxJ),
                                                        1)))),
                                  cToDescriptor (NULL, ":")),
                              getCHARACTER (
                                  getFIXED (mSYM_TAB)
                                  + 34
                                        * (COREHALFWORD (
                                            getFIXED (
                                                mFORMAT_NAME_TERM_CELLSxVMEM_H)
                                            + 2
                                                  * xadd (
                                                      COREHALFWORD (
                                                          mFORMAT_NAME_TERM_CELLSxJ),
                                                      3)))
                                  + 0 + 4 * (0))),
                          cToDescriptor (NULL, ","));
                      putCHARACTER (
                          mS + 4 * (COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK)),
                          stringRHS);
                      stringRHS->inUse = 0;
                    }
                  // J = J + 4; (2711)
                  {
                    int32_t numberRHS = (int32_t)(xadd (
                        COREHALFWORD (mFORMAT_NAME_TERM_CELLSxJ), 4));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mFORMAT_NAME_TERM_CELLSxJ, bitRHS);
                    bitRHS->inUse = 0;
                  }
                es1s3s3s1:;
                } // End of DO block
                break;
              case 1:
                // DO; (2713)
                {
                rs1s3s3s2:;
                  // S(K) = S(K)||'('||VMEM_H(J+2)||'#,+'||VMEM_H(J+3)||')(';
                  // (2713)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = xsCAT (
                        xsCAT (
                            xsCAT (
                                xsCAT (
                                    xsCAT (
                                        getCHARACTER (
                                            mS
                                            + 4
                                                  * COREHALFWORD (
                                                      mFORMAT_NAME_TERM_CELLSxK)),
                                        cToDescriptor (NULL, "(")),
                                    bitToCharacter (getBIT (
                                        16,
                                        getFIXED (
                                            mFORMAT_NAME_TERM_CELLSxVMEM_H)
                                            + 2
                                                  * xadd (
                                                      COREHALFWORD (
                                                          mFORMAT_NAME_TERM_CELLSxJ),
                                                      2)))),
                                cToDescriptor (NULL, "#,+")),
                            bitToCharacter (getBIT (
                                16,
                                getFIXED (mFORMAT_NAME_TERM_CELLSxVMEM_H)
                                    + 2
                                          * xadd (
                                              COREHALFWORD (
                                                  mFORMAT_NAME_TERM_CELLSxJ),
                                              3)))),
                        cToDescriptor (NULL, ")("));
                    putCHARACTER (
                        mS + 4 * (COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK)),
                        stringRHS);
                    stringRHS->inUse = 0;
                  }
                  // J = J + 4; (2714)
                  {
                    int32_t numberRHS = (int32_t)(xadd (
                        COREHALFWORD (mFORMAT_NAME_TERM_CELLSxJ), 4));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mFORMAT_NAME_TERM_CELLSxJ, bitRHS);
                    bitRHS->inUse = 0;
                  }
                es1s3s3s2:;
                } // End of DO block
                break;
              case 2:
                // DO; (2716)
                {
                rs1s3s3s3:;
                  // IF BYTE(S(K),LENGTH(S(K))-1) = BYTE(',') THEN (2716)
                  if (1
                      & (xEQ (
                          BYTE (getCHARACTER (
                                    mS
                                    + 4
                                          * COREHALFWORD (
                                              mFORMAT_NAME_TERM_CELLSxK)),
                                xsubtract (
                                    LENGTH (getCHARACTER (
                                        mS
                                        + 4
                                              * COREHALFWORD (
                                                  mFORMAT_NAME_TERM_CELLSxK))),
                                    1)),
                          BYTE1 (cToDescriptor (NULL, ",")))))
                    // S(K) = SUBSTR(S(K),0,LENGTH(S(K))-1); (2717)
                    {
                      descriptor_t *stringRHS;
                      stringRHS = SUBSTR (
                          getCHARACTER (
                              mS
                              + 4 * COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK)),
                          0,
                          xsubtract (
                              LENGTH (getCHARACTER (
                                  mS
                                  + 4
                                        * COREHALFWORD (
                                            mFORMAT_NAME_TERM_CELLSxK))),
                              1));
                      putCHARACTER (
                          mS + 4 * (COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK)),
                          stringRHS);
                      stringRHS->inUse = 0;
                    }
                  // S(K) = S(K) || '),'; (2718)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = xsCAT (
                        getCHARACTER (
                            mS + 4 * COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK)),
                        cToDescriptor (NULL, "),"));
                    putCHARACTER (
                        mS + 4 * (COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK)),
                        stringRHS);
                    stringRHS->inUse = 0;
                  }
                  // J = J + 2; (2719)
                  {
                    int32_t numberRHS = (int32_t)(xadd (
                        COREHALFWORD (mFORMAT_NAME_TERM_CELLSxJ), 2));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mFORMAT_NAME_TERM_CELLSxJ, bitRHS);
                    bitRHS->inUse = 0;
                  }
                es1s3s3s3:;
                } // End of DO block
                break;
              case 3:
                // IF VMEM_H(J+1) = 0 THEN (2721)
                if (1
                    & (xEQ (COREHALFWORD (
                                getFIXED (mFORMAT_NAME_TERM_CELLSxVMEM_H)
                                + 2
                                      * xadd (COREHALFWORD (
                                                  mFORMAT_NAME_TERM_CELLSxJ),
                                              1)),
                            0)))
                  goto DONE;
                else
                  {
                  rs1s3s3s4:;
                    // CALL LOCATE(VMEM_F(SHR(J+2,1)),ADDR(VMEM_F),0); (2724)
                    {
                      putFIXED (
                          mLOCATExPTR,
                          getFIXED (
                              getFIXED (mFORMAT_NAME_TERM_CELLSxVMEM_F)
                              + 4
                                    * SHR (
                                        xadd (COREHALFWORD (
                                                  mFORMAT_NAME_TERM_CELLSxJ),
                                              2),
                                        1)));
                      putFIXED (mLOCATExBVAR,
                                ADDR ("FORMAT_NAME_TERM_CELLSxVMEM_F",
                                      0x80000000, NULL, 0));
                      putBITp (8, mLOCATExFLAGS,
                               fixedToBit (32, (int32_t)(0)));
                      LOCATE (0);
                    }
                    // COREWORD(ADDR(VMEM_H)) = VMEM_LOC_ADDR; (2725)
                    {
                      int32_t numberRHS = (int32_t)(getFIXED (mVMEM_LOC_ADDR));
                      COREWORD2 (ADDR ("FORMAT_NAME_TERM_CELLSxVMEM_H",
                                       0x80000000, NULL, 0),
                                 numberRHS);
                    }
                    // J = 2; (2726)
                    {
                      int32_t numberRHS = (int32_t)(2);
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (16, mFORMAT_NAME_TERM_CELLSxJ, bitRHS);
                      bitRHS->inUse = 0;
                    }
                  es1s3s3s4:;
                  } // End of DO block
                break;
              }
          } // End of DO CASE block
        }   // End of DO WHILE block
    // DONE: (2727)
    DONE:
      // IF BYTE(S(K),LENGTH(S(K))-1) = BYTE(',') THEN (2728)
      if (1
          & (xEQ (
              BYTE (
                  getCHARACTER (
                      mS + 4 * COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK)),
                  xsubtract (
                      LENGTH (getCHARACTER (
                          mS + 4 * COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK))),
                      1)),
              BYTE1 (cToDescriptor (NULL, ",")))))
        // S(K) = SUBSTR(S(K),0,LENGTH(S(K))-1); (2729)
        {
          descriptor_t *stringRHS;
          stringRHS = SUBSTR (
              getCHARACTER (mS + 4 * COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK)),
              0,
              xsubtract (
                  LENGTH (getCHARACTER (
                      mS + 4 * COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK))),
                  1));
          putCHARACTER (mS + 4 * (COREHALFWORD (mFORMAT_NAME_TERM_CELLSxK)),
                        stringRHS);
          stringRHS->inUse = 0;
        }
      // CALL FLUSH(K,1); (2730)
      {
        putBITp (16, mFLUSHxLAST, getBIT (16, mFORMAT_NAME_TERM_CELLSxK));
        putBITp (8, mFLUSHxNO_PTR, fixedToBit (32, (int32_t)(1)));
        FLUSH (0);
      }
    // DONETOO: (2731)
    DONETOO:;
    } // End of DO WHILE block
  {
    reentryGuard = 0;
    return 0;
  }
}
