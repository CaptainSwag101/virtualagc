/*
  File FORMAT_FORM_PARM_CELL.c generated by XCOM-I, 2024-08-09 12:38:39.
*/

#include "runtimeC.h"

int32_t
FORMAT_FORM_PARM_CELL (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "FORMAT_FORM_PARM_CELL");
  // S = HEX(PTR,8) || ' --> ' || SYT_NAME(SYMB#) || '('; (2488)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (
        xsCAT (
            xsCAT (
                (putFIXED (mHEXxHVAL, getFIXED (mFORMAT_FORM_PARM_CELLxPTR)),
                 putFIXED (mHEXxN, 8), HEX (0)),
                cToDescriptor (NULL, " --> ")),
            getCHARACTER (getFIXED (mSYM_TAB)
                          + 34 * (COREHALFWORD (mFORMAT_FORM_PARM_CELLxSYMBp))
                          + 0 + 4 * (0))),
        cToDescriptor (NULL, "("));
    putCHARACTER (mS, stringRHS);
    stringRHS->inUse = 0;
  }
  // CALL LOCATE(PTR,ADDR(VMEM_H),0); (2489)
  {
    putFIXED (mLOCATExPTR, getFIXED (mFORMAT_FORM_PARM_CELLxPTR));
    putFIXED (mLOCATExBVAR, ADDR ("VMEM_H", 0x80000000, NULL, 0));
    putBITp (8, mLOCATExFLAGS, fixedToBit (32, (int32_t)(0)));
    LOCATE (0);
  }
  // COREWORD(ADDR(VMEM_B)) = VMEM_LOC_ADDR; (2490)
  {
    int32_t numberRHS = (int32_t)(getFIXED (mVMEM_LOC_ADDR));
    COREWORD2 (ADDR ("VMEM_B", 0x80000000, NULL, 0), numberRHS);
  }
  // K = 0; (2491)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mFORMAT_FORM_PARM_CELLxK, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF VMEM_B(3) > 0 THEN (2492)
  if (1 & (xGT (BYTE0 (getFIXED (mVMEM_B) + 1 * 3), 0)))
    // DO; (2493)
    {
    rs1:;
      // DO J = 2 TO VMEM_B(3) + 1; (2494)
      {
        int32_t from50, to50, by50;
        from50 = 2;
        to50 = xadd (BYTE0 (getFIXED (mVMEM_B) + 1 * 3), 1);
        by50 = 1;
        for (putBIT (16, mFORMAT_FORM_PARM_CELLxJ, fixedToBit (16, from50));
             bitToFixed (getBIT (16, mFORMAT_FORM_PARM_CELLxJ)) <= to50;
             putBIT (16, mFORMAT_FORM_PARM_CELLxJ,
                     fixedToBit (
                         16, bitToFixed (getBIT (16, mFORMAT_FORM_PARM_CELLxJ))
                                 + by50)))
          {
            // IF LENGTH(S(K)) > LINELENGTH THEN (2495)
            if (1
                & (xGT (LENGTH (getCHARACTER (
                            mS + 4 * COREHALFWORD (mFORMAT_FORM_PARM_CELLxK))),
                        131)))
              // K = K + 1; (2496)
              {
                int32_t numberRHS = (int32_t)(xadd (
                    COREHALFWORD (mFORMAT_FORM_PARM_CELLxK), 1));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mFORMAT_FORM_PARM_CELLxK, bitRHS);
                bitRHS->inUse = 0;
              }
            // S(K) = S(K) || SYT_NAME(VMEM_H(J)) || ','; (2497)
            {
              descriptor_t *stringRHS;
              stringRHS = xsCAT (
                  xsCAT (getCHARACTER (
                             mS + 4 * COREHALFWORD (mFORMAT_FORM_PARM_CELLxK)),
                         getCHARACTER (
                             getFIXED (mSYM_TAB)
                             + 34
                                   * (COREHALFWORD (
                                       getFIXED (mVMEM_H)
                                       + 2
                                             * COREHALFWORD (
                                                 mFORMAT_FORM_PARM_CELLxJ)))
                             + 0 + 4 * (0))),
                  cToDescriptor (NULL, ","));
              putCHARACTER (mS + 4 * (COREHALFWORD (mFORMAT_FORM_PARM_CELLxK)),
                            stringRHS);
              stringRHS->inUse = 0;
            }
          }
      } // End of DO for-loop block
      // BYTE(S(K),LENGTH(S(K))-1) = BYTE(')'); (2498)
      {
        int32_t numberRHS = (int32_t)(BYTE1 (cToDescriptor (NULL, ")")));
        lBYTEb (
            ADDR (NULL, 0, "S", COREHALFWORD (mFORMAT_FORM_PARM_CELLxK)),
            xsubtract (LENGTH (getCHARACTER (
                           mS + 4 * COREHALFWORD (mFORMAT_FORM_PARM_CELLxK))),
                       1),
            BYTE1 (cToDescriptor (NULL, ")")));
      }
    es1:;
    } // End of DO block
  // ELSE (2499)
  else
    // S = S || ')'; (2500)
    {
      descriptor_t *stringRHS;
      stringRHS = xsCAT (getCHARACTER (mS), cToDescriptor (NULL, ")"));
      putCHARACTER (mS, stringRHS);
      stringRHS->inUse = 0;
    }
  // IF VMEM_B(2) > VMEM_B(3) THEN (2501)
  if (1
      & (xGT (BYTE0 (getFIXED (mVMEM_B) + 1 * 2),
              BYTE0 (getFIXED (mVMEM_B) + 1 * 3))))
    // DO; (2502)
    {
    rs2:;
      // S(K) = S(K) || ' ASSIGN('; (2503)
      {
        descriptor_t *stringRHS;
        stringRHS = xsCAT (
            getCHARACTER (mS + 4 * COREHALFWORD (mFORMAT_FORM_PARM_CELLxK)),
            cToDescriptor (NULL, " ASSIGN("));
        putCHARACTER (mS + 4 * (COREHALFWORD (mFORMAT_FORM_PARM_CELLxK)),
                      stringRHS);
        stringRHS->inUse = 0;
      }
      // DO J = VMEM_B(3)+2 TO VMEM_B(2)+1; (2504)
      {
        int32_t from51, to51, by51;
        from51 = xadd (BYTE0 (getFIXED (mVMEM_B) + 1 * 3), 2);
        to51 = xadd (BYTE0 (getFIXED (mVMEM_B) + 1 * 2), 1);
        by51 = 1;
        for (putBIT (16, mFORMAT_FORM_PARM_CELLxJ, fixedToBit (16, from51));
             bitToFixed (getBIT (16, mFORMAT_FORM_PARM_CELLxJ)) <= to51;
             putBIT (16, mFORMAT_FORM_PARM_CELLxJ,
                     fixedToBit (
                         16, bitToFixed (getBIT (16, mFORMAT_FORM_PARM_CELLxJ))
                                 + by51)))
          {
            // IF LENGTH(S(K)) > LINELENGTH THEN (2505)
            if (1
                & (xGT (LENGTH (getCHARACTER (
                            mS + 4 * COREHALFWORD (mFORMAT_FORM_PARM_CELLxK))),
                        131)))
              // K = K + 1; (2506)
              {
                int32_t numberRHS = (int32_t)(xadd (
                    COREHALFWORD (mFORMAT_FORM_PARM_CELLxK), 1));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mFORMAT_FORM_PARM_CELLxK, bitRHS);
                bitRHS->inUse = 0;
              }
            // S(K) = S(K) || SYT_NAME(VMEM_H(J)) || ','; (2507)
            {
              descriptor_t *stringRHS;
              stringRHS = xsCAT (
                  xsCAT (getCHARACTER (
                             mS + 4 * COREHALFWORD (mFORMAT_FORM_PARM_CELLxK)),
                         getCHARACTER (
                             getFIXED (mSYM_TAB)
                             + 34
                                   * (COREHALFWORD (
                                       getFIXED (mVMEM_H)
                                       + 2
                                             * COREHALFWORD (
                                                 mFORMAT_FORM_PARM_CELLxJ)))
                             + 0 + 4 * (0))),
                  cToDescriptor (NULL, ","));
              putCHARACTER (mS + 4 * (COREHALFWORD (mFORMAT_FORM_PARM_CELLxK)),
                            stringRHS);
              stringRHS->inUse = 0;
            }
          }
      } // End of DO for-loop block
      // BYTE(S(K),LENGTH(S(K))-1) = BYTE(')'); (2508)
      {
        int32_t numberRHS = (int32_t)(BYTE1 (cToDescriptor (NULL, ")")));
        lBYTEb (
            ADDR (NULL, 0, "S", COREHALFWORD (mFORMAT_FORM_PARM_CELLxK)),
            xsubtract (LENGTH (getCHARACTER (
                           mS + 4 * COREHALFWORD (mFORMAT_FORM_PARM_CELLxK))),
                       1),
            BYTE1 (cToDescriptor (NULL, ")")));
      }
    es2:;
    } // End of DO block
  // CALL FLUSH(K); (2509)
  {
    putBITp (16, mFLUSHxLAST, getBIT (16, mFORMAT_FORM_PARM_CELLxK));
    FLUSH (0);
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
