/*
  File SEARCH_EXPRESSION.c generated by XCOM-I, 2024-08-09 12:38:39.
*/

#include "runtimeC.h"

int32_t
SEARCH_EXPRESSION (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "SEARCH_EXPRESSION");
  // IF PROC_TRACE THEN (1475)
  if (1 & (bitToFixed (getBIT (8, mPROC_TRACE))))
    // OUTPUT='SEARCH_EXPRESSION('||BLOCK#||':'||CTR||')'; (1476)
    {
      descriptor_t *stringRHS;
      stringRHS = xsCAT (
          xsCAT (xsCAT (xsCAT (cToDescriptor (NULL, "SEARCH_EXPRESSION("),
                               bitToCharacter (getBIT (16, mBLOCKp))),
                        cToDescriptor (NULL, ":")),
                 bitToCharacter (getBIT (16, mSEARCH_EXPRESSIONxCTR))),
          cToDescriptor (NULL, ")"));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // IF TYPE_BITS(CTR) ~= VAC THEN (1477)
  if (1
      & (xNEQ (bitToFixed ((putBITp (16, mTYPE_BITSxCTR,
                                     getBIT (16, mSEARCH_EXPRESSIONxCTR)),
                            TYPE_BITS (0))),
               COREHALFWORD (mVAC))))
    // DO; (1478)
    {
    rs1:;
      // CALL DO_OPERAND(CTR); (1479)
      {
        putBITp (16, mSEARCH_EXPRESSIONxDO_OPERANDxOPERAND,
                 getBIT (16, mSEARCH_EXPRESSIONxCTR));
        SEARCH_EXPRESSIONxDO_OPERAND (0);
      }
      // RETURN; (1480)
      {
        reentryGuard = 0;
        return 0;
      }
    es1:;
    } // End of DO block
  // SAVE_INX = 0; (1481)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mSEARCH_EXPRESSIONxSAVE_INX, bitRHS);
    bitRHS->inUse = 0;
  }
  // CALL BUMP_VAC(CTR); (1482)
  {
    putBITp (16, mSEARCH_EXPRESSIONxBUMP_VACxOPERAND,
             getBIT (16, mSEARCH_EXPRESSIONxCTR));
    SEARCH_EXPRESSIONxBUMP_VAC (0);
  }
  // DO WHILE SAVE_INX ~= 0; (1483)
  while (1 & (xNEQ (COREHALFWORD (mSEARCH_EXPRESSIONxSAVE_INX), 0)))
    {
      // OP = SAVE_VACS(SAVE_INX); (1484)
      {
        descriptor_t *bitRHS = getBIT (
            16, mSEARCH_EXPRESSIONxSAVE_VACS
                    + 2 * COREHALFWORD (mSEARCH_EXPRESSIONxSAVE_INX));
        putBIT (16, mSEARCH_EXPRESSIONxOP, bitRHS);
        bitRHS->inUse = 0;
      }
      // SAVE_INX = SAVE_INX - 1; (1485)
      {
        int32_t numberRHS = (int32_t)(xsubtract (
            COREHALFWORD (mSEARCH_EXPRESSIONxSAVE_INX), 1));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mSEARCH_EXPRESSIONxSAVE_INX, bitRHS);
        bitRHS->inUse = 0;
      }
      // CALL DECODEPOP(OP); (1486)
      {
        putBITp (16, mDECODEPOPxCTR, getBIT (16, mSEARCH_EXPRESSIONxOP));
        DECODEPOP (0);
      }
      // IF CLASS = 0 THEN (1487)
      if (1 & (xEQ (COREHALFWORD (mCLASS), 0)))
        // DO; (1488)
        {
        rs2s1:;
          // IF OPCODE = LFNC | (OPCODE >= MSHP & OPCODE <= ISHP) THEN (1489)
          if (1
              & (xOR (
                  xEQ (COREHALFWORD (mOPCODE), COREHALFWORD (mLFNC)),
                  xAND (xGE (COREHALFWORD (mOPCODE), COREHALFWORD (mMSHP)),
                        xLE (COREHALFWORD (mOPCODE), COREHALFWORD (mISHP))))))
            // CALL GET_SF_ARGS(OP); (1490)
            {
              putBITp (16, mSEARCH_EXPRESSIONxGET_SF_ARGSxCTR,
                       getBIT (16, mSEARCH_EXPRESSIONxOP));
              SEARCH_EXPRESSIONxGET_SF_ARGS (0);
            }
          // ELSE (1491)
          else
            // IF OPCODE=DSUB | OPCODE=TSUB | OPCODE=PCAL | OPCODE=FCAL |
            // OPCODE=IDEF THEN (1492)
            if (1
                & (xOR (
                    xOR (xOR (xOR (xEQ (COREHALFWORD (mOPCODE),
                                        COREHALFWORD (mDSUB)),
                                   xEQ (COREHALFWORD (mOPCODE),
                                        COREHALFWORD (mTSUB))),
                              xEQ (COREHALFWORD (mOPCODE),
                                   COREHALFWORD (mPCAL))),
                         xEQ (COREHALFWORD (mOPCODE), COREHALFWORD (mFCAL))),
                    xEQ (COREHALFWORD (mOPCODE), COREHALFWORD (mIDEF)))))
              // DO; (1493)
              {
              rs2s1s1:;
                // IF HALMAT_PTR(OP) ~= 0 THEN (1494)
                if (1
                    & (xNEQ (
                        getFIXED (mHALMAT_PTR
                                  + 4 * COREHALFWORD (mSEARCH_EXPRESSIONxOP)),
                        0)))
                  // DO; (1495)
                  {
                  rs2s1s1s1:;
                    // PTR_INX = PTR_INX + 1; (1496)
                    {
                      int32_t numberRHS
                          = (int32_t)(xadd (COREHALFWORD (mPTR_INX), 1));
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (16, mPTR_INX, bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // EXP_PTRS(PTR_INX) = HALMAT_PTR(OP); (1497)
                    {
                      int32_t numberRHS = (int32_t)(getFIXED (
                          mHALMAT_PTR
                          + 4 * COREHALFWORD (mSEARCH_EXPRESSIONxOP)));
                      putFIXED (mEXP_PTRS + 4 * (COREHALFWORD (mPTR_INX)),
                                numberRHS);
                    }
                  es2s1s1s1:;
                  } // End of DO block
                // ELSE (1498)
                else
                  // CALL ERRORS (CLASS_BI, 204, ' '||BLOCK#||':'||OP); (1499)
                  {
                    putBITp (16, mERRORSxCLASS, getBIT (16, mCLASS_BI));
                    putBITp (16, mERRORSxNUM, fixedToBit (32, (int32_t)(204)));
                    putCHARACTERp (
                        mERRORSxTEXT,
                        xsCAT (xsCAT (xsCAT (cToDescriptor (NULL, " "),
                                             bitToCharacter (
                                                 getBIT (16, mBLOCKp))),
                                      cToDescriptor (NULL, ":")),
                               bitToCharacter (
                                   getBIT (16, mSEARCH_EXPRESSIONxOP))));
                    ERRORS (0);
                  }
              es2s1s1:;
              } // End of DO block
            // ELSE (1500)
            else
              // IF OPCODE = EXTN THEN (1501)
              if (1 & (xEQ (COREHALFWORD (mOPCODE), COREHALFWORD (mEXTN))))
                // CALL PROCESS_EXTN(OP); (1502)
                {
                  putBITp (16, mPROCESS_EXTNxCTR,
                           getBIT (16, mSEARCH_EXPRESSIONxOP));
                  PROCESS_EXTN (0);
                }
              // ELSE (1503)
              else
                // DO I = 1 TO NUMOP; (1504)
                {
                  int32_t from35, to35, by35;
                  from35 = 1;
                  to35 = bitToFixed (getBIT (16, mNUMOP));
                  by35 = 1;
                  for (putBIT (16, mSEARCH_EXPRESSIONxI,
                               fixedToBit (16, from35));
                       bitToFixed (getBIT (16, mSEARCH_EXPRESSIONxI)) <= to35;
                       putBIT (16, mSEARCH_EXPRESSIONxI,
                               fixedToBit (16, bitToFixed (getBIT (
                                                   16, mSEARCH_EXPRESSIONxI))
                                                   + by35)))
                    {
                      // CALL DO_OPERAND(OP+I); (1505)
                      {
                        putBITp (
                            16, mSEARCH_EXPRESSIONxDO_OPERANDxOPERAND,
                            fixedToBit (
                                32,
                                (int32_t)(xadd (
                                    COREHALFWORD (mSEARCH_EXPRESSIONxOP),
                                    COREHALFWORD (mSEARCH_EXPRESSIONxI)))));
                        SEARCH_EXPRESSIONxDO_OPERAND (0);
                      }
                    }
                } // End of DO for-loop block
        es2s1:;
        } // End of DO block
      // ELSE (1506)
      else
        // DO I = 1 TO NUMOP; (1507)
        {
          int32_t from36, to36, by36;
          from36 = 1;
          to36 = bitToFixed (getBIT (16, mNUMOP));
          by36 = 1;
          for (putBIT (16, mSEARCH_EXPRESSIONxI, fixedToBit (16, from36));
               bitToFixed (getBIT (16, mSEARCH_EXPRESSIONxI)) <= to36;
               putBIT (16, mSEARCH_EXPRESSIONxI,
                       fixedToBit (
                           16, bitToFixed (getBIT (16, mSEARCH_EXPRESSIONxI))
                                   + by36)))
            {
              // CALL DO_OPERAND(OP+I); (1508)
              {
                putBITp (16, mSEARCH_EXPRESSIONxDO_OPERANDxOPERAND,
                         fixedToBit (
                             32, (int32_t)(xadd (
                                     COREHALFWORD (mSEARCH_EXPRESSIONxOP),
                                     COREHALFWORD (mSEARCH_EXPRESSIONxI)))));
                SEARCH_EXPRESSIONxDO_OPERAND (0);
              }
            }
        } // End of DO for-loop block
    }     // End of DO WHILE block
  {
    reentryGuard = 0;
    return 0;
  }
}
