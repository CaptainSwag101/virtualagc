/*
  File GET_VAR_REF_CELLxGET_SUBSCRIPTS.c generated by XCOM-I, 2024-08-08
  04:31:35.
*/

#include "runtimeC.h"

int32_t
GET_VAR_REF_CELLxGET_SUBSCRIPTS (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard
      = guardReentry (reentryGuard, "GET_VAR_REF_CELLxGET_SUBSCRIPTS");
  // DO I = 2 TO POPNUM(CTR); (1638)
  {
    int32_t from40, to40, by40;
    from40 = 2;
    to40 = bitToFixed (
        (putBITp (16, mPOPNUMxCTR, getBIT (16, mGET_VAR_REF_CELLxCTR)),
         POPNUM (0)));
    by40 = 1;
    for (putBIT (16, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI,
                 fixedToBit (16, from40));
         bitToFixed (getBIT (16, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI)) <= to40;
         putBIT (16, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI,
                 fixedToBit (16, bitToFixed (getBIT (
                                     16, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI))
                                     + by40)))
      {
        // TYPE = 0; (1639)
        {
          int32_t numberRHS = (int32_t)(0);
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (8, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxTYPE, bitRHS);
          bitRHS->inUse = 0;
        }
        // OPERAND = CTR + I; (1640)
        {
          int32_t numberRHS = (int32_t)(xadd (
              COREHALFWORD (mGET_VAR_REF_CELLxCTR),
              COREHALFWORD (mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI)));
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (16, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxOPERAND, bitRHS);
          bitRHS->inUse = 0;
        }
        // DO CASE TYPE_BITS(OPERAND); (1641)
        {
        rs1s1:
          switch (bitToFixed (
              (putBITp (16, mTYPE_BITSxCTR,
                        getBIT (16, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxOPERAND)),
               TYPE_BITS (0))))
            {
            case 0:
                // ; (1643)
                ;
              break;
            case 1:
              // DO; (1644)
              {
              rs1s1s1:;
                // VAR_INX = VAR_INX + 1; (1644)
                {
                  int32_t numberRHS
                      = (int32_t)(xadd (COREHALFWORD (mVAR_INX), 1));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mVAR_INX, bitRHS);
                  bitRHS->inUse = 0;
                }
                // EXP_VARS(VAR_INX) = REFERENCE; (1645)
                {
                  int32_t numberRHS = (int32_t)(SHR (
                      getFIXED (
                          mOPR
                          + 4
                                * xadd (
                                    COREHALFWORD (mGET_VAR_REF_CELLxCTR),
                                    COREHALFWORD (
                                        mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI))),
                      16));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mEXP_VARS + 2 * (COREHALFWORD (mVAR_INX)),
                          bitRHS);
                  bitRHS->inUse = 0;
                }
              es1s1s1:;
              } // End of DO block
              break;
            case 2:
                // ; (1647)
                ;
              break;
            case 3:
              // CALL SEARCH_EXPRESSION(CTR+I); (1648)
              {
                putBITp (
                    16, mSEARCH_EXPRESSIONxCTR,
                    fixedToBit (
                        32, (int32_t)(xadd (
                                COREHALFWORD (mGET_VAR_REF_CELLxCTR),
                                COREHALFWORD (
                                    mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI)))));
                SEARCH_EXPRESSION (0);
              }
              break;
            case 4:
              // CALL PROCESS_EXTN(REFERENCE); (1649)
              {
                putBITp (
                    16, mPROCESS_EXTNxCTR,
                    fixedToBit (
                        32,
                        (int32_t)(SHR (
                            getFIXED (
                                mOPR
                                + 4
                                      * xadd (
                                          COREHALFWORD (mGET_VAR_REF_CELLxCTR),
                                          COREHALFWORD (
                                              mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI))),
                            16))));
                PROCESS_EXTN (0);
              }
              break;
            case 5:
              // DO; (1650)
              {
              rs1s1s2:;
                // LIT_VAL = INTEGER_LIT(REFERENCE); (1650)
                {
                  descriptor_t *bitRHS
                      = (putBITp (
                             16, mINTEGER_LITxPTR,
                             fixedToBit (
                                 32,
                                 (int32_t)(SHR (
                                     getFIXED (
                                         mOPR
                                         + 4
                                               * xadd (
                                                   COREHALFWORD (
                                                       mGET_VAR_REF_CELLxCTR),
                                                   COREHALFWORD (
                                                       mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI))),
                                     16)))),
                         INTEGER_LIT (0));
                  putBIT (16, mGET_VAR_REF_CELLxLIT_VAL, bitRHS);
                  bitRHS->inUse = 0;
                }
                // TYPE = 1; (1651)
                {
                  int32_t numberRHS = (int32_t)(1);
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (8, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxTYPE, bitRHS);
                  bitRHS->inUse = 0;
                }
              es1s1s2:;
              } // End of DO block
              break;
            case 6:
              // DO; (1653)
              {
              rs1s1s3:;
                // LIT_VAL = REFERENCE; (1653)
                {
                  int32_t numberRHS = (int32_t)(SHR (
                      getFIXED (
                          mOPR
                          + 4
                                * xadd (
                                    COREHALFWORD (mGET_VAR_REF_CELLxCTR),
                                    COREHALFWORD (
                                        mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI))),
                      16));
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (16, mGET_VAR_REF_CELLxLIT_VAL, bitRHS);
                  bitRHS->inUse = 0;
                }
                // TYPE = 1; (1654)
                {
                  int32_t numberRHS = (int32_t)(1);
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (8, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxTYPE, bitRHS);
                  bitRHS->inUse = 0;
                }
              es1s1s3:;
              } // End of DO block
              break;
            case 7:
                // ; (1656)
                ;
              break;
            case 8:
              // DO; (1657)
              {
              rs1s1s4:;
              // DO_CSZ: (1657)
              DO_CSZ:
                // IF REFERENCE = 0 THEN (1658)
                if (1
                    & (xEQ (
                        SHR (
                            getFIXED (
                                mOPR
                                + 4
                                      * xadd (
                                          COREHALFWORD (mGET_VAR_REF_CELLxCTR),
                                          COREHALFWORD (
                                              mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI))),
                            16),
                        0)))
                  // TYPE = 8; (1659)
                  {
                    int32_t numberRHS = (int32_t)(8);
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (8, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxTYPE, bitRHS);
                    bitRHS->inUse = 0;
                  }
                // ELSE (1660)
                else
                  // DO; (1661)
                  {
                  rs1s1s4s1:;
                    // TYPE = SHL(REFERENCE,1); (1662)
                    {
                      int32_t numberRHS = (int32_t)(SHL (
                          SHR (
                              getFIXED (
                                  mOPR
                                  + 4
                                        * xadd (
                                            COREHALFWORD (
                                                mGET_VAR_REF_CELLxCTR),
                                            COREHALFWORD (
                                                mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI))),
                              16),
                          1));
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (8, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxTYPE,
                              bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // I = I + 1; (1663)
                    {
                      int32_t numberRHS = (int32_t)(xadd (
                          COREHALFWORD (mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI),
                          1));
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (16, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxI, bitRHS);
                      bitRHS->inUse = 0;
                    }
                    // DO CASE TYPE_BITS(OPERAND+1); (1664)
                    {
                    rs1s1s4s1s1:
                      switch (bitToFixed ((
                          putBITp (
                              16, mTYPE_BITSxCTR,
                              fixedToBit (
                                  32,
                                  (int32_t)(xadd (
                                      COREHALFWORD (
                                          mGET_VAR_REF_CELLxGET_SUBSCRIPTSxOPERAND),
                                      1)))),
                          TYPE_BITS (0))))
                        {
                        case 0:
                            // ; (1666)
                            ;
                          break;
                        case 1:
                          // DO; (1667)
                          {
                          rs1s1s4s1s1s1:;
                            // REF_INX = REF_INX + 1; (1667)
                            {
                              int32_t numberRHS = (int32_t)(xadd (
                                  COREHALFWORD (mGET_VAR_REF_CELLxREF_INX),
                                  1));
                              descriptor_t *bitRHS;
                              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                              putBIT (16, mGET_VAR_REF_CELLxREF_INX, bitRHS);
                              bitRHS->inUse = 0;
                            }
                            // REF(REF_INX) = REFERENCE1; (1668)
                            {
                              int32_t numberRHS = (int32_t)(SHR (
                                  getFIXED (
                                      mOPR
                                      + 4
                                            * xadd (
                                                COREHALFWORD (
                                                    mGET_VAR_REF_CELLxGET_SUBSCRIPTSxOPERAND),
                                                1)),
                                  16));
                              descriptor_t *bitRHS;
                              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                              putBIT (
                                  16,
                                  mGET_VAR_REF_CELLxREF
                                      + 2
                                            * (COREHALFWORD (
                                                mGET_VAR_REF_CELLxREF_INX)),
                                  bitRHS);
                              bitRHS->inUse = 0;
                            }
                          es1s1s4s1s1s1:;
                          } // End of DO block
                          break;
                        case 2:
                            // ; (1670)
                            ;
                          break;
                        case 3:
                          // CALL SEARCH_EXPRESSION(OPERAND+1); (1671)
                          {
                            putBITp (
                                16, mSEARCH_EXPRESSIONxCTR,
                                fixedToBit (
                                    32,
                                    (int32_t)(xadd (
                                        COREHALFWORD (
                                            mGET_VAR_REF_CELLxGET_SUBSCRIPTSxOPERAND),
                                        1))));
                            SEARCH_EXPRESSION (0);
                          }
                          break;
                        case 4:
                          // CALL PROCESS_EXTN(REFERENCE1); (1672)
                          {
                            putBITp (
                                16, mPROCESS_EXTNxCTR,
                                fixedToBit (
                                    32,
                                    (int32_t)(SHR (
                                        getFIXED (
                                            mOPR
                                            + 4
                                                  * xadd (
                                                      COREHALFWORD (
                                                          mGET_VAR_REF_CELLxGET_SUBSCRIPTSxOPERAND),
                                                      1)),
                                        16))));
                            PROCESS_EXTN (0);
                          }
                          break;
                        case 5:
                          // DO; (1673)
                          {
                          rs1s1s4s1s1s2:;
                            // LIT_VAL = INTEGER_LIT(REFERENCE1); (1673)
                            {
                              descriptor_t *bitRHS
                                  = (putBITp (
                                         16, mINTEGER_LITxPTR,
                                         fixedToBit (
                                             32,
                                             (int32_t)(SHR (
                                                 getFIXED (
                                                     mOPR
                                                     + 4
                                                           * xadd (
                                                               COREHALFWORD (
                                                                   mGET_VAR_REF_CELLxGET_SUBSCRIPTSxOPERAND),
                                                               1)),
                                                 16)))),
                                     INTEGER_LIT (0));
                              putBIT (16, mGET_VAR_REF_CELLxLIT_VAL, bitRHS);
                              bitRHS->inUse = 0;
                            }
                            // TYPE = TYPE + 1; (1674)
                            {
                              int32_t numberRHS = (int32_t)(xadd (
                                  BYTE0 (
                                      mGET_VAR_REF_CELLxGET_SUBSCRIPTSxTYPE),
                                  1));
                              descriptor_t *bitRHS;
                              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                              putBIT (8, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxTYPE,
                                      bitRHS);
                              bitRHS->inUse = 0;
                            }
                          es1s1s4s1s1s2:;
                          } // End of DO block
                          break;
                        case 6:
                          // DO; (1676)
                          {
                          rs1s1s4s1s1s3:;
                            // LIT_VAL = REFERENCE1; (1676)
                            {
                              int32_t numberRHS = (int32_t)(SHR (
                                  getFIXED (
                                      mOPR
                                      + 4
                                            * xadd (
                                                COREHALFWORD (
                                                    mGET_VAR_REF_CELLxGET_SUBSCRIPTSxOPERAND),
                                                1)),
                                  16));
                              descriptor_t *bitRHS;
                              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                              putBIT (16, mGET_VAR_REF_CELLxLIT_VAL, bitRHS);
                              bitRHS->inUse = 0;
                            }
                            // TYPE = TYPE + 1; (1677)
                            {
                              int32_t numberRHS = (int32_t)(xadd (
                                  BYTE0 (
                                      mGET_VAR_REF_CELLxGET_SUBSCRIPTSxTYPE),
                                  1));
                              descriptor_t *bitRHS;
                              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                              putBIT (8, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxTYPE,
                                      bitRHS);
                              bitRHS->inUse = 0;
                            }
                          es1s1s4s1s1s3:;
                          } // End of DO block
                          break;
                        }
                    } // End of DO CASE block
                  es1s1s4s1:;
                  } // End of DO block
              es1s1s4:;
              } // End of DO block
              break;
            case 9:
              // GO TO DO_CSZ; (1679)
              goto DO_CSZ;
              break;
            case 10:
                // ; (1680)
                ;
              break;
            }
        } // End of DO CASE block
        // SUB_TYPE = (OPR(OPERAND) &  65280) + SHL(TYPE,4) + X_BITS(OPERAND);
        // (1680)
        {
          int32_t numberRHS = (int32_t)(xadd (
              xadd (
                  xAND (
                      getFIXED (
                          mOPR
                          + 4
                                * COREHALFWORD (
                                    mGET_VAR_REF_CELLxGET_SUBSCRIPTSxOPERAND)),
                      65280),
                  SHL (BYTE0 (mGET_VAR_REF_CELLxGET_SUBSCRIPTSxTYPE), 4)),
              bitToFixed (
                  (putBITp (
                       16, mX_BITSxCTR,
                       getBIT (16, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxOPERAND)),
                   X_BITS (0)))));
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (16, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxSUB_TYPE, bitRHS);
          bitRHS->inUse = 0;
        }
        // SUB_INX = SUB_INX + 1; (1681)
        {
          int32_t numberRHS
              = (int32_t)(xadd (COREHALFWORD (mGET_VAR_REF_CELLxSUB_INX), 1));
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (16, mGET_VAR_REF_CELLxSUB_INX, bitRHS);
          bitRHS->inUse = 0;
        }
        // SUBS(SUB_INX) = SUB_TYPE; (1682)
        {
          descriptor_t *bitRHS
              = getBIT (16, mGET_VAR_REF_CELLxGET_SUBSCRIPTSxSUB_TYPE);
          putBIT (16,
                  mGET_VAR_REF_CELLxSUBS
                      + 2 * (COREHALFWORD (mGET_VAR_REF_CELLxSUB_INX)),
                  bitRHS);
          bitRHS->inUse = 0;
        }
        // IF (TYPE & 1) = 1 THEN (1683)
        if (1
            & (xEQ (xAND (BYTE0 (mGET_VAR_REF_CELLxGET_SUBSCRIPTSxTYPE), 1),
                    1)))
          // DO; (1684)
          {
          rs1s2:;
            // SUB_INX = SUB_INX + 1; (1685)
            {
              int32_t numberRHS = (int32_t)(xadd (
                  COREHALFWORD (mGET_VAR_REF_CELLxSUB_INX), 1));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mGET_VAR_REF_CELLxSUB_INX, bitRHS);
              bitRHS->inUse = 0;
            }
            // SUBS(SUB_INX) = LIT_VAL; (1686)
            {
              descriptor_t *bitRHS = getBIT (16, mGET_VAR_REF_CELLxLIT_VAL);
              putBIT (16,
                      mGET_VAR_REF_CELLxSUBS
                          + 2 * (COREHALFWORD (mGET_VAR_REF_CELLxSUB_INX)),
                      bitRHS);
              bitRHS->inUse = 0;
            }
          es1s2:;
          } // End of DO block
      }
  } // End of DO for-loop block
  {
    reentryGuard = 0;
    return 0;
  }
}
