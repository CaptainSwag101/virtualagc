/*
  File GET_EXP_VARS_CELL.c generated by XCOM-I, 2024-08-08 04:31:35.
*/

#include "runtimeC.h"

int32_t
GET_EXP_VARS_CELL (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "GET_EXP_VARS_CELL");
  // IF PROC_TRACE THEN (1459)
  if (1 & (bitToFixed (getBIT (8, mPROC_TRACE))))
    // OUTPUT='GET_EXP_VARS_CELL'; (1460)
    {
      descriptor_t *stringRHS;
      stringRHS = cToDescriptor (NULL, "GET_EXP_VARS_CELL");
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // IF PTR_INX=0 & VAR_INX=0 THEN (1461)
  if (1
      & (xAND (xEQ (COREHALFWORD (mPTR_INX), 0),
               xEQ (COREHALFWORD (mVAR_INX), 0))))
    // RETURN 0; (1462)
    {
      reentryGuard = 0;
      return 0;
    }
  // PTR_START = SHR(VAR_INX+1,1); (1463)
  {
    int32_t numberRHS = (int32_t)(SHR (xadd (COREHALFWORD (mVAR_INX), 1), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mGET_EXP_VARS_CELLxPTR_START, bitRHS);
    bitRHS->inUse = 0;
  }
  // CELLSIZE = SHL(PTR_START+PTR_INX+1,2); (1464)
  {
    int32_t numberRHS = (int32_t)(SHL (
        xadd (xadd (COREHALFWORD (mGET_EXP_VARS_CELLxPTR_START),
                    COREHALFWORD (mPTR_INX)),
              1),
        2));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mCELLSIZE, bitRHS);
    bitRHS->inUse = 0;
  }
  // CELL = GET_CELL(CELLSIZE,ADDR(VMEM_H),MODF); (1465)
  {
    int32_t numberRHS = (int32_t)((
        putFIXED (mGET_CELLxCELL_SIZE, COREHALFWORD (mCELLSIZE)),
        putFIXED (mGET_CELLxBVAR, ADDR ("VMEM_H", 0x80000000, NULL, 0)),
        putBITp (8, mGET_CELLxFLAGS, getBIT (8, mMODF)), GET_CELL (0)));
    putFIXED (mGET_EXP_VARS_CELLxCELL, numberRHS);
  }
  // VMEM_H(0) = CELLSIZE; (1466)
  {
    descriptor_t *bitRHS = getBIT (16, mCELLSIZE);
    putBIT (16, getFIXED (mVMEM_H) + 2 * (0), bitRHS);
    bitRHS->inUse = 0;
  }
  // VMEM_H(1) = VAR_INX; (1467)
  {
    descriptor_t *bitRHS = getBIT (16, mVAR_INX);
    putBIT (16, getFIXED (mVMEM_H) + 2 * (1), bitRHS);
    bitRHS->inUse = 0;
  }
  // DO I = 1 TO VAR_INX; (1468)
  {
    int32_t from33, to33, by33;
    from33 = 1;
    to33 = bitToFixed (getBIT (16, mVAR_INX));
    by33 = 1;
    for (putBIT (16, mGET_EXP_VARS_CELLxI, fixedToBit (16, from33));
         bitToFixed (getBIT (16, mGET_EXP_VARS_CELLxI)) <= to33;
         putBIT (16, mGET_EXP_VARS_CELLxI,
                 fixedToBit (16, bitToFixed (getBIT (16, mGET_EXP_VARS_CELLxI))
                                     + by33)))
      {
        // VMEM_H(I+1) = EXP_VARS(I); (1469)
        {
          descriptor_t *bitRHS = getBIT (
              16, mEXP_VARS + 2 * COREHALFWORD (mGET_EXP_VARS_CELLxI));
          putBIT (16,
                  getFIXED (mVMEM_H)
                      + 2 * (xadd (COREHALFWORD (mGET_EXP_VARS_CELLxI), 1)),
                  bitRHS);
          bitRHS->inUse = 0;
        }
      }
  } // End of DO for-loop block
  // COREWORD(ADDR(VMEM_F)) = VMEM_LOC_ADDR; (1470)
  {
    int32_t numberRHS = (int32_t)(getFIXED (mVMEM_LOC_ADDR));
    COREWORD2 (ADDR ("VMEM_F", 0x80000000, NULL, 0), numberRHS);
  }
  // DO I = 1 TO PTR_INX; (1471)
  {
    int32_t from34, to34, by34;
    from34 = 1;
    to34 = bitToFixed (getBIT (16, mPTR_INX));
    by34 = 1;
    for (putBIT (16, mGET_EXP_VARS_CELLxI, fixedToBit (16, from34));
         bitToFixed (getBIT (16, mGET_EXP_VARS_CELLxI)) <= to34;
         putBIT (16, mGET_EXP_VARS_CELLxI,
                 fixedToBit (16, bitToFixed (getBIT (16, mGET_EXP_VARS_CELLxI))
                                     + by34)))
      {
        // VMEM_F(PTR_START+I) = EXP_PTRS(I); (1472)
        {
          int32_t numberRHS = (int32_t)(getFIXED (
              mEXP_PTRS + 4 * COREHALFWORD (mGET_EXP_VARS_CELLxI)));
          putFIXED (
              getFIXED (mVMEM_F)
                  + 4
                        * (xadd (COREHALFWORD (mGET_EXP_VARS_CELLxPTR_START),
                                 COREHALFWORD (mGET_EXP_VARS_CELLxI))),
              numberRHS);
        }
      }
  } // End of DO for-loop block
  // VAR_INX, PTR_INX = 0; (1473)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mVAR_INX, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mPTR_INX, bitRHS);
    bitRHS->inUse = 0;
  }
  // RETURN CELL; (1474)
  {
    reentryGuard = 0;
    return getFIXED (mGET_EXP_VARS_CELLxCELL);
  }
}
