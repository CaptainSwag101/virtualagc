/*
  File PTR_LOCATExPAGING_STRATEGY.c generated by XCOM-I, 2024-08-08 04:31:35.
*/

#include "runtimeC.h"

int32_t
PTR_LOCATExPAGING_STRATEGY (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "PTR_LOCATExPAGING_STRATEGY");
  // CUR_NDX = -1; (963)
  {
    int32_t numberRHS = (int32_t)(-1);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mPTR_LOCATExCUR_NDX, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO I = 0 TO VMEM_MAX_PAGE; (964)
  {
    int32_t from20, to20, by20;
    from20 = 0;
    to20 = bitToFixed (getBIT (16, mVMEM_MAX_PAGE));
    by20 = 1;
    for (putBIT (16, mPTR_LOCATExI, fixedToBit (16, from20));
         bitToFixed (getBIT (16, mPTR_LOCATExI)) <= to20; putBIT (
             16, mPTR_LOCATExI,
             fixedToBit (16, bitToFixed (getBIT (16, mPTR_LOCATExI)) + by20)))
      {
        // IF (VMEM_PAD_DISP(I) &  16383) = 0 THEN (965)
        if (1
            & (xEQ (xAND (COREHALFWORD (mVMEM_PAD_DISP
                                        + 2 * COREHALFWORD (mPTR_LOCATExI)),
                          16383),
                    0)))
          // DO; (966)
          {
          rs1s1:;
            // IF CUR_NDX < 0 THEN (967)
            if (1 & (xLT (COREHALFWORD (mPTR_LOCATExCUR_NDX), 0)))
              // DO; (968)
              {
              rs1s1s1:;
                // CUR_NDX=I; (969)
                {
                  descriptor_t *bitRHS = getBIT (16, mPTR_LOCATExI);
                  putBIT (16, mPTR_LOCATExCUR_NDX, bitRHS);
                  bitRHS->inUse = 0;
                }
                // PREV_CNT=VMEM_PAD_CNT(I); (970)
                {
                  int32_t numberRHS = (int32_t)(getFIXED (
                      mVMEM_PAD_CNT + 4 * COREHALFWORD (mPTR_LOCATExI)));
                  putFIXED (mPTR_LOCATExPREV_CNT, numberRHS);
                }
              es1s1s1:;
              } // End of DO block
            // ELSE (971)
            else
              // IF (VMEM_PAD_CNT(I) < PREV_CNT) THEN (972)
              if (1
                  & (xLT (getFIXED (mVMEM_PAD_CNT
                                    + 4 * COREHALFWORD (mPTR_LOCATExI)),
                          getFIXED (mPTR_LOCATExPREV_CNT))))
                // DO; (973)
                {
                rs1s1s2:;
                  // CUR_NDX=I; (974)
                  {
                    descriptor_t *bitRHS = getBIT (16, mPTR_LOCATExI);
                    putBIT (16, mPTR_LOCATExCUR_NDX, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // PREV_CNT=VMEM_PAD_CNT(I); (975)
                  {
                    int32_t numberRHS = (int32_t)(getFIXED (
                        mVMEM_PAD_CNT + 4 * COREHALFWORD (mPTR_LOCATExI)));
                    putFIXED (mPTR_LOCATExPREV_CNT, numberRHS);
                  }
                es1s1s2:;
                } // End of DO block
          es1s1:;
          } // End of DO block
      }
  } // End of DO for-loop block
  // IF CUR_NDX < 0 THEN (976)
  if (1 & (xLT (COREHALFWORD (mPTR_LOCATExCUR_NDX), 0)))
    // DO; (977)
    {
    rs2:;
      // CALL ERRORS(CLASS_BI,700); (978)
      {
        putBITp (16, mERRORSxCLASS, getBIT (16, mCLASS_BI));
        putBITp (16, mERRORSxNUM, fixedToBit (32, (int32_t)(700)));
        ERRORS (0);
      }
      // CALL EXIT; (979)
      EXIT ();
    es2:;
    } // End of DO block
  // PAGE_TMP = VMEM_PAD_PAGE(CUR_NDX); (980)
  {
    descriptor_t *bitRHS
        = getBIT (16, mVMEM_PAD_PAGE + 2 * COREHALFWORD (mPTR_LOCATExCUR_NDX));
    putBIT (16, mPTR_LOCATExPAGE_TMP, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF PAGE_TMP ~= -1 THEN (981)
  if (1 & (xNEQ (COREHALFWORD (mPTR_LOCATExPAGE_TMP), -1)))
    // DO; (982)
    {
    rs3:;
      // VMEM_PAGE_TO_NDX(PAGE_TMP) = -1; (983)
      {
        int32_t numberRHS = (int32_t)(-1);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16,
                mVMEM_PAGE_TO_NDX + 2 * (COREHALFWORD (mPTR_LOCATExPAGE_TMP)),
                bitRHS);
        bitRHS->inUse = 0;
      }
      // IF PAGE_TMP = VMEM_LOOK_AHEAD_PAGE THEN (984)
      if (1
          & (xEQ (COREHALFWORD (mPTR_LOCATExPAGE_TMP),
                  COREHALFWORD (mVMEM_LOOK_AHEAD_PAGE))))
        // DO; (985)
        {
        rs3s1:;
          // CALL MONITOR(31,0,-1); (986)
          MONITOR31 (0, -1);
          // VMEM_LOOK_AHEAD_PAGE = -1; (987)
          {
            int32_t numberRHS = (int32_t)(-1);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mVMEM_LOOK_AHEAD_PAGE, bitRHS);
            bitRHS->inUse = 0;
          }
        es3s1:;
        } // End of DO block
    es3:;
    } // End of DO block
  // IF (VMEM_PAD_DISP(CUR_NDX)& 16384) ~= 0 THEN (988)
  if (1
      & (xNEQ (xAND (COREHALFWORD (mVMEM_PAD_DISP
                                   + 2 * COREHALFWORD (mPTR_LOCATExCUR_NDX)),
                     16384),
               0)))
    // DO; (989)
    {
    rs4:;
      // IF VMEM_LOOK_AHEAD_PAGE >= 0 THEN (990)
      if (1 & (xGE (COREHALFWORD (mVMEM_LOOK_AHEAD_PAGE), 0)))
        // DO; (991)
        {
        rs4s1:;
          // CALL MONITOR(31,0,-1); (992)
          MONITOR31 (0, -1);
          // VMEM_LOOK_AHEAD_PAGE = -1; (993)
          {
            int32_t numberRHS = (int32_t)(-1);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mVMEM_LOOK_AHEAD_PAGE, bitRHS);
            bitRHS->inUse = 0;
          }
        es4s1:;
        } // End of DO block
      // COREWORD(ADDR(VMEM_PAGE)) = VMEM_PAD_ADDR(CUR_NDX); (994)
      {
        int32_t numberRHS = (int32_t)(getFIXED (
            mVMEM_PAD_ADDR + 4 * COREHALFWORD (mPTR_LOCATExCUR_NDX)));
        COREWORD2 (ADDR ("PTR_LOCATExVMEM_PAGE", 0x80000000, NULL, 0),
                   numberRHS);
      }
      // FILE(VMEM_FILE#,PAGE_TMP) = VMEM_PAGE; (995)
      {
        lFILE (6, COREHALFWORD (mPTR_LOCATExPAGE_TMP),
               ADDR ("PTR_LOCATExVMEM_PAGE", 0, NULL, 0));
      }
      // VMEM_WRITE_CNT = VMEM_WRITE_CNT + 1; (996)
      {
        int32_t numberRHS = (int32_t)(xadd (getFIXED (mVMEM_WRITE_CNT), 1));
        putFIXED (mVMEM_WRITE_CNT, numberRHS);
      }
    es4:;
    } // End of DO block
  {
    reentryGuard = 0;
    return 0;
  }
}
