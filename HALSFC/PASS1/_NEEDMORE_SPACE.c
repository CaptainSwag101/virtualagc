/*
  File _NEEDMORE_SPACE.c generated by XCOM-I, 2024-08-08 04:31:11.
*/

#include "runtimeC.h"

int32_t
_NEEDMORE_SPACE (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "_NEEDMORE_SPACE");
  // CALL _CHECK_FOR_THEFT; (622)
  _CHECK_FOR_THEFT (0);
  // IF _IS_REC_CONSTANT(DOPE) THEN (623)
  if (1
      & (xNEQ (xAND (COREWORD (xadd (getFIXED (m_NEEDMORE_SPACExDOPE), 20)),
                     50331648),
               0)))
    // CALL _SPMANERR( 'TRIED TO INCREASE CONSTANT RECORD, DOPE='||DOPE); (624)
    {
      putCHARACTERp (
          m_SPMANERRxMSG,
          xsCAT (
              cToDescriptor (NULL, "TRIED TO INCREASE CONSTANT RECORD, DOPE="),
              fixedToCharacter (getFIXED (m_NEEDMORE_SPACExDOPE))));
      _SPMANERR (0);
    }
  // IF _DOPE_ALLOC(DOPE)=0 THEN (625)
  if (1 & (xEQ (COREWORD (xadd (getFIXED (m_NEEDMORE_SPACExDOPE), 8)), 0)))
    // CALL _ALLOCATE_SPACE(DOPE,-1 _IFA(NAME)); (626)
    {
      putFIXED (m_ALLOCATE_SPACExDOPE, getFIXED (m_NEEDMORE_SPACExDOPE));
      putFIXED (m_ALLOCATE_SPACExHIREC, -1);
      _ALLOCATE_SPACE (0);
    }
  // ELSE (627)
  else
    // CALL _INCREASE_RECORD(DOPE,_HOW_MUCH(DOPE,0)); (628)
    {
      putFIXED (m_INCREASE_RECORDxDOPE, getFIXED (m_NEEDMORE_SPACExDOPE));
      putFIXED (m_INCREASE_RECORDxNRECSMORE,
                (putFIXED (m_HOW_MUCHxDOPE, getFIXED (m_NEEDMORE_SPACExDOPE)),
                 putFIXED (m_HOW_MUCHxANS, 0), _HOW_MUCH (0)));
      _INCREASE_RECORD (0);
    }
  {
    reentryGuard = 0;
    return 0;
  }
}
