/*
  File CHECK_TOKEN.c generated by XCOM-I, 2024-08-09 12:38:15.
*/

#include "runtimeC.h"

int32_t
CHECK_TOKEN (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "CHECK_TOKEN");
  // K=SP-1; (13914)
  {
    int32_t numberRHS = (int32_t)(xsubtract (getFIXED (mSP), 1));
    putFIXED (mK, numberRHS);
  }
  // DO WHILE NSTATE>0; (13915)
  while (1 & (xGT (COREHALFWORD (mCHECK_TOKENxNSTATE), 0)))
    {
      // IF NSTATE<=MAXR# THEN (13916)
      if (1 & (xLE (COREHALFWORD (mCHECK_TOKENxNSTATE), 441)))
        // DO; (13917)
        {
        rs1s1:;
          // I=INDEX1(NSTATE); (13918)
          {
            descriptor_t *bitRHS = getBIT (
                16, mINDEX1 + 2 * COREHALFWORD (mCHECK_TOKENxNSTATE));
            int32_t numberRHS;
            numberRHS = bitToFixed (bitRHS);
            putFIXED (mI, numberRHS);
            bitRHS->inUse = 0;
          }
          // DO I=I TO I+INDEX2(NSTATE)-1; (13919)
          {
            int32_t from175, to175, by175;
            from175 = getFIXED (mI);
            to175 = xsubtract (
                xadd (getFIXED (mI),
                      COREHALFWORD (mINDEX2
                                    + 2 * COREHALFWORD (mCHECK_TOKENxNSTATE))),
                1);
            by175 = 1;
            for (putFIXED (mI, from175); getFIXED (mI) <= to175;
                 putFIXED (mI, getFIXED (mI) + by175))
              {
                // IF READ1(I)=NTOKEN THEN (13920)
                if (1
                    & (xEQ (BYTE0 (mREAD1 + 1 * getFIXED (mI)),
                            COREHALFWORD (mCHECK_TOKENxNTOKEN))))
                  // DO; (13921)
                  {
                  rs1s1s1s1:;
                    // IF NLOOK>=0 THEN (13922)
                    if (1 & (xGE (COREHALFWORD (mCHECK_TOKENxNLOOK), 0)))
                      // RETURN NSTATE; (13923)
                      {
                        reentryGuard = 0;
                        return COREHALFWORD (mCHECK_TOKENxNSTATE);
                      }
                    // ELSE (13924)
                    else
                      // RETURN -NLOOK; (13925)
                      {
                        reentryGuard = 0;
                        return xminus (COREHALFWORD (mCHECK_TOKENxNLOOK));
                      }
                  es1s1s1s1:;
                  } // End of DO block
              }
          } // End of DO for-loop block
          // IF NLOOK<=0 THEN (13926)
          if (1 & (xLE (COREHALFWORD (mCHECK_TOKENxNLOOK), 0)))
            // RETURN 0; (13927)
            {
              reentryGuard = 0;
              return 0;
            }
          // NSTATE=NLOOK; (13928)
          {
            descriptor_t *bitRHS = getBIT (16, mCHECK_TOKENxNLOOK);
            putBIT (16, mCHECK_TOKENxNSTATE, bitRHS);
            bitRHS->inUse = 0;
          }
          // NLOOK=-NSTATE; (13929)
          {
            int32_t numberRHS
                = (int32_t)(xminus (COREHALFWORD (mCHECK_TOKENxNSTATE)));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mCHECK_TOKENxNLOOK, bitRHS);
            bitRHS->inUse = 0;
          }
        es1s1:;
        } // End of DO block
      // ELSE (13930)
      else
        // IF NSTATE>MAXP# THEN (13931)
        if (1 & (xGT (COREHALFWORD (mCHECK_TOKENxNSTATE), 810)))
          // DO; (13932)
          {
          rs1s2:;
            // I=INDEX1(NSTATE); (13933)
            {
              descriptor_t *bitRHS = getBIT (
                  16, mINDEX1 + 2 * COREHALFWORD (mCHECK_TOKENxNSTATE));
              int32_t numberRHS;
              numberRHS = bitToFixed (bitRHS);
              putFIXED (mI, numberRHS);
              bitRHS->inUse = 0;
            }
            // K=K-INDEX2(NSTATE); (13934)
            {
              int32_t numberRHS = (int32_t)(xsubtract (
                  getFIXED (mK),
                  COREHALFWORD (mINDEX2
                                + 2 * COREHALFWORD (mCHECK_TOKENxNSTATE))));
              putFIXED (mK, numberRHS);
            }
            // J=STATE_STACK(K); (13935)
            {
              int32_t numberRHS
                  = (int32_t)(getFIXED (mSTATE_STACK + 4 * getFIXED (mK)));
              putFIXED (mJ, numberRHS);
            }
            // DO WHILE J~=APPLY1(I); (13936)
            while (1
                   & (xNEQ (getFIXED (mJ),
                            COREHALFWORD (mAPPLY1 + 2 * getFIXED (mI)))))
              {
                // IF APPLY1(I)=0 THEN (13937)
                if (1 & (xEQ (COREHALFWORD (mAPPLY1 + 2 * getFIXED (mI)), 0)))
                  // J=0; (13938)
                  {
                    int32_t numberRHS = (int32_t)(0);
                    putFIXED (mJ, numberRHS);
                  }
                // ELSE (13939)
                else
                  // I=I+1; (13940)
                  {
                    int32_t numberRHS = (int32_t)(xadd (getFIXED (mI), 1));
                    putFIXED (mI, numberRHS);
                  }
              } // End of DO WHILE block
            // NSTATE=APPLY2(I); (13941)
            {
              descriptor_t *bitRHS = getBIT (16, mAPPLY2 + 2 * getFIXED (mI));
              putBIT (16, mCHECK_TOKENxNSTATE, bitRHS);
              bitRHS->inUse = 0;
            }
          es1s2:;
          } // End of DO block
        // ELSE (13942)
        else
          // IF NSTATE<=MAXL# THEN (13943)
          if (1 & (xLE (COREHALFWORD (mCHECK_TOKENxNSTATE), 666)))
            // DO; (13944)
            {
            rs1s3:;
              // I=INDEX1(NSTATE); (13945)
              {
                descriptor_t *bitRHS = getBIT (
                    16, mINDEX1 + 2 * COREHALFWORD (mCHECK_TOKENxNSTATE));
                int32_t numberRHS;
                numberRHS = bitToFixed (bitRHS);
                putFIXED (mI, numberRHS);
                bitRHS->inUse = 0;
              }
              // J=NTOKEN; (13946)
              {
                descriptor_t *bitRHS = getBIT (16, mCHECK_TOKENxNTOKEN);
                int32_t numberRHS;
                numberRHS = bitToFixed (bitRHS);
                putFIXED (mJ, numberRHS);
                bitRHS->inUse = 0;
              }
              // DO WHILE LOOK1(I)~=J; (13947)
              while (
                  1
                  & (xNEQ (BYTE0 (mLOOK1 + 1 * getFIXED (mI)), getFIXED (mJ))))
                {
                  // IF LOOK1(I)=0 THEN (13948)
                  if (1 & (xEQ (BYTE0 (mLOOK1 + 1 * getFIXED (mI)), 0)))
                    // J=0; (13949)
                    {
                      int32_t numberRHS = (int32_t)(0);
                      putFIXED (mJ, numberRHS);
                    }
                  // ELSE (13950)
                  else
                    // I=I+1; (13951)
                    {
                      int32_t numberRHS = (int32_t)(xadd (getFIXED (mI), 1));
                      putFIXED (mI, numberRHS);
                    }
                } // End of DO WHILE block
              // NSTATE=LOOK2(I); (13952)
              {
                descriptor_t *bitRHS = getBIT (16, mLOOK2 + 2 * getFIXED (mI));
                putBIT (16, mCHECK_TOKENxNSTATE, bitRHS);
                bitRHS->inUse = 0;
              }
            es1s3:;
            } // End of DO block
          // ELSE (13953)
          else
            // NSTATE=0; (13954)
            {
              int32_t numberRHS = (int32_t)(0);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mCHECK_TOKENxNSTATE, bitRHS);
              bitRHS->inUse = 0;
            }
    } // End of DO WHILE block
  // RETURN 0; (13955)
  {
    reentryGuard = 0;
    return 0;
  }
}
