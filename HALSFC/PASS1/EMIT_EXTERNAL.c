/*
  File EMIT_EXTERNAL.c generated by XCOM-I, 2024-08-09 12:38:15.
*/

#include "runtimeC.h"

int32_t
EMIT_EXTERNAL (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "EMIT_EXTERNAL");
  // DO CASE EXTERNALIZE; (6874)
  {
  rs1:
    switch (COREHALFWORD (mEXTERNALIZE))
      {
      case 0:
          // ; (6876)
          ;
        break;
      case 1:
        // DO; (6877)
        {
        rs1s1:;
          // IF TOKEN = REPLACE_TEXT THEN (6877)
          if (1 & (xEQ (getFIXED (mTOKEN), getFIXED (mREPLACE_TEXT))))
            // DO; (6878)
            {
            rs1s1s1:;
              // CALL ADD_CHAR(BYTE('"')); (6879)
              {
                putBITp (16, mEMIT_EXTERNALxADD_CHARxVAL,
                         fixedToBit (32, (int32_t)(BYTE1 (
                                             cToDescriptor (NULL, "\"")))));
                EMIT_EXTERNALxADD_CHAR (0);
              }
              // I = START_POINT; (6880)
              {
                int32_t numberRHS = (int32_t)(getFIXED (mSTART_POINT));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (16, mEMIT_EXTERNALxI, bitRHS);
                bitRHS->inUse = 0;
              }
              // J = MACRO_TEXT(I); (6881)
              {
                descriptor_t *bitRHS
                    = getBIT (8, getFIXED (mMACRO_TEXTS)
                                     + 1 * (COREHALFWORD (mEMIT_EXTERNALxI))
                                     + 0 + 1 * (0));
                putBIT (16, mEMIT_EXTERNALxJ, bitRHS);
                bitRHS->inUse = 0;
              }
              // DO WHILE J ~=  239; (6882)
              while (1 & (xNEQ (COREHALFWORD (mEMIT_EXTERNALxJ), 239)))
                {
                  // IF J = BYTE('"') THEN (6883)
                  if (1
                      & (xEQ (COREHALFWORD (mEMIT_EXTERNALxJ),
                              BYTE1 (cToDescriptor (NULL, "\"")))))
                    // DO; (6884)
                    {
                    rs1s1s1s1s1:;
                      // CALL ADD_CHAR(BYTE('"')); (6885)
                      {
                        putBITp (
                            16, mEMIT_EXTERNALxADD_CHARxVAL,
                            fixedToBit (32, (int32_t)(BYTE1 (
                                                cToDescriptor (NULL, "\"")))));
                        EMIT_EXTERNALxADD_CHAR (0);
                      }
                      // CALL ADD_CHAR(BYTE('"')); (6886)
                      {
                        putBITp (
                            16, mEMIT_EXTERNALxADD_CHARxVAL,
                            fixedToBit (32, (int32_t)(BYTE1 (
                                                cToDescriptor (NULL, "\"")))));
                        EMIT_EXTERNALxADD_CHAR (0);
                      }
                    es1s1s1s1s1:;
                    } // End of DO block
                  // ELSE (6887)
                  else
                    // IF J =  238 THEN (6888)
                    if (1 & (xEQ (COREHALFWORD (mEMIT_EXTERNALxJ), 238)))
                      // DO; (6889)
                      {
                      rs1s1s1s1s2:;
                        // DO J = 1 TO MACRO_TEXT(I+1) + (MACRO_TEXT(I+1)~=0);
                        // (6890)
                        {
                          int32_t from108, to108, by108;
                          from108 = 1;
                          to108 = xadd (
                              BYTE0 (getFIXED (mMACRO_TEXTS)
                                     + 1
                                           * (xadd (
                                               COREHALFWORD (mEMIT_EXTERNALxI),
                                               1))
                                     + 0 + 1 * (0)),
                              xNEQ (
                                  BYTE0 (getFIXED (mMACRO_TEXTS)
                                         + 1
                                               * (xadd (COREHALFWORD (
                                                            mEMIT_EXTERNALxI),
                                                        1))
                                         + 0 + 1 * (0)),
                                  0));
                          by108 = 1;
                          for (putBIT (16, mEMIT_EXTERNALxJ,
                                       fixedToBit (16, from108));
                               bitToFixed (getBIT (16, mEMIT_EXTERNALxJ))
                               <= to108;
                               putBIT (
                                   16, mEMIT_EXTERNALxJ,
                                   fixedToBit (16, bitToFixed (getBIT (
                                                       16, mEMIT_EXTERNALxJ))
                                                       + by108)))
                            {
                              // CALL ADD_CHAR(BYTE(X1)); (6891)
                              {
                                putBITp (
                                    16, mEMIT_EXTERNALxADD_CHARxVAL,
                                    fixedToBit (32, (int32_t)(BYTE1 (
                                                        getCHARACTER (mX1)))));
                                EMIT_EXTERNALxADD_CHAR (0);
                              }
                            }
                        } // End of DO for-loop block
                        // I = I + 1; (6892)
                        {
                          int32_t numberRHS = (int32_t)(xadd (
                              COREHALFWORD (mEMIT_EXTERNALxI), 1));
                          descriptor_t *bitRHS;
                          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                          putBIT (16, mEMIT_EXTERNALxI, bitRHS);
                          bitRHS->inUse = 0;
                        }
                      es1s1s1s1s2:;
                      } // End of DO block
                    // ELSE (6893)
                    else
                      // CALL ADD_CHAR(J); (6894)
                      {
                        putBITp (16, mEMIT_EXTERNALxADD_CHARxVAL,
                                 getBIT (16, mEMIT_EXTERNALxJ));
                        EMIT_EXTERNALxADD_CHAR (0);
                      }
                  // I = I + 1; (6895)
                  {
                    int32_t numberRHS
                        = (int32_t)(xadd (COREHALFWORD (mEMIT_EXTERNALxI), 1));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mEMIT_EXTERNALxI, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // J = MACRO_TEXT(I); (6896)
                  {
                    descriptor_t *bitRHS = getBIT (
                        8, getFIXED (mMACRO_TEXTS)
                               + 1 * (COREHALFWORD (mEMIT_EXTERNALxI)) + 0
                               + 1 * (0));
                    putBIT (16, mEMIT_EXTERNALxJ, bitRHS);
                    bitRHS->inUse = 0;
                  }
                } // End of DO WHILE block
              // CALL ADD_CHAR(BYTE('"')); (6897)
              {
                putBITp (16, mEMIT_EXTERNALxADD_CHARxVAL,
                         fixedToBit (32, (int32_t)(BYTE1 (
                                             cToDescriptor (NULL, "\"")))));
                EMIT_EXTERNALxADD_CHAR (0);
              }
            es1s1s1:;
            } // End of DO block
          // ELSE (6898)
          else
            // IF RESERVED_WORD THEN (6899)
            if (1 & (bitToFixed (getBIT (1, mRESERVED_WORD))))
              // DO; (6900)
              {
              rs1s1s2:;
                // CHAR = STRING(VOCAB_INDEX(TOKEN)); (6901)
                {
                  descriptor_t *stringRHS;
                  stringRHS
                      = getCHARACTER (mVOCAB_INDEX + 4 * getFIXED (mTOKEN));
                  putCHARACTER (mEMIT_EXTERNALxCHAR, stringRHS);
                  stringRHS->inUse = 0;
                }
                // DO I = 0 TO LENGTH(CHAR) - 1; (6902)
                {
                  int32_t from109, to109, by109;
                  from109 = 0;
                  to109 = xsubtract (
                      LENGTH (getCHARACTER (mEMIT_EXTERNALxCHAR)), 1);
                  by109 = 1;
                  for (putBIT (16, mEMIT_EXTERNALxI, fixedToBit (16, from109));
                       bitToFixed (getBIT (16, mEMIT_EXTERNALxI)) <= to109;
                       putBIT (16, mEMIT_EXTERNALxI,
                               fixedToBit (16, bitToFixed (getBIT (
                                                   16, mEMIT_EXTERNALxI))
                                                   + by109)))
                    {
                      // CALL ADD_CHAR(BYTE(CHAR, I)); (6903)
                      {
                        putBITp (
                            16, mEMIT_EXTERNALxADD_CHARxVAL,
                            fixedToBit (
                                32, (int32_t)(BYTE (
                                        getCHARACTER (mEMIT_EXTERNALxCHAR),
                                        COREHALFWORD (mEMIT_EXTERNALxI)))));
                        EMIT_EXTERNALxADD_CHAR (0);
                      }
                    }
                } // End of DO for-loop block
              es1s1s2:;
              } // End of DO block
            // ELSE (6904)
            else
              // IF TOKEN = CHARACTER_STRING THEN (6905)
              if (1 & (xEQ (getFIXED (mTOKEN), getFIXED (mCHARACTER_STRING))))
                // DO; (6906)
                {
                rs1s1s3:;
                  // CALL ADD_CHAR(BYTE(SQUOTE)); (6907)
                  {
                    putBITp (16, mEMIT_EXTERNALxADD_CHARxVAL,
                             fixedToBit (32, (int32_t)(BYTE1 (
                                                 getCHARACTER (mSQUOTE)))));
                    EMIT_EXTERNALxADD_CHAR (0);
                  }
                  // I = 0; (6908)
                  {
                    int32_t numberRHS = (int32_t)(0);
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mEMIT_EXTERNALxI, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // J = BYTE(BCD, I); (6909)
                  {
                    int32_t numberRHS = (int32_t)(BYTE (
                        getCHARACTER (mBCD), COREHALFWORD (mEMIT_EXTERNALxI)));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mEMIT_EXTERNALxJ, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // DO WHILE (J ~= BYTE(SQUOTE)) & (I < LENGTH(BCD)); (6910)
                  while (1
                         & (xAND (xNEQ (COREHALFWORD (mEMIT_EXTERNALxJ),
                                        BYTE1 (getCHARACTER (mSQUOTE))),
                                  xLT (COREHALFWORD (mEMIT_EXTERNALxI),
                                       LENGTH (getCHARACTER (mBCD))))))
                    {
                      // IF (TRANS_OUT(J) &  255) ~= 0 THEN (6911)
                      if (1
                          & (xNEQ (
                              xAND (COREHALFWORD (
                                        mTRANS_OUT
                                        + 2 * COREHALFWORD (mEMIT_EXTERNALxJ)),
                                    255),
                              0)))
                        // DO; (6912)
                        {
                        rs1s1s3s1s1:;
                          // DO K = 0 TO SHR(TRANS_OUT(J), 8) &  255; (6913)
                          {
                            int32_t from110, to110, by110;
                            from110 = 0;
                            to110 = xAND (
                                SHR (
                                    COREHALFWORD (
                                        mTRANS_OUT
                                        + 2 * COREHALFWORD (mEMIT_EXTERNALxJ)),
                                    8),
                                255);
                            by110 = 1;
                            for (putBIT (16, mEMIT_EXTERNALxK,
                                         fixedToBit (16, from110));
                                 bitToFixed (getBIT (16, mEMIT_EXTERNALxK))
                                 <= to110;
                                 putBIT (
                                     16, mEMIT_EXTERNALxK,
                                     fixedToBit (16, bitToFixed (getBIT (
                                                         16, mEMIT_EXTERNALxK))
                                                         + by110)))
                              {
                                // CALL ADD_CHAR(ESCP); (6914)
                                {
                                  putBITp (16, mEMIT_EXTERNALxADD_CHARxVAL,
                                           getBIT (8, mESCP));
                                  EMIT_EXTERNALxADD_CHAR (0);
                                }
                              }
                          } // End of DO for-loop block
                          // CALL ADD_CHAR(TRANS_OUT(J) &  255); (6915)
                          {
                            putBITp (
                                16, mEMIT_EXTERNALxADD_CHARxVAL,
                                fixedToBit (
                                    32, (int32_t)(xAND (
                                            COREHALFWORD (
                                                mTRANS_OUT
                                                + 2
                                                      * COREHALFWORD (
                                                          mEMIT_EXTERNALxJ)),
                                            255))));
                            EMIT_EXTERNALxADD_CHAR (0);
                          }
                        es1s1s3s1s1:;
                        } // End of DO block
                      // ELSE (6916)
                      else
                        // CALL ADD_CHAR(J); (6917)
                        {
                          putBITp (16, mEMIT_EXTERNALxADD_CHARxVAL,
                                   getBIT (16, mEMIT_EXTERNALxJ));
                          EMIT_EXTERNALxADD_CHAR (0);
                        }
                    // INCR_PTR: (6918)
                    INCR_PTR:
                      // I = I + 1; (6919)
                      {
                        int32_t numberRHS = (int32_t)(xadd (
                            COREHALFWORD (mEMIT_EXTERNALxI), 1));
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (16, mEMIT_EXTERNALxI, bitRHS);
                        bitRHS->inUse = 0;
                      }
                      // J = BYTE(BCD, I); (6920)
                      {
                        int32_t numberRHS = (int32_t)(BYTE (
                            getCHARACTER (mBCD),
                            COREHALFWORD (mEMIT_EXTERNALxI)));
                        descriptor_t *bitRHS;
                        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                        putBIT (16, mEMIT_EXTERNALxJ, bitRHS);
                        bitRHS->inUse = 0;
                      }
                    } // End of DO WHILE block
                  // CALL ADD_CHAR(BYTE(SQUOTE)); (6921)
                  {
                    putBITp (16, mEMIT_EXTERNALxADD_CHARxVAL,
                             fixedToBit (32, (int32_t)(BYTE1 (
                                                 getCHARACTER (mSQUOTE)))));
                    EMIT_EXTERNALxADD_CHAR (0);
                  }
                  // IF I ~= LENGTH(BCD) THEN (6922)
                  if (1
                      & (xNEQ (COREHALFWORD (mEMIT_EXTERNALxI),
                               LENGTH (getCHARACTER (mBCD)))))
                    // DO; (6923)
                    {
                    rs1s1s3s2:;
                      // CALL ADD_CHAR(BYTE(SQUOTE)); (6924)
                      {
                        putBITp (
                            16, mEMIT_EXTERNALxADD_CHARxVAL,
                            fixedToBit (32, (int32_t)(BYTE1 (
                                                getCHARACTER (mSQUOTE)))));
                        EMIT_EXTERNALxADD_CHAR (0);
                      }
                      // GO TO INCR_PTR; (6925)
                      goto INCR_PTR;
                    es1s1s3s2:;
                    } // End of DO block
                es1s1s3:;
                } // End of DO block
              // ELSE (6926)
              else
                // DO; (6927)
                {
                rs1s1s4:;
                  // DO I = 0 TO LENGTH(BCD) - 1; (6928)
                  {
                    int32_t from111, to111, by111;
                    from111 = 0;
                    to111 = xsubtract (LENGTH (getCHARACTER (mBCD)), 1);
                    by111 = 1;
                    for (putBIT (16, mEMIT_EXTERNALxI,
                                 fixedToBit (16, from111));
                         bitToFixed (getBIT (16, mEMIT_EXTERNALxI)) <= to111;
                         putBIT (16, mEMIT_EXTERNALxI,
                                 fixedToBit (16, bitToFixed (getBIT (
                                                     16, mEMIT_EXTERNALxI))
                                                     + by111)))
                      {
                        // CALL ADD_CHAR(BYTE(BCD, I)); (6929)
                        {
                          putBITp (
                              16, mEMIT_EXTERNALxADD_CHARxVAL,
                              fixedToBit (
                                  32, (int32_t)(BYTE (
                                          getCHARACTER (mBCD),
                                          COREHALFWORD (mEMIT_EXTERNALxI)))));
                          EMIT_EXTERNALxADD_CHAR (0);
                        }
                      }
                  } // End of DO for-loop block
                es1s1s4:;
                } // End of DO block
          // CALL ADD_CHAR(BYTE(X1)); (6930)
          {
            putBITp (16, mEMIT_EXTERNALxADD_CHARxVAL,
                     fixedToBit (32, (int32_t)(BYTE1 (getCHARACTER (mX1)))));
            EMIT_EXTERNALxADD_CHAR (0);
          }
        es1s1:;
        } // End of DO block
        break;
      case 2:
        // DO; (6932)
        {
        rs1s2:;
          // IF BINX>1 THEN (6932)
          if (1 & (xGT (COREHALFWORD (mEMIT_EXTERNALxBINX), 1)))
            // CALL EX_WRITE; (6933)
            EMIT_EXTERNALxEX_WRITE (0);
          // NEWBUFF=PAD(' CLOSE ;   ',TPL_LRECL); (6934)
          {
            descriptor_t *stringRHS;
            stringRHS
                = (putCHARACTERp (mPADxSTRING,
                                  cToDescriptor (NULL, " CLOSE ;   ")),
                   putFIXED (mPADxWIDTH, COREHALFWORD (mTPL_LRECL)), PAD (0));
            putCHARACTER (mEMIT_EXTERNALxNEWBUFF, stringRHS);
            stringRHS->inUse = 0;
          }
          // CALL EX_WRITE; (6935)
          EMIT_EXTERNALxEX_WRITE (0);
          // EXTERNALIZE=0; (6936)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mEXTERNALIZE, bitRHS);
            bitRHS->inUse = 0;
          }
          // IF TPL_FLAG=3 THEN (6937)
          if (1 & (xEQ (COREHALFWORD (mTPL_FLAG), 3)))
            // RETURN; (6938)
            {
              reentryGuard = 0;
              return 0;
            }
          // IF TPL_FLAG=0 THEN (6939)
          if (1 & (xEQ (COREHALFWORD (mTPL_FLAG), 0)))
            // J,BYTE(VERSION,10)= 1; (6940)
            {
              int32_t numberRHS = (int32_t)(1);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mEMIT_EXTERNALxJ, bitRHS);
              lBYTEb (ADDR (NULL, 0, "EMIT_EXTERNALxVERSION", 0), 10, 1);
              bitRHS->inUse = 0;
            }
          // ELSE (6941)
          else
            // DO; (6942)
            {
            rs1s2s1:;
              // DO WHILE LENGTH(OLDBUFF)>0; (6943)
              while (
                  1
                  & (xGT (LENGTH (getCHARACTER (mEMIT_EXTERNALxOLDBUFF)), 0)))
                {
                  // NEWBUFF=OLDBUFF; (6944)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = getCHARACTER (mEMIT_EXTERNALxOLDBUFF);
                    putCHARACTER (mEMIT_EXTERNALxNEWBUFF, stringRHS);
                    stringRHS->inUse = 0;
                  }
                  // OLDBUFF=INPUT(7); (6945)
                  {
                    descriptor_t *stringRHS;
                    stringRHS = INPUT (7);
                    putCHARACTER (mEMIT_EXTERNALxOLDBUFF, stringRHS);
                    stringRHS->inUse = 0;
                  }
                } // End of DO WHILE block
              // CALL MONITOR(3, 7); (6946)
              MONITOR3 (7);
              // IF SUBSTR(NEWBUFF,0,10)~=SUBSTR(VERSION,0,10) THEN (6947)
              if (1
                  & (xsNEQ (
                      SUBSTR (getCHARACTER (mEMIT_EXTERNALxNEWBUFF), 0, 10),
                      SUBSTR (getCHARACTER (mEMIT_EXTERNALxVERSION), 0, 10))))
                // DO; (6948)
                {
                rs1s2s1s2:;
                  // I,J= 1; (6949)
                  {
                    int32_t numberRHS = (int32_t)(1);
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mEMIT_EXTERNALxI, bitRHS);
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mEMIT_EXTERNALxJ, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // IF ~SDL_OPTION THEN (6950)
                  if (1 & (xNOT (BYTE0 (mSDL_OPTION))))
                    // CALL ERROR(CLASS_XV, 1, TPL_NAME); (6951)
                    {
                      putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_XV));
                      putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(1)));
                      putCHARACTERp (mERRORxTEXT, getCHARACTER (mTPL_NAME));
                      ERROR (0);
                    }
                es1s2s1s2:;
                } // End of DO block
              // ELSE (6952)
              else
                // DO; (6953)
                {
                rs1s2s1s3:;
                  // J=BYTE(NEWBUFF,10); (6954)
                  {
                    int32_t numberRHS = (int32_t)(BYTE (
                        getCHARACTER (mEMIT_EXTERNALxNEWBUFF), 10));
                    descriptor_t *bitRHS;
                    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                    putBIT (16, mEMIT_EXTERNALxJ, bitRHS);
                    bitRHS->inUse = 0;
                  }
                  // IF J= 255 THEN (6955)
                  if (1 & (xEQ (COREHALFWORD (mEMIT_EXTERNALxJ), 255)))
                    // I= 1; (6956)
                    {
                      int32_t numberRHS = (int32_t)(1);
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (16, mEMIT_EXTERNALxI, bitRHS);
                      bitRHS->inUse = 0;
                    }
                  // ELSE (6957)
                  else
                    // I=J+1; (6958)
                    {
                      int32_t numberRHS = (int32_t)(xadd (
                          COREHALFWORD (mEMIT_EXTERNALxJ), 1));
                      descriptor_t *bitRHS;
                      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                      putBIT (16, mEMIT_EXTERNALxI, bitRHS);
                      bitRHS->inUse = 0;
                    }
                  // IF TPL_FLAG=2 THEN (6959)
                  if (1 & (xEQ (COREHALFWORD (mTPL_FLAG), 2)))
                    // J=I; (6960)
                    {
                      descriptor_t *bitRHS = getBIT (16, mEMIT_EXTERNALxI);
                      putBIT (16, mEMIT_EXTERNALxJ, bitRHS);
                      bitRHS->inUse = 0;
                    }
                es1s2s1s3:;
                } // End of DO block
              // BYTE(VERSION,10)=I; (6961)
              {
                descriptor_t *bitRHS = getBIT (16, mEMIT_EXTERNALxI);
                lBYTEb (ADDR (NULL, 0, "EMIT_EXTERNALxVERSION", 0), 10,
                        COREHALFWORD (mEMIT_EXTERNALxI));
                bitRHS->inUse = 0;
              }
            es1s2s1:;
            } // End of DO block
          // SYT_LOCK#(BLOCK_SYTREF(1))=J; (6962)
          {
            descriptor_t *bitRHS = getBIT (16, mEMIT_EXTERNALxJ);
            putBIT (8,
                    getFIXED (mSYM_TAB)
                        + 34 * (COREHALFWORD (mBLOCK_SYTREF + 2 * 1)) + 31
                        + 1 * (0),
                    bitRHS);
            bitRHS->inUse = 0;
          }
          // OUTPUT(6) = VERSION || BYTE(VERSION, 10); (6963)
          {
            descriptor_t *stringRHS;
            stringRHS
                = xsCAT (getCHARACTER (mEMIT_EXTERNALxVERSION),
                         fixedToCharacter (BYTE (
                             getCHARACTER (mEMIT_EXTERNALxVERSION), 10)));
            OUTPUT (6, stringRHS);
            stringRHS->inUse = 0;
          }
        es1s2:;
        } // End of DO block
        break;
      case 3:
        // DO; (6965)
        {
        rs1s3:;
          // NEWBUFF=': EXTERNAL '||STRING(VOCAB_INDEX(PARSE_STACK(SP)))||X1;
          // (6965)
          {
            descriptor_t *stringRHS;
            stringRHS = xsCAT (
                xsCAT (cToDescriptor (NULL, ": EXTERNAL "),
                       getCHARACTER (
                           mVOCAB_INDEX
                           + 4
                                 * COREHALFWORD (mPARSE_STACK
                                                 + 2 * getFIXED (mSP)))),
                getCHARACTER (mX1));
            putCHARACTER (mEMIT_EXTERNALxNEWBUFF, stringRHS);
            stringRHS->inUse = 0;
          }
          // NEWBUFF=X1||VAR(MP)||NEWBUFF; (6966)
          {
            descriptor_t *stringRHS;
            stringRHS
                = xsCAT (xsCAT (getCHARACTER (mX1),
                                getCHARACTER (mVAR + 4 * getFIXED (mMP))),
                         getCHARACTER (mEMIT_EXTERNALxNEWBUFF));
            putCHARACTER (mEMIT_EXTERNALxNEWBUFF, stringRHS);
            stringRHS->inUse = 0;
          }
          // BINX=LENGTH(NEWBUFF); (6967)
          {
            int32_t numberRHS
                = (int32_t)(LENGTH (getCHARACTER (mEMIT_EXTERNALxNEWBUFF)));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mEMIT_EXTERNALxBINX, bitRHS);
            bitRHS->inUse = 0;
          }
          // NEWBUFF=PAD(NEWBUFF,TPL_LRECL); (6968)
          {
            descriptor_t *stringRHS;
            stringRHS
                = (putCHARACTERp (mPADxSTRING,
                                  getCHARACTER (mEMIT_EXTERNALxNEWBUFF)),
                   putFIXED (mPADxWIDTH, COREHALFWORD (mTPL_LRECL)), PAD (0));
            putCHARACTER (mEMIT_EXTERNALxNEWBUFF, stringRHS);
            stringRHS->inUse = 0;
          }
          // EXTERNALIZE=1; (6969)
          {
            int32_t numberRHS = (int32_t)(1);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mEXTERNALIZE, bitRHS);
            bitRHS->inUse = 0;
          }
          // TPL_NAME=DESCORE(VAR(MP)); (6970)
          {
            descriptor_t *stringRHS;
            stringRHS
                = (putCHARACTERp (mDESCORExCHAR,
                                  getCHARACTER (mVAR + 4 * getFIXED (mMP))),
                   DESCORE (0));
            putCHARACTER (mTPL_NAME, stringRHS);
            stringRHS->inUse = 0;
          }
          // TPL_FLAG = FINDER(7, TPL_NAME, 1) = 0; (6971)
          {
            int32_t numberRHS = (int32_t)(xEQ (
                bitToFixed ((
                    putBITp (16, mFINDERxFILENO,
                             fixedToBit (32, (int32_t)(7))),
                    putCHARACTERp (mFINDERxNAME, getCHARACTER (mTPL_NAME)),
                    putBITp (16, mFINDERxSTART, fixedToBit (32, (int32_t)(1))),
                    FINDER (0))),
                0));
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (16, mTPL_FLAG, bitRHS);
            bitRHS->inUse = 0;
          }
          // IF TPL_FLAG THEN (6972)
          if (1 & (bitToFixed (getBIT (16, mTPL_FLAG))))
            // OLDBUFF=INPUT(7); (6973)
            {
              descriptor_t *stringRHS;
              stringRHS = INPUT (7);
              putCHARACTER (mEMIT_EXTERNALxOLDBUFF, stringRHS);
              stringRHS->inUse = 0;
            }
        es1s3:;
        } // End of DO block
        break;
      case 4:
          // ; (6975)
          ;
        break;
      }
  } // End of DO CASE block
  {
    reentryGuard = 0;
    return 0;
  }
}
