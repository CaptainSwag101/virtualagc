/*
  File CHECK_ASSIGN_CONTEXT.c generated by XCOM-I, 2024-08-09 12:38:15.
*/

#include "runtimeC.h"

int32_t
CHECK_ASSIGN_CONTEXT (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "CHECK_ASSIGN_CONTEXT");
  // IF CONTEXT>0 THEN (7334)
  if (1 & (xGT (getFIXED (mCONTEXT), 0)))
    // DO; (7335)
    {
    rs1:;
      // CALL SET_XREF_RORS(LOC); (7336)
      {
        putFIXED (mSET_XREF_RORSxI, COREHALFWORD (mCHECK_ASSIGN_CONTEXTxLOC));
        SET_XREF_RORS (0);
      }
      // RETURN; (7337)
      {
        reentryGuard = 0;
        return 0;
      }
    es1:;
    } // End of DO block
  // T=VAL_P(PTR(LOC)); (7338)
  {
    descriptor_t *bitRHS = getBIT (
        16,
        mVAL_P
            + 2
                  * COREHALFWORD (
                      mPTR + 2 * COREHALFWORD (mCHECK_ASSIGN_CONTEXTxLOC)));
    putBIT (16, mCHECK_ASSIGN_CONTEXTxT, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF FIXV(LOC)~=0 THEN (7339)
  if (1
      & (xNEQ (getFIXED (mFIXV + 4 * COREHALFWORD (mCHECK_ASSIGN_CONTEXTxLOC)),
               0)))
    // FIX=FIXV(LOC); (7340)
    {
      int32_t numberRHS = (int32_t)(getFIXED (
          mFIXV + 4 * COREHALFWORD (mCHECK_ASSIGN_CONTEXTxLOC)));
      putFIXED (mCHECK_ASSIGN_CONTEXTxFIX, numberRHS);
    }
  // ELSE (7341)
  else
    // FIX = FIXL(LOC); (7342)
    {
      int32_t numberRHS = (int32_t)(getFIXED (
          mFIXL + 4 * COREHALFWORD (mCHECK_ASSIGN_CONTEXTxLOC)));
      putFIXED (mCHECK_ASSIGN_CONTEXTxFIX, numberRHS);
    }
  // IF (SYT_FLAGS(FIX) & INP_OR_CONST) ~= 0 THEN (7343)
  if (1
      & (xNEQ (xAND (getFIXED (getFIXED (mSYM_TAB)
                               + 34 * (getFIXED (mCHECK_ASSIGN_CONTEXTxFIX))
                               + 8 + 4 * (0)),
                     5120),
               0)))
    // CALL ERROR(CLASS_A,1,VAR(LOC)); (7344)
    {
      putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_A));
      putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(1)));
      putCHARACTERp (
          mERRORxTEXT,
          getCHARACTER (mVAR + 4 * COREHALFWORD (mCHECK_ASSIGN_CONTEXTxLOC)));
      ERROR (0);
    }
  // IF (SYT_FLAGS(FIX) & ACCESS_FLAG) ~= 0 THEN (7345)
  if (1
      & (xNEQ (xAND (getFIXED (getFIXED (mSYM_TAB)
                               + 34 * (getFIXED (mCHECK_ASSIGN_CONTEXTxFIX))
                               + 8 + 4 * (0)),
                     65536),
               0)))
    // CALL ERROR(CLASS_PS, 8, VAR(LOC)); (7346)
    {
      putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_PS));
      putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(8)));
      putCHARACTERp (
          mERRORxTEXT,
          getCHARACTER (mVAR + 4 * COREHALFWORD (mCHECK_ASSIGN_CONTEXTxLOC)));
      ERROR (0);
    }
  // IF SIMULATING THEN (7347)
  if (1 & (bitToFixed (getBIT (8, mSIMULATING))))
    // CALL STAB_VAR(LOC); (7348)
    {
      putBITp (16, mSTAB_VARxLOC, getBIT (16, mCHECK_ASSIGN_CONTEXTxLOC));
      STAB_VAR (0);
    }
  // CALL SET_XREF_RORS(LOC,0,XREF_ASSIGN); (7349)
  {
    putFIXED (mSET_XREF_RORSxI, COREHALFWORD (mCHECK_ASSIGN_CONTEXTxLOC));
    putFIXED (mSET_XREF_RORSxJ, 0);
    putFIXED (mSET_XREF_RORSxK, getFIXED (mXREF_ASSIGN));
    SET_XREF_RORS (0);
  }
  // IF SHR(T,5) THEN (7350)
  if (1 & (SHR (COREHALFWORD (mCHECK_ASSIGN_CONTEXTxT), 5)))
    // CALL HALMAT_FIX_PIPTAGS(INX(PTR(LOC)),0,1); (7351)
    {
      putFIXED (
          mHALMAT_FIX_PIPTAGSxPIP_LOC,
          COREHALFWORD (
              mINX
              + 2
                    * COREHALFWORD (
                        mPTR + 2 * COREHALFWORD (mCHECK_ASSIGN_CONTEXTxLOC))));
      putBITp (8, mHALMAT_FIX_PIPTAGSxTAG1, fixedToBit (32, (int32_t)(0)));
      putBITp (8, mHALMAT_FIX_PIPTAGSxTAG2, fixedToBit (32, (int32_t)(1)));
      HALMAT_FIX_PIPTAGS (0);
    }
  // IF SHR(T,6) THEN (7352)
  if (1 & (SHR (COREHALFWORD (mCHECK_ASSIGN_CONTEXTxT), 6)))
    // CALL ERROR(CLASS_SQ,3,VAR(LOC)); (7353)
    {
      putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_SQ));
      putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(3)));
      putCHARACTERp (
          mERRORxTEXT,
          getCHARACTER (mVAR + 4 * COREHALFWORD (mCHECK_ASSIGN_CONTEXTxLOC)));
      ERROR (0);
    }
  // IF DELAY_CONTEXT_CHECK THEN (7354)
  if (1 & (bitToFixed (getBIT (1, mDELAY_CONTEXT_CHECK))))
    // RETURN; (7355)
    {
      reentryGuard = 0;
      return 0;
    }
  // ARRAYNESS_FLAG=1; (7356)
  {
    int32_t numberRHS = (int32_t)(1);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mARRAYNESS_FLAG, bitRHS);
    bitRHS->inUse = 0;
  }
  {
    reentryGuard = 0;
    return 0;
  }
}
