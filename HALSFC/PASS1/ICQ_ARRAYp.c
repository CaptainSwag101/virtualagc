/*
  File ICQ_ARRAYp.c generated by XCOM-I, 2024-08-08 04:31:11.
*/

#include "runtimeC.h"

int32_t
ICQ_ARRAYp (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "ICQ_ARRAYp");
  // IF NAME_IMPLIED THEN (1311)
  if (1 & (bitToFixed (getBIT (1, mNAME_IMPLIED))))
    // RETURN 1; (1312)
    {
      reentryGuard = 0;
      return 1;
    }
  // I=1; (1313)
  {
    int32_t numberRHS = (int32_t)(1);
    putFIXED (mICQ_ARRAYpxI, numberRHS);
  }
  // IF SYT_ARRAY(LOC)~=0 THEN (1314)
  if (1
      & (xNEQ (COREHALFWORD (getFIXED (mSYM_TAB)
                             + 34 * (COREHALFWORD (mICQ_ARRAYpxLOC)) + 20
                             + 2 * (0)),
               0)))
    // DO LOC=SYT_ARRAY(LOC)+1 TO SYT_ARRAY(LOC)+EXT_ARRAY(SYT_ARRAY(LOC));
    // (1315)
    {
      int32_t from24, to24, by24;
      from24 = xadd (COREHALFWORD (getFIXED (mSYM_TAB)
                                   + 34 * (COREHALFWORD (mICQ_ARRAYpxLOC)) + 20
                                   + 2 * (0)),
                     1);
      to24 = xadd (
          COREHALFWORD (getFIXED (mSYM_TAB)
                        + 34 * (COREHALFWORD (mICQ_ARRAYpxLOC)) + 20
                        + 2 * (0)),
          COREHALFWORD (
              mEXT_ARRAY
              + 2
                    * COREHALFWORD (getFIXED (mSYM_TAB)
                                    + 34 * (COREHALFWORD (mICQ_ARRAYpxLOC))
                                    + 20 + 2 * (0))));
      by24 = 1;
      for (putBIT (16, mICQ_ARRAYpxLOC, fixedToBit (16, from24));
           bitToFixed (getBIT (16, mICQ_ARRAYpxLOC)) <= to24;
           putBIT (16, mICQ_ARRAYpxLOC,
                   fixedToBit (16, bitToFixed (getBIT (16, mICQ_ARRAYpxLOC))
                                       + by24)))
        {
          // I=EXT_ARRAY(LOC)*I; (1316)
          {
            int32_t numberRHS = (int32_t)(xmultiply (
                COREHALFWORD (mEXT_ARRAY + 2 * COREHALFWORD (mICQ_ARRAYpxLOC)),
                getFIXED (mICQ_ARRAYpxI)));
            putFIXED (mICQ_ARRAYpxI, numberRHS);
          }
        }
    } // End of DO for-loop block
  // RETURN I; (1317)
  {
    reentryGuard = 0;
    return getFIXED (mICQ_ARRAYpxI);
  }
}
