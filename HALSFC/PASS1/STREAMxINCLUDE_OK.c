/*
  File STREAMxINCLUDE_OK.c generated by XCOM-I, 2024-08-09 12:38:15.
*/

#include "runtimeC.h"

descriptor_t *
STREAMxINCLUDE_OK (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (descriptor_t *)0;
    }
  reentryGuard = guardReentry (reentryGuard, "STREAMxINCLUDE_OK");
  // IF INCLUDING THEN (4054)
  if (1 & (bitToFixed (getBIT (1, mINCLUDING))))
    // DO; (4055)
    {
    rs1:;
      // CALL ERROR(CLASS_XI,1); (4056)
      {
        putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_XI));
        putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(1)));
        ERROR (0);
      }
      // RETURN FALSE; (4057)
      {
        reentryGuard = 0;
        return fixedToBit (32, (int32_t)(0));
      }
    es1:;
    } // End of DO block
  // INCL_FLAGS = 0; (4058)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mSTREAMxINCLUDE_OKxINCL_FLAGS, bitRHS);
    bitRHS->inUse = 0;
  }
  // C = D_TOKEN; (4059)
  {
    descriptor_t *stringRHS;
    stringRHS = STREAMxD_TOKEN (0);
    putCHARACTER (mC, stringRHS);
    stringRHS->inUse = 0;
  }
  // TEMPLATE_FLAG, SDF_FLAG = FALSE; (4060)
  {
    int32_t numberRHS = (int32_t)(0);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (1, mSTREAMxTEMPLATE_FLAG, bitRHS);
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (1, mSTREAMxINCLUDE_OKxSDF_FLAG, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF C = 'TEMPLATE' THEN (4061)
  if (1 & (xsEQ (getCHARACTER (mC), cToDescriptor (NULL, "TEMPLATE"))))
    // DO; (4062)
    {
    rs2:;
      // SDF_FLAG, TEMPLATE_FLAG = TRUE; (4063)
      {
        int32_t numberRHS = (int32_t)(1);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (1, mSTREAMxINCLUDE_OKxSDF_FLAG, bitRHS);
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (1, mSTREAMxTEMPLATE_FLAG, bitRHS);
        bitRHS->inUse = 0;
      }
      // INCL_FLAGS = INCL_FLAGS | INCL_TEMPLATE_FLAG; (4064)
      {
        int32_t numberRHS
            = (int32_t)(xOR (BYTE0 (mSTREAMxINCLUDE_OKxINCL_FLAGS), 2));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (8, mSTREAMxINCLUDE_OKxINCL_FLAGS, bitRHS);
        bitRHS->inUse = 0;
      }
      // MEMBER = D_TOKEN; (4065)
      {
        descriptor_t *stringRHS;
        stringRHS = STREAMxD_TOKEN (0);
        putCHARACTER (mMEMBER, stringRHS);
        stringRHS->inUse = 0;
      }
    es2:;
    } // End of DO block
  // ELSE (4066)
  else
    // IF C = 'SDF' THEN (4067)
    if (1 & (xsEQ (getCHARACTER (mC), cToDescriptor (NULL, "SDF"))))
      // DO; (4068)
      {
      rs3:;
        // SDF_FLAG = TRUE; (4069)
        {
          int32_t numberRHS = (int32_t)(1);
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (1, mSTREAMxINCLUDE_OKxSDF_FLAG, bitRHS);
          bitRHS->inUse = 0;
        }
        // MEMBER = D_TOKEN; (4070)
        {
          descriptor_t *stringRHS;
          stringRHS = STREAMxD_TOKEN (0);
          putCHARACTER (mMEMBER, stringRHS);
          stringRHS->inUse = 0;
        }
      es3:;
      } // End of DO block
    // ELSE (4071)
    else
      // MEMBER = C; (4072)
      {
        descriptor_t *stringRHS;
        stringRHS = getCHARACTER (mC);
        putCHARACTER (mMEMBER, stringRHS);
        stringRHS->inUse = 0;
      }
  // IF LENGTH(MEMBER) = 0 THEN (4073)
  if (1 & (xEQ (LENGTH (getCHARACTER (mMEMBER)), 0)))
    // DO; (4074)
    {
    rs4:;
      // CALL ERROR(CLASS_XI,2); (4075)
      {
        putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_XI));
        putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(2)));
        ERROR (0);
      }
      // RETURN FALSE; (4076)
      {
        reentryGuard = 0;
        return fixedToBit (32, (int32_t)(0));
      }
    es4:;
    } // End of DO block
  // C = D_TOKEN; (4077)
  {
    descriptor_t *stringRHS;
    stringRHS = STREAMxD_TOKEN (0);
    putCHARACTER (mC, stringRHS);
    stringRHS->inUse = 0;
  }
  // LIST_FLAG = TRUE; (4078)
  {
    int32_t numberRHS = (int32_t)(1);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (1, mSTREAMxINCLUDE_OKxLIST_FLAG, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO FOREVER; (4079)
  while (1 & (1))
    {
      // IF C = 'NOLIST' THEN (4080)
      if (1 & (xsEQ (getCHARACTER (mC), cToDescriptor (NULL, "NOLIST"))))
        // LIST_FLAG = FALSE; (4081)
        {
          int32_t numberRHS = (int32_t)(0);
          descriptor_t *bitRHS;
          bitRHS = fixedToBit (32, (int32_t)(numberRHS));
          putBIT (1, mSTREAMxINCLUDE_OKxLIST_FLAG, bitRHS);
          bitRHS->inUse = 0;
        }
      // ELSE (4082)
      else
        // IF (C = 'NOSDF') & TEMPLATE_FLAG THEN (4083)
        if (1
            & (xAND (xsEQ (getCHARACTER (mC), cToDescriptor (NULL, "NOSDF")),
                     BYTE0 (mSTREAMxTEMPLATE_FLAG))))
          // SDF_FLAG = FALSE; (4084)
          {
            int32_t numberRHS = (int32_t)(0);
            descriptor_t *bitRHS;
            bitRHS = fixedToBit (32, (int32_t)(numberRHS));
            putBIT (1, mSTREAMxINCLUDE_OKxSDF_FLAG, bitRHS);
            bitRHS->inUse = 0;
          }
        // ELSE (4085)
        else
          // IF C = 'REMOTE' THEN (4086)
          if (1 & (xsEQ (getCHARACTER (mC), cToDescriptor (NULL, "REMOTE"))))
            // DO; (4087)
            {
            rs5s1:;
              // INCL_FLAGS = INCL_FLAGS | INCL_REMOTE_FLAG; (4088)
              {
                int32_t numberRHS = (int32_t)(xOR (
                    BYTE0 (mSTREAMxINCLUDE_OKxINCL_FLAGS), 1));
                descriptor_t *bitRHS;
                bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                putBIT (8, mSTREAMxINCLUDE_OKxINCL_FLAGS, bitRHS);
                bitRHS->inUse = 0;
              }
              // IF TEMPLATE_FLAG THEN (4089)
              if (1 & (bitToFixed (getBIT (1, mSTREAMxTEMPLATE_FLAG))))
                // TPL_REMOTE = TRUE; (4090)
                {
                  int32_t numberRHS = (int32_t)(1);
                  descriptor_t *bitRHS;
                  bitRHS = fixedToBit (32, (int32_t)(numberRHS));
                  putBIT (1, mTPL_REMOTE, bitRHS);
                  bitRHS->inUse = 0;
                }
              // ELSE (4091)
              else
                // IF ~SDF_FLAG THEN (4092)
                if (1 & (xNOT (BYTE0 (mSTREAMxINCLUDE_OKxSDF_FLAG))))
                  // CALL ERROR(CLASS_XI, 4); (4093)
                  {
                    putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_XI));
                    putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(4)));
                    ERROR (0);
                  }
            es5s1:;
            } // End of DO block
          // ELSE (4094)
          else
            // ESCAPE; (4095)
            break;
      // C = D_TOKEN; (4096)
      {
        descriptor_t *stringRHS;
        stringRHS = STREAMxD_TOKEN (0);
        putCHARACTER (mC, stringRHS);
        stringRHS->inUse = 0;
      }
    } // End of DO WHILE block
  // IF (TEMPLATE_FLAG | SDF_FLAG) & CREATING THEN (4097)
  if (1
      & (xAND (xOR (BYTE0 (mSTREAMxTEMPLATE_FLAG),
                    BYTE0 (mSTREAMxINCLUDE_OKxSDF_FLAG)),
               BYTE0 (mSTREAMxCREATING))))
    // DO; (4098)
    {
    rs6:;
      // CALL ERROR(CLASS_XI, 12); (4099)
      {
        putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_XI));
        putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(12)));
        ERROR (0);
      }
      // RETURN FALSE; (4100)
      {
        reentryGuard = 0;
        return fixedToBit (32, (int32_t)(0));
      }
    es6:;
    } // End of DO block
  // IF SDF_FLAG THEN (4101)
  if (1 & (bitToFixed (getBIT (1, mSTREAMxINCLUDE_OKxSDF_FLAG))))
    // DO; (4102)
    {
    rs7:;
      // IF ~TEMPLATE_FLAG THEN (4103)
      if (1 & (xNOT (BYTE0 (mSTREAMxTEMPLATE_FLAG))))
        // RETURN FALSE; (4104)
        {
          reentryGuard = 0;
          return fixedToBit (32, (int32_t)(0));
        }
    es7:;
    } // End of DO block
  // IF TEMPLATE_FLAG THEN (4105)
  if (1 & (bitToFixed (getBIT (1, mSTREAMxTEMPLATE_FLAG))))
    // MEMBER = DESCORE(MEMBER); (4106)
    {
      descriptor_t *stringRHS;
      stringRHS = (putCHARACTERp (mDESCORExCHAR, getCHARACTER (mMEMBER)),
                   DESCORE (0));
      putCHARACTER (mMEMBER, stringRHS);
      stringRHS->inUse = 0;
    }
  // ELSE (4107)
  else
    // IF LENGTH(MEMBER) < 8 THEN (4108)
    if (1 & (xLT (LENGTH (getCHARACTER (mMEMBER)), 8)))
      // MEMBER = PAD(MEMBER, 8); (4109)
      {
        descriptor_t *stringRHS;
        stringRHS = (putCHARACTERp (mPADxSTRING, getCHARACTER (mMEMBER)),
                     putFIXED (mPADxWIDTH, 8), PAD (0));
        putCHARACTER (mMEMBER, stringRHS);
        stringRHS->inUse = 0;
      }
    // ELSE (4110)
    else
      // MEMBER = SUBSTR(MEMBER, 0, 8); (4111)
      {
        descriptor_t *stringRHS;
        stringRHS = SUBSTR (getCHARACTER (mMEMBER), 0, 8);
        putCHARACTER (mMEMBER, stringRHS);
        stringRHS->inUse = 0;
      }
  // IF FINDER(4, MEMBER, 0) THEN (4112)
  if (1
      & (bitToFixed (
          (putBITp (16, mFINDERxFILENO, fixedToBit (32, (int32_t)(4))),
           putCHARACTERp (mFINDERxNAME, getCHARACTER (mMEMBER)),
           putBITp (16, mFINDERxSTART, fixedToBit (32, (int32_t)(0))),
           FINDER (0)))))
    // DO; (4113)
    {
    rs8:;
      // CALL ERROR(CLASS_XI,3,MEMBER); (4114)
      {
        putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_XI));
        putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(3)));
        putCHARACTERp (mERRORxTEXT, getCHARACTER (mMEMBER));
        ERROR (0);
      }
      // RETURN FALSE; (4115)
      {
        reentryGuard = 0;
        return fixedToBit (32, (int32_t)(0));
      }
    es8:;
    } // End of DO block
  // IF TEMPLATE_FLAG THEN (4116)
  if (1 & (bitToFixed (getBIT (1, mSTREAMxTEMPLATE_FLAG))))
    // DO; (4117)
    {
    rs9:;
      // COMPARE_SOURCE=FALSE; (4118)
      {
        int32_t numberRHS = (int32_t)(0);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (1, mCOMPARE_SOURCE, bitRHS);
        bitRHS->inUse = 0;
      }
      // INCLUDE_STMT = STMT_NUM; (4119)
      {
        int32_t numberRHS = (int32_t)(getFIXED (mCOMM + 4 * 3));
        putFIXED (mINCLUDE_STMT, numberRHS);
      }
    es9:;
    } // End of DO block
  // INCL_FLAGS = INCL_FLAGS | SHL( 1,SHR(INCLUDE_FILE#,1)); (4120)
  {
    int32_t numberRHS
        = (int32_t)(xOR (BYTE0 (mSTREAMxINCLUDE_OKxINCL_FLAGS),
                         SHL (1, SHR (COREHALFWORD (mINCLUDE_FILEp), 1))));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (8, mSTREAMxINCLUDE_OKxINCL_FLAGS, bitRHS);
    bitRHS->inUse = 0;
  }
  // REV_CAT = MONITOR(15); (4121)
  {
    int32_t numberRHS = (int32_t)(MONITOR15 ());
    putFIXED (mREV_CAT, numberRHS);
  }
  // INCLUDE_MSG = ' OF INCLUDED MEMBER, RVL ' || STRING( 16777216 |
  // ADDR(REV_CAT)) || ', CATENATION NUMBER ' || (REV_CAT &  65535); (4122)
  {
    descriptor_t *stringRHS;
    stringRHS = xsCAT (
        xsCAT (xsCAT (cToDescriptor (NULL, " OF INCLUDED MEMBER, RVL "),
                      getCHARACTERd (
                          xOR (16777216, ADDR (NULL, 0, "REV_CAT", 0)))),
               cToDescriptor (NULL, ", CATENATION NUMBER ")),
        fixedToCharacter (xAND (getFIXED (mREV_CAT), 65535)));
    putCHARACTER (mINCLUDE_MSG, stringRHS);
    stringRHS->inUse = 0;
  }
  // INCLUDE_LIST, INCLUDE_LIST2 = LIST_FLAG; (4123)
  {
    descriptor_t *bitRHS = getBIT (1, mSTREAMxINCLUDE_OKxLIST_FLAG);
    putBIT (1, mINCLUDE_LIST, bitRHS);
    putBIT (1, mINCLUDE_LIST2, bitRHS);
    bitRHS->inUse = 0;
  }
  // INCLUDE_OFFSET = CARD_COUNT + 1; (4124)
  {
    int32_t numberRHS = (int32_t)(xadd (getFIXED (mCARD_COUNT), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mINCLUDE_OFFSET, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF SIMULATING THEN (4125)
  if (1 & (bitToFixed (getBIT (8, mSIMULATING))))
    // CALL MAKE_INCL_CELL(MEMBER, INCL_FLAGS, REV_CAT); (4126)
    {
      putCHARACTERp (mMAKE_INCL_CELLxNAME, getCHARACTER (mMEMBER));
      putBITp (8, mMAKE_INCL_CELLxFLAGS,
               getBIT (8, mSTREAMxINCLUDE_OKxINCL_FLAGS));
      putFIXED (mMAKE_INCL_CELLxREV_CAT, getFIXED (mREV_CAT));
      MAKE_INCL_CELL (0);
    }
  // INCLUDING = TRUE; (4127)
  {
    int32_t numberRHS = (int32_t)(1);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (1, mINCLUDING, bitRHS);
    bitRHS->inUse = 0;
  }
  // INPUT_DEV = 4; (4128)
  {
    int32_t numberRHS = (int32_t)(4);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mINPUT_DEV, bitRHS);
    bitRHS->inUse = 0;
  }
  // INCLUDE_OPENED = TRUE; (4129)
  {
    int32_t numberRHS = (int32_t)(1);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (1, mINCLUDE_OPENED, bitRHS);
    bitRHS->inUse = 0;
  }
  // CURRENT_CARD = INPUT(INPUT_DEV); (4130)
  {
    descriptor_t *stringRHS;
    stringRHS = INPUT (COREHALFWORD (mINPUT_DEV));
    putCHARACTER (mCURRENT_CARD, stringRHS);
    stringRHS->inUse = 0;
  }
  // LRECL(1) = LENGTH(CURRENT_CARD) - 1; (4131)
  {
    int32_t numberRHS
        = (int32_t)(xsubtract (LENGTH (getCHARACTER (mCURRENT_CARD)), 1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mLRECL + 2 * (1), bitRHS);
    bitRHS->inUse = 0;
  }
  // IF BYTE(CURRENT_CARD) =  0 THEN (4132)
  if (1 & (xEQ (BYTE1 (getCHARACTER (mCURRENT_CARD)), 0)))
    // DO; (4133)
    {
    rs10:;
      // INCLUDE_COMPRESSED = TRUE; (4134)
      {
        int32_t numberRHS = (int32_t)(1);
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (1, mINCLUDE_COMPRESSED, bitRHS);
        bitRHS->inUse = 0;
      }
      // INPUT_REC(1) = CURRENT_CARD; (4135)
      {
        descriptor_t *stringRHS;
        stringRHS = getCHARACTER (mCURRENT_CARD);
        putCHARACTER (mINPUT_REC + 4 * (1), stringRHS);
        stringRHS->inUse = 0;
      }
    es10:;
    } // End of DO block
  // ELSE (4136)
  else
    // INITIAL_INCLUDE_RECORD = TRUE; (4137)
    {
      int32_t numberRHS = (int32_t)(1);
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (1, mINITIAL_INCLUDE_RECORD, bitRHS);
      bitRHS->inUse = 0;
    }
  // RETURN TRUE; (4138)
  {
    reentryGuard = 0;
    return fixedToBit (32, (int32_t)(1));
  }
}
