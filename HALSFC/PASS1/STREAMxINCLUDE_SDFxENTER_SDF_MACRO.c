/*
  File STREAMxINCLUDE_SDFxENTER_SDF_MACRO.c generated by XCOM-I, 2024-08-08
  04:31:11.
*/

#include "runtimeC.h"

int32_t
STREAMxINCLUDE_SDFxENTER_SDF_MACRO (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard
      = guardReentry (reentryGuard, "STREAMxINCLUDE_SDFxENTER_SDF_MACRO");
  // IF DUPLICATE_NAME(BCD) THEN (3809)
  if (1
      & (bitToFixed ((putCHARACTERp (mSTREAMxINCLUDE_SDFxDUPLICATE_NAMExNAME,
                                     getCHARACTER (mBCD)),
                      STREAMxINCLUDE_SDFxDUPLICATE_NAME (0)))))
    // DO; (3810)
    {
    rs1:;
      // CALL ERROR(CLASS_PM, 1, BCD); (3811)
      {
        putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_PM));
        putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(1)));
        putCHARACTERp (mERRORxTEXT, getCHARACTER (mBCD));
        ERROR (0);
      }
      // RETURN; (3812)
      {
        reentryGuard = 0;
        return 0;
      }
    es1:;
    } // End of DO block
  // MACRO_NDX = ENTER(BCD, REPL_CLASS); (3813)
  {
    int32_t numberRHS
        = (int32_t)((putCHARACTERp (mENTERxNAME, getCHARACTER (mBCD)),
                     putFIXED (mENTERxCLASS, BYTE0 (mREPL_CLASS)), ENTER (0)));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxMACRO_NDX, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF CONTROL( 3) THEN (3814)
  if (1 & (bitToFixed (getBIT (1, mCONTROL + 1 * 3))))
    // OUTPUT = 'ENTER_SDF_MACRO: ID_LOC = ' || MACRO_NDX || ', MACRO = ' ||
    // BCD; (3815)
    {
      descriptor_t *stringRHS;
      stringRHS = xsCAT (
          xsCAT (
              xsCAT (cToDescriptor (NULL, "ENTER_SDF_MACRO: ID_LOC = "),
                     bitToCharacter (getBIT (
                         16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxMACRO_NDX))),
              cToDescriptor (NULL, ", MACRO = ")),
          getCHARACTER (mBCD));
      OUTPUT (0, stringRHS);
      stringRHS->inUse = 0;
    }
  // TEMP_PTR = SDFPKG_LOC_PTR; (3816)
  {
    int32_t numberRHS = (int32_t)(getFIXED (
        getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD) + 4 * 6));
    putFIXED (mSTREAMxINCLUDE_SDFxTEMP_PTR, numberRHS);
  }
  // DO ; (3817)
  {
  rs2:;
    // COMMTABL_FULLWORD ( 6 ) = SDF_F ( 5 ) ; (3818)
    {
      int32_t numberRHS
          = (int32_t)(getFIXED (getFIXED (mSTREAMxINCLUDE_SDFxSDF_F) + 4 * 5));
      putFIXED (getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD) + 4 * (6),
                numberRHS);
    }
    // CALL MONITOR ( 22 , 5 ) ; (3819)
    MONITOR22 (5);
    // COREWORD ( ADDR ( SDF_B ) ) , COREWORD ( ADDR ( SDF_H ) ) , COREWORD (
    // ADDR ( SDF_F ) ) = COMMTABL_FULLWORD(7) ; (3820)
    {
      int32_t numberRHS = (int32_t)(getFIXED (
          getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD) + 4 * 7));
      COREWORD2 (ADDR ("STREAMxINCLUDE_SDFxSDF_B", 0x80000000, NULL, 0),
                 numberRHS);
      COREWORD2 (ADDR ("STREAMxINCLUDE_SDFxSDF_H", 0x80000000, NULL, 0),
                 numberRHS);
      COREWORD2 (ADDR ("STREAMxINCLUDE_SDFxSDF_F", 0x80000000, NULL, 0),
                 numberRHS);
    }
    // ; (3821)
    ;
  es2:;
  } // End of DO block
  // ; (3822)
  ;
  // MACRO_ARG_COUNT = SDF_REPL_ARG_CNT; (3823)
  {
    int32_t numberRHS = (int32_t)(xsubtract (
        xminus (COREHALFWORD (getFIXED (mSTREAMxINCLUDE_SDFxSDF_H) + 2 * 2)),
        1));
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mMACRO_ARG_COUNT, bitRHS);
    bitRHS->inUse = 0;
  }
  // DO I = 1 TO MACRO_ARG_COUNT; (3824)
  {
    int32_t from70, to70, by70;
    from70 = 1;
    to70 = bitToFixed (getBIT (16, mMACRO_ARG_COUNT));
    by70 = 1;
    for (putBIT (16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxI,
                 fixedToBit (16, from70));
         bitToFixed (getBIT (16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxI))
         <= to70;
         putBIT (
             16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxI,
             fixedToBit (16, bitToFixed (getBIT (
                                 16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxI))
                                 + by70)))
      {
        // BCD = NEW_STRING(SDF_REPL_ARG_NAME(I)); (3825)
        {
          descriptor_t *stringRHS;
          stringRHS = SUBSTR2 (
              xsCAT (
                  getCHARACTER (mX1),
                  getCHARACTERd (xadd (
                      getFIXED (
                          getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD)
                          + 4 * 7),
                      getFIXED (
                          getFIXED (mSTREAMxINCLUDE_SDFxSDF_F)
                          + 4
                                * xadd (
                                    1,
                                    COREHALFWORD (
                                        mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxI)))))),
              1);
          putCHARACTER (mBCD, stringRHS);
          stringRHS->inUse = 0;
        }
        // ID_LOC = ENTER(BCD, REPL_ARG_CLASS); (3826)
        {
          int32_t numberRHS = (int32_t)((
              putCHARACTERp (mENTERxNAME, getCHARACTER (mBCD)),
              putFIXED (mENTERxCLASS, BYTE0 (mREPL_ARG_CLASS)), ENTER (0)));
          putFIXED (mID_LOC, numberRHS);
        }
        // IF CONTROL( 3) THEN (3827)
        if (1 & (bitToFixed (getBIT (1, mCONTROL + 1 * 3))))
          // OUTPUT = 'ENTER_SDF_MACRO: ID_LOC = ' || ID_LOC || ', ARG = ' ||
          // BCD; (3828)
          {
            descriptor_t *stringRHS;
            stringRHS = xsCAT (
                xsCAT (
                    xsCAT (cToDescriptor (NULL, "ENTER_SDF_MACRO: ID_LOC = "),
                           fixedToCharacter (getFIXED (mID_LOC))),
                    cToDescriptor (NULL, ", ARG = ")),
                getCHARACTER (mBCD));
            OUTPUT (0, stringRHS);
            stringRHS->inUse = 0;
          }
        // SYT_FLAGS(ID_LOC) = INACTIVE_FLAG; (3829)
        {
          int32_t numberRHS = (int32_t)(32768);
          putFIXED (getFIXED (mSYM_TAB) + 34 * (getFIXED (mID_LOC)) + 8
                        + 4 * (0),
                    numberRHS);
        }
      }
  } // End of DO for-loop block
  // VAR_LENGTH(MACRO_NDX) = MACRO_ARG_COUNT; (3830)
  {
    descriptor_t *bitRHS = getBIT (16, mMACRO_ARG_COUNT);
    putBIT (16,
            getFIXED (mSYM_TAB)
                + 34
                      * (COREHALFWORD (
                          mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxMACRO_NDX))
                + 18 + 2 * (0),
            bitRHS);
    bitRHS->inUse = 0;
  }
  // START_POINT, SYT_ADDR(MACRO_NDX) = FIRST_FREE; (3831)
  {
    int32_t numberRHS = (int32_t)(getFIXED (mCOMM + 4 * 9));
    putFIXED (mSTART_POINT, numberRHS);
    putFIXED (getFIXED (mSYM_TAB)
                  + 34
                        * (COREHALFWORD (
                            mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxMACRO_NDX))
                  + 4 + 4 * (0),
              numberRHS);
  }
// MOVE_TEXT: (3832)
MOVE_TEXT:
  // DO WHILE SDF_REPL_NEXT_PTR ~= 0; (3833)
  while (1
         & (xNEQ (getFIXED (getFIXED (mSTREAMxINCLUDE_SDFxSDF_F) + 4 * 0), 0)))
    {
      // DO ; (3834)
      {
      rs4s1:;
        // COMMTABL_FULLWORD ( 6 ) = SDF_F ( 0 ) ; (3835)
        {
          int32_t numberRHS = (int32_t)(getFIXED (
              getFIXED (mSTREAMxINCLUDE_SDFxSDF_F) + 4 * 0));
          putFIXED (getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD) + 4 * (6),
                    numberRHS);
        }
        // CALL MONITOR ( 22 , 5 ) ; (3836)
        MONITOR22 (5);
        // COREWORD ( ADDR ( SDF_B ) ) , COREWORD ( ADDR ( SDF_H ) ) , COREWORD
        // ( ADDR ( SDF_F ) ) = COMMTABL_FULLWORD(7) ; (3837)
        {
          int32_t numberRHS = (int32_t)(getFIXED (
              getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD) + 4 * 7));
          COREWORD2 (ADDR ("STREAMxINCLUDE_SDFxSDF_B", 0x80000000, NULL, 0),
                     numberRHS);
          COREWORD2 (ADDR ("STREAMxINCLUDE_SDFxSDF_H", 0x80000000, NULL, 0),
                     numberRHS);
          COREWORD2 (ADDR ("STREAMxINCLUDE_SDFxSDF_F", 0x80000000, NULL, 0),
                     numberRHS);
        }
        // ; (3838)
        ;
      es4s1:;
      } // End of DO block
      // ; (3839)
      ;
      // #BYTES = SDF_REPL_#BYTES; (3840)
      {
        descriptor_t *bitRHS
            = getBIT (16, getFIXED (mSTREAMxINCLUDE_SDFxSDF_H) + 2 * 2);
        putBIT (16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxpBYTES, bitRHS);
        bitRHS->inUse = 0;
      }
      // DO I= 1 TO #BYTES; (3841)
      {
        int32_t from71, to71, by71;
        from71 = 1;
        to71 = bitToFixed (
            getBIT (16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxpBYTES));
        by71 = 1;
        for (putBIT (16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxI,
                     fixedToBit (16, from71));
             bitToFixed (getBIT (16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxI))
             <= to71;
             putBIT (16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxI,
                     fixedToBit (
                         16, bitToFixed (getBIT (
                                 16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxI))
                                 + by71)))
          {
            // DO ; (3842)
            {
            rs4s2s1:;
              // IF COREWORD ( ADDR ( MACRO_TEXTS ) + 12 ) >= COREWORD ( ADDR (
              // MACRO_TEXTS ) + 8 ) THEN (3843)
              if (1
                  & (xGE (COREWORD (xadd (
                              ADDR ("MACRO_TEXTS", 0x80000000, NULL, 0), 12)),
                          COREWORD (xadd (
                              ADDR ("MACRO_TEXTS", 0x80000000, NULL, 0), 8)))))
                // CALL _NEEDMORE_SPACE ( ADDR ( MACRO_TEXTS )  ) ; (3844)
                {
                  putFIXED (m_NEEDMORE_SPACExDOPE,
                            ADDR ("MACRO_TEXTS", 0x80000000, NULL, 0));
                  _NEEDMORE_SPACE (0);
                }
              // COREWORD ( ADDR ( MACRO_TEXTS ) + 12 ) = COREWORD ( ADDR (
              // MACRO_TEXTS ) + 12 ) + 1 ; (3845)
              {
                int32_t numberRHS = (int32_t)(xadd (
                    COREWORD (
                        xadd (ADDR ("MACRO_TEXTS", 0x80000000, NULL, 0), 12)),
                    1));
                COREWORD2 (
                    xadd (ADDR ("MACRO_TEXTS", 0x80000000, NULL, 0), 12),
                    numberRHS);
              }
            es4s2s1:;
            } // End of DO block
          }
      } // End of DO for-loop block
      // CALL MOVE(#BYTES, SDF_REPL_TEXT_ADDR, ADDR(MACRO_TEXTS(FIRST_FREE)));
      // (3846)
      {
        putBITp (16, mMOVExLEGNTH,
                 getBIT (16, mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxpBYTES));
        putFIXED (
            mMOVExFROM,
            xadd (getFIXED (getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD)
                            + 4 * 7),
                  6));
        putFIXED (mMOVExINTO,
                  ADDR ("MACRO_TEXTS", getFIXED (mCOMM + 4 * 9), NULL, 0));
        MOVE (0);
      }
      // FIRST_FREE = FIRST_FREE + #BYTES; (3847)
      {
        int32_t numberRHS = (int32_t)(xadd (
            getFIXED (mCOMM + 4 * 9),
            COREHALFWORD (mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxpBYTES)));
        putFIXED (mCOMM + 4 * (9), numberRHS);
      }
      if (0)
        {
        rs4:
          continue;
        es4:
          break;
        } // block labeled MOVE_TEXT
    }     // End of DO WHILE block
  // CALL FINISH_MACRO_TEXT; (3848)
  FINISH_MACRO_TEXT (0);
  // EXTENT(MACRO_NDX) = REPLACE_TEXT_PTR; (3849)
  {
    int32_t numberRHS = (int32_t)(getFIXED (mREPLACE_TEXT_PTR));
    putFIXED (getFIXED (mSYM_TAB)
                  + 34
                        * (COREHALFWORD (
                            mSTREAMxINCLUDE_SDFxENTER_SDF_MACROxMACRO_NDX))
                  + 12 + 4 * (0),
              numberRHS);
  }
  // DO ; (3850)
  {
  rs5:;
    // COMMTABL_FULLWORD ( 6 ) = TEMP_PTR ; (3851)
    {
      int32_t numberRHS = (int32_t)(getFIXED (mSTREAMxINCLUDE_SDFxTEMP_PTR));
      putFIXED (getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD) + 4 * (6),
                numberRHS);
    }
    // CALL MONITOR ( 22 , 5 ) ; (3852)
    MONITOR22 (5);
    // COREWORD ( ADDR ( SDF_B ) ) , COREWORD ( ADDR ( SDF_H ) ) , COREWORD (
    // ADDR ( SDF_F ) ) = COMMTABL_FULLWORD(7) ; (3853)
    {
      int32_t numberRHS = (int32_t)(getFIXED (
          getFIXED (mSTREAMxINCLUDE_SDFxCOMMTABL_FULLWORD) + 4 * 7));
      COREWORD2 (ADDR ("STREAMxINCLUDE_SDFxSDF_B", 0x80000000, NULL, 0),
                 numberRHS);
      COREWORD2 (ADDR ("STREAMxINCLUDE_SDFxSDF_H", 0x80000000, NULL, 0),
                 numberRHS);
      COREWORD2 (ADDR ("STREAMxINCLUDE_SDFxSDF_F", 0x80000000, NULL, 0),
                 numberRHS);
    }
    // ; (3854)
    ;
  es5:;
  } // End of DO block
  // ; (3855)
  ;
  // RETURN; (3856)
  {
    reentryGuard = 0;
    return 0;
  }
}
