/*
  File ASSOCIATE.c generated by XCOM-I, 2024-08-08 04:31:11.
*/

#include "runtimeC.h"

int32_t
ASSOCIATE (int reset)
{
  static int reentryGuard = 0;
  if (reset)
    {
      reentryGuard = 0;
      return (int32_t)0;
    }
  reentryGuard = guardReentry (reentryGuard, "ASSOCIATE");
  // IF FIXV(MP)=0 THEN (9888)
  if (1 & (xEQ (getFIXED (mFIXV + 4 * getFIXED (mMP)), 0)))
    // I=FIXL(MP); (9889)
    {
      int32_t numberRHS = (int32_t)(getFIXED (mFIXL + 4 * getFIXED (mMP)));
      putFIXED (mASSOCIATExI, numberRHS);
    }
  // ELSE (9890)
  else
    // I=FIXV(MP); (9891)
    {
      int32_t numberRHS = (int32_t)(getFIXED (mFIXV + 4 * getFIXED (mMP)));
      putFIXED (mASSOCIATExI, numberRHS);
    }
  // IF (SYT_FLAGS(I) & READ_ACCESS_FLAG) ~= 0 THEN (9892)
  if (1
      & (xNEQ (xAND (getFIXED (getFIXED (mSYM_TAB)
                               + 34 * (getFIXED (mASSOCIATExI)) + 8 + 4 * (0)),
                     536870912),
               0)))
    // CALL ERROR(CLASS_PS, 9, VAR(MP)); (9893)
    {
      putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_PS));
      putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(9)));
      putCHARACTERp (mERRORxTEXT, getCHARACTER (mVAR + 4 * getFIXED (mMP)));
      ERROR (0);
    }
  // IF (SYT_FLAGS(I) & LOCK_FLAG) ~= 0 THEN (9894)
  if (1
      & (xNEQ (xAND (getFIXED (getFIXED (mSYM_TAB)
                               + 34 * (getFIXED (mASSOCIATExI)) + 8 + 4 * (0)),
                     1),
               0)))
    // IF ~ASSIGN_ARG_LIST THEN (9895)
    if (1 & (xNOT (BYTE0 (mASSIGN_ARG_LIST))))
      // IF UPDATE_BLOCK_LEVEL <= 0 THEN (9896)
      if (1 & (xLE (COREHALFWORD (mUPDATE_BLOCK_LEVEL), 0)))
        // CALL ERROR(CLASS_UI, 1, VAR(MP)); (9897)
        {
          putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_UI));
          putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(1)));
          putCHARACTERp (mERRORxTEXT,
                         getCHARACTER (mVAR + 4 * getFIXED (mMP)));
          ERROR (0);
        }
  // J=PSEUDO_TYPE(PTR(MP)); (9898)
  {
    descriptor_t *bitRHS = getBIT (
        8, mPSEUDO_TYPE + 1 * COREHALFWORD (mPTR + 2 * getFIXED (mMP)));
    int32_t numberRHS;
    numberRHS = bitToFixed (bitRHS);
    putFIXED (mASSOCIATExJ, numberRHS);
    bitRHS->inUse = 0;
  }
  // L = EXT_P(PTR(MP)); (9899)
  {
    descriptor_t *bitRHS
        = getBIT (16, mEXT_P + 2 * COREHALFWORD (mPTR + 2 * getFIXED (mMP)));
    int32_t numberRHS;
    numberRHS = bitToFixed (bitRHS);
    putFIXED (mASSOCIATExL, numberRHS);
    bitRHS->inUse = 0;
  }
  // IF J>TEMPL_NAME THEN (9900)
  if (1 & (xGT (getFIXED (mASSOCIATExJ), 62)))
    // GO TO ARR_STRUC_CHECK; (9901)
    goto ARR_STRUC_CHECK;
  // IF L >= 0 THEN (9902)
  if (1 & (xGE (getFIXED (mASSOCIATExL), 0)))
    // DO; (9903)
    {
    rs1:;
      // I = TOKEN_FLAGS(L); (9904)
      {
        descriptor_t *bitRHS
            = getBIT (16, mTOKEN_FLAGS + 2 * getFIXED (mASSOCIATExL));
        int32_t numberRHS;
        numberRHS = bitToFixed (bitRHS);
        putFIXED (mASSOCIATExI, numberRHS);
        bitRHS->inUse = 0;
      }
      // K = I &  31; (9905)
      {
        int32_t numberRHS = (int32_t)(xAND (getFIXED (mASSOCIATExI), 31));
        putFIXED (mASSOCIATExK, numberRHS);
      }
      // IF K = 7 THEN (9906)
      if (1 & (xEQ (getFIXED (mASSOCIATExK), 7)))
        // GO TO ARR_STRUC_CHECK; (9907)
        goto ARR_STRUC_CHECK;
      // IF K >= 3 THEN (9908)
      if (1 & (xGE (getFIXED (mASSOCIATExK), 3)))
        // IF K <= 4 THEN (9909)
        if (1 & (xLE (getFIXED (mASSOCIATExK), 4)))
          // IF (J &  31) ~= K THEN (9910)
          if (1
              & (xNEQ (xAND (getFIXED (mASSOCIATExJ), 31),
                       getFIXED (mASSOCIATExK))))
            // CALL ERROR(CLASS_SV, 2, VAR(MP)); (9911)
            {
              putBITp (16, mERRORxCLASS, getBIT (16, mCLASS_SV));
              putBITp (8, mERRORxNUM, fixedToBit (32, (int32_t)(2)));
              putCHARACTERp (mERRORxTEXT,
                             getCHARACTER (mVAR + 4 * getFIXED (mMP)));
              ERROR (0);
            }
      // I = (I - K) | (J &  31); (9912)
      {
        int32_t numberRHS = (int32_t)(xOR (
            xsubtract (getFIXED (mASSOCIATExI), getFIXED (mASSOCIATExK)),
            xAND (getFIXED (mASSOCIATExJ), 31)));
        putFIXED (mASSOCIATExI, numberRHS);
      }
      // TOKEN_FLAGS(L) = I; (9913)
      {
        int32_t numberRHS = (int32_t)(getFIXED (mASSOCIATExI));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mTOKEN_FLAGS + 2 * (getFIXED (mASSOCIATExL)), bitRHS);
        bitRHS->inUse = 0;
      }
    es1:;
    } // End of DO block
// ARR_STRUC_CHECK: (9914)
ARR_STRUC_CHECK:
  // K = STACK_PTR(MP); (9915)
  {
    descriptor_t *bitRHS = getBIT (16, mSTACK_PTR + 2 * getFIXED (mMP));
    int32_t numberRHS;
    numberRHS = bitToFixed (bitRHS);
    putFIXED (mASSOCIATExK, numberRHS);
    bitRHS->inUse = 0;
  }
  // J=VAL_P(PTR(MP)); (9916)
  {
    descriptor_t *bitRHS
        = getBIT (16, mVAL_P + 2 * COREHALFWORD (mPTR + 2 * getFIXED (mMP)));
    int32_t numberRHS;
    numberRHS = bitToFixed (bitRHS);
    putFIXED (mASSOCIATExJ, numberRHS);
    bitRHS->inUse = 0;
  }
  // IF DELAY_CONTEXT_CHECK THEN (9917)
  if (1 & (bitToFixed (getBIT (1, mDELAY_CONTEXT_CHECK))))
    // IF SUBSCRIPT_LEVEL = 0 THEN (9918)
    if (1 & (xEQ (COREHALFWORD (mSUBSCRIPT_LEVEL), 0)))
      // DO; (9919)
      {
      rs2:;
        // CALL SAVE_ARRAYNESS; (9920)
        SAVE_ARRAYNESS (0);
        // IF (J& 518)= 514 THEN (9921)
        if (1 & (xEQ (xAND (getFIXED (mASSOCIATExJ), 518), 514)))
          // DO; (9922)
          {
          rs2s1:;
            // AS_PTR=AS_PTR-1; (9923)
            {
              int32_t numberRHS
                  = (int32_t)(xsubtract (COREHALFWORD (mAS_PTR), 1));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mAS_PTR, bitRHS);
              bitRHS->inUse = 0;
            }
            // EXT_P(PTR(MP))=ARRAYNESS_STACK(AS_PTR); (9924)
            {
              descriptor_t *bitRHS
                  = getBIT (16, mARRAYNESS_STACK + 2 * COREHALFWORD (mAS_PTR));
              putBIT (16,
                      mEXT_P + 2 * (COREHALFWORD (mPTR + 2 * getFIXED (mMP))),
                      bitRHS);
              bitRHS->inUse = 0;
            }
            // IF TAG>=0 THEN (9925)
            if (1 & (xGE (COREHALFWORD (mASSOCIATExTAG), 0)))
              // CALL HALMAT_FIX_POPTAG(TAG,1); (9926)
              {
                putFIXED (mHALMAT_FIX_POPTAGxPOP_LOC,
                          COREHALFWORD (mASSOCIATExTAG));
                putBITp (8, mHALMAT_FIX_POPTAGxTAG,
                         fixedToBit (32, (int32_t)(1)));
                HALMAT_FIX_POPTAG (0);
              }
            // J=J& 57342; (9927)
            {
              int32_t numberRHS
                  = (int32_t)(xAND (getFIXED (mASSOCIATExJ), 57342));
              putFIXED (mASSOCIATExJ, numberRHS);
            }
            // ARRAYNESS_STACK(AS_PTR)=ARRAYNESS_STACK(AS_PTR+1)-1; (9928)
            {
              int32_t numberRHS = (int32_t)(xsubtract (
                  COREHALFWORD (mARRAYNESS_STACK
                                + 2 * xadd (COREHALFWORD (mAS_PTR), 1)),
                  1));
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16, mARRAYNESS_STACK + 2 * (COREHALFWORD (mAS_PTR)),
                      bitRHS);
              bitRHS->inUse = 0;
            }
          es2s1:;
          } // End of DO block
        // ELSE (9929)
        else
          // DO; (9930)
          {
          rs2s2:;
            // EXT_P(PTR(MP))=0; (9931)
            {
              int32_t numberRHS = (int32_t)(0);
              descriptor_t *bitRHS;
              bitRHS = fixedToBit (32, (int32_t)(numberRHS));
              putBIT (16,
                      mEXT_P + 2 * (COREHALFWORD (mPTR + 2 * getFIXED (mMP))),
                      bitRHS);
              bitRHS->inUse = 0;
            }
            // J=J& 65532; (9932)
            {
              int32_t numberRHS
                  = (int32_t)(xAND (getFIXED (mASSOCIATExJ), 65532));
              putFIXED (mASSOCIATExJ, numberRHS);
            }
          es2s2:;
          } // End of DO block
      es2:;
      } // End of DO block
  // IF J THEN (9933)
  if (1 & (getFIXED (mASSOCIATExJ)))
    // DO; (9934)
    {
    rs3:;
      // GRAMMAR_FLAGS(K) = GRAMMAR_FLAGS(K) | LEFT_BRACKET_FLAG; (9935)
      {
        int32_t numberRHS = (int32_t)(xOR (
            COREHALFWORD (mGRAMMAR_FLAGS + 2 * getFIXED (mASSOCIATExK)),
            COREHALFWORD (mLEFT_BRACKET_FLAG)));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGRAMMAR_FLAGS + 2 * (getFIXED (mASSOCIATExK)), bitRHS);
        bitRHS->inUse = 0;
      }
      // GRAMMAR_FLAGS(L) = GRAMMAR_FLAGS(L) | RIGHT_BRACKET_FLAG; (9936)
      {
        int32_t numberRHS = (int32_t)(xOR (
            COREHALFWORD (mGRAMMAR_FLAGS + 2 * getFIXED (mASSOCIATExL)),
            COREHALFWORD (mRIGHT_BRACKET_FLAG)));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGRAMMAR_FLAGS + 2 * (getFIXED (mASSOCIATExL)), bitRHS);
        bitRHS->inUse = 0;
      }
    es3:;
    } // End of DO block
  // IF SHR(J,1) THEN (9937)
  if (1 & (SHR (getFIXED (mASSOCIATExJ), 1)))
    // DO; (9938)
    {
    rs4:;
      // GRAMMAR_FLAGS(K) = GRAMMAR_FLAGS(K) | LEFT_BRACE_FLAG; (9939)
      {
        int32_t numberRHS = (int32_t)(xOR (
            COREHALFWORD (mGRAMMAR_FLAGS + 2 * getFIXED (mASSOCIATExK)),
            COREHALFWORD (mLEFT_BRACE_FLAG)));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGRAMMAR_FLAGS + 2 * (getFIXED (mASSOCIATExK)), bitRHS);
        bitRHS->inUse = 0;
      }
      // GRAMMAR_FLAGS(L) = GRAMMAR_FLAGS(L) | RIGHT_BRACE_FLAG; (9940)
      {
        int32_t numberRHS = (int32_t)(xOR (
            COREHALFWORD (mGRAMMAR_FLAGS + 2 * getFIXED (mASSOCIATExL)),
            COREHALFWORD (mRIGHT_BRACE_FLAG)));
        descriptor_t *bitRHS;
        bitRHS = fixedToBit (32, (int32_t)(numberRHS));
        putBIT (16, mGRAMMAR_FLAGS + 2 * (getFIXED (mASSOCIATExL)), bitRHS);
        bitRHS->inUse = 0;
      }
    es4:;
    } // End of DO block
  // TAG=-1; (9941)
  {
    int32_t numberRHS = (int32_t)(-1);
    descriptor_t *bitRHS;
    bitRHS = fixedToBit (32, (int32_t)(numberRHS));
    putBIT (16, mASSOCIATExTAG, bitRHS);
    bitRHS->inUse = 0;
  }
  // IF SHR(J,13) THEN (9942)
  if (1 & (SHR (getFIXED (mASSOCIATExJ), 13)))
    // VAL_P(PTR(MP))=J| 16; (9943)
    {
      int32_t numberRHS = (int32_t)(xOR (getFIXED (mASSOCIATExJ), 16));
      descriptor_t *bitRHS;
      bitRHS = fixedToBit (32, (int32_t)(numberRHS));
      putBIT (16, mVAL_P + 2 * (COREHALFWORD (mPTR + 2 * getFIXED (mMP))),
              bitRHS);
      bitRHS->inUse = 0;
    }
  {
    reentryGuard = 0;
    return 0;
  }
}
